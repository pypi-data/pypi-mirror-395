Metadata-Version: 2.3
Name: pilmoji-for-parser
Version: 0.2.0
Summary: Pilmoji for nonebot-plugin-parser
Requires-Dist: aiofiles>=25.1.0
Requires-Dist: emoji>=2.15.0,<3.0.0
Requires-Dist: httpx>=0.27.2,<1.0.0
Requires-Dist: pillow>=11.0.0
Requires-Dist: tqdm>=4.66.0 ; extra == 'tqdm'
Requires-Python: >=3.10
Project-URL: IssueTracker, https://github.com/fllesser/pilmoji-for-parser/issues
Project-URL: Release, https://github.com/fllesser/pilmoji-for-parser/releases
Project-URL: Repository, https://github.com/fllesser/pilmoji-for-parser
Provides-Extra: tqdm
Description-Content-Type: text/markdown

# Pilmoji for Parser

A simplified emoji renderer for [Pillow](https://github.com/python-pillow/Pillow/), Python's imaging library. This is a streamlined fork optimized for use with [nonebot-plugin-parser](https://github.com/fllesser/nonebot-plugin-parser).

## âœ¨ Features

- ğŸ¨ **Unicode Emoji Support** - Render standard Unicode emojis
- ğŸ’¬ **Discord Emoji Support** - Render custom Discord emojis
- ğŸ“ **Multi-line Text** - Automatic line break handling
- ğŸ­ **Multiple Emoji Styles** - Apple, Google, Twitter, Facebook
- âš¡ **Async/Await** - Built with modern async Python
- ğŸ’¾ **Smart Caching** - Local file caching for better performance
- ğŸ”§ **Simple API** - Easy-to-use interface with sensible defaults

## ğŸ“¦ Installation

**Requirements:** Python 3.10 or higher

```bash
pip install pilmoji-for-parser
```

Or install from source:

```bash
git clone https://github.com/fllesser/pilmoji-for-parser.git
cd pilmoji-for-parser
pip install .
```

## ğŸš€ Quick Start

### Basic Usage (Unicode Emoji Only)

```python
import asyncio
from pilmoji import Pilmoji
from PIL import Image, ImageFont

async def main():
    text = '''
    Hello, world! ğŸ‘‹ 
    Here are some emojis: ğŸ¨ ğŸŒŠ ğŸ˜
    Multi-line support! ğŸš€ âœ¨
    '''
    
    # Create image
    image = Image.new('RGB', (550, 150), (255, 255, 255))
    font = ImageFont.truetype('arial.ttf', 24)
    
    # Render text with emojis
    async with Pilmoji() as pilmoji:
        await pilmoji.text(image, (10, 10), text.strip(), font, fill=(0, 0, 0))
    
    image.save('output.png')
    image.show()

asyncio.run(main())
```

### With Discord Emoji Support

```python
async def main():
    text = '''
    Unicode emoji: ğŸ‘‹ ğŸ¨ ğŸ˜
    Discord emoji: <:custom:123456789012345678>
    '''
    
    image = Image.new('RGB', (550, 100), (255, 255, 255))
    font = ImageFont.truetype('arial.ttf', 24)
    
    async with Pilmoji() as pilmoji:
        await pilmoji.text_with_discord_emoji(
            image, (10, 10), text.strip(), font, fill=(0, 0, 0)
        )
    
    image.save('output.png')

asyncio.run(main())
```

## ğŸ¨ Emoji Styles

Choose from different emoji styles:

```python
from pilmoji import Pilmoji, EmojiStyle, EmojiCDNSource

# Apple style (default)
source = EmojiCDNSource(style=EmojiStyle.APPLE)

# Google style
source = EmojiCDNSource(style=EmojiStyle.GOOGLE)

# Twitter style
source = EmojiCDNSource(style=EmojiStyle.TWITTER)

# Facebook style
source = EmojiCDNSource(style=EmojiStyle.FACEBOOK)

async with Pilmoji(source=source) as pilmoji:
    await pilmoji.text(image, (10, 10), "Hello ğŸ‘‹", font)
```

## ğŸ”§ API Reference

### `Pilmoji`

Main class for rendering text with emojis.

**Constructor:**
```python
Pilmoji(
    source: BaseSource = EmojiCDNSource(),
    cache: bool = True
)
```

**Parameters:**
- `source`: Emoji source to use (default: `EmojiCDNSource()`)
- `cache`: Enable emoji caching (default: `True`)

**Methods:**

#### `async text(image, xy, text, font, fill=None)`

Render text with Unicode emoji support.

- `image`: PIL Image object to render onto
- `xy`: Tuple of (x, y) coordinates for text position
- `text`: Text string to render (supports multiple lines)
- `font`: PIL Font object
- `fill`: Text color (default: black)

#### `async text_with_discord_emoji(image, xy, text, font, fill=None)`

Render text with both Unicode and Discord emoji support.

Parameters are the same as `text()`.

### `EmojiCDNSource`

Default emoji source using [emojicdn.elk.sh](https://emojicdn.elk.sh/).

**Constructor:**
```python
EmojiCDNSource(
    style: EmojiStyle = EmojiStyle.APPLE,
    cache_dir: Path | None = None
)
```

**Parameters:**
- `style`: Emoji style to use (Apple, Google, Twitter, Facebook)
- `cache_dir`: Custom cache directory (default: `~/.cache/pilmoji`)

## ğŸ”Œ Custom Emoji Sources

Create your own emoji source by subclassing `BaseSource`:

```python
from pilmoji import BaseSource
from io import BytesIO

class CustomEmojiSource(BaseSource):
    async def get_emoji(self, emoji: str) -> BytesIO | None:
        # Your custom emoji fetching logic
        pass
    
    async def get_discord_emoji(self, id: int) -> BytesIO | None:
        # Your custom Discord emoji fetching logic
        pass

# Use your custom source
async with Pilmoji(source=CustomEmojiSource()) as pilmoji:
    await pilmoji.text(image, (10, 10), "Hello ğŸ‘‹", font)
```

## ğŸ“ Examples

### Different Text Colors

```python
# Red text
await pilmoji.text(image, (10, 10), "Red text ğŸ”´", font, fill=(255, 0, 0))

# RGB tuple
await pilmoji.text(image, (10, 50), "Blue text ğŸ”µ", font, fill=(0, 0, 255))

# RGBA tuple with transparency
await pilmoji.text(image, (10, 90), "Semi-transparent ğŸ‘»", font, fill=(0, 0, 0, 128))
```

### Multi-line Text

```python
text = """Line 1 with emoji ğŸ¨
Line 2 with emoji ğŸŒŠ
Line 3 with emoji ğŸ˜"""

await pilmoji.text(image, (10, 10), text, font, fill=(0, 0, 0))
```

### Without Context Manager

```python
pilmoji = Pilmoji()
await pilmoji.text(image, (10, 10), "Hello ğŸ‘‹", font)
await pilmoji.aclose()  # Don't forget to close!
```

## ğŸ§ª Development

### Setup

```bash
# Clone the repository
git clone https://github.com/fllesser/pilmoji-for-parser.git
cd pilmoji-for-parser

# Install dependencies
uv sync --dev

# Run tests
uv run pytest

# Run linting
uv run ruff check src/
```

### Running Tests

```bash
# Run all tests
uv run poe test

# Run with coverage
uv run pytest --cov=src --cov-report=html
```

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## ğŸ™ Acknowledgments

- Original [Pilmoji](https://github.com/jay3332/pilmoji) project by jay3332
- [Pillow](https://github.com/python-pillow/Pillow/) - Python Imaging Library
- [emojicdn.elk.sh](https://emojicdn.elk.sh/) - Emoji CDN service

## ğŸ”— Links

- **Repository:** https://github.com/fllesser/pilmoji-for-parser
- **Issues:** https://github.com/fllesser/pilmoji-for-parser/issues
- **Releases:** https://github.com/fllesser/pilmoji-for-parser/releases
- **Related Project:** [nonebot-plugin-parser](https://github.com/fllesser/nonebot-plugin-parser)

[project]
name = "splunk-appinspect"
description = "Automatic validation checks for Splunk Apps"
authors = [{ name = "Splunk", email = "devsupport-splunk@cisco.com" }]
requires-python = ">=3.7"
readme = "splunk_appinspect/README.md"
license = {text = "Proprietary"}
keywords = [
    "AppInspect",
    "Certification",
    "Splunk",
    "Splunk AppInspect",
    "Testing",
]
classifiers = [
    "Development Status :: 5 - Production/Stable",
    "Environment :: Console",
    "Intended Audience :: Developers",
    "Intended Audience :: End Users/Desktop",
    "Natural Language :: English",
    "Operating System :: MacOS",
    "Operating System :: Microsoft",
    "Operating System :: Unix",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: Implementation :: CPython",
    "Topic :: Software Development :: Testing",
    "Topic :: Utilities",
]
dependencies = [
    "beautifulsoup4==4.10.0",
    "chardet==3.0.4",
    "click>=8.0.0",
    "croniter>=0.3.34,<2.0.0",
    "defusedxml==0.7.1",
    "jinja2>=3.1.6,<4.0.0",
    "lxml>=5.3.0,<6.0.0",
    "mako>=1.0.12,<2.0.0",
    "markdown>=3.1.1,<4.0.0",
    "packaging-legacy==23.0",
    "painter>=0.3.1,<1.0.0",
    "pyyaml>=6.0.1,<7.0.0",
    "structlog>=23.1.0,<=24.4.0",
    "semver>=2.13.0",
    "python-magic==0.4.24 ; sys_platform != 'win32'",
    "python-magic-bin==0.4.14 ; sys_platform == 'win32'",
    "pywin32==310 ; sys_platform == 'win32'",
]
dynamic = ["version"]

[project.optional-dependencies]
mcp = [
    "fastmcp>=2.13.0.2,<3 ; python_full_version >= '3.10'",
]

[project.urls]
Homepage = "https://splunk.com"
Repository = "https://dev.splunk.com/goto/appinspectdownload"

[project.scripts]
splunk-appinspect = "splunk_appinspect.main:execute"

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.hatch.build]
include = [
    "splunk_appinspect",
    "tarsec/tarsec"
]
artifacts = [
    "splunk_appinspect/python_analyzer/trustedlibs/lib_files/*.csv",
]

[tool.hatch.version]
path = "splunk_appinspect/version/VERSION.txt"
pattern = "^(?P<version>.+)$"

[dependency-groups]
dev = [
    "pytest",
    "configparser==3.5.0",
    "Pympler==0.8",
    "pytest-cov==3.0.0",
    "pytest-xdist==2.4.0",
    "virtualenv==20.26.2",
    {include-group = "static-analysis"}
]
static-analysis = [
    "black==25.1.0 ; python_version >= '3.13'",
    "isort==5.12.0 ; python_version >= '3.13'",
    "flake8==7.1.0 ; python_version >= '3.13'",
    "typos==1.17.2 ; python_version >= '3.13'",
    "codespell==2.2.6 ; python_version >= '3.13'",
]

[tool.pydocstyle]
ignore = ["D202", "D204", "D205", "D208", "D301", "D400", "D401"]
match-dir= "[^contrib|.env|.venv|venv].*"

[tool.black]
target-version = ["py312"] # TODO change to py313 when possible
force-exclude = "venv|inconsistent_tab_space|syntax_error|null_byte|with_hardcoded|malformed|splunklib_dependency_under_bin|has_python_sdk|has_binary_file|tarsec|data|packages|python_analyzer_packages"
line-length = 120

[tool.isort]
line_length = 120
profile = "black"
skip = [".poetry", ".venv", "venv", "./build", "./tarsec", "splunklib_dependency_under_bin", "has_python_sdk_old_deep_nested", "has_python_sdk_old", "has_binary_file", "data", "packages", "python_analyzer_packages"]
multi_line_output = "3"
include_trailing_comma = true
force_grid_wrap = "0"
use_parentheses = true


[tool.hatch.build.targets.sdist]
only-include = [
    "splunk_appinspect",
    "tarsec/tarsec",
    "scripts/splunk-appinspect",
]

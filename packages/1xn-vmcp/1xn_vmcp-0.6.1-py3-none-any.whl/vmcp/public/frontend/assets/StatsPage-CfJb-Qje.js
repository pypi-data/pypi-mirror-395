import{j as e}from"./ui-BzkW_zSA.js";import{r as l}from"./vendor-Dje7enk0.js";import{c as D,p as N,u as ne,d as le,N as oe,B as h,S as z,I as ce,y as ie,n as de,r as me,a as xe,M as ue}from"./index-CxHQsSmh.js";import{C as f,a as j,d as B,b as O,c as V}from"./card-BfWTGDCc.js";import{B as E}from"./badge-B4R87TdU.js";import{S as M}from"./searchable-select-8QB8UQao.js";import{c as he,d as ge,D as pe,e as fe,b as je,i as be}from"./dropdown-menu-Vp8-epT-.js";import{R as H}from"./refresh-cw-CiD6VP0n.js";import{A as Ne}from"./activity-xqzoIOr-.js";import{Z as ve}from"./zap-BQC4oCcW.js";import{F as $}from"./file-text-BF6iJmBf.js";import{C as we}from"./chevron-down-Cj0HsQ0D.js";import"./check-D22Mrj8T.js";const ye=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],b=D("bot",ye);const ke=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ce=D("chevron-left",ke);const Se=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],q=D("funnel",Se);function _e({className:r,...t}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:N("w-full caption-bottom text-sm",r),...t})})}function Me({className:r,...t}){return e.jsx("thead",{"data-slot":"table-header",className:N("[&_tr]:border-b",r),...t})}function Te({className:r,...t}){return e.jsx("tbody",{"data-slot":"table-body",className:N("[&_tr:last-child]:border-0",r),...t})}function T({className:r,...t}){return e.jsx("tr",{"data-slot":"table-row",className:N("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",r),...t})}function i({className:r,...t}){return e.jsx("th",{"data-slot":"table-head",className:N("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",r),...t})}function c({className:r,...t}){return e.jsx("td",{"data-slot":"table-cell",className:N("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",r),...t})}const J=({data:r,label:t,maxChars:k})=>{const[_,v]=l.useState(!1),g=JSON.stringify(r,null,2),w=g.length>k,o=w?g.substring(0,k)+"...":g;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:t}),w&&e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>v(!0),className:"h-6 px-2 text-xs hover:bg-muted",children:"Show More"})]}),e.jsx("pre",{className:"text-xs bg-muted p-2 rounded overflow-x-auto whitespace-pre-wrap border border-border",children:o})]}),e.jsx(ue,{isOpen:_,onClose:()=>v(!1),title:t,size:"xl",children:e.jsx("pre",{className:"text-sm bg-muted p-4 rounded overflow-x-auto whitespace-pre-wrap border border-border max-h-[70vh] overflow-y-auto",children:g})})]})};function Ze(){ne();const{error:r}=le(),[t,k]=l.useState(null),[_,v]=l.useState(!0),[g,w]=l.useState(!1),[o,Q]=l.useState(1),[C]=l.useState(20),[d,F]=l.useState([]),[m,P]=l.useState([]),[x,A]=l.useState([]),[y,L]=l.useState(""),[a,Z]=l.useState({index:!0,client:!0,timestamp:!0,method:!0,vmcp:!0,mcpServer:!1,operationId:!1,arguments:!0,result:!0,activeConfig:!1}),[De,Fe]=l.useState(!0),[Pe,Ae]=l.useState(0),p=async(s=1,n={})=>{try{v(!0);const S=localStorage.getItem("access_token");if(!S){r("Please log in to view stats");return}const u=await xe.getStats({page:s,limit:C,...n},S);if(u.success&&u.data){const te={...u.data,pagination:{...u.data.pagination,total_pages:u.data.pagination.pages??u.data.pagination.total_pages},logs:u.data.logs.sort((ae,re)=>new Date(re.timestamp).getTime()-new Date(ae.timestamp).getTime())};k(te),Q(s)}else r(u.error||"Failed to fetch stats")}catch(S){console.error("Error fetching stats:",S),r("Failed to fetch stats")}finally{v(!1),w(!1)}},K=()=>{w(!0);const s={agent_name:d.length>0?d.join(","):void 0,vmcp_name:m.length>0?m.join(","):void 0,method:x.length>0?x.join(","):void 0,search:y||void 0};p(o,s)},G=()=>{const s={agent_name:d.length>0?d.join(","):void 0,vmcp_name:m.length>0?m.join(","):void 0,method:x.length>0?x.join(","):void 0,search:y||void 0};p(1,s)},I=s=>{if(t&&s!==o&&s>=1&&s<=t.pagination.total_pages){const n={agent_name:d.length>0?d.join(","):void 0,vmcp_name:m.length>0?m.join(","):void 0,method:x.length>0?x.join(","):void 0,search:y||void 0};p(s,n)}},R=()=>{const s={agent_name:d.length>0?d.join(","):void 0,vmcp_name:m.length>0?m.join(","):void 0,method:x.length>0?x.join(","):void 0,search:y||void 0};p(1,s)},U=()=>{F([]),P([]),A([]),L(""),p(1,{})};l.useEffect(()=>{p(1,{})},[]);const W=s=>new Date(s).toLocaleString(),X=s=>{const n=s.toLowerCase();return n.includes("claude")?e.jsx(b,{className:"h-4 w-4 text-orange-600"}):n.includes("visual studio")||n.includes("vscode")||n.includes("vs code")?e.jsx(b,{className:"h-4 w-4 text-blue-600"}):n.includes("cursor")?e.jsx(b,{className:"h-4 w-4 text-purple-600"}):n.includes("gemini")?e.jsx(b,{className:"h-4 w-4 text-yellow-600"}):e.jsx(b,{className:"h-4 w-4 text-blue-600"})},Y=s=>s.includes("tool")?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":s.includes("resource")?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":s.includes("prompt")?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300",ee=s=>{Z(n=>({...n,[s]:!n[s]}))},se=[{key:"index",label:"#"},{key:"client",label:"Client"},{key:"timestamp",label:"Timestamp"},{key:"method",label:"Method"},{key:"vmcp",label:"vMCP"},{key:"mcpServer",label:"MCP Server"},{key:"operationId",label:"Operation ID"},{key:"arguments",label:"Arguments"},{key:"result",label:"Result"},{key:"activeConfig",label:"Active Config"}];return _?e.jsx("div",{className:"min-h-screen text-foreground flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{children:"Loading stats..."})]})}):e.jsxs("div",{className:"min-h-screen mx-auto p-4",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg bg-primary/20 flex items-center justify-center",children:e.jsx(oe,{className:"h-8 w-8 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Statistics"}),e.jsx("p",{className:"text-muted-foreground",children:"MCP analytics and logs"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(h,{onClick:K,disabled:g,variant:"outline",size:"sm",children:[e.jsx(H,{className:`h-4 w-4 mr-2 ${g?"animate-spin":""}`}),"Refresh"]})})]})}),t&&e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2 mb-4",children:[e.jsx(f,{children:e.jsx(j,{className:"",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-blue-100 dark:bg-blue-900 flex items-center justify-center",children:e.jsx(Ne,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),e.jsx("p",{className:"font-medium text-muted-foreground truncate",children:"Total Logs"}),e.jsx("p",{className:"text-lg font-bold text-foreground",children:t.stats.total_logs.toLocaleString()})]})})}),e.jsx(f,{children:e.jsx(j,{className:"",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-green-100 dark:bg-green-900 flex items-center justify-center",children:e.jsx(b,{className:"h-4 w-4 text-green-600 dark:text-green-400"})}),e.jsx("p",{className:"font-medium text-muted-foreground truncate",children:"Active Clients"}),e.jsx("p",{className:"text-lg font-bold text-foreground",children:t.stats.total_agents})]})})}),e.jsx(f,{children:e.jsx(j,{className:"",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-purple-100 dark:bg-purple-900 flex items-center justify-center",children:e.jsx(z,{className:"h-4 w-4 text-purple-600 dark:text-purple-400"})}),e.jsx("p",{className:"font-medium text-muted-foreground truncate",children:"vMCPs"}),e.jsx("p",{className:"text-lg font-bold text-foreground",children:t.stats.total_vmcps})]})})}),e.jsx(f,{children:e.jsx(j,{className:"",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-orange-100 dark:bg-orange-900 flex items-center justify-center",children:e.jsx(ve,{className:"h-4 w-4  text-orange-600 dark:text-orange-400"})}),e.jsx("p",{className:"font-medium text-muted-foreground truncate",children:"Tool Calls"}),e.jsx("p",{className:"text-lg font-bold text-foreground",children:t.stats.total_tool_calls.toLocaleString()})]})})})]}),e.jsxs(f,{className:"mb-4",children:[e.jsxs(B,{className:"flex flex-row items-center justify-between space-y-0",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{children:[e.jsxs(O,{className:"flex flex-row text-foreground mb-2 gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Filters & Search"]}),e.jsx(V,{className:"text-muted-foreground",children:"Filter logs by client, vMCP, method, or search across all fields"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(h,{onClick:G,size:"sm",className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Apply Filters"]}),e.jsx(h,{onClick:U,variant:"outline",size:"sm",className:"flex items-center gap-2",children:"Clear Filters"})]})]}),e.jsx(j,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e.jsx("div",{children:e.jsx(M,{options:t?.filter_options?.vmcp_names||[],value:m,onValueChange:P,placeholder:"Select vMCPs...",searchPlaceholder:"Search vMCPs...",emptyText:"No vMCPs found"})}),e.jsx("div",{children:e.jsx(M,{options:t?.filter_options?.agent_names||[],value:d,onValueChange:F,placeholder:"Select clients...",searchPlaceholder:"Search clients...",emptyText:"No clients found"})}),e.jsx("div",{children:e.jsx(M,{options:t?.filter_options?.methods||[],value:x,onValueChange:A,placeholder:"Select methods...",searchPlaceholder:"Search methods...",emptyText:"No methods found"})}),e.jsx("div",{children:e.jsxs("div",{className:"flex gap-2 h-10 items-center",children:[e.jsx(ce,{placeholder:"Search logs...",value:y,onChange:s=>L(s.target.value),onKeyDown:s=>{s.key==="Enter"&&R()},className:"bg-background border-border text-foreground h-10"}),e.jsx(h,{onClick:R,size:"sm",children:e.jsx(ie,{className:"h-5 w-5"})})]})})]})})]}),e.jsxs(f,{children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(O,{className:"flex flex-row items-center text-foreground mb-2 gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"System Logs"]}),e.jsx(V,{className:"text-muted-foreground",children:"Detailed view of all system activities with filtering and pagination"})]}),e.jsxs(he,{children:[e.jsx(ge,{asChild:!0,children:e.jsxs(h,{variant:"outline",size:"sm",className:"ml-auto",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Columns",e.jsx(we,{className:"h-4 w-4 ml-2"})]})}),e.jsxs(pe,{align:"end",className:"w-[200px]",children:[e.jsx(fe,{children:"Toggle columns"}),e.jsx(je,{}),se.map(s=>e.jsx(be,{checked:a[s.key],onCheckedChange:()=>ee(s.key),children:s.label},s.key))]})]})]})}),e.jsxs(j,{children:[e.jsx("div",{className:"w-full overflow-hidden",children:e.jsxs(_e,{className:"min-w-full",children:[e.jsx(Me,{children:e.jsxs(T,{className:"border-border",children:[a.index&&e.jsx(i,{className:"text-muted-foreground bg-background",children:"#"}),a.client&&e.jsx(i,{className:"text-muted-foreground  bg-background max-w-[200px]",children:"Client"}),a.timestamp&&e.jsx(i,{className:"text-muted-foreground bg-background",children:"Timestamp"}),a.method&&e.jsx(i,{className:"text-muted-foreground bg-background",children:"Method"}),a.vmcp&&e.jsx(i,{className:"text-muted-foreground  bg-background",children:"vMCP"}),a.mcpServer&&e.jsx(i,{className:"text-muted-foreground bg-background",children:"MCP Server"}),a.operationId&&e.jsx(i,{className:"text-muted-foreground  bg-background",children:"Operation ID"}),a.arguments&&e.jsx(i,{className:"text-muted-foreground bg-background w-[400px]",children:"Arguments"}),a.result&&e.jsx(i,{className:"text-muted-foreground  bg-background flex-1",children:"Result"}),a.activeConfig&&e.jsx(i,{className:"text-muted-foreground bg-background",children:"Active Config"})]})}),e.jsx(Te,{children:t&&t.logs&&t.logs.length>0?t.logs.map((s,n)=>e.jsxs(T,{className:"border-border hover:bg-muted/50",children:[a.index&&e.jsx(c,{className:"text-foreground font-medium text-center max-w-[10px] text-truncate",children:(o-1)*C+n+1}),a.client&&e.jsx(c,{className:"text-foreground max-w-[200px]",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[X(s.agent_name),e.jsx("span",{className:"text-sm font-medium truncate",children:s.agent_name})]})}),a.timestamp&&e.jsx(c,{className:"text-foreground",children:e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx("span",{className:"text-xs truncate",children:W(s.timestamp)})})}),a.method&&e.jsx(c,{className:"text-foreground",children:e.jsx(E,{className:`text-xs ${Y(s.method)}`,children:s.method})}),a.vmcp&&e.jsx(c,{className:"text-foreground",children:e.jsx("div",{className:"truncate",children:s.vmcp_name?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{className:"h-3 w-3 text-primary"}),e.jsx("span",{className:"text-sm font-mono truncate",children:s.vmcp_name})]}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})})}),a.mcpServer&&e.jsx(c,{className:"text-foreground",children:e.jsx("div",{className:"truncate",children:s.mcp_server?e.jsx(E,{variant:"secondary",className:"bg-muted text-foreground truncate max-w-full",children:s.mcp_server}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})})}),a.operationId&&e.jsx(c,{className:"text-foreground",children:e.jsx("span",{className:"text-sm font-mono truncate block",children:s.operation_id||"N/A"})}),a.arguments&&e.jsx(c,{className:"text-foreground max-w-[400px]",children:e.jsx("div",{className:"truncate",children:s.arguments?e.jsx(J,{data:s.arguments,label:"",maxChars:100}):e.jsx("span",{className:"text-muted-foreground",children:"No arguments"})})}),a.result&&e.jsx(c,{className:"text-foreground",children:e.jsx("div",{className:"truncate",children:s.result?e.jsx(J,{data:s.result,label:"Result",maxChars:100}):e.jsx("span",{className:"text-muted-foreground",children:"No result"})})}),a.activeConfig&&e.jsx(c,{className:"text-foreground",children:e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("div",{children:[s.total_tools||0," tools"]}),e.jsxs("div",{children:[s.total_prompts||0," prompts"]}),e.jsxs("div",{children:[s.total_resources||0," resources"]})]})})]},n)):e.jsx(T,{children:e.jsxs(c,{colSpan:Object.values(a).filter(Boolean).length,className:"text-center py-8",children:[e.jsx($,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No logs found"}),e.jsx("p",{className:"text-muted-foreground",children:"Logs will appear here when agents make requests."})]})})})]})}),t&&t.pagination.total>0&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(o-1)*C+1," to ",Math.min(o*C,t.pagination.total)," of ",t.pagination.total," logs"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>I(o-1),disabled:o===1,className:"border-border bg-card text-foreground hover:bg-muted disabled:opacity-50",children:[e.jsx(Ce,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("span",{className:"text-sm text-muted-foreground px-3",children:["Page ",o," of ",t.pagination.total_pages]}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>I(o+1),disabled:o>=t.pagination.total_pages,className:"border-border bg-card text-foreground hover:bg-muted disabled:opacity-50",children:["Next",e.jsx(me,{className:"h-4 w-4 ml-1"})]})]})]})]})]})]})}export{Ze as default};
//# sourceMappingURL=StatsPage-CfJb-Qje.js.map

Metadata-Version: 2.4
Name: sm-py-bc
Version: 0.1.1
Summary: SM2/SM3/SM4 implementation in Python based on Bouncy Castle
Author-email: Developer <dev@example.com>
License: MIT
Project-URL: Homepage, https://github.com/lihongjie0209/sm-py-bc
Project-URL: Bug Tracker, https://github.com/lihongjie0209/sm-py-bc/issues
Project-URL: Documentation, https://github.com/lihongjie0209/sm-py-bc/tree/master/docs
Project-URL: Source Code, https://github.com/lihongjie0209/sm-py-bc
Keywords: sm2,sm3,sm4,cryptography,chinese-crypto,gm-crypto,bouncy-castle
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Security :: Cryptography
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.10
Description-Content-Type: text/markdown
License-File: LICENSE
Provides-Extra: test
Requires-Dist: pytest>=7.0; extra == "test"
Requires-Dist: pytest-cov>=4.0; extra == "test"
Dynamic: license-file

# SM-PY-BC: çº¯ Python å›½å¯†ç®—æ³•åº“

**å®Œæ•´ã€ç”Ÿäº§å°±ç»ªçš„ä¸­å›½å›½å®¶å¯†ç ç®—æ³•æ ‡å‡†ï¼ˆSM2ã€SM3ã€SM4ï¼‰çº¯ Python å®ç°ï¼Œé›¶å¤–éƒ¨ä¾èµ–ã€‚**

[![CI](https://github.com/lihongjie0209/sm-py-bc/actions/workflows/ci.yml/badge.svg)](https://github.com/lihongjie0209/sm-py-bc/actions/workflows/ci.yml)
[![PyPI](https://img.shields.io/pypi/v/sm-py-bc.svg)](https://pypi.org/project/sm-py-bc/)
[![Python 3.10+](https://img.shields.io/badge/python-3.10+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![Tests: 200+ Passing](https://img.shields.io/badge/tests-200%2B%20passing-brightgreen.svg)](tests/)

---

## ğŸ¯ ç‰¹æ€§

### âœ… å®Œæ•´çš„å›½å¯†ç®—æ³•å¥—ä»¶

**SM2 - å…¬é’¥å¯†ç ç®—æ³•** (GM/T 0003-2012)
- æ•°å­—ç­¾åï¼ˆç­¾å/éªŒç­¾ï¼‰
- å…¬é’¥åŠ å¯†/è§£å¯†
- SM2 æ¨èæ›²çº¿ä¸Šçš„æ¤­åœ†æ›²çº¿è¿ç®—
- ç¬¦åˆä¸­å›½å›½å®¶æ ‡å‡†

**SM3 - å¯†ç æ‚å‡‘ç®—æ³•** (GM/T 0004-2012)
- 256 ä½å“ˆå¸Œè¾“å‡º
- Memoable æ¥å£æ”¯æŒé«˜æ•ˆå¢é‡å“ˆå¸Œ
- å®Œå…¨ç¬¦åˆè§„èŒƒ

**SM4 - åˆ†ç»„å¯†ç ç®—æ³•** (GB/T 32907-2016)
- 128 ä½åˆ†ç»„ï¼Œ128 ä½å¯†é’¥
- 32 è½® Feistel ç»“æ„
- 5 ç§åŠ å¯†æ¨¡å¼ï¼šECBã€CBCã€CTRã€OFBã€CFB
- 4 ç§å¡«å……æ–¹æ¡ˆï¼šPKCS#7ã€ISO 7816-4ã€ISO 10126ã€Zero-byte

### ğŸ”’ å®‰å…¨ç‰¹æ€§

- **é›¶å¤–éƒ¨ä¾èµ–** - çº¯ Python å®Œæ•´å¯†ç å­¦å®ç°
- **æŠ—ä¾§ä¿¡é“æ”»å‡»** - åœ¨é€‚ç”¨çš„åœ°æ–¹ä½¿ç”¨å¸¸é‡æ—¶é—´è¿ç®—
- **æµ‹è¯•å……åˆ†** - 200+ ç»¼åˆå•å…ƒæµ‹è¯•ï¼ˆ100% é€šè¿‡ï¼‰
- **ç¬¦åˆæ ‡å‡†** - éµå¾ªå®˜æ–¹ä¸­å›½å¯†ç å­¦æ ‡å‡†

### ğŸš€ æ˜“ç”¨çš„é«˜å±‚ API

```python
from sm_bc.crypto.cipher import create_sm4_cipher

# ä½¿ç”¨æ¨èè®¾ç½®è¿›è¡Œç®€å•åŠ å¯†
cipher = create_sm4_cipher(mode='CBC', padding='PKCS7')
cipher.init(True, key, iv)
ciphertext = cipher.encrypt(plaintext)

# è§£å¯†
cipher.init(False, key, iv)
plaintext = cipher.decrypt(ciphertext)
```

---

## ğŸ“¦ å®‰è£…

```bash
# ä» PyPI å®‰è£…ï¼ˆæ¨èï¼‰
pip install sm-py-bc

# æˆ–ä» GitHub å…‹éš†
git clone https://github.com/lihongjie0209/sm-py-bc.git
cd sm-py-bc
pip install -e .

# æ— éœ€é¢å¤–ä¾èµ–ï¼
# åªéœ€è¦ Python 3.10 æˆ–æ›´é«˜ç‰ˆæœ¬
```

éªŒè¯å®‰è£…:
```python
import sm_bc
print(sm_bc.__version__)  # 0.1.0
```

---

## ğŸ”§ å¿«é€Ÿå¼€å§‹

### SM4 å¯¹ç§°åŠ å¯†

```python
from sm_bc.crypto.cipher import create_sm4_cipher
import secrets

# ç”Ÿæˆéšæœºå¯†é’¥å’Œ IV
key = secrets.token_bytes(16)  # 128 ä½å¯†é’¥
iv = secrets.token_bytes(16)   # 128 ä½ IV

# ä½¿ç”¨ CBC æ¨¡å¼å’Œ PKCS#7 å¡«å……åˆ›å»ºå¯†ç å™¨ï¼ˆæ¨èï¼‰
cipher = create_sm4_cipher(mode='CBC', padding='PKCS7')

# åŠ å¯†
cipher.init(True, key, iv)
plaintext = b"Hello, SM4 encryption!"
ciphertext = cipher.encrypt(plaintext)

# è§£å¯†
cipher.init(False, key, iv)
decrypted = cipher.decrypt(ciphertext)

assert plaintext == bytes(decrypted)
```

### SM3 å¯†ç æ‚å‡‘

```python
from sm_bc.crypto.digests import SM3Digest

# åˆ›å»ºæ‘˜è¦
digest = SM3Digest()

# å“ˆå¸Œæ•°æ®
data = b"Hello, SM3!"
digest.update(data, 0, len(data))

# è·å–å“ˆå¸Œè¾“å‡ºï¼ˆ32 å­—èŠ‚ / 256 ä½ï¼‰
hash_output = bytearray(32)
digest.do_final(hash_output, 0)

print(f"SM3 å“ˆå¸Œ: {hash_output.hex()}")
```

### SM2 æ•°å­—ç­¾å

```python
from sm_bc.crypto.signers import SM2Signer
from sm_bc.crypto.params.ec_key_parameters import ECPrivateKeyParameters, ECPublicKeyParameters
from sm_bc.math.ec_curve import SM2P256V1Curve
import secrets

# ç”Ÿæˆå¯†é’¥å¯¹
curve = SM2P256V1Curve()
d = secrets.randbelow(curve.n)  # ç§é’¥
public_key = curve.G.multiply(d)  # å…¬é’¥

# åˆ›å»ºç­¾åå™¨
signer = SM2Signer()

# ç­¾åæ¶ˆæ¯
message = b"Message to sign"
priv_params = ECPrivateKeyParameters(d, curve.domain_params)
signer.init(True, priv_params)
signature = signer.generate_signature(message)

# éªŒè¯ç­¾å
pub_params = ECPublicKeyParameters(public_key, curve.domain_params)
signer.init(False, pub_params)
is_valid = signer.verify_signature(message, signature)

print(f"ç­¾åæœ‰æ•ˆ: {is_valid}")
```

### SM2 åŠ å¯†/è§£å¯†

```python
from sm_bc.crypto.engines import SM2Engine
from sm_bc.crypto.params.ec_key_parameters import ECPrivateKeyParameters, ECPublicKeyParameters
from sm_bc.math.ec_curve import SM2P256V1Curve
import secrets

# ç”Ÿæˆå¯†é’¥å¯¹
curve = SM2P256V1Curve()
d = secrets.randbelow(curve.n)
public_key = curve.G.multiply(d)

# åˆ›å»ºå¼•æ“
engine = SM2Engine()

# åŠ å¯†
plaintext = b"Secret message"
pub_params = ECPublicKeyParameters(public_key, curve.domain_params)
engine.init(True, pub_params)
ciphertext = engine.process_block(plaintext, 0, len(plaintext))

# è§£å¯†
priv_params = ECPrivateKeyParameters(d, curve.domain_params)
engine.init(False, priv_params)
decrypted = engine.process_block(ciphertext, 0, len(ciphertext))

assert plaintext == bytes(decrypted)
```

---

## ğŸ“š æ–‡æ¡£

### æ”¯æŒçš„åŠ å¯†æ¨¡å¼

| æ¨¡å¼ | æè¿° | éœ€è¦ IV | éœ€è¦å¡«å…… | ä½¿ç”¨åœºæ™¯ |
|------|------|---------|----------|----------|
| **CBC** | å¯†ç åˆ†ç»„é“¾æ¥ | âœ… æ˜¯ | âœ… æ˜¯ | é€šç”¨åŠ å¯†ï¼ˆæ¨èï¼‰ |
| **CTR** | è®¡æ•°å™¨æ¨¡å¼ | âœ… æ˜¯ | âŒ å¦ | æµå¯†ç ï¼Œä»»æ„é•¿åº¦ |
| **OFB** | è¾“å‡ºåé¦ˆ | âœ… æ˜¯ | âŒ å¦ | æµå¯†ç ï¼Œç®€å• |
| **CFB** | å¯†æ–‡åé¦ˆ | âœ… æ˜¯ | âŒ å¦ | è‡ªåŒæ­¥ |
| **ECB** | ç”µå­å¯†ç æœ¬ | âŒ å¦ | âœ… æ˜¯ | âš ï¸ ä¸æ¨èï¼ˆä¸å®‰å…¨ï¼‰ |

### æ”¯æŒçš„å¡«å……æ–¹æ¡ˆ

| å¡«å…… | æè¿° | å¯é  | æ ‡å‡† |
|------|------|------|------|
| **PKCS#7** | æ ‡å‡†å¡«å…… | âœ… æ˜¯ | RFC 5652ï¼ˆæ¨èï¼‰ |
| **ISO 7816-4** | æ™ºèƒ½å¡å¡«å…… | âœ… æ˜¯ | ISO/IEC 7816-4 |
| **ISO 10126** | éšæœºå¡«å…… | âœ… æ˜¯ | ISO/IEC 10126ï¼ˆå·²å¼ƒç”¨ï¼‰ |
| **Zero-byte** | ç®€å•é›¶å¡«å…… | âŒ å¦ | ä»…ç”¨äºå…¼å®¹ |

### å®‰å…¨å»ºè®®

âœ… **æ¨èåšæ³•**:
- ä½¿ç”¨ CBC æˆ– CTR æ¨¡å¼è¿›è¡Œé€šç”¨åŠ å¯†
- å¯¹äºå—æ¨¡å¼å§‹ç»ˆä½¿ç”¨ PKCS#7 å¡«å……
- ä¸ºæ¯æ¬¡åŠ å¯†æ“ä½œç”Ÿæˆå”¯ä¸€çš„ IV
- ä½¿ç”¨å¯†ç å­¦å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆå™¨
- ä¿æŠ¤å¥½ç§é’¥ï¼Œæ°¸è¿œä¸è¦ç¡¬ç¼–ç 

âŒ **é¿å…åšæ³•**:
- ä½¿ç”¨ ECB æ¨¡å¼ï¼ˆä¼šæš´éœ²æ˜æ–‡æ¨¡å¼ï¼‰
- ä½¿ç”¨ç›¸åŒå¯†é’¥é‡å¤ä½¿ç”¨ IV
- ä½¿ç”¨é›¶å­—èŠ‚å¡«å……ï¼ˆä¸å¯é ï¼‰
- ä»¥æ˜æ–‡å½¢å¼å­˜å‚¨å¯†é’¥

---

## ğŸ§ª æµ‹è¯•

è¿è¡Œç»¼åˆæµ‹è¯•å¥—ä»¶:

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest tests/unit/

# è¿è¡Œç‰¹å®šç®—æ³•æµ‹è¯•
pytest tests/unit/test_sm2_engine.py
pytest tests/unit/test_sm3_digest.py
pytest tests/unit/test_sm4_engine.py

# å¸¦è¦†ç›–ç‡æŠ¥å‘Šè¿è¡Œ
pytest --cov=sm_bc tests/unit/
```

**æµ‹è¯•è¦†ç›–**:
- 200+ å•å…ƒæµ‹è¯•ï¼ˆ100% é€šè¿‡ï¼‰
- SM2: 29 ä¸ªæµ‹è¯•ï¼ˆåŠ å¯†ã€ç­¾åã€å¯†é’¥æ“ä½œï¼‰
- SM3: 18 ä¸ªæµ‹è¯•ï¼ˆå“ˆå¸Œã€memoable æ¥å£ï¼‰
- SM4: 18 ä¸ªæµ‹è¯•ï¼ˆåˆ†ç»„å¯†ç æ“ä½œï¼‰
- å¯†ç æ¨¡å¼: 60 ä¸ªæµ‹è¯•ï¼ˆCBCã€CTRã€OFBã€CFBï¼‰
- å¡«å……: 40 ä¸ªæµ‹è¯•ï¼ˆæ‰€æœ‰æ–¹æ¡ˆã€è¾¹ç•Œæƒ…å†µï¼‰

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
sm-py-bc/
â”œâ”€â”€ src/sm_bc/              # ä¸»è¦æºä»£ç 
â”‚   â”œâ”€â”€ crypto/             # å¯†ç å­¦å®ç°
â”‚   â”‚   â”œâ”€â”€ digests/        # SM3 å“ˆå¸Œå‡½æ•°
â”‚   â”‚   â”œâ”€â”€ engines/        # SM2ã€SM4 å¼•æ“
â”‚   â”‚   â”œâ”€â”€ signers/        # SM2 ç­¾åå™¨
â”‚   â”‚   â”œâ”€â”€ modes/          # å¯†ç æ¨¡å¼ï¼ˆCBCã€CTRã€OFBã€CFBï¼‰
â”‚   â”‚   â”œâ”€â”€ paddings/       # å¡«å……æ–¹æ¡ˆ
â”‚   â”‚   â”œâ”€â”€ params/         # å¯†ç å­¦å‚æ•°
â”‚   â”‚   â””â”€â”€ cipher.py       # é«˜å±‚å¯†ç æ¥å£
â”‚   â”œâ”€â”€ math/               # æ¤­åœ†æ›²çº¿æ•°å­¦
â”‚   â””â”€â”€ util/               # å·¥å…·ç±»
â”œâ”€â”€ tests/                  # ç»¼åˆæµ‹è¯•å¥—ä»¶
â”‚   â””â”€â”€ unit/              # æ‰€æœ‰ç»„ä»¶çš„å•å…ƒæµ‹è¯•
â”œâ”€â”€ examples/               # ä½¿ç”¨ç¤ºä¾‹å’Œæ¼”ç¤º
â”œâ”€â”€ docs/                   # é™„åŠ æ–‡æ¡£
â”‚   â””â”€â”€ process/           # å¼€å‘è¿‡ç¨‹æ–‡æ¡£
â””â”€â”€ pyproject.toml         # é¡¹ç›®é…ç½®
```

---

## ğŸ”¬ ç¤ºä¾‹

æŸ¥çœ‹ `examples/` ç›®å½•è·å–å®Œæ•´çš„å·¥ä½œç¤ºä¾‹:

- `sm4_comprehensive_demo.py` - å±•ç¤ºæ‰€æœ‰ SM4 ç‰¹æ€§
- `test_sm2_engine_demo.py` - SM2 åŠ å¯†ç¤ºä¾‹
- `test_sm3_demo.py` - SM3 å“ˆå¸Œç¤ºä¾‹
- `test_cbc_demo.py` - CBC æ¨¡å¼ç¤ºä¾‹
- `test_ctr_demo.py` - CTR æ¨¡å¼ç¤ºä¾‹
- `test_padding_demo.py` - å¡«å……æ–¹æ¡ˆç¤ºä¾‹

è¿è¡Œä»»ä½•ç¤ºä¾‹:
```bash
python examples/sm4_comprehensive_demo.py
```

---

## ğŸ“ æŠ€æœ¯ç»†èŠ‚

### å®ç°æ–¹æ³•

**çº¯ Python** - æ‰€æœ‰å¯†ç å­¦æ“ä½œä»å¤´å®ç°:
- æ— å¤–éƒ¨å¯†ç å­¦åº“
- ä»…ä½¿ç”¨ Python æ ‡å‡†åº“
- å®Œå…¨å¯å®¡è®¡å’Œé€æ˜

**åŸºäºå‚è€ƒå®ç°** - ä»å¯ä¿¡å®ç°ç§»æ¤:
- ä¸»è¦å‚è€ƒ: [sm-js-bc](https://github.com/lihongjie0209/sm-js-bc) (TypeScript)
- æ¬¡è¦å‚è€ƒ: Bouncy Castle Java å®ç°
- ä¿æŒä¸å‚è€ƒå®ç°çš„å…¼å®¹æ€§

**ç¬¦åˆæ ‡å‡†**:
- SM2: GM/T 0003-2012ï¼ˆåŸºäºæ¤­åœ†æ›²çº¿çš„å…¬é’¥å¯†ç ç®—æ³•ï¼‰
- SM3: GM/T 0004-2012ï¼ˆå¯†ç æ‚å‡‘ç®—æ³•ï¼‰
- SM4: GB/T 32907-2016ï¼ˆåˆ†ç»„å¯†ç ç®—æ³•ï¼‰

### æ€§èƒ½è¯´æ˜

è¿™æ˜¯ä¸€ä¸ªä¸“æ³¨äºæ­£ç¡®æ€§å’Œå®‰å…¨æ€§è€ŒéåŸå§‹æ€§èƒ½çš„çº¯ Python å®ç°ã€‚å¯¹äºéœ€è¦é«˜ååé‡çš„ç”Ÿäº§åº”ç”¨:

- åœ¨å¯ç”¨æ—¶è€ƒè™‘ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿ
- å¯¹å…³é”®è·¯å¾„ä½¿ç”¨åŸç”Ÿå®ç°ï¼ˆC/C++ï¼‰
- æ­¤åº“éå¸¸é€‚åˆå¼€å‘ã€æµ‹è¯•å’Œéœ€è¦çº¯ Python çš„åº”ç”¨

**å…¸å‹æ€§èƒ½**ï¼ˆç°ä»£ç¡¬ä»¶ä¸Šçš„ Python 3.10+ï¼‰:
- SM3 å“ˆå¸Œ: ~5-10 MB/s
- SM4 åŠ å¯†: ~1-5 MB/s
- SM2 æ“ä½œ: ~100-500 ops/s

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·:

1. Fork ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. ä¸ºæ–°åŠŸèƒ½æ·»åŠ æµ‹è¯•
4. ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
5. æäº¤ pull request

---

## ğŸ“„ è®¸å¯è¯

MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

---

## ğŸ™ è‡´è°¢

- åŸºäº [sm-js-bc](https://github.com/lihongjie0209/sm-js-bc) (TypeScript) çš„å‚è€ƒå®ç°
- å— Bouncy Castle å¯†ç å­¦åº“å¯å‘
- å®ç°ä¸­å›½å›½å®¶å¯†ç å­¦æ ‡å‡†

---

## âš–ï¸ æ³•å¾‹å£°æ˜

æœ¬è½¯ä»¶å®ç°ä¸­å›½å›½å®¶å¯†ç å­¦æ ‡å‡†ã€‚ç”¨æˆ·æœ‰è´£ä»»éµå®ˆå…¶ç®¡è¾–èŒƒå›´å†…é€‚ç”¨çš„å‡ºå£ç®¡åˆ¶æ³•å¾‹æ³•è§„ã€‚

---

## ğŸ“ æ”¯æŒ

- **Issues**: [GitHub Issues](https://github.com/lihongjie0209/sm-py-bc/issues)
- **æ–‡æ¡£**: [å®Œæ•´æ–‡æ¡£](https://github.com/lihongjie0209/sm-py-bc/tree/master/docs)
- **ç¤ºä¾‹**: [ç¤ºä¾‹ç›®å½•](https://github.com/lihongjie0209/sm-py-bc/tree/master/examples)

---

**ç”¨ â¤ï¸ ä¸ºå¯†ç å­¦ç¤¾åŒºåˆ¶ä½œ**

*ç”Ÿäº§å°±ç»ª â€¢ æµ‹è¯•å……åˆ† â€¢ ç¬¦åˆæ ‡å‡† â€¢ çº¯ Python*

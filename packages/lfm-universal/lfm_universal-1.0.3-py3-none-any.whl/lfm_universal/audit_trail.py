# -*- coding: utf-8 -*-
"""Audit Trail

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1wSgumtFh6vdJt9y36Dr3nTbGNIiTlPWI
"""

import time
import hashlib

AUDIT_FILE = "audit_trail.jsonl"

def enable_audit_trail(signing_key=None):
    """
    Enables the unbreakable audit trail.
    Every action is cryptographically hashed (simulated) and logged.
    """
    if signing_key is None:
        signing_key = "ANONYMOUS_OBSERVER"

    event = f"ACTIVATION_EVENT_BY_{signing_key}_{time.time()}"
    event_hash = hashlib.sha256(event.encode()).hexdigest()

    log_entry = f"{time.time()} | KEY:{signing_key} | HASH:{event_hash}\n"

    with open(AUDIT_FILE, 'a') as f:
        f.write(log_entry)

    print(f"   [Audit] Secure channel open. Identity '{signing_key}' logged to {AUDIT_FILE}")
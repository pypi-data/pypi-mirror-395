"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4499],{1338:(e,s,r)=>{r.d(s,{L:()=>a});var t=r(4568),n=r(7620);class a extends n.Component{static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,s){console.error("❌❌❌ CONSENT PAGE CRITICAL ERROR ❌❌❌"),console.error("Error:",e),console.error("Error Info:",s),console.error("Stack:",e.stack),this.setState({error:e,errorInfo:s}),alert("Critical error in Consent page: ".concat(e.message,"\n\nPlease refresh the page or contact support."))}render(){if(this.state.hasError){var e;return(0,t.jsx)("div",{className:"min-h-screen bg-red-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"max-w-2xl w-full bg-white rounded-lg shadow-xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("svg",{className:"h-12 w-12 text-red-600 mr-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-red-600",children:"Consent Page Error"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[(0,t.jsx)("p",{className:"font-bold",children:"Error Message:"}),(0,t.jsx)("p",{className:"font-mono text-sm mt-1",children:null==(e=this.state.error)?void 0:e.message})]}),!1,(0,t.jsxs)("div",{className:"flex space-x-4 mt-6",children:[(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Reload Page"}),(0,t.jsx)("button",{onClick:()=>window.location.href="/",className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Go to Home"})]})]})]})})}return this.props.children}constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}}},3457:(e,s,r)=>{r.d(s,{k:()=>n,u:()=>a});var t=r(4568);function n(){return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"Consent Record Creation"}),(0,t.jsx)("div",{className:"mt-2 text-sm text-blue-700",children:(0,t.jsxs)("p",{children:["Consent records are automatically created ",(0,t.jsx)("strong",{children:"6-12 hours after your first Discord interaction"})," with CIRIS. This delay ensures meaningful engagement before establishing a consent relationship."]})})]})]})}),(0,t.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-amber-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-amber-800",children:"Important Consent Rules"}),(0,t.jsxs)("div",{className:"mt-2 text-sm text-amber-700 space-y-2",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Downgrades:"})," Switching to TEMPORARY or ANONYMOUS creates a proactive opt-out and takes effect immediately."]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Partnership Upgrades:"})," Always require mutual consent from both you and the agent. The agent must approve your partnership request."]})]})]})]})}),(0,t.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-800",children:"Privacy & Access Control"}),(0,t.jsx)("div",{className:"mt-2 text-sm text-gray-700",children:(0,t.jsx)("p",{children:"You can only view and manage your own consent settings. Administrators can view consent records for all users for compliance purposes, but cannot modify them."})})]})]})})]})}function a(e){let{partnershipRequests:s}=e;if(!s||0===s.length)return null;let r=s.filter(e=>"agent"===e.from);return 0===r.length?null:(0,t.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("svg",{className:"h-6 w-6 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{d:"M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z"})}),(0,t.jsx)("span",{className:"absolute -top-1 -right-1 h-3 w-3 bg-green-400 rounded-full animate-pulse"})]})}),(0,t.jsxs)("div",{className:"ml-3 flex-1",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-green-800",children:"Partnership Request from Agent"}),(0,t.jsxs)("div",{className:"mt-2 text-sm text-green-700",children:[(0,t.jsx)("p",{children:"The agent has requested to establish a partnership with you! This would enable:"}),(0,t.jsxs)("ul",{className:"mt-2 list-disc list-inside space-y-1",children:[(0,t.jsx)("li",{children:"Enhanced personalization based on your preferences"}),(0,t.jsx)("li",{children:"Long-term memory of your interactions"}),(0,t.jsx)("li",{children:"Mutual growth and learning"})]}),r[0].message&&(0,t.jsxs)("p",{className:"mt-3 italic",children:['"',r[0].message,'"']}),(0,t.jsxs)("div",{className:"mt-4 flex space-x-3",children:[(0,t.jsx)("button",{className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Accept Partnership"}),(0,t.jsx)("button",{className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Decline"})]})]})]})]})})}r(7620)},5003:(e,s,r)=>{r.d(s,{A:()=>o});var t=r(4568),n=r(7620),a=r(704),i=r(7192);let l=[{id:a.Lb.INTERACTION,name:"Interaction",description:"Learn from our conversations",icon:"\uD83D\uDCAC"},{id:a.Lb.PREFERENCE,name:"Preference",description:"Learn your preferences and patterns",icon:"⚙️"},{id:a.Lb.IMPROVEMENT,name:"Improvement",description:"Use for self-improvement",icon:"\uD83D\uDCC8"},{id:a.Lb.RESEARCH,name:"Research",description:"Use for research purposes",icon:"\uD83D\uDD2C"},{id:a.Lb.SHARING,name:"Sharing",description:"Share learnings with others",icon:"\uD83E\uDD32"}];function o(e){let{isOpen:s,onClose:r,onSuccess:o}=e,[d,c]=(0,n.useState)([]),[m,h]=(0,n.useState)(""),[u,x]=(0,n.useState)(!1),[g,f]=(0,n.useState)(null);if(!s)return null;let p=e=>{c(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},b=async()=>{if(0===d.length)return void f("Please select at least one category");x(!0),f(null);try{console.log("Selected categories (raw):",d),console.log("Selected categories (values):",d.map(e=>String(e))),await a.AQ.consent.requestPartnership(d,m||"User requested partnership upgrade"),o(),r()}catch(e){f((0,i.PE)(e)),console.error("Partnership request failed:",e),console.error("Error details:",{status:null==e?void 0:e.status,detail:null==e?void 0:e.detail,message:null==e?void 0:e.message,type:null==e?void 0:e.type})}finally{x(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"border-b px-6 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Request Partnership"}),(0,t.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-500",children:(0,t.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:"Partnership requires mutual consent. The agent will review your request."})]}),(0,t.jsxs)("div",{className:"px-6 py-4",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Select what you'd like to share:"}),(0,t.jsx)("div",{className:"space-y-3",children:l.map(e=>(0,t.jsxs)("label",{className:"flex items-start cursor-pointer hover:bg-gray-50 p-3 rounded-lg transition-colors",children:[(0,t.jsx)("input",{type:"checkbox",checked:d.includes(e.id),onChange:()=>p(e.id),className:"mt-1 h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,t.jsxs)("div",{className:"ml-3 flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("span",{className:"text-lg mr-2",children:e.icon}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:e.name})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]})]},e.id))})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-900 mb-2",children:"Tell the agent why you want to partner (optional):"}),(0,t.jsx)("textarea",{id:"reason",rows:4,value:m,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Share your goals and how partnership would help both of us grow..."})]}),g&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:(0,t.jsx)("p",{className:"text-sm text-red-600",children:g})}),(0,t.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"About Partnership"}),(0,t.jsx)("div",{className:"mt-2 text-sm text-blue-700",children:(0,t.jsxs)("ul",{className:"list-disc pl-5 space-y-1",children:[(0,t.jsx)("li",{children:"The agent will review your request within 48 hours"}),(0,t.jsx)("li",{children:"You'll be notified when a decision is made"}),(0,t.jsx)("li",{children:"You can withdraw your request at any time"}),(0,t.jsx)("li",{children:"Partnership can be ended by either party"})]})})]})]})})]}),(0,t.jsx)("div",{className:"border-t px-6 py-4 bg-gray-50",children:(0,t.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,t.jsx)("button",{onClick:r,disabled:u,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Cancel"}),(0,t.jsx)("button",{onClick:b,disabled:u||0===d.length,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Submitting...":"Submit Request"})]})})]})})}},6264:(e,s,r)=>{r.d(s,{O:()=>l});var t=r(4568),n=r(7620),a=r(2942),i=r(9484);function l(e){let{children:s,requiredRole:r,requiredPermission:l}=e,{user:o,loading:d,hasRole:c,hasPermission:m}=(0,i.A)(),h=(0,a.useRouter)();return((0,n.useEffect)(()=>{if(!d){if(!o)return void h.push("/login");if(r&&!c(r)||l&&!m(l))return void h.push("/unauthorized")}},[o,d,r,l,c,m,h]),d)?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"text-lg",children:"Loading..."})}):o&&(!r||c(r))&&(!l||m(l))?(0,t.jsx)(t.Fragment,{children:s}):null}},7192:(e,s,r)=>{function t(e){if(!e)return"Unknown error";if("string"==typeof e)return e;if(Array.isArray(e))return e.map(e=>"string"==typeof e?e:e.msg?e.msg:e.message?e.message:JSON.stringify(e)).join("; ");if(e.detail){if(Array.isArray(e.detail))return e.detail.map(e=>{let s=Array.isArray(e.loc)?e.loc.join("."):e.loc||"",r=e.msg||e.message||"Validation error";return s?"".concat(s,": ").concat(r):r}).join("; ");if("string"==typeof e.detail)return e.detail;if("object"==typeof e.detail)return JSON.stringify(e.detail)}if(e.message&&"string"==typeof e.message)return e.message;if(e.error&&"string"==typeof e.error)return e.error;if(e.statusText&&"string"==typeof e.statusText)return e.statusText;try{let s=JSON.stringify(e);if(s.length>200)return"Complex error object (see console for details)";return s}catch(e){return"Unknown error (see console for details)"}}r.d(s,{PE:()=>t})}}]);

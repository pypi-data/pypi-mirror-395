# enikki

テキスト対話から絵日記風マンガを生成するCLIツール。Gemini 3 を使用して脚本生成・画像生成を行います。

## 特徴

- **対話型UI**: ストーリー、スタイル、コマ数などを対話形式で入力
- **19種類のスタイルプリセット**: 4コマ漫画、少年漫画、少女漫画、Webtoon、アメコミなど
- **Gemini 3 による一括生成**: キャラクターの一貫性を保った1枚絵のマンガを生成
- **ステップごとの確認**: 脚本・画像それぞれで確認・再生成が可能
- **キャラクター画像の参照**: キャラクター画像を指定して一貫性を向上

## API利用料金

enikkiは Google Gemini API を使用しています。1回のマンガ生成にかかるおおよその料金は以下の通りです。

### 使用モデルと単価

| 処理 | モデル | 入力単価 | 出力単価 |
|------|--------|----------|----------|
| 脚本生成 | gemini-3-pro-preview | $2.00/1Mトークン | $12.00/1Mトークン |
| 画像生成 | gemini-3-pro-image-preview | $2.00/1Mトークン | $120.00/1Mトークン（画像） |

※ 画像出力は1枚あたり約1,120トークンを消費

### 1回あたりの推定コスト（4コマ漫画の場合）

| 処理 | 入力トークン | 出力トークン | 料金 |
|------|-------------|-------------|------|
| 脚本生成 | 約1,500 | 約500 | 約 $0.009 |
| 画像生成 | 約800 | 約1,120（1枚） | 約 $0.14 |
| **合計** | - | - | **約 $0.15（約22円）** |

※ 為替レート: $1 = ¥150 で計算
※ 再生成を行うと追加料金が発生します
※ キャラクター画像を入力する場合、画像入力トークン（約560トークン/$0.001）が追加されます

### 料金を抑えるコツ

- 脚本を確認してから画像生成に進む（画像生成の方が高コスト）
- 追加指示は具体的に書いて再生成回数を減らす

詳細は [Gemini API 料金ページ](https://ai.google.dev/gemini-api/docs/pricing) を参照してください。

## クイックスタート

1. Google AI API キーを取得: https://aistudio.google.com/app/apikey

2. APIキーを設定:
```bash
export GEMINI_API_KEY="your-api-key-here"
```

3. uvx で実行（インストール不要）:
```bash
uvx enikki --lang ja run
```

これだけでOKです！

> 注: 環境変数は `GEMINI_API_KEY` と `GOOGLE_API_KEY` の両方に対応しています。

## インストール（オプション）

### pip を使う場合

```bash
pip install enikki
enikki --lang ja run
```

### ソースから

```bash
git clone https://github.com/kentaro/enikki.git
cd enikki
pip install -e .
enikki --lang ja run
```

## 使い方

### インタラクティブモード（推奨）

```bash
uvx enikki --lang ja run
# または pip でインストールした場合
enikki --lang ja run
```

グローバルオプション:
- `--config`: 設定ファイルのパス（デフォルト: `config.toml` または `~/.config/enikki/config.toml`）
- `--lang, -l`: UIの言語（`en` または `ja`、デフォルト: `en`）

対話形式で以下を入力:
1. スタイル選択
2. ストーリー概要の入力
3. アスペクト比の選択
4. コマ数の選択
5. キャラクター画像の指定（オプション）

生成フロー:
- **Step 1: 脚本生成** → 確認 → OK / 追加指示して再生成 / 戻る / 終了
- **Step 2: 画像生成** → プレビュー表示 → OK / 追加指示して再生成 / 戻る / 終了
- **Step 3: 保存** → 完成画像を開く

### クイックモード

```bash
uvx enikki quick "今日カフェで変な客に遭遇した話" --style essay --panels 4
```

オプション:
- `--style, -s`: スタイルID（デフォルト: yonkoma）
- `--panels, -p`: コマ数（デフォルト: 4）
- `--ratio, -r`: アスペクト比（デフォルト: 9:16）
- `--character, -c`: キャラクター画像ファイル
- `--output, -o`: 出力ファイル（省略時は日時ベースで自動生成）
- `--backend, -b`: バックエンド（gemini / mock）

### スタイル一覧を表示

```bash
uvx enikki --lang ja styles
```

## 利用可能なスタイル

### 日本漫画
| ID | 名前 | 説明 |
|----|------|------|
| yonkoma | 4コマ漫画 | 起承転結の王道4コマ形式 |
| shonen | 少年漫画風 | ダイナミックな構図と迫力のある表現 |
| shojo | 少女漫画風 | 繊細な線と華やかな演出 |
| seinen | 青年漫画風 | リアルな描写と深みのある表現 |
| yuru | ゆるふわ日常系 | かわいいデフォルメとほのぼの表現 |
| horror | ホラー漫画風 | 不気味さと恐怖を演出 |

### Web漫画
| ID | 名前 | 説明 |
|----|------|------|
| webtoon | Webtoon風 | フルカラー縦スクロール形式 |
| sns | SNS漫画風 | シンプルで読みやすい1ページ完結型 |
| essay | エッセイ漫画風 | 実体験を漫画化するスタイル |

### 海外コミック
| ID | 名前 | 説明 |
|----|------|------|
| american | アメコミ風 | ヒーローコミック風の力強い表現 |
| bd | バンドデシネ風 | ヨーロッパ風の芸術的なコミック |
| manhwa | マンファ風 | 韓国漫画スタイル |

### アート・実験系
| ID | 名前 | 説明 |
|----|------|------|
| pixel | ピクセルアート風 | レトロゲーム風のドット絵表現 |
| watercolor | 水彩画風 | 柔らかい水彩タッチの表現 |
| ukiyoe | 浮世絵風 | 日本の伝統的な木版画スタイル |
| noir | フィルムノワール風 | モノクロの影と光のコントラスト |

### 教育・ビジネス
| ID | 名前 | 説明 |
|----|------|------|
| infographic | インフォグラフィック風 | 情報を視覚的に伝えるスタイル |
| educational | 学習漫画風 | わかりやすい解説漫画スタイル |
| corporate | ビジネス漫画風 | 企業向けのクリーンなスタイル |

## 作者

[栗林健太郎](https://kentarokuribayashi.com/)

## ライセンス

MIT License

# For more information about configuring project metadata for the
# setuptools build backend, please see
# https://setuptools.pypa.io/en/latest/userguide/pyproject_config.html
[build-system]
build-backend = "setuptools.build_meta"
requires = ["setuptools"]

[project]
authors = [
    { name = "Cybersecurity and Infrastructure Security Agency", email = "github@cisa.dhs.gov" }
]
# See https://pypi.python.org/pypi?%3Aaction=list_classifiers
classifiers = [
    # How mature is this project? Common values are
    #   3 - Alpha
    #   4 - Beta
    #   5 - Production/Stable
    "Development Status :: 4 - Beta",
    "Environment :: Console",
    # Indicate who your project is intended for
    "Intended Audience :: Developers",
    "Natural Language :: English",
    "Operating System :: OS Independent",
    # Specify the Python versions you support here. In particular, ensure
    # that you indicate whether you support Python 2, Python 3 or both.
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3 :: Only",
    "Programming Language :: Python :: 3.7",
    "Programming Language :: Python :: 3.8",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Programming Language :: Python :: 3.14",
    "Programming Language :: Python :: Implementation :: CPython",
]
dependencies = [
    "dnspython",
    "docopt",
    "publicsuffixlist[update]",
    "py3dns",
    "pyspf",
    "requests",
]
description = "Scan domains and return data based on trustworthy email best practices"
dynamic = ["readme", "version"]
keywords = ["email", "authentication", "STARTTLS"]
# Although PEP 639 allows us to specify the license via a simple SPDX
# string, the versions of setuptools we have to use for Python 3.7 and
# 3.8 do not allow this; hence, this antiquated format from the
# deprecated PEP 621.
license = { text = "CC0-1.0" }
name = "trustymail"
requires-python = ">=3.7"

[project.optional-dependencies]
# IMPORTANT: Keep type hinting-related dependencies of the dev section
# in sync with the mypy pre-commit hook configuration (see
# .pre-commit-config.yaml). Any changes to type hinting-related
# dependencies here should be reflected in the additional_dependencies
# field of the mypy pre-commit hook to avoid discrepancies in type
# checking between environments.
dev = [
    "types-docopt",
    "types-requests",
]
test = [
    "coverage",
    "coveralls",
    "pre-commit",
    "pytest-cov",
    "pytest",
]

[project.scripts]
trustymail = "trustymail.cli:main"

[project.urls]
homepage = "https://github.com/cisagov/trustymail"
issues = "https://github.com/cisagov/trustymail/issues"
# Landing page for CISA's cybersecurity mission
mission = "https://www.cisa.gov/cybersecurity"
source = "https://github.com/cisagov/trustymail"

[tool.flake8]
max-line-length = 80
# Select (turn on)
# * Complexity violations reported by mccabe (C) -
#   http://flake8.pycqa.org/en/latest/user/error-codes.html#error-violation-codes
# * Documentation conventions compliance reported by pydocstyle (D) -
#   http://www.pydocstyle.org/en/stable/error_codes.html
# * Default errors and warnings reported by pycodestyle (E and W) -
#   https://pycodestyle.readthedocs.io/en/latest/intro.html#error-codes
# * Default errors reported by pyflakes (F) -
#   http://flake8.pycqa.org/en/latest/glossary.html#term-pyflakes
# * Default warnings reported by flake8-bugbear (B) -
#   https://github.com/PyCQA/flake8-bugbear#list-of-warnings
# * The B950 flake8-bugbear opinionated warning -
#   https://github.com/PyCQA/flake8-bugbear#opinionated-warnings
select = ["C", "D", "E", "F", "W", "B", "B950"]
# Ignore flake8's default warning about maximum line length, which has
# a hard stop at the configured value.  Instead we use
# flake8-bugbear's B950, which allows up to 10% overage.
#
# Also ignore flake8's warning about line breaks before binary
# operators.  It no longer agrees with PEP8.  See, for example, here:
# https://github.com/ambv/black/issues/21. Guido agrees here:
# https://github.com/python/peps/commit/c59c4376ad233a62ca4b3a6060c81368bd21e85b.
extend-ignore = ["E501", "W503"]

[tool.isort]
combine_star = true
force_sort_within_sections = true

import_heading_stdlib = "Standard Python Libraries"
import_heading_thirdparty = "Third-Party Libraries"
import_heading_firstparty = "cisagov Libraries"

# Run isort under the black profile to align with our other Python
# linting
profile = "black"

[tool.pytest.ini_options]
# Increase verbosity, display extra test summary info for tests that
# did not pass, display code coverage results, and enable debug
# logging.
addopts = "--verbose -ra --cov --log-cli-level=DEBUG"

[tool.setuptools.dynamic]
readme = {file = ["README.md"], content-type = "text/markdown"}
version = {attr = "trustymail._version.__version__"}

import{b as Ae,j as t}from"./query-vendor-DJBV9M4k.js";import{a as ue,C,b as w,L as De,l as Fe,d as L,e as R,j as Ke}from"./index-Bd7Eqoup.js";import{r as Oe}from"./react-vendor-UO7EsjdD.js";import{a as Ee}from"./api-D3yPf1fc.js";import{R as oe,L as Ce,C as de,X as me,Y as fe,T as he,b as we,A as Le,a as Pe,c as Te,B as $e,d as qe}from"./chart-vendor-DrD9aRso.js";import{C as Be}from"./circle-x-CnIbKxAQ.js";import"./ui-vendor-CGdvvLxe.js";const Ie=[{value:"1h",label:"Last hour"},{value:"6h",label:"Last 6 hours"},{value:"24h",label:"Last 24 hours"},{value:"7d",label:"Last 7 days"},{value:"30d",label:"Last 30 days"}],d={completed:"#10b981",failed:"#ef4444",pending:"#f59e0b",running:"#3b82f6",successRate:"#3b82f6"},Re=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6"];function Ne(e){return new Date(e).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})}function Me(e){const s=ue.c(7),{active:r,payload:a,label:l}=e;if(!r||!a||a.length===0)return null;let c;s[0]!==l?(c=t.jsx("p",{className:"mb-2 text-xs text-zinc-500 dark:text-zinc-400",children:l}),s[0]=l,s[1]=c):c=s[1];let i;s[2]!==a?(i=a.map(Ge),s[2]=a,s[3]=i):i=s[3];let n;return s[4]!==c||s[5]!==i?(n=t.jsxs("div",{className:"rounded-lg border border-zinc-200 bg-white p-3 shadow-lg dark:border-zinc-700 dark:bg-zinc-800",children:[c,i]}),s[4]=c,s[5]=i,s[6]=n):n=s[6],n}function Ge(e){return t.jsxs("p",{className:"text-sm",style:{color:e.color},children:[e.name,": ",e.value?.toLocaleString()]},e.name)}function Qe(e){const s=ue.c(7),{active:r,payload:a,label:l}=e;if(!r||!a||a.length===0)return null;let c;s[0]!==l?(c=t.jsx("p",{className:"mb-2 text-xs text-zinc-500 dark:text-zinc-400",children:l}),s[0]=l,s[1]=c):c=s[1];let i;s[2]!==a?(i=a.map(We),s[2]=a,s[3]=i):i=s[3];let n;return s[4]!==c||s[5]!==i?(n=t.jsxs("div",{className:"rounded-lg border border-zinc-200 bg-white p-3 shadow-lg dark:border-zinc-700 dark:bg-zinc-800",children:[c,i]}),s[4]=c,s[5]=i,s[6]=n):n=s[6],n}function We(e){return t.jsxs("p",{className:"text-sm",style:{color:e.color},children:[e.name,":"," ",typeof e.value=="number"?`${e.value.toFixed(1)}%`:e.value]},e.name)}function xe(e){const s=ue.c(9),{label:r,value:a}=e;let l;s[0]!==r?(l=t.jsx("div",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:r}),s[0]=r,s[1]=l):l=s[1];let c;s[2]!==a?(c=a!=null?`${a.toLocaleString()}ms`:"â€”",s[2]=a,s[3]=c):c=s[3];let i;s[4]!==c?(i=t.jsx("div",{className:"text-2xl font-semibold text-zinc-900 dark:text-zinc-100",children:c}),s[4]=c,s[5]=i):i=s[5];let n;return s[6]!==l||s[7]!==i?(n=t.jsxs("div",{className:"rounded-lg bg-zinc-100 p-4 dark:bg-zinc-800",children:[l,i]}),s[6]=l,s[7]=i,s[8]=n):n=s[8],n}function Xe(e){return e.map(s=>{const r=s.completed+s.failed,a=r>0?s.completed/r*100:100;return{...s,successRate:a}})}function it(){const e=ue.c(83),[s,r]=Oe.useState("24h");let a;e[0]!==s?(a={queryKey:["metrics","summary",s],queryFn:()=>Ee.getMetricsSummary(s),refetchInterval:3e4},e[0]=s,e[1]=a):a=e[1];const{data:l,isLoading:c,error:i}=Ae(a);if(c){let o;return e[2]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsx(De,{label:"Loading metrics..."}),e[2]=o):o=e[2],o}if(i){let o,ne;e[3]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsx(Be,{className:"h-12 w-12 text-red-500"}),ne=t.jsx("p",{className:"text-lg font-medium text-zinc-900 dark:text-zinc-100",children:"Failed to load metrics"}),e[3]=o,e[4]=ne):(o=e[3],ne=e[4]);const ve=i instanceof Error?i.message:"An error occurred";let re;return e[5]!==ve?(re=t.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 p-12",children:[o,ne,t.jsx("p",{className:"text-sm text-zinc-500",children:ve})]}),e[5]=ve,e[6]=re):re=e[6],re}let n;e[7]!==l?.throughput?(n=l?.throughput??[],e[7]=l?.throughput,e[8]=n):n=e[8];let T;e[9]!==n?(T=Xe(n),e[9]=n,e[10]=T):T=e[10];const m=T,pe=l?.status_breakdown?.pending??0;let f;e[11]!==pe?(f={name:"Pending",value:pe,fill:d.pending},e[11]=pe,e[12]=f):f=e[12];const je=l?.status_breakdown?.running??0;let h;e[13]!==je?(h={name:"Running",value:je,fill:d.running},e[13]=je,e[14]=h):h=e[14];const be=l?.status_breakdown?.completed??0;let x;e[15]!==be?(x={name:"Completed",value:be,fill:d.completed},e[15]=be,e[16]=x):x=e[16];const ke=l?.status_breakdown?.failed??0;let u;e[17]!==ke?(u={name:"Failed",value:ke,fill:d.failed},e[17]=ke,e[18]=u):u=e[18];let A;e[19]!==u||e[20]!==f||e[21]!==h||e[22]!==x?(A=[f,h,x,u],e[19]=u,e[20]=f,e[21]=h,e[22]=x,e[23]=A):A=e[23];const _e=A;let D;e[24]===Symbol.for("react.memo_cache_sentinel")?(D=t.jsx("h1",{className:"text-2xl font-semibold text-zinc-900 dark:text-zinc-100",children:"Metrics & Analytics"}),e[24]=D):D=e[24];let F,K;e[25]===Symbol.for("react.memo_cache_sentinel")?(F=o=>r(o),K=Ie.map(Je),e[25]=F,e[26]=K):(F=e[25],K=e[26]);let p;e[27]!==s?(p=t.jsxs("div",{className:"flex items-center justify-between",children:[D,t.jsx(Fe,{"aria-label":"Time range",selectedKey:s,onSelectionChange:F,children:K})]}),e[27]=s,e[28]=p):p=e[28];let O;e[29]===Symbol.for("react.memo_cache_sentinel")?(O=t.jsx(L,{children:t.jsx(R,{children:"Task Throughput"})}),e[29]=O):O=e[29];let E;e[30]===Symbol.for("react.memo_cache_sentinel")?(E=t.jsxs("linearGradient",{id:"colorCompleted",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:d.completed,stopOpacity:.8}),t.jsx("stop",{offset:"95%",stopColor:d.completed,stopOpacity:.1})]}),e[30]=E):E=e[30];let P,$;e[31]===Symbol.for("react.memo_cache_sentinel")?(P=t.jsxs("defs",{children:[E,t.jsxs("linearGradient",{id:"colorFailed",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:d.failed,stopOpacity:.8}),t.jsx("stop",{offset:"95%",stopColor:d.failed,stopOpacity:.1})]})]}),$=t.jsx(de,{strokeDasharray:"3 3",className:"stroke-zinc-200 dark:stroke-zinc-700"}),e[31]=P,e[32]=$):(P=e[31],$=e[32]);let q;e[33]===Symbol.for("react.memo_cache_sentinel")?(q=t.jsx(me,{dataKey:"timestamp",tickFormatter:Ne,tick:{fontSize:12},className:"fill-zinc-500 dark:fill-zinc-400"}),e[33]=q):q=e[33];let B;e[34]===Symbol.for("react.memo_cache_sentinel")?(B=t.jsx(fe,{tick:{fontSize:12},className:"fill-zinc-500 dark:fill-zinc-400"}),e[34]=B):B=e[34];let I,M,G,Q;e[35]===Symbol.for("react.memo_cache_sentinel")?(I=t.jsx(he,{content:t.jsx(Me,{})}),M=t.jsx(we,{}),G=t.jsx(Le,{type:"monotone",dataKey:"completed",name:"Completed",stackId:"1",stroke:d.completed,fill:"url(#colorCompleted)"}),Q=t.jsx(Le,{type:"monotone",dataKey:"failed",name:"Failed",stackId:"1",stroke:d.failed,fill:"url(#colorFailed)"}),e[35]=I,e[36]=M,e[37]=G,e[38]=Q):(I=e[35],M=e[36],G=e[37],Q=e[38]);let j;e[39]!==m?(j=t.jsxs(C,{children:[O,t.jsx(w,{className:"h-72",children:t.jsx(oe,{width:"100%",height:"100%",children:t.jsxs(Pe,{data:m,children:[P,$,q,B,I,M,G,Q]})})})]}),e[39]=m,e[40]=j):j=e[40];let W;e[41]===Symbol.for("react.memo_cache_sentinel")?(W=t.jsx(L,{children:t.jsx(R,{children:"Success Rate"})}),e[41]=W):W=e[41];let X;e[42]===Symbol.for("react.memo_cache_sentinel")?(X=t.jsx(de,{strokeDasharray:"3 3",className:"stroke-zinc-200 dark:stroke-zinc-700"}),e[42]=X):X=e[42];let H;e[43]===Symbol.for("react.memo_cache_sentinel")?(H=t.jsx(me,{dataKey:"timestamp",tickFormatter:Ne,tick:{fontSize:12},className:"fill-zinc-500 dark:fill-zinc-400"}),e[43]=H):H=e[43];let U;e[44]===Symbol.for("react.memo_cache_sentinel")?(U=t.jsx(fe,{domain:[0,100],tick:{fontSize:12},tickFormatter:Ye,className:"fill-zinc-500 dark:fill-zinc-400"}),e[44]=U):U=e[44];let Y;e[45]===Symbol.for("react.memo_cache_sentinel")?(Y=t.jsx(he,{content:t.jsx(Qe,{})}),e[45]=Y):Y=e[45];let J;e[46]===Symbol.for("react.memo_cache_sentinel")?(J=t.jsx(Te,{type:"monotone",dataKey:"successRate",name:"Success Rate",stroke:d.successRate,strokeWidth:2,dot:!1,activeDot:{r:4,strokeWidth:2}}),e[46]=J):J=e[46];let b;e[47]!==m?(b=t.jsxs(C,{children:[W,t.jsx(w,{className:"h-72",children:t.jsx(oe,{width:"100%",height:"100%",children:t.jsxs(Ce,{data:m,children:[X,H,U,Y,J]})})})]}),e[47]=m,e[48]=b):b=e[48];let V;e[49]===Symbol.for("react.memo_cache_sentinel")?(V=t.jsx(L,{children:t.jsx(R,{children:"Status Breakdown"})}),e[49]=V):V=e[49];let Z;e[50]===Symbol.for("react.memo_cache_sentinel")?(Z=t.jsx(de,{strokeDasharray:"3 3",className:"stroke-zinc-200 dark:stroke-zinc-700"}),e[50]=Z):Z=e[50];let ee;e[51]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsx(me,{dataKey:"name",tick:{fontSize:12},className:"fill-zinc-500 dark:fill-zinc-400"}),e[51]=ee):ee=e[51];let te,se;e[52]===Symbol.for("react.memo_cache_sentinel")?(te=t.jsx(fe,{tick:{fontSize:12},className:"fill-zinc-500 dark:fill-zinc-400"}),se=t.jsx(he,{content:Ue}),e[52]=te,e[53]=se):(te=e[52],se=e[53]);let le;e[54]===Symbol.for("react.memo_cache_sentinel")?(le=t.jsx($e,{dataKey:"value",name:"Tasks",radius:[4,4,0,0]}),e[54]=le):le=e[54];let k;e[55]!==_e?(k=t.jsxs(C,{children:[V,t.jsx(w,{className:"h-72",children:t.jsx(oe,{width:"100%",height:"100%",children:t.jsxs(qe,{data:_e,children:[Z,ee,te,se,le]})})})]}),e[55]=_e,e[56]=k):k=e[56];let ae;e[57]===Symbol.for("react.memo_cache_sentinel")?(ae=t.jsx(L,{children:t.jsx(R,{children:"Queue Depth"})}),e[57]=ae):ae=e[57];let _;e[58]!==l?(_=t.jsxs(C,{children:[ae,t.jsx(w,{className:"h-72",children:l?.queue_depth&&l.queue_depth.length>0?t.jsx(oe,{width:"100%",height:"100%",children:t.jsxs(Ce,{data:l.queue_depth,children:[t.jsx(de,{strokeDasharray:"3 3",className:"stroke-zinc-200 dark:stroke-zinc-700"}),t.jsx(me,{dataKey:"timestamp",tickFormatter:Ne,tick:{fontSize:12},className:"fill-zinc-500 dark:fill-zinc-400"}),t.jsx(fe,{tick:{fontSize:12},className:"fill-zinc-500 dark:fill-zinc-400"}),t.jsx(he,{}),t.jsx(we,{}),(l.queues??[]).map(He)]})}):t.jsx("div",{className:"flex h-full items-center justify-center",children:t.jsx("p",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:"No queue depth data available"})})})]}),e[58]=l,e[59]=_):_=e[59];let g;e[60]!==j||e[61]!==b||e[62]!==k||e[63]!==_?(g=t.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[j,b,k,_]}),e[60]=j,e[61]=b,e[62]=k,e[63]=_,e[64]=g):g=e[64];let ie;e[65]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx(L,{children:t.jsx(R,{children:"Duration Percentiles"})}),e[65]=ie):ie=e[65];const ge=l?.duration?.avg_ms;let y;e[66]!==ge?(y=t.jsx(xe,{label:"Average",value:ge}),e[66]=ge,e[67]=y):y=e[67];const ye=l?.duration?.p50_ms;let z;e[68]!==ye?(z=t.jsx(xe,{label:"P50 (Median)",value:ye}),e[68]=ye,e[69]=z):z=e[69];const ze=l?.duration?.p95_ms;let S;e[70]!==ze?(S=t.jsx(xe,{label:"P95",value:ze}),e[70]=ze,e[71]=S):S=e[71];const Se=l?.duration?.p99_ms;let v;e[72]!==Se?(v=t.jsx(xe,{label:"P99",value:Se}),e[72]=Se,e[73]=v):v=e[73];let N;e[74]!==y||e[75]!==z||e[76]!==S||e[77]!==v?(N=t.jsxs(C,{children:[ie,t.jsx(w,{children:t.jsxs("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-4",children:[y,z,S,v]})})]}),e[74]=y,e[75]=z,e[76]=S,e[77]=v,e[78]=N):N=e[78];let ce;return e[79]!==p||e[80]!==g||e[81]!==N?(ce=t.jsxs("div",{className:"space-y-6",children:[p,g,N]}),e[79]=p,e[80]=g,e[81]=N,e[82]=ce):ce=e[82],ce}function He(e,s){return t.jsx(Te,{type:"monotone",dataKey:e,name:e,stroke:Re[s%Re.length],strokeWidth:2,dot:!1,activeDot:{r:4}},e)}function Ue(e){const{active:s,payload:r}=e;if(!s||!r||r.length===0)return null;const a=r[0]?.payload;return t.jsx("div",{className:"rounded-lg border border-zinc-200 bg-white p-3 shadow-lg dark:border-zinc-700 dark:bg-zinc-800",children:t.jsxs("p",{className:"text-sm font-medium",style:{color:a.fill},children:[a.name,": ",a.value.toLocaleString()]})})}function Ye(e){return`${e}%`}function Je(e){return t.jsx(Ke,{id:e.value,children:e.label},e.value)}export{it as default};

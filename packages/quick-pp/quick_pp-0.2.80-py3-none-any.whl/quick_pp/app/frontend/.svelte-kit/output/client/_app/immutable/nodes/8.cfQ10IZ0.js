const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/HHMWGB-5.js","../chunks/CqkleIqs.js"])))=>i.map(i=>d[i]);
import{f as q,a as z,c as pt}from"../chunks/DzJWYvWT.js";import"../chunks/CDFnLX1k.js";import{a as U,o as dt}from"../chunks/B8lXtDag.js";import{p as X,s as n,m as b,l as mt,g as r,a as ut,c as F,d as _,r as P,b as Y,f as ft,af as ht,y as vt}from"../chunks/B_idv_Bi.js";import{i as tt}from"../chunks/BB0Jw3vZ.js";import{_ as bt}from"../chunks/PPVm8Dsz.js";import{s as gt}from"../chunks/aZZtfabf.js";import{i as J}from"../chunks/CES9meuh.js";import{r as yt}from"../chunks/BzZ_A8--.js";import{b as xt}from"../chunks/BMvMhH3M.js";import{p as _t,b as K}from"../chunks/D5_Bn7R5.js";import"../chunks/DgWdy5DX.js";import{D as Pt}from"../chunks/BjC9EeZr.js";import{w as et,d as It}from"../chunks/Mv797lCI.js";import{P as wt}from"../chunks/BYv_GcAz.js";var Ft=q('<div class="text-sm text-blue-600 mb-3">Loading FZI data...</div>'),kt=q('<div class="text-sm text-red-600 mb-3"> </div>'),Zt=q('<div class="ws-rock-typing"><div class="mb-2"><div class="font-semibold">Rock Typing (Multi-Well)</div> <div class="text-sm text-muted-foreground">Cluster wells into rock types across the project.</div></div> <!> <div class="bg-panel rounded p-3 mb-3"><div class="flex-1"><label for="cutoffs" class="block text-sm font-medium mb-1">FZI Cutoffs (comma-separated)</label> <input id="cutoffs" type="text" class="w-full px-3 py-2 border border-border rounded-md bg-background text-foreground" placeholder="e.g., 0.5,1.0,2.0"/></div> <div class="font-semibold mb-2">FZI Log-Log Plot</div> <div class="text-sm text-muted-foreground mb-3">Plot Flow Zone Indicator (FZI) from porosity and permeability data across all wells.</div> <!> <div class="bg-surface rounded p-3 min-h-[400px]"><div class="w-full max-w-[600px] h-[500px] mx-auto"></div></div> <div class="font-semibold mb-2">Pore-Perm Crossplot</div> <div class="text-sm text-muted-foreground mb-3">Plot porosity vs permeability with FZI cutoff lines and rock type coloring.</div> <div class="bg-surface rounded p-3 min-h-[400px]"><div class="w-full max-w-[600px] h-[500px] mx-auto"></div></div></div></div>');function zt($,j){X(j,!1);let g=_t(j,"projectId",8,null),k=b(!1),h=b(null),c=b(null),p=b({enabled:!1,zones:[]});const D=et.subscribe(o=>{o?.zoneFilter&&n(p,{...o.zoneFilter})});U(()=>D());function E(){if(!r(c))return null;const o=r(c).phit.map((a,d)=>({phit:a,perm:r(c).perm[d],zone:r(c).zones[d]})),s=It(o,r(p));return console.log("Applying zone filter:",o.length,r(p),s.length),{phit:s.map(a=>a.phit),perm:s.map(a=>a.perm),zones:s.map(a=>a.zone)}}let I=b("0.1, 1.0, 3.0, 6.0"),M=null,N=b(null),R=b(null);const ot="http://localhost:6312";async function S(){if(M)return M;const o=await bt(()=>import("../chunks/HHMWGB-5.js").then(s=>s.p),__vite__mapDeps([0,1]),import.meta.url);return M=o.default||o,M}async function rt(){if(g()){n(k,!0),n(h,null);try{const o=`${ot}/quick_pp/database/projects/${g()}/fzi_data`,s=await fetch(o);if(!s.ok)throw new Error(await s.text());n(c,await s.json()),console.log("Loaded FZI data:",r(c))}catch(o){n(h,o.message||"Failed to load FZI data"),n(c,null)}finally{n(k,!1)}}}function st(){const o=E();if(!o||!r(N))return;const{phit:s,perm:a}=o,d=s.map((t,e)=>.0314*Math.sqrt(a[e]/t)),m=s.map(t=>t<=0||!isFinite(t)?NaN:t/(1-t)),y=d.map((t,e)=>t/m[e]),l=r(I).split(",").map(t=>parseFloat(t.trim())).filter(t=>!isNaN(t)&&t>0),V=y.map(t=>{if(isNaN(t)||!isFinite(t))return null;for(let e=0;e<l.length;e++)if(t<l[e])return e+1;return l.length+1}),v=new Array,i={};V.forEach((t,e)=>{t!==null&&(i[t]||(i[t]={phiZ:[],rqi:[]}),i[t].phiZ.push(m[e]),i[t].rqi.push(d[e]))});const Z=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];Object.keys(i).sort((t,e)=>parseInt(t)-parseInt(e)).forEach(t=>{const e=i[parseInt(t)];v.push({x:e.phiZ,y:e.rqi,mode:"markers",type:"scatter",name:`Rock Type ${t}`,marker:{color:Z[(parseInt(t)-1)%Z.length],size:4,symbol:"circle"}})});const u=m.filter(t=>t>0&&isFinite(t));if(u.length>0){const t=Math.min(...u),e=Math.max(...u),w=[];for(let f=0;f<20;f++)w.push(t*Math.pow(e/t,f/19));l.forEach(f=>{const T=w.map(x=>f*x);v.push({x:w,y:T,mode:"lines",type:"scatter",name:`FZI=${f.toFixed(1)}`,line:{dash:"dash",color:"red"}})})}const O={title:"FZI Log-Log Plot",xaxis:{title:"Pore to Solid Volume Ratio (phi_z)",type:"log",autorange:!0},yaxis:{title:"Rock Quality Index (RQI)",type:"log",autorange:!0},showlegend:!0,margin:{l:60,r:60,t:60,b:60}};S().then(t=>{t.newPlot(r(N),v,O,{responsive:!0})})}function at(){const o=E();if(!o||!r(R))return;const{phit:s,perm:a}=o,d=s.map((t,e)=>.0314*Math.sqrt(a[e]/t)),m=s.map(t=>t/(1-t)),y=d.map((t,e)=>t/m[e]),l=r(I).split(",").map(t=>parseFloat(t.trim())).filter(t=>!isNaN(t)&&t>0),V=y.map(t=>{if(isNaN(t)||!isFinite(t))return null;for(let e=0;e<l.length;e++)if(t<l[e])return e+1;return l.length+1}),v=new Array,i={};V.forEach((t,e)=>{t!==null&&(i[t]||(i[t]={phit:[],perm:[]}),i[t].phit.push(s[e]),i[t].perm.push(a[e]))});const Z=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];Object.keys(i).sort((t,e)=>parseInt(t)-parseInt(e)).forEach(t=>{const e=i[parseInt(t)];v.push({x:e.phit,y:e.perm,mode:"markers",type:"scatter",name:`Rock Type ${t}`,marker:{color:Z[(parseInt(t)-1)%Z.length],size:4,symbol:"circle"}})});const u=new Array;for(let t=0;t<=50;t++)u.push(t*.01);l.forEach((t,e)=>{const w=u.map(x=>x<=0||x>=1?null:x*Math.pow(x*t/(.0314*(1-x)),2));v.push({x:u,y:w,mode:"lines",type:"scatter",name:`FZI=${t.toFixed(1)}`,line:{dash:"dash",color:"red"}});const f=l.length-e,T=Math.floor(u.length*.7);v.push({x:[u[T]],y:[w[T]],mode:"text",type:"scatter",name:`PRT ${f}`,text:[`PRT ${f}`],textposition:"middle right",showlegend:!1,textfont:{size:10,color:"red"}})});const O={title:"Pore-Perm Crossplot",xaxis:{title:"Porosity (fraction)",range:[-.05,.5],autorange:!1},yaxis:{title:"Permeability (mD)",type:"log",autorange:!0},showlegend:!0,margin:{l:60,r:60,t:60,b:60}};S().then(t=>{t.newPlot(r(R),v,O,{responsive:!0})})}dt(()=>{g()&&rt()}),mt(()=>(r(c),r(I),r(p)),()=>{r(c)&&r(I)&&r(p)&&(st(),at())}),ut(),tt();var L=Zt(),W=F(_(L),2);Pt(W,{});var G=F(W,2),A=_(G),Q=F(_(A),2);yt(Q),P(A);var B=F(A,6);{var it=o=>{var s=Ft();z(o,s)},lt=o=>{var s=pt(),a=ft(s);{var d=m=>{var y=kt(),l=_(y,!0);P(y),ht(()=>gt(l,r(h))),z(m,y)};J(a,m=>{r(h)&&m(d)},!0)}z(o,s)};J(B,o=>{r(k)?o(it):o(lt,!1)})}var C=F(B,2),nt=_(C);K(nt,o=>n(N,o),()=>r(N)),P(C);var H=F(C,6),ct=_(H);K(ct,o=>n(R,o),()=>r(R)),P(H),P(G),P(L),xt(Q,()=>r(I),o=>n(I,o)),z($,L),Y()}var jt=q('<div slot="left"><!></div>');function Gt($,j){X(j,!1);let g=b(null);const k=et.subscribe(h=>{n(g,h?.project??null)});U(()=>k()),tt(),wt($,{get project(){return r(g)},$$slots:{left:(h,c)=>{var p=jt(),D=_(p);{let E=vt(()=>r(g)?.project_id??null);zt(D,{get projectId(){return r(E)}})}P(p),z(h,p)}}}),Y()}export{Gt as component};

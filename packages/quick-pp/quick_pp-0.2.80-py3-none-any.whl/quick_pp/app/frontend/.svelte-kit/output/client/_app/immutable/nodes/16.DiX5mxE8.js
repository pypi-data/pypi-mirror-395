import{f as h,a as f,t as Se}from"../chunks/DzJWYvWT.js";import"../chunks/CDFnLX1k.js";import{o as ke,a as ce}from"../chunks/B8lXtDag.js";import{p as ue,l as U,g as e,$ as ie,a as je,b as me,m as b,c as v,d,s as a,r as o,n as Re,y as ae,_ as q,af as Y}from"../chunks/B_idv_Bi.js";import{i as pe}from"../chunks/BB0Jw3vZ.js";import{s as J}from"../chunks/aZZtfabf.js";import{i as K}from"../chunks/CES9meuh.js";import{e as X,i as ee}from"../chunks/CizqEEQF.js";import{r as te,c as ne}from"../chunks/BzZ_A8--.js";import{b as re}from"../chunks/BMvMhH3M.js";import{p as de,b as $e}from"../chunks/D5_Bn7R5.js";import{B as Pe}from"../chunks/DgWdy5DX.js";import{j as w}from"../chunks/CI7O7L-p.js";import{P as Te}from"../chunks/BYv_GcAz.js";import{w as Ie}from"../chunks/Mv797lCI.js";import"../chunks/pot6Uotm.js";const Ce=()=>({title:"Reservoir Summary",subtitle:"Reservoir summary and exports for the selected well"}),lt=Object.freeze(Object.defineProperty({__proto__:null,load:Ce},Symbol.toStringTag,{value:"Module"}));var Ae=h('<div class="text-sm text-red-600 mb-2"> </div>'),Ee=h('<th class="px-2 py-1 text-xs font-medium"><div class="whitespace-nowrap font-medium"> </div> <div class="mt-1"><input class="dt-filter-input input w-full" type="text"/></div></th>'),Oe=h('<td class="px-2 py-1 text-sm"> </td>'),Ve=h('<tr class="border-t odd:bg-white even:bg-surface"></tr>'),We=h('<table class="min-w-full table-auto border-collapse"><thead><tr class="bg-muted text-left"></tr></thead><tbody></tbody></table>'),De=h('<div class="text-sm text-muted-foreground">No results. Click "Generate Report" to compute reservoir summary for the selected well.</div>'),ze=h('<div class="bg-panel rounded p-3"><div class="grid grid-cols-2 gap-3 mb-3"><div><label class="text-sm" for="minPhitInput">Min PHIT (cutoff)</label> <input id="minPhitInput" type="number" class="input w-full" placeholder="min phit"/></div> <div><label class="text-sm" for="maxSwtInput">Max SWT (cutoff)</label> <input id="maxSwtInput" type="number" class="input w-full" placeholder="max swt"/></div> <div><label class="text-sm" for="maxVclayInput">Max VCLAY (cutoff)</label> <input id="maxVclayInput" type="number" class="input w-full" placeholder="max vclay"/></div> <div class="flex items-end gap-2"><!></div></div> <!> <div class="overflow-x-auto"><!></div></div>'),Le=h('<div class="text-sm text-muted-foreground">Select a well to view reservoir summary.</div>'),Me=h('<div class="ws-reservoir-summary"><div class="mb-2"><div class="font-semibold">Reservoir Summary</div> <div class="text-sm text-muted-foreground">High-level reservoir summary and exportable reports.</div></div> <!></div>');function Be(F,V){ue(V,!1);const l=b();let y=de(V,"projectId",8),g=de(V,"wellName",8);window.jQuery=w,window.$=w;const N="http://localhost:6312";let S=b(!1),c=b(null),k=[],$=b([]),P=b(.01),L=b(.99),M=b(.4),_=b(null),j=null;function se(){if(e(_))try{if(j){try{j.destroy()}catch{}for(;e(_).tBodies.length;)e(_).removeChild(e(_).tBodies[0])}const i=(e(l).length?Object.keys(e(l)[0]):[]).map(t=>({title:t,data:t}));j=w(e(_)).DataTable({data:e(l),columns:i,destroy:!0,paging:!0,searching:!0,dom:"Blfrtip",buttons:[{extend:"csv",text:"Export CSV"},{extend:"colvis",text:"Columns"}],lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],pageLength:10,info:!0,responsive:!0,autoWidth:!1,stripeClasses:["odd","even"],rowCallback(t,u,s){return s%2===0?w(t).addClass("even-row"):w(t).addClass("odd-row"),w(t).addClass("hoverable-row"),t}});try{w(e(_)).find("thead").off("input.dt-filter"),w(e(_)).find("thead .dt-filter-input").each(function(t,u){const s=w(u);s.off("keyup.dt-filter change.dt-filter"),s.on("keyup.dt-filter change.dt-filter",function(){const m=this.value||"";j.column(t).search(m).draw()})})}catch{}}catch(r){console.warn("DataTables init error",r)}}ke(()=>{se()}),ce(()=>{try{j&&j.destroy()}catch{}j=null});async function ve(){if(!(!y()||!g())){a(S,!0),a(c,null);try{const r=await fetch(`${N}/quick_pp/database/projects/${y()}/wells/${encodeURIComponent(String(g()))}/merged`);if(!r.ok)throw new Error(await r.text());const i=await r.json(),t=i&&i.data?i.data:i;if(!Array.isArray(t))throw new Error("Unexpected data format from backend");k=t}catch(r){console.warn("Failed to load well data",r),a(c,String(r?.message??r))}finally{a(S,!1)}}}function fe(){const r=Array.isArray(k)?k:[],i=[];for(const t of r){const u=Number(t.depth??t.tvdss??t.TVD??t.TVDSS??t.DEPTH??NaN),s=Number(t.vcld??t.VCLD??t.vclay??t.VCLAY??NaN),m=Number(t.phit??t.PHIT??NaN),x=Number(t.swt??t.SWT??NaN),T=Number(t.perm??t.PERM??t.permeability??NaN);let I=t.zones??t.ZONES??t.zone??t.ZONE??null;I==null&&(k.some(C=>{const W=C.zones??C.ZONES??C.zone??C.ZONE;return W!=null&&String(W).trim()!==""})||(I="ALL")),!(isNaN(u)||isNaN(s)||isNaN(m)||isNaN(x)||isNaN(T))&&i.push({depth:u,vcld:s,phit:m,swt:x,perm:T,zones:I})}return i}async function be(){if(a(c,null),!y()||!g()){a(c,"Select a project and well before generating a report");return}const r=fe(),i=k.length,t=r.length,u=i-t;if(!r.length){a(c,"No valid well rows available to compute reservoir summary (missing required numeric fields)");return}a(S,!0);try{const s={data:r,cut_offs:{}};e(P)!=null&&(s.cut_offs.PHIT=Number(e(P))),e(L)!=null&&(s.cut_offs.SWT=Number(e(L))),e(M)!=null&&(s.cut_offs.VSHALE=Number(e(M)));const m=await fetch(`${N}/quick_pp/ressum`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!m.ok)throw new Error(await m.text());const x=await m.json();a($,Array.isArray(x)?x:[]),u>0&&(console.warn(`Skipped ${u} / ${i} rows because they lacked required numeric values (depth, vcld, phit, swt, perm).`),a(c,`Report generated. Note: skipped ${u} row(s) with missing numeric values.`))}catch(s){console.warn("Ressum error",s),a(c,String(s?.message??s)),a($,[])}finally{a(S,!1)}}U(()=>e($),()=>{a(l,e($)??[])}),U(()=>e(l),()=>{e(l)&&setTimeout(()=>se(),0)}),U(()=>(ie(y()),ie(g())),()=>{y()&&g()&&ve()}),je(),pe();var G=Me(),he=v(d(G),2);{var ye=r=>{var i=ze(),t=d(i),u=d(t),s=v(d(u),2);te(s),o(u);var m=v(u,2),x=v(d(m),2);te(x),o(m);var T=v(m,2),I=v(d(T),2);te(I),o(T);var Q=v(T,2),C=d(Q);{let n=ae(()=>e(S)?"opacity:0.6; pointer-events:none;":"");Pe(C,{class:"btn btn-primary",onclick:be,get disabled(){return e(S)},get style(){return e(n)},children:(p,A)=>{Re();var B=Se("Generate Report");f(p,B)},$$slots:{default:!0}})}o(Q),o(t);var W=v(t,2);{var we=n=>{var p=Ae(),A=d(p);o(p),Y(()=>J(A,`Error: ${e(c)??""}`)),f(n,p)};K(W,n=>{e(c)&&n(we)})}var oe=v(W,2),ge=d(oe);{var xe=n=>{var p=We(),A=d(p),B=d(A);X(B,5,()=>(e(l),q(()=>Object.keys(e(l)[0]))),ee,(D,E)=>{var R=Ee(),z=d(R),H=d(z,!0);o(z);var O=v(z,2),Z=d(O);o(O),o(R),Y(()=>{J(H,e(E)),ne(Z,"placeholder",`Filter ${e(E)??""}`),ne(Z,"data-col",e(E))}),f(D,R)}),o(B),o(A);var le=v(A);X(le,5,()=>e(l),ee,(D,E)=>{var R=Ve();X(R,5,()=>(e(l),q(()=>Object.keys(e(l)[0]))),ee,(z,H)=>{var O=Oe(),Z=d(O,!0);o(O),Y(()=>J(Z,(e(E),e(H),q(()=>e(E)[e(H)])))),f(z,O)}),o(R),f(D,R)}),o(le),o(p),$e(p,D=>a(_,D),()=>e(_)),f(n,p)},Ne=n=>{var p=De();f(n,p)};K(ge,n=>{e(l),q(()=>e(l)&&e(l).length)?n(xe):n(Ne,!1)})}o(oe),o(i),re(s,()=>e(P),n=>a(P,n)),re(x,()=>e(L),n=>a(L,n)),re(I,()=>e(M),n=>a(M,n)),f(r,i)},_e=r=>{var i=Le();f(r,i)};K(he,r=>{g()?r(ye):r(_e,!1)})}o(G),f(F,G),me()}var He=h('<div slot="left"><!></div>');function it(F,V){ue(V,!1);let l=b(null),y=b(null);const g=Ie.subscribe(N=>{a(l,N?.project??null),a(y,N?.selectedWell??null)});ce(()=>g()),pe(),Te(F,{get selectedWell(){return e(y)},get project(){return e(l)},$$slots:{left:(N,S)=>{var c=He(),k=d(c);{let $=ae(()=>e(l)?.project_id??""),P=ae(()=>e(y)?.name??"");Be(k,{get projectId(){return e($)},get wellName(){return e(P)}})}o(c),f(N,c)}}}),me()}export{it as component,lt as universal};

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./HHMWGB-5.js","./CqkleIqs.js"])))=>i.map(i=>d[i]);
import{_ as te}from"./PPVm8Dsz.js";import{f as P,a as _,c as re}from"./DzJWYvWT.js";import"./CDFnLX1k.js";import{o as ae,a as J}from"./B8lXtDag.js";import{p as oe,g as r,m as h,l as M,$ as T,a as ie,d as b,c as v,n as le,r as y,s as f,af as U,b as se,ap as ne,f as de}from"./B_idv_Bi.js";import{s as ce}from"./aZZtfabf.js";import{i as k}from"./CES9meuh.js";import{r as Z,s as pe}from"./BzZ_A8--.js";import{d as fe}from"./C6QL3neo.js";import{a as me,b as ue}from"./BMvMhH3M.js";import{p as j,b as ve}from"./D5_Bn7R5.js";import{i as _e}from"./BB0Jw3vZ.js";import{w as he}from"./Mv797lCI.js";import{D as be}from"./BjC9EeZr.js";const ye=!0,ge=ye;var we=P('<label class="text-sm">Interval (ms): <input type="number" class="input w-24 ml-2"/></label>'),ze=P('<div class="text-sm">Loading well logâ€¦</div>'),xe=P('<div class="text-sm text-red-500"> </div>'),Re=P('<div class="ws-well-plot"><!> <div class="mb-2 flex items-center gap-2"><button class="btn px-3 py-1 text-sm bg-gray-800 text-white rounded" aria-label="Refresh plot">Refresh</button> <label class="text-sm flex items-center gap-1"><input type="checkbox"/> Auto-refresh</label> <!></div> <!> <div></div></div>');function Be(C,g){oe(g,!1);let n=j(g,"projectId",8),d=j(g,"wellName",8),w=null,a=h(null),V=j(g,"minWidth",8,"480px"),A=h(!1),z=h(null),x=h(!1),O=h(5e3),c=null,p={enabled:!1,minDepth:null,maxDepth:null},s={enabled:!1,zones:[]};const G="http://localhost:6312";async function H(){if(w)return w;const e=await te(()=>import("./HHMWGB-5.js").then(t=>t.p),__vite__mapDeps([0,1]),import.meta.url);return w=e.default||e,w}async function m(){if(!(!n()||!d())){f(A,!0),f(z,null);try{let e=`${G}/quick_pp/plotter/projects/${n()}/wells/${encodeURIComponent(String(d()))}/log`;const t=new URLSearchParams;if(p.enabled&&(p.minDepth!==null&&t.append("min_depth",String(p.minDepth)),p.maxDepth!==null&&t.append("max_depth",String(p.maxDepth))),s?.enabled&&Array.isArray(s.zones)&&s.zones.length>0){const S=s.zones.map(F=>String(F)).join(",");t.append("zones",S)}t.toString()&&(e+="?"+t.toString());const o=await fetch(e);if(!o.ok)throw new Error(await o.text());const i=await o.json();if(!r(a))throw new Error("Missing plot container");const l=await H();if(!l)throw new Error("Failed to load Plotly library");const u={...i.config||{},responsive:!0,scrollZoom:!0},R={...i.layout||{},dragmode:i.layout?.dragmode??"zoom"};if(l.react?l.react(r(a),i.data,R,u):l.newPlot(r(a),i.data,R,u),ge&&typeof ResizeObserver<"u"){if(r(a)?._plotlyResizeObserver)try{r(a)._plotlyResizeObserver.disconnect()}catch{}const S=new ResizeObserver(()=>{try{l.Plots&&l.Plots.resize&&l.Plots.resize(r(a))}catch{}});S.observe(r(a)),ne(a,r(a)._plotlyResizeObserver=S)}}catch(e){console.error("Failed to render well plot",e),f(z,String(e?.message??e))}finally{f(A,!1)}}}function K(){try{c&&(clearInterval(c),c=null),r(x)&&typeof window<"u"&&(c=window.setInterval(()=>{m()},Number(r(O))||5e3))}catch{}}const Q=he.subscribe(e=>{if(e?.depthFilter){const t={...e.depthFilter};JSON.stringify(t)!==JSON.stringify(p)&&(p=t,n()&&d()&&m())}if(e?.zoneFilter){const t={...e.zoneFilter},o=s&&Array.isArray(s.zones)?s.zones.join(","):"",i=t&&Array.isArray(t.zones)?t.zones.join(","):"";(t.enabled!==s.enabled||o!==i)&&(s=t,n()&&d()&&m())}});ae(()=>{}),J(()=>{try{Q(),r(a)&&r(a)._plotlyResizeObserver&&(r(a)._plotlyResizeObserver.disconnect(),delete r(a)._plotlyResizeObserver),c&&(clearInterval(c),c=null)}catch{}});{const e=t=>{try{const o=t.detail;if(!o)return;String(o.projectId)===String(n())&&String(o.wellName)===String(d())&&m()}catch{}};window.addEventListener("qpp:data-updated",e),J(()=>window.removeEventListener("qpp:data-updated",e))}M(()=>(T(n()),T(d())),()=>{n()&&d()&&m()}),M(()=>{},()=>{K()}),ie(),_e();var I=Re(),W=b(I);be(W,{});var D=v(W,2),L=b(D);L.__click=m;var E=v(L,2),N=b(E);Z(N),le(),y(E);var X=v(E,2);{var Y=e=>{var t=we(),o=v(b(t));Z(o),y(t),ue(o,()=>r(O),i=>f(O,i)),_(e,t)};k(X,e=>{r(x)&&e(Y)})}y(D);var q=v(D,2);{var $=e=>{var t=ze();_(e,t)},ee=e=>{var t=re(),o=de(t);{var i=l=>{var u=xe(),R=b(u);y(u),U(()=>ce(R,`Error: ${r(z)??""}`)),_(l,u)};k(o,l=>{r(z)&&l(i)},!0)}_(e,t)};k(q,e=>{r(A)?e($):e(ee,!1)})}var B=v(q,2);ve(B,e=>f(a,e),()=>r(a)),y(I),U(()=>pe(B,`width:100%; min-width: ${V()??""}; height:900px;`)),me(N,()=>r(x),e=>f(x,e)),_(C,I),se()}fe(["click"]);export{Be as W};

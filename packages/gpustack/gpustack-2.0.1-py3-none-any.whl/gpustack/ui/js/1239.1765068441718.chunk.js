"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1239],{28565:function(e,n,t){var r=t(48305),i=t.n(r),a=t(53231),s=t(35421);n.Z=function(){var e=(0,a.useIntl)(),n=s.ZP.useMessage(),t=i()(n,2),r=t[0];t[1];return{getRuleMessage:function(n,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=r?e.formatMessage({id:t}):t,a=Array.isArray(n)?n:[n];return a.includes("select")&&a.includes("input")?e.formatMessage({id:"common.form.rule.selectInput"},{name:i}):a.includes("input")?e.formatMessage({id:"common.form.rule.input"},{name:i}):e.formatMessage({id:"common.form.rule.select"},{name:i})},showSuccess:function(n){r.success(n||e.formatMessage({id:"common.message.success"}))}}}},6077:function(e,n,t){t.d(n,{Z:function(){return V}});var r,i=t(90228),a=t.n(i),s=t(87999),l=t.n(s),o=t(48305),u=t.n(o),c=t(51143),d=t(1452),m=t(53231),p=t(26965),f=t(75271),v=t(73940),g=t(53649),h=t.n(g),x=t(32914),b=t(18385),j=t(91315),y=t(28565),w=t(26447),I=t(32699),Z=t.n(I),F=t(67585),k=t(92086),_=t(52676),M=F.ZP.div(r||(r=h()(["\n  display: flex;\n  align-items: center;\n  .label {\n    font-weight: 500;\n  }\n  .dot {\n    width: 4px;\n    height: 4px;\n    border-radius: 50%;\n    background: var(--ant-color-text);\n    margin: 0 8px;\n  }\n  .datacenter,\n  .value {\n    color: var(--ant-color-text-secondary);\n  }\n  .icon {\n    margin-right: 8px;\n  }\n"]))),C=function(){var e=(0,w.KO)(x.Vd),n=u()(e,2)[1],t=(0,m.useIntl)();return(0,_.jsx)(m.Link,{to:"/cluster-management/credentials",onClick:function(){n(!0)},children:t.formatMessage({id:"clusters.button.addCredential"})})},q=function(e){var n=e.value,t=e.data;return(0,_.jsxs)(M,{className:"flex-center",children:[(0,_.jsx)("span",{className:"icon",children:t.icon}),(0,_.jsx)("span",{className:"label",children:t.label})," ",(0,_.jsx)("span",{className:"dot"}),(0,_.jsx)("span",{className:"datacenter",children:t.datacenter})," ",(0,_.jsx)("span",{className:"dot"})," ",(0,_.jsx)("span",{className:"value",children:Z().toUpper(n)})]})},L=function(e){var n=e.credentialList,t=e.action,r=e.credentialID,i=(0,m.useIntl)(),s=(0,k.K)(),o=s.getRegions,u=s.getOSImages,c=s.updateOSImages,d=s.updateInstanceTypes,v=s.getInstanceTypes,g=s.setLoading,h=s.loading,x=s.regions,w=(0,y.Z)().getRuleMessage,I=function(){var e=l()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),e.next=3,Promise.all([u(n),v(n)]);case 3:return e.next=5,o(n);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();(0,f.useEffect)((function(){r&&t!==j.Kd.CREATE&&o(r)}),[r]);return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(p.Z.Item,{name:"credential_id",rules:[{required:!0,message:w("input","clusters.credential.title")}],children:(0,_.jsx)(b.Z,{notFoundContent:(0,_.jsx)(C,{}),disabled:t===j.Kd.EDIT,label:i.formatMessage({id:"clusters.credential.title"}),required:!0,options:n,onChange:I})}),(0,_.jsx)(p.Z.Item,{name:"region",rules:[{required:!0,message:w("input","clusters.workerpool.region")}],children:(0,_.jsx)(b.Z,{showSearch:!0,disabled:t===j.Kd.EDIT,label:i.formatMessage({id:"clusters.workerpool.region"}),required:!0,options:x,loading:h,filterOption:function(e,n){return n.label.toLowerCase().includes(e.toLowerCase())||n.datacenter.toLowerCase().includes(e.toLowerCase())||n.value.toLowerCase().includes(e.toLowerCase())},labelRender:function(e){var n=x.find((function(n){return n.value===e.value}));return n?(0,_.jsxs)(M,{className:"flex-center",children:[(0,_.jsx)("span",{className:"icon",children:null==n?void 0:n.icon}),(0,_.jsx)("span",{className:"label",children:null==n?void 0:n.label})," ",(0,_.jsx)("span",{className:"dot"}),(0,_.jsx)("span",{className:"datacenter",children:null==n?void 0:n.datacenter})," ",(0,_.jsx)("span",{className:"dot"}),(0,_.jsx)("span",{className:"value",children:Z().toUpper(null==n?void 0:n.value)})]}):e.label},optionRender:q,onChange:function(e){d(e),c(e)},notFoundContent:i.formatMessage({id:"clusters.create.noRegions"})})})]})},S=(0,f.forwardRef)((function(e,n){var t=e.action,r=e.provider,i=e.currentData,s=e.credentialList,o=e.onFinish,g=p.Z.useForm(),h=u()(g,1)[0],x=(0,m.useIntl)();return(0,f.useEffect)((function(){i&&h.setFieldsValue(i)}),[i]),(0,f.useImperativeHandle)(n,(function(){return{resetFields:function(){h.resetFields()},submit:function(){h.submit()},setFieldsValue:function(e){h.setFieldsValue(e)},getFieldsValue:function(){return h.getFieldsValue()},validateFields:(e=l()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.validateFields();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})};var e})),(0,_.jsxs)(p.Z,{name:"clusterForm",form:h,onFinish:o,preserve:!1,scrollToFirstError:!0,initialValues:i,children:[(0,_.jsx)(p.Z.Item,{name:"name",rules:[{required:!0,message:x.formatMessage({id:"common.form.rule.input"},{name:x.formatMessage({id:"common.table.name"})})}],children:(0,_.jsx)(c.Z.Input,{label:x.formatMessage({id:"common.table.name"}),required:!0,trim:!1})}),r===v.dC.DigitalOcean&&(0,_.jsx)(L,{provider:r,action:t,credentialID:null==i?void 0:i.credential_id,credentialList:s}),(0,_.jsx)(p.Z.Item,{name:"description",rules:[{required:!1}],children:(0,_.jsx)(d.Z,{autoSize:{minRows:4,maxRows:6},label:x.formatMessage({id:"common.table.description"})})})]})})),V=S},29032:function(e,n,t){t.d(n,{F:function(){return me},Z:function(){return ve}});var r,i,a=t(90228),s=t.n(a),l=t(87999),o=t.n(l),u=t(67825),c=t.n(u),d=t(48305),m=t.n(d),p=t(26068),f=t.n(p),v=t(53649),g=t.n(v),h=t(32914),x=t(8961),b=t(92829),j=t(81305),y=t(53722),w=t(68048),I=t(51143),Z=t(18385),F=t(91315),k=t(28565),_=t(66275),M=t(38913),C=t(53231),q=t(25383),L=t(26965),S=t(79635),V=t(26447),z=t(32699),T=t.n(z),P=t(75271),O=t(67585),N=t(73940),R=t(15558),E=t.n(R),D=t(82092),K=t.n(D),B=t(63551),A=t(55446),U=t(69002),G=t(52676),W=function(e){var n=e.widget,t=e.title,r=e.required,i=e.placeholder,a=e.options,s=e.description,l=e.enum,o=e.style,u=e.value,c=e.min,d=e.max,m=e.status,p=e.checked,v=e.isInFormItems,g=e.disabled,h=e.onChange,x=U.Z[n],b=null==l?void 0:l.map((function(e){return{label:e,value:e}}));return x?(0,G.jsx)(x,{label:t,required:r,placeholder:i,description:s,min:c,max:d,status:m,isInFormItems:v,disabled:g,options:a||b,value:u,checked:p,style:f()({width:"100%"},o),onChange:h}):null},H=O.ZP.div(r||(r=g()(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 8px;\n"]))),Q=O.ZP.div(i||(i=g()(["\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  width: 100%;\n"]))),X=function(e){var n=e.schemaList,t=e.data,r=e.onChange,i=e.validateStatus,a=e.disabled,s=function(e,n){var t;if("checkbox"===(null==n||null===(t=n.target)||void 0===t?void 0:t.type)){var i,a=null===(i=n.target)||void 0===i?void 0:i.checked;null==r||r(K()({},e,a))}else{var s=null!=n&&n.target?n.target.value:n;null==r||r(K()({},e,s))}};return(0,G.jsx)(G.Fragment,{children:n.map((function(e){return(0,P.createElement)(W,f()(f()({status:null==i?void 0:i[e.name],widget:e.type},e),{},{disabled:a||e.readOnly,key:e.name,value:null==t?void 0:t[e.name],checked:null==t?void 0:t[e.name],isInFormItems:!1,onChange:function(n){return s(e.name,n)}}))}))})},J=function(e){var n=e.dataList,t=void 0===n?[]:n,r=e.label,i=e.btnText,a=e.properties,s=void 0===a?{}:a,l=e.requiredFields,o=void 0===l?[]:l,u=e.minItems,c=void 0===u?0:u,d=e.validateStatusList,p=void 0===d?[]:d,v=e.disabled,g=e.onAdd,h=e.onDelete,x=e.onChange,b=P.useState(t||[]),j=m()(b,2),y=j[0],w=j[1],I=(0,P.useMemo)((function(){return Object.entries(s).map((function(e){var n=m()(e,2),t=n[0],r=n[1];return f()(f()({},r),{},{required:o.includes(t),name:t})}))}),[s,o]),Z=function(){var e=Object.keys(s),n=[].concat(E()(y),[f()({},e.reduce((function(e,n){return f()(f()({},e),{},K()({},n,""))}),{}))]);w(n),null==g||g(n)},F=function(e,n){var t=E()(y);t[e]=f()(f()({},t[e]),n),w(t),null==x||x(t)};return(0,P.useEffect)((function(){!t.length&&c>0&&Z()}),[]),(0,P.useEffect)((function(){w(t)}),[t]),(0,G.jsx)(B.Z,{label:r,btnText:i,onAdd:Z,disabled:v,children:y.map((function(e,n){return(0,G.jsxs)(H,{children:[(0,G.jsx)(Q,{children:(0,G.jsx)(X,{schemaList:I,data:e,validateStatus:null==p?void 0:p[n],disabled:v,onChange:function(e){return F(n,e)}})}),!v&&(0,G.jsx)(S.ZP,{size:"small",type:"default",shape:"circle",style:{width:24,marginLeft:10,flex:"none"},icon:(0,G.jsx)(A.Z,{}),onClick:function(){return function(e){var n=y[e],t=y.filter((function(n,t){return t!==e}));w(t),null==h||h(n,t)}(n)}})]},n)}))})};var Y,$,ee,ne,te={type:"array",title:"Volumes",name:"volumes",required:["name","size_gb","format"],properties:{name:{name:"name",type:"string",title:"Name",widget:"Input"},size_gb:{name:"size_gb",type:"number",title:"Size (GB)",widget:"InputNumber",min:0,style:{width:120}},format:{name:"format",type:"string",title:"Format",widget:"Select",enum:["ext4","xfs"],style:{width:150}}}},re=(0,P.forwardRef)((function(e,n){var t=e.disabled,r=(0,C.useIntl)(),i=L.Z.useFormInstance(),a=L.Z.useWatch(["cloud_options",te.name],i),l=(0,P.useState)([]),u=m()(l,2),c=u[0],d=u[1],p=function(e){var n=e.requiredFields,t=e.setValidateStatusList,r=(0,P.useRef)(!1),i=function(e,n){return!e},a=function(){var e=o()(s()().mark((function e(a,l){var o,u;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.current){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:if(o=new Set,u=[],(l||[]).forEach((function(e,t){var r={};Object.entries(e||{}).forEach((function(e){var t=m()(e,2),a=t[0],s=t[1];i(s)?(o.add(a),null!=n&&n.includes(a)?r[a]="error":r[a]=""):r[a]=""})),u.push(r)})),t(u),!(o.size>0)){e.next=8;break}return e.abrupt("return",Promise.reject("".concat(Array.from(o).join(", ")," is required")));case 8:return e.abrupt("return",Promise.resolve());case 9:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}();return{listMapValidator:a,toggleValidation:function(e){r.current=e}}}({requiredFields:te.required,setValidateStatusList:function(e){d(e)}}),f=p.listMapValidator,v=p.toggleValidation;return(0,G.jsx)(L.Z.Item,{name:["cloud_options",te.name],rules:[{validator:f}],children:(0,G.jsx)(J,{validateStatusList:c,btnText:r.formatMessage({id:"clusters.workerpool.volumes.add"}),label:r.formatMessage({id:"clusters.workerpool.volumes"}),dataList:a||[],properties:te.properties||{},requiredFields:te.required||[],disabled:t,onAdd:function(e){v(!1),i.setFieldValue(["cloud_options",te.name],e),v(!0)},onDelete:function(e,n){v(!1),i.setFieldValue(["cloud_options",te.name],n),v(!0)},onChange:function(e){v(!0),i.setFieldValue(["cloud_options",te.name],e)}})})})),ie=re,ae=["collapsible","onToggle"],se=O.ZP.div(Y||(Y=g()(["\n  pointer-events: auto;\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  grid-gap: 0 16px;\n  .ant-form-item:nth-child(1) {\n    grid-column: 1 / 3;\n  }\n  .ant-form-item:nth-child(2) {\n    grid-column: 1 / 3;\n  }\n  .ant-form-item:nth-child(5) {\n    grid-column: 1 / 3;\n  }\n\n  .ant-form-item:nth-child(6) {\n    grid-column: 1 / 3;\n  }\n  .ant-form-item:nth-child(7) {\n    grid-column: 1 / 3;\n  }\n"]))),le=O.ZP.div($||($=g()(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding-block: 12px;\n"]))),oe=O.ZP.div.attrs({className:"option-item"})(ee||(ee=g()(["\n  display: flex;\n  gap: 8px;\n  align-items: center;\n"]))),ue=O.ZP.div(ne||(ne=g()(["\n  display: grid;\n  grid-template-columns: 1fr 1fr 1fr;\n  gap: 4px 8px;\n  font-weight: 400;\n"]))),ce=function(){var e=(0,C.useIntl)();return(0,G.jsx)(le,{children:e.formatMessage({id:"clusters.create.noInstanceTypes"})})},de=function(e){var n=e.label,t=e.vendor,r=e.style;return(0,G.jsxs)("div",{style:r,className:"flex-center gap-8",children:[(0,G.jsx)(b.Z,{type:T().get(N._T,t,"icon-gpu1")}),n]})},me=function(e){var n=e.data,t=void 0===n?{}:n,r=e.styles,i=Object.entries((null==t?void 0:t.specInfo)||{});return(0,G.jsx)(_._,{header:(0,G.jsx)(de,{label:t.description||t.label,vendor:t.vendor,style:null==r?void 0:r.header}),description:i.length>0&&(0,G.jsx)(ue,{style:f()({},null==r?void 0:r.description),children:Object.entries(null==t?void 0:t.specInfo).filter((function(e){var n=m()(e,2);n[0];return n[1]})).map((function(e){var n=m()(e,2),t=n[0],r=n[1];return(0,G.jsxs)(oe,{children:[(0,G.jsxs)("span",{className:"label",children:[T().get(N.TE,t,t),":"]}),(0,G.jsx)("span",{className:"value",children:r})]},t)}))})},t.value)},pe=function(e){var n=e.instanceSpec;return(0,G.jsx)(G.Fragment,{children:Object.entries(n).filter((function(e){var n=m()(e,2);n[0];return n[1]})).map((function(e){var n=m()(e,2),t=n[0];n[1];return(0,G.jsx)(L.Z.Item,{name:["instance_spec",t],hidden:!0,children:(0,G.jsx)(I.Z.Input,{})},t)}))})},fe=(0,P.forwardRef)((function(e,n){var t=e.action,r=e.name,i=void 0===r?"workerPoolForm":r,a=e.onFinish,l=e.onDelete,u=e.showDelete,d=e.currentData,p=e.collapseProps,v=(0,V.KO)(h.FB),g=m()(v,1)[0],b=(0,V.KO)(h.hQ),_=m()(b,1)[0],z=p||{},O=z.collapsible,N=z.onToggle,R=c()(z,ae),E=L.Z.useForm(),D=m()(E,1)[0],K=(0,C.useIntl)(),B=(0,k.Z)().getRuleMessage,A=L.Z.useWatch("labels",D),U=L.Z.useWatch("name",D),W=(0,P.useState)({}),H=m()(W,2),Q=H[0],X=H[1];(0,P.useEffect)((function(){if(d){var e=_.find((function(e){return e.os_image===d.os_image})),n=g.find((function(e){return e.value===d.instance_type}));D.setFieldsValue(f()(f()({},d),{},{instance_type:(null==n?void 0:n.value)||"",os_image:(null==e?void 0:e.os_image)||"",image_name:(null==e?void 0:e.value)||""})),X((function(){return n?d.instance_spec:{}}))}}),[d,g,_]);var J=(0,q.Z)((function(e){return 8===e.count?_.filter((function(e){return"gpu-h100x8-base"===e.os_image})):1===e.count&&"amd"===e.vendor?_.filter((function(e){return"gpu-amd-base"===e.os_image})):1===e.count&&"nvidia"===e.vendor?_.filter((function(e){return"gpu-h100x1-base"===e.os_image})):_})),Y=(0,P.useMemo)((function(){return J(Q)}),[_,Q,J]);return(0,P.useImperativeHandle)(n,(function(){return{resetFields:function(){D.resetFields()},submit:function(){D.submit()},setFieldsValue:function(e){D.setFieldsValue(e)},getFieldsValue:function(){return D.getFieldsValue()},validateFields:(e=o()(s()().mark((function e(){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.validateFields();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})};var e})),(0,G.jsx)(x.Z,f()(f()({},R),{},{title:U,collapsible:O,onToggle:N,deleteBtn:u&&(0,G.jsx)(S.ZP,{onClick:l,icon:(0,G.jsx)(M.Z,{}),danger:!0,type:"text",variant:"filled",color:"danger",size:"small"}),children:(0,G.jsx)(L.Z,{name:i,form:D,onFinish:a,preserve:!1,scrollToFirstError:!0,initialValues:{replicas:1,batch_size:1},children:(0,G.jsxs)(se,{children:[(0,G.jsx)(L.Z.Item,{name:"name",rules:[{required:!0,message:B("input","common.table.name")}],children:(0,G.jsx)(I.Z.Input,{label:K.formatMessage({id:"common.table.name"}),required:!0})}),(0,G.jsx)(L.Z.Item,{name:"instance_type",rules:[{required:!0,message:B("input","clusters.workerpool.instanceType")}],children:(0,G.jsx)(Z.Z,{showSearch:!0,filterOption:function(e,n){return n.label.toLowerCase().includes(e.toLowerCase())||n.description.toLowerCase().includes(e.toLowerCase())},labelRender:function(e){var n=g.find((function(n){return n.value===e.value}))||Q;return!n||T().isEmpty(n)?null:(0,G.jsx)(de,{label:e.label||(null==n?void 0:n.label)||e.value,vendor:(null==n?void 0:n.vendor)||""})},notFoundContent:(0,G.jsx)(ce,{}),label:K.formatMessage({id:"clusters.workerpool.instanceType"}),required:!0,options:g,disabled:t===F.Kd.EDIT,optionRender:me,onChange:function(e,n){var t,r,i=f()(f()({},n.specInfo),{},{label:n.label,vendor:n.vendor,description:n.description,count:n.count});X(f()({},i));var a=J(f()({},i));D.setFieldsValue({os_image:null===(t=a[0])||void 0===t?void 0:t.os_image,image_name:null===(r=a[0])||void 0===r?void 0:r.value,instance_spec:f()({},i)})}})}),(0,G.jsx)(L.Z.Item,{name:"replicas",rules:[{required:!0,message:B("input","clusters.workerpool.replicas")}],children:(0,G.jsx)(w.Z,{label:K.formatMessage({id:"clusters.workerpool.replicas"}),required:!0})}),(0,G.jsx)(L.Z.Item,{name:"batch_size",rules:[{required:!0,message:B("input","clusters.workerpool.batchSize")}],children:(0,G.jsx)(w.Z,{description:K.formatMessage({id:"clusters.workerpool.batchSize.desc"}),label:K.formatMessage({id:"clusters.workerpool.batchSize"}),required:!0})}),(0,G.jsx)(L.Z.Item,{name:"image_name",rules:[{required:!0,message:B("input","clusters.workerpool.osImage")}],children:(0,G.jsx)(y.Z,{showSearch:!0,allowClear:!0,onChange:function(e,n){D.setFieldsValue({os_image:n.os_image||e})},optionRender:function(e){return me(f()(f()({},e),{},{styles:{header:{marginBlock:5}}}))},options:Y,disabled:t===F.Kd.EDIT,label:K.formatMessage({id:"clusters.workerpool.osImage"}),required:!0})}),(0,G.jsx)(L.Z.Item,{name:"labels",rules:[function(e){e.getFieldValue;return{validator:function(e,n){return T().keys(n).length>0&&T().some(T().keys(n),(function(e){return!n[e]}))?Promise.reject(K.formatMessage({id:"common.validate.value"},{name:"labels"})):Promise.resolve()}}}],children:(0,G.jsx)(j.Z,{label:K.formatMessage({id:"resources.table.labels"}),labels:A||{},btnText:K.formatMessage({id:"common.button.addLabel"})})}),(0,G.jsx)(ie,{disabled:t===F.Kd.EDIT}),(0,G.jsx)(L.Z.Item,{name:"os_image",hidden:!0,children:(0,G.jsx)(I.Z.Input,{})}),(0,G.jsx)(pe,{instanceSpec:Q})]})})}))})),ve=fe},92086:function(e,n,t){t.d(n,{K:function(){return b}});var r=t(90228),i=t.n(r),a=t(26068),s=t.n(a),l=t(87999),o=t.n(l),u=t(48305),c=t.n(u),d=t(32914),m=t(48075),p=t(26447),f=t(32699),v=t.n(f),g=t(75271),h=t(92047),x={nyc1:"ðŸ‡ºðŸ‡¸",nyc2:"ðŸ‡ºðŸ‡¸",nyc3:"ðŸ‡ºðŸ‡¸",tor1:"ðŸ‡¨ðŸ‡¦",sfo1:"ðŸ‡ºðŸ‡¸",sfo2:"ðŸ‡ºðŸ‡¸",sfo3:"ðŸ‡ºðŸ‡¸",atl1:"ðŸ‡ºðŸ‡¸",sgp1:"ðŸ‡¸ðŸ‡¬",blr1:"ðŸ‡®ðŸ‡³",lon1:"ðŸ‡¬ðŸ‡§",ams2:"ðŸ‡³ðŸ‡±",ams3:"ðŸ‡³ðŸ‡±",fra1:"ðŸ‡©ðŸ‡ª",syd1:"ðŸ‡¦ðŸ‡º"},b=function(){var e=(0,p.KO)(d.pp),n=c()(e,2),t=n[0],r=n[1],a=(0,p.KO)(d.FB),l=c()(a,2)[1],u=(0,p.KO)(d.hQ),f=c()(u,2)[1],b=(0,p.KO)(d.uu),j=c()(b,2),y=j[0],w=j[1],I=(0,p.KO)(d.hG),Z=c()(I,2),F=Z[0],k=Z[1],_=(0,g.useState)(!1),M=c()(_,2),C=M[0],q=M[1],L=function(){var e=o()(i()().mark((function e(n){var t,a,l,o;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,q(!0),e.next=4,(0,h.c9)({id:n});case 4:l=e.sent,o=null==l||null===(t=l.regions)||void 0===t||null===(a=t.filter)||void 0===a?void 0:a.call(t,(function(e){return e.sizes.some((function(e){return e.includes("gpu")}))&&e.available})).map((function(e){return s()(s()({},(n=e.name,t=n.trim().split(" "),r=t.pop(),{label:t.join(" "),datacenter:"Datacenter ".concat(r)})),{},{value:e.slug,icon:x[e.slug],sizes:e.sizes||[]});var n,t,r})),r(o),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),r([]);case 12:return e.prev=12,q(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])})));return function(n){return e.apply(this,arguments)}}(),S=function(){var e=o()(i()().mark((function e(n){var t,r,a;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,h.BT)({id:n});case 3:return r=e.sent,a=null==r||null===(t=r.sizes)||void 0===t?void 0:t.filter((function(e){return e.gpu_info&&e.available})).map((function(e){var n,t,r,i,a,s,l,o,u,c,d,p,f,g=(o=(i=e).gpu_info,u=i.disk_info,{vram:(0,m.AU)({sizeInBytes:(null==o||null===(a=o.vram)||void 0===a?void 0:a.amount)||0,defaultUnit:"GiB"}),vcpus:i.vcpus||0,ram:(0,m.AU)({sizeInBytes:i.memory||0,defaultUnit:"MiB"}),bootDisk:(0,m.AU)({sizeInBytes:(null==u||null===(s=u.find((function(e){return"local"===e.type})))||void 0===s?void 0:s.size.amount)||0,defaultUnit:"GiB"}),scratchDisk:(0,m.AU)({sizeInBytes:(null==u||null===(l=u.find((function(e){return"scratch"===e.type})))||void 0===l?void 0:l.size.amount)||0,defaultUnit:"GiB"})}),h=(c=e,"".concat(v().toUpper(null===(d=c.gpu_info)||void 0===d?void 0:d.model.replace(/_/g," ")))),x="".concat(h," ").concat(null===(n=e.gpu_info)||void 0===n?void 0:n.count,"X");return{count:null===(t=e.gpu_info)||void 0===t?void 0:t.count,label:"".concat(x," - ").concat((p=g,f=[],p.vram&&f.push("".concat(p.vram," VRAM")),p.vcpus&&f.push("".concat(p.vcpus," vCPUs")),p.ram&&f.push("".concat(p.ram," RAM")),f.join(" / "))),value:e.slug,description:x,specInfo:g,vendor:v().get(v().split(null===(r=e.gpu_info)||void 0===r?void 0:r.model,"_"),0),available:e.available,regions:e.regions||[]}})),k(a),e.abrupt("return",a);case 9:e.prev=9,e.t0=e.catch(0),k([]);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n){return e.apply(this,arguments)}}(),V=function(){var e=o()(i()().mark((function e(n){var t,r,a;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,h.iL)({id:n});case 3:return r=e.sent,a=null===(t=r.images)||void 0===t?void 0:t.filter((function(e){return"available"===e.status})).map((function(e){return{label:e.description,value:e.description,os_image:e.slug,name:e.name,description:e.description,vendor:v().camelCase(e.distribution),specInfo:{},regions:e.regions||[]}})),w(a),e.abrupt("return",a);case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n){return e.apply(this,arguments)}}();return{regions:t,loading:C,setLoading:q,getRegions:L,getInstanceTypes:S,getOSImages:V,updateOSImages:function(e,n){var t=(n||y).filter((function(n){return n.regions.includes(e)&&["debian","ubuntu"].includes(n.vendor)}));f(t)},updateInstanceTypes:function(e,n){var t=(n||F).filter((function(n){return n.regions.includes(e)}));l(t)}}}},66275:function(e,n,t){t.d(n,{_:function(){return j},Z:function(){return y}});var r,i,a,s,l=t(53649),o=t.n(l),u=t(85882),c=t(48075),d=t(53231),m=t(32699),p=t.n(m),f=(t(75271),t(67585)),v=t(52676),g=f.ZP.div(r||(r=o()(["\n  display: flex;\n  gap: 8px;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: center;\n  width: 100%;\n  border-bottom: 1px solid var(--ant-color-split);\n  padding-bottom: 5px;\n"]))),h=f.ZP.div(i||(i=o()(["\n  width: 100%;\n"]))),x=f.ZP.div(a||(a=o()(["\n  display: flex;\n  flex-wrap: wrap;\n  white-space: break-spaces;\n"]))),b=f.ZP.div(s||(s=o()(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  gap: 8px;\n  color: var(--ant-color-text-tertiary);\n"]))),j=function(e){var n=e.header,t=e.description;return(0,v.jsxs)(g,{children:[(0,v.jsx)(h,{children:n}),t&&(0,v.jsx)(b,{children:t})]})},y=function(e){var n,t,r,i,a,s,l,o=e.data,m=e.header,f=e.info,g=(0,d.useIntl)();return(0,v.jsx)(j,{header:m||(0,v.jsxs)(u.Z,{ghost:!0,children:[(0,v.jsxs)("span",{className:"font-700",children:["[",o.index,"] "]}),o.label]}),description:f||(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(x,{children:[g.formatMessage({id:"resources.table.vram"}),"(",g.formatMessage({id:"resources.table.used"}),"/",g.formatMessage({id:"resources.table.total"}),"):"," ",(0,v.jsxs)("span",{children:[(0,c.hy)((null==o||null===(n=o.memory)||void 0===n?void 0:n.used)||(null==o||null===(t=o.memory)||void 0===t?void 0:t.allocated)||0)," ","/ ",(0,c.hy)((null==o||null===(r=o.memory)||void 0===r?void 0:r.total)||0)]})]}),(0,v.jsxs)(x,{children:[(0,v.jsxs)("span",{children:[g.formatMessage({id:"resources.table.gpuutilization"}),":"," "]}),null!=o&&null!==(i=o.memory)&&void 0!==i&&i.used?p().round((null==o||null===(a=o.memory)||void 0===a?void 0:a.utilization_rate)||0,2):100*p().round((null===(s=o.memory)||void 0===s?void 0:s.allocated)/(null===(l=o.memory)||void 0===l?void 0:l.total),2),"%"]})]})})}}}]);
(self.webpackChunk=self.webpackChunk||[]).push([[4931],{85882:function(e,t,n){"use strict";var a,r=n(26068),o=n.n(r),i=n(48305),l=n.n(i),s=n(67825),u=n.n(s),c=n(53649),d=n.n(c),m=n(15409),h=n(68652),p=n(32699),f=n(75271),v=n(67585),g=n(3453),x=n(52676),b=["children","maxWidth","minWidth","ghost","title","showTitle","tooltipProps","radius","filled"],y=(0,v.ZP)(h.Z)(a||(a=d()(["\n  margin: 0;\n  &.tag-filled {\n    border: none;\n    background-color: var(--ant-color-fill-secondary);\n  }\n"]))),_=function(e){var t=e.children,n=e.maxWidth,a=void 0===n?"100%":n,r=e.minWidth,i=e.ghost,s=void 0!==i&&i,c=e.title,d=e.showTitle,h=void 0!==d&&d,v=e.tooltipProps,_=e.radius,k=void 0===_?12:_,w=e.filled,j=void 0!==w&&w,D=u()(e,b),Z=(0,f.useRef)(null),C=(0,f.useState)(!1),M=l()(C,2),S=M[0],T=M[1],P=(0,f.useRef)(null),A=(0,f.useCallback)((function(){if(Z.current){var e=Z.current,t=e.scrollWidth,n=e.clientWidth;T(t>n)}}),[Z.current]);(0,f.useEffect)((function(){var e,t,n=Z.current;if(n)return null===(e=P.current)||void 0===e||e.disconnect(),P.current=new ResizeObserver((function(){A()})),null===(t=P.current)||void 0===t||t.observe(n),A(),function(){var e;null===(e=P.current)||void 0===e||e.disconnect(),P.current=null}}),[A]),(0,f.useEffect)((function(){var e=(0,p.throttle)(A,200);return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e),e.cancel()}}),[A]),(0,f.useEffect)((function(){A()}),[t,A]);var I=(0,f.useMemo)((function(){return o()({maxWidth:a,minWidth:r,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},D.style)}),[a,D.style]);return(0,x.jsx)(g.$R,{toolTipProps:o()(o()({},v),{},{destroyOnHidden:!1}),title:!(!S&&!h)&&(c||t),children:s?(0,x.jsx)("div",{ref:Z,style:I,"data-overflow":S,children:t}):(0,x.jsx)(y,o()(o()({},D),{},{className:"".concat(D.className||""," ").concat(j?"tag-filled":""),ref:Z,style:o()({paddingInline:D.closable?"8px 22px":8,borderRadius:k},I),closeIcon:!!D.closable&&(0,x.jsx)(m.Z,{style:{position:"absolute",right:8,top:"50%",transform:"translateY(-50%)"}}),children:t}))})};t.Z=f.memo(_)},72742:function(e,t,n){"use strict";var a,r=n(26068),o=n.n(r),i=n(53649),l=n.n(i),s=n(53231),u=n(18843),c=n(79635),d=(n(75271),n(67585)),m=n(52676),h=d.ZP.div(a||(a=l()(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 20px;\n"])));t.Z=function(e){var t=e.onOk,n=e.onCancel,a=e.cancelText,r=e.okText,i=e.okBtnProps,l=e.cancelBtnProps,d=e.loading,p=e.htmlType,f=void 0===p?"button":p,v=e.style,g=e.showOkBtn,x=void 0===g||g,b=e.description,y=e.extra,_=e.showCancelBtn,k=void 0===_||_,w=(e.form,(0,s.useIntl)());return(0,m.jsxs)(h,{children:[(0,m.jsx)("div",{children:b}),(0,m.jsxs)(u.Z,{size:20,style:o()({},v),children:[k&&(0,m.jsx)(c.ZP,o()(o()({onClick:n,style:{width:"88px"}},l),{},{children:a||w.formatMessage({id:"common.button.cancel"})})),y,x&&(0,m.jsx)(c.ZP,o()(o()({type:"primary",onClick:t,style:{width:"88px"},loading:d,htmlType:f},i),{},{children:r||w.formatMessage({id:"common.button.save"})}))]})]})}},3453:function(e,t,n){"use strict";n.d(t,{$R:function(){return x},QR:function(){return g}});var a,r=n(67825),o=n.n(r),i=n(26068),l=n.n(i),s=n(53649),u=n.n(s),c=n(2825),d=n(25408),m=n(75271),h=n(67585),p=n(52676),f=["styles"],v=h.ZP.div(a||(a=u()(["\n  max-height: ",";\n  overflow-y: auto;\n  width: 100%;\n"])),(function(e){var t=e.$maxHeight;return"number"==typeof t?"".concat(t,"px"):t})),g=function(e){var t=e.children,n=e.maxHeight,a=e.scrollbars,r=e.oppositeTheme,o=e.style,i=e.onScroll,s=m.useRef(null),u=(0,c.Z)({options:{scrollbars:a,oppositeTheme:r}}).initialize;return m.useEffect((function(){s.current&&u(s.current)}),[]),(0,p.jsx)(v,{ref:s,"data-overlayscrollbars-initialize":!0,className:"overlay-scroller-wrapper",$maxHeight:n||200,hidden:!1,onWheel:i,style:l()({paddingInlineStart:8,paddingInlineEnd:8},o),children:t})},x=function(e){var t=e.children,n=e.maxHeight,a=e.title,r=e.toolTipProps,i=e.scrollbars,s=e.oppositeTheme,u=r||{},c=u.styles,m=o()(u,f);return(0,p.jsx)(d.Z,l()(l()({styles:l()(l()({},c),{},{body:l()({paddingInline:0},null==c?void 0:c.body)}),title:a&&(0,p.jsx)(g,{scrollbars:l()(l()({},i),{},{theme:"os-theme-light"}),maxHeight:n,oppositeTheme:s,children:a})},m),{},{children:t}))};t.ZP=g},3108:function(e,t,n){"use strict";n.d(t,{f:function(){return g},Z:function(){return x}});var a=n(91780),r=n(83843),o=n(17114),i=n(38913),l=n(67618),s=n(37565),u=n(53231),c=n(18843),d=n(79635),m=n(97014),h=n(75271),p=n(88256),f=n(52676),v=function(e){var t=e.left,n=e.right,a=e.marginBottom,r=void 0===a?0:a,o=e.marginTop,i=void 0===o?30:o,l=e.style,s=(0,h.useMemo)((function(){var e={};return e.marginBottom="".concat(r,"px"),e.marginTop="".concat(i,"px"),l&&Object.assign(e,l),e}),[r,i,l]);return(0,f.jsxs)("div",{className:"page-tools",style:s,children:[(0,f.jsx)("div",{className:"left",children:t}),(0,f.jsx)("div",{className:"right",children:n})]})},g=function(e){var t=e.handleInputChange,n=e.handleSelectChange,g=e.handleSearch,x=e.handleDeleteByBatch,b=void 0===x?null:x,y=e.handleClickPrimary,_=void 0===y?null:y,k=e.rowSelection,w=e.actionItems,j=void 0===w?[]:w,D=e.selectOptions,Z=e.showSelect,C=e.buttonText,M=e.buttonIcon,S=e.actionType,T=void 0===S?"button":S,P=e.marginBottom,A=void 0===P?10:P,I=(e.marginTop,e.inputHolder),L=e.selectHolder,E=e.right,R=(e.left,e.width),Y=(0,u.useIntl)(),z=(0,h.useMemo)((function(){var e,t,n,l;return _||b?(0,f.jsxs)(c.Z,{size:20,children:[_?"dropdown"===T?(0,f.jsx)(a.Z,{menu:{items:j,onClick:_},children:(0,f.jsx)(d.ZP,{icon:(0,f.jsx)(r.Z,{}),type:"primary",iconPosition:"end",children:C})}):(0,f.jsx)(d.ZP,{icon:null!=M?M:(0,f.jsx)(o.Z,{}),type:"primary",onClick:_,children:C}):null,b&&(0,f.jsx)(d.ZP,{icon:(0,f.jsx)(i.Z,{}),danger:!0,onClick:b,disabled:!(null!=k&&null!==(e=k.selectedRowKeys)&&void 0!==e&&e.length),children:(0,f.jsxs)("span",{children:[null==Y||null===(t=Y.formatMessage)||void 0===t?void 0:t.call(Y,{id:"common.button.delete"}),(null==k||null===(n=k.selectedRowKeys)||void 0===n?void 0:n.length)>0&&(0,f.jsxs)("span",{children:["(",null==k||null===(l=k.selectedRowKeys)||void 0===l?void 0:l.length,")"]})]})})]}):null}),[j,T,null==k?void 0:k.selectedRowKeys,_,Y]);return(0,f.jsx)(v,{marginBottom:A,marginTop:0,left:(0,f.jsxs)(c.Z,{children:[(0,f.jsx)(m.Z,{prefix:(0,f.jsx)(l.Z,{style:{color:"var(--ant-color-text-placeholder)"}}),placeholder:I||Y.formatMessage({id:"common.filter.name"}),style:{width:(null==R?void 0:R.input)||230},allowClear:!0,onChange:t}),Z&&(0,f.jsx)(p.Z,{allowClear:!0,showSearch:!1,placeholder:L,style:{width:(null==R?void 0:R.select)||230},size:"large",onChange:n,options:D}),(0,f.jsx)(d.ZP,{type:"text",style:{color:"var(--ant-color-text-tertiary)"},onClick:g,icon:(0,f.jsx)(s.Z,{})})]}),right:E||z})},x=v},11401:function(e,t,n){"use strict";var a,r=n(26068),o=n.n(r),i=n(53649),l=n.n(i),s=n(21363),u=n(2825),c=n(950),d=n(75271),m=n(67585),h=n(52676),p=m.ZP.div(a||(a=l()(["\n  max-height: ",";\n  overflow-y: auto;\n  width: 100%;\n"])),(function(e){var t=e.$maxHeight;return"number"==typeof t?"".concat(t,"px"):t}));t.Z=function(e){var t=d.useRef(null),n=(0,s.Z)(),a=n.saveScrollHeight,r=n.restoreScrollHeight,i=(0,u.Z)(),l=i.initialize,m=i.destroyInstance;return d.useEffect((function(){e.open?a():r()}),[e.open]),d.useEffect((function(){var n=null;return e.open&&(n=setTimeout((function(){t.current&&l(t.current)}),100)),function(){n&&clearTimeout(n),m()}}),[e.open,l]),(0,h.jsx)(c.Z,o()(o()({},e),{},{destroyOnHidden:!0,styles:{content:{padding:0},header:{padding:"var(--ant-modal-content-padding)",paddingBottom:"0"},body:{padding:"0",paddingBlockEnd:e.footer?"0":"24px"},footer:e.footer?{padding:"12px 24px 24px",margin:"0"}:{}},children:(0,h.jsx)(p,{ref:t,"data-overlayscrollbars-initialize":!0,className:"overlay-scroller-wrapper",$maxHeight:e.maxContentHeight||500,hidden:!1,style:{paddingInline:24,paddingBlockEnd:0},children:e.children})}))}},91962:function(e,t){"use strict";t.Z={xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1600}},21363:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(75271);function r(){var e=a.useRef(0),t=a.useRef({}),n=a.useRef(null),r=a.useRef(null),o=a.useRef(null),i=function(){var e;n.current=null===(e=window.__GPUSTACK_BODY_SCROLLER__)||void 0===e||null===(e=e.elements())||void 0===e?void 0:e.scrollEventElement,r.current=window.__GPUSTACK_BODY_SCROLLER__},l=a.useCallback((function(){var a,o,l,s;n.current||i(),t.current=null===(a=r.current)||void 0===a?void 0:a.state();var u=null===(o=t.current)||void 0===o||null===(o=o.overflowAmount)||void 0===o?void 0:o.y;e.current=u,null===(l=r.current)||void 0===l||null===(s=l.options)||void 0===s||s.call(l,{overflow:{x:"hidden",y:"visible"}})}),[]),s=a.useCallback((function(){o.current&&clearTimeout(o.current),o.current=setTimeout((function(){var e,t;null===(e=r.current)||void 0===e||null===(t=e.options)||void 0===t||t.call(e,{overflow:{x:"hidden",y:"scroll"}})}),500)}),[]);return a.useEffect((function(){return i(),function(){n.current=null,r.current=null}}),[]),{saveScrollHeight:l,restoreScrollHeight:s,bodyScroller:n.current}}},4144:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var a=n(48305),r=n.n(a),o=n(91962),i=n(32699),l=n.n(i),s=n(75271);function u(){var e=(0,s.useState)({width:window.innerWidth,height:window.innerHeight}),t=r()(e,2),n=t[0],a=t[1],i=(0,s.useState)(!1),u=r()(i,2),c=u[0],d=u[1],m=(0,s.useState)(!1),h=r()(m,2),p=h[0],f=h[1],v=(0,s.useState)(!1),g=r()(v,2),x=g[0],b=g[1],y=(0,s.useState)(""),_=r()(y,2),k=_[0],w=_[1],j=(0,s.useCallback)((function(e){return e<o.Z.sm?(d(!0),f(!1),b(!1),void w("sm")):e<o.Z.md?(d(!1),f(!0),b(!1),void w("md")):e<o.Z.lg?(d(!1),f(!1),b(!0),void w("lg")):(d(!1),f(!1),b(!0),void w("xl"))}),[]),D=(0,s.useCallback)(l().throttle((function(){a({width:window.innerWidth,height:window.innerHeight})}),200),[]);return(0,s.useEffect)((function(){return window.addEventListener("resize",D),function(){window.removeEventListener("resize",D)}}),[D]),(0,s.useEffect)((function(){j(n.width)}),[n.width,j]),{size:n,isMobile:c,isTablet:p,isDesktop:x,currentPoint:k}}},90330:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return xt}});var a=n(26068),r=n.n(a),o=n(90228),i=n.n(o),l=n(87999),s=n.n(l),u=n(48305),c=n.n(u),d=n(25383),m=n(3246),h=n(75271),p=n(94213),f=n(52064),v=n(85882),g=n(3108),x=n(67996),b=n(48075),y=n(53231),_=n(27441),k=n(77634),w=n(92665),j=(0,h.createContext)({}),D=j,Z=n(52676),C=[x.Us.llm,x.Us.embedding,x.Us.reranker],M=function(){var e=(0,y.useIntl)(),t=(0,h.useContext)(j).active_models||[],n=[{title:e.formatMessage({id:"common.table.name"}),dataIndex:"name",key:"name",ellipsis:!0,render:function(e,t){return(0,Z.jsx)(v.Z,{ghost:!0,children:(0,Z.jsx)("span",{children:e})})}},{title:e.formatMessage({id:"dashboard.allocatevram"}),dataIndex:"resource_claim.memory",key:"vram",ellipsis:!0,render:function(e,t){var n,a;return(0,Z.jsxs)(v.Z,{ghost:!0,children:[(0,b.hy)((null===(n=t.resource_claim)||void 0===n?void 0:n.vram)||0)," /"," ",(0,b.hy)((null===(a=t.resource_claim)||void 0===a?void 0:a.ram)||0)]})}},{title:e.formatMessage({id:"models.form.replicas"}),dataIndex:"instance_count",key:"instance_count"},{title:e.formatMessage({id:"dashboard.tokens"}),dataIndex:"token_count",key:"token_count",ellipsis:!0,render:function(e,t){var n,a=e;e||(a=C.includes(null===(n=t.categories)||void 0===n?void 0:n[0])?0:"N/A");return(0,Z.jsx)(v.Z,{ghost:!0,children:(0,Z.jsx)("span",{children:a})})}}];return(0,Z.jsx)(_.Z,{gutter:[20,0],children:(0,Z.jsxs)(k.Z,{xs:24,sm:24,md:24,lg:24,xl:24,children:[(0,Z.jsx)(g.Z,{style:{margin:"26px 0px"},left:(0,Z.jsx)("span",{style:{fontWeight:"var(--font-weight-bold)"},children:e.formatMessage({id:"dashboard.activeModels"})}),right:!1}),(0,Z.jsx)("div",{children:(0,Z.jsx)(w.Z,{columns:n,dataSource:t,pagination:!1,rowKey:"id"})})]})})},S=(0,h.memo)(M),T=n(48721),P=n(18843),A=n(32699),I=n.n(A),L=[{key:"cluster_count",label:"dashboard.clusters",backgroundColor:"var(--color-white-1)"},{key:"worker_count",label:"dashboard.workers",backgroundColor:"var(--color-white-1)"},{key:"gpu_count",label:"dashboard.totalgpus",backgroundColor:"var(--color-white-1)"},{key:"model_count",label:"dashboard.models",backgroundColor:"var(--color-white-1)"},{key:"model_instance_count",label:"models.form.replicas",backgroundColor:"var(--color-white-1)"}],E="rgba(0,85,255,0.8)",R="rgb(102, 214, 224)",Y="rgba(85,167,255,0.8)",z="card-body___by6gK",q="row___aaW9s",N="content___L6aNm",U=function(e){var t=e.label,n=e.value;e.bgColor;return(0,Z.jsx)(T.Z,{variant:"borderless",style:{background:"var(--color-white-1)"},className:z,children:(0,Z.jsxs)("div",{className:N,children:[(0,Z.jsx)("div",{className:"label text-secondary",children:t}),(0,Z.jsx)("div",{className:"value font-600 font-size-16",children:n})]})})},B=function(){var e=(0,y.useIntl)(),t=(0,h.useContext)(j).resource_counts||{};return(0,Z.jsx)("div",{children:(0,Z.jsx)(_.Z,{gutter:[20,20],className:q,children:L.map((function(n,a){return(0,Z.jsx)(k.Z,{xs:{flex:"100%"},sm:{flex:"50%"},md:{flex:"50%"},lg:{flex:"20%"},xl:{flex:"20%"},children:U({label:e.formatMessage({id:n.label}),value:(r=I().get(t,n.key,0),"number"==typeof r?r:(0,Z.jsxs)(P.Z,{className:"value-box",size:20,children:[(0,Z.jsx)("span",{className:"value-healthy",children:r.healthy}),(0,Z.jsx)("span",{className:"value-warning",children:r.warning}),(0,Z.jsx)("span",{className:"value-error",children:r.error})]})),bgColor:n.backgroundColor})},n.key);var r}))})})},H=h.memo(B),O="cardWrapper___Q41EU",W=function(e){var t=e.children,n=e.style;return(0,Z.jsx)("div",{className:O,style:r()({},n),children:t})},G=n(61163),F=n(88256),K=n(92047),$=n(27220),V=n(71656),X=n.n(V),Q={cpu:{label:"CPU",type:"CPU",intl:!1,color:"rgba(250, 173, 20,.8)"},ram:{label:"dashboard.memory",type:"Memory",intl:!0,color:"rgba(114, 46, 209,.8)"},gpu:{label:"GPU",type:"GPU",intl:!1,color:"rgba(84, 204, 152,.8)"},vram:{label:"dashboard.vram",type:"VRAM",intl:!0,color:"rgba(255, 107, 179, 80%)"}},J=function(e){var t=e.data,n=(0,y.useIntl)(),a=["gpu","cpu","ram","vram"],r=(0,h.useMemo)((function(){var e=[],r=[];return{seriesData:I().map(a,(function(a){var o=I().get(Q,a,{}),i=o.intl?n.formatMessage({id:o.label}):o.label;e.push(i);var l=I().get(t,a,[]);return{name:i,color:o.color,data:I().map(l,(function(e){var t=X()(1e3*e.timestamp).format("HH:mm:ss");return r.push(t),{time:e,value:I().round(I().get(e,"value",0),1)}}))}})),legendData:e,xAxisData:I().uniq(r)}}),[t,n]);return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)($.Z,{height:390,seriesData:r.seriesData,legendData:r.legendData,xAxisData:r.xAxisData,tooltipValueFormatter:function(e){return e?"".concat(e,"%"):e},smooth:!0,width:"100%",yAxisName:"(%)"})})},ee=(0,h.memo)(J),te=190,ne=function(){var e=(0,y.useIntl)(),t=(0,h.useContext)(j),n=t.system_load,a=t.fetchData,r=(0,h.useState)(n||{}),o=c()(r,2),l=o[0],u=o[1],d=(0,h.useState)([]),m=c()(d,2),p=m[0],f=m[1],v=(0,h.useMemo)((function(){var e=(null==l?void 0:l.current)||{};return{gpu:{data:I().round(e.gpu||0,1)},vram:{data:I().round(e.vram||0,1)},cpu:{data:I().round(e.cpu||0,1)},ram:{data:I().round(e.ram||0,1)}}}),[null==l?void 0:l.current]);(0,h.useEffect)((function(){u(n||{})}),[n]);var x=function(){var e=s()(i()().mark((function e(t){var n;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a({cluster_id:t});case 3:n=e.sent,u(n.system_load||{}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),u({});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return(0,h.useEffect)((function(){var e=function(){var e=s()(i()().mark((function e(){var t,n;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,K.ax)({page:-1});case 3:t=e.sent,n=t.items.map((function(e){return{label:e.name,value:e.id}})),f(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),f([]);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,Z.jsx)("div",{children:(0,Z.jsxs)("div",{className:"system-load",children:[(0,Z.jsx)(g.Z,{style:{margin:"26px 0px"},left:(0,Z.jsx)("span",{className:"font-700",children:e.formatMessage({id:"dashboard.systemload"})}),right:(0,Z.jsx)(F.Z,{allowClear:!0,onChange:x,style:{width:360},options:p,placeholder:e.formatMessage({id:"clusters.filterBy.cluster"})})}),(0,Z.jsxs)(_.Z,{gutter:[20,20],children:[(0,Z.jsx)(k.Z,{xs:24,sm:24,md:24,lg:24,xl:16,children:(0,Z.jsx)(W,{style:{height:400},children:(0,Z.jsx)(ee,{data:null==l?void 0:l.history})})}),(0,Z.jsx)(k.Z,{xs:24,sm:24,md:24,lg:24,xl:8,children:(0,Z.jsx)(W,{style:{height:400},children:(0,Z.jsxs)(_.Z,{style:{height:400},children:[(0,Z.jsx)(k.Z,{span:12,style:{height:te},children:(0,Z.jsx)(G.Z,{height:te,value:v.gpu.data,title:e.formatMessage({id:"dashboard.gpuutilization"})})}),(0,Z.jsx)(k.Z,{span:12,style:{height:te},children:(0,Z.jsx)(G.Z,{title:e.formatMessage({id:"dashboard.vramutilization"}),height:te,value:v.vram.data})}),(0,Z.jsx)(k.Z,{span:12,style:{height:te},children:(0,Z.jsx)(G.Z,{title:e.formatMessage({id:"dashboard.cpuutilization"}),height:te,value:v.cpu.data})}),(0,Z.jsx)(k.Z,{span:12,style:{height:te},children:(0,Z.jsx)(G.Z,{title:e.formatMessage({id:"dashboard.memoryutilization"}),height:te,value:v.ram.data})})]})})})]})]})})},ae=n(91962),re=n(4144),oe=n(15558),ie=n.n(oe),le=n(53649),se=n.n(le),ue=n(67585),ce=n(72742),de=n(11401),me=n(335),he=n.n(me),pe=n(11227),fe=n(28667);var ve,ge,xe,be,ye,_e=n(67825),ke=n.n(_e),we=n(68652),je=n(72567),De=["options","showTags"],Ze=ue.ZP.div(ve||(ve=se()(["\n  display: flex;\n  align-items: center;\n  gap: 8px;\n"]))),Ce=ue.ZP.div(ge||(ge=se()(["\n  .ant-select-item {\n    padding-inline-start: 8px;\n    &:hover {\n      background-color: var(--ant-select-option-active-bg);\n    }\n  }\n  .ant-select-item-option-selected:not(.ant-select-item-option-disabled) {\n    background-color: unset;\n    font-weight: unset;\n    &:hover {\n      background-color: var(--ant-select-option-active-bg);\n    }\n  }\n"]))),Me=ue.ZP.div(xe||(xe=se()(["\n  margin-bottom: 10px;\n  padding: 5px 8px;\n  font-size: 12px;\n  border-bottom: 1px solid var(--ant-color-split);\n  .ant-checkbox-wrapper {\n    color: var(--ant-color-text-tertiary);\n  }\n"]))),Se=(0,ue.ZP)(we.Z)(be||(be=se()(["\n  border-radius: 12px;\n"]))),Te=(0,h.forwardRef)((function(e,t){var n=(0,y.useIntl)(),a=e.options,o=void 0===a?[]:a,i=e.showTags,l=ke()(e,De),s=h.useState({checked:!1,indeterminate:!1}),u=c()(s,2),d=u[0],m=u[1],p=h.useState(o||[]),f=c()(p,2),g=f[0],x=f[1],b=h.useRef(null),_=h.useRef(null);(0,h.useEffect)((function(){x(o||[])}),[o]);var k=function(e){var t,n=e.target.checked,a=(null==g?void 0:g.map((function(e){return e.value})))||[];m({checked:n,indeterminate:!1});var r=ie()(l.value||[]);r=n?Array.from(new Set([].concat(ie()(r),ie()(a)))):r.filter((function(e){return!a.includes(e)})),null===(t=l.onChange)||void 0===t||t.call(l,r,g||[])},w=function(e){if(l.value&&Array.isArray(l.value)&&0!==e.length){var t=new Set(l.value),n=(null==e?void 0:e.map((function(e){return e.value})))||[],a=n.every((function(e){return t.has(e)})),r=n.some((function(e){return t.has(e)}));m({checked:a,indeterminate:r&&!a})}else m({checked:!1,indeterminate:!1})};return(0,h.useEffect)((function(){var e,t,n=null===(e=b.current)||void 0===e||null===(t=e.querySelector)||void 0===t?void 0:t.call(e,"input");if(n){var a=function(e){"Backspace"===e.key&&""===n.value&&(e.stopPropagation(),e.preventDefault())};return n.addEventListener("keydown",a),function(){n.removeEventListener("keydown",a)}}}),[b.current]),(0,h.useImperativeHandle)(t,(function(){return{focus:function(){var e;null===(e=_.current)||void 0===e||e.focus()},blur:function(){var e;null===(e=_.current)||void 0===e||e.blur()}}})),(0,Z.jsx)("div",{ref:b,style:{width:"inherit"},children:(0,Z.jsx)(F.Z,r()(r()({},l),{},{ref:_,options:g,maxTagCount:l.maxTagCount||0,defaultActiveFirstOption:!1,popupRender:function(e){return(0,Z.jsxs)(Ce,{children:["multiple"===l.mode&&(0,Z.jsx)(Me,{children:(0,Z.jsx)(je.Z,{checked:d.checked,indeterminate:d.indeterminate,onChange:k,children:n.formatMessage({id:"common.checbox.all"})})}),e]})},optionRender:function(e,t){var n,a,r=e.value,o=e.label;return(0,Z.jsxs)(Ze,{children:[null!==(n=l.value)&&void 0!==n&&null!==(a=n.includes)&&void 0!==a&&a.call(n,r)?(0,Z.jsx)(je.Z,{checked:!0}):(0,Z.jsx)(je.Z,{}),(0,Z.jsx)(v.Z,{ghost:!0,children:o})]})},menuItemSelectedIcon:!1,onChange:function(e,t){var n,a=Array.isArray(e)?e:[e],r=(null==g?void 0:g.map((function(e){return e.value})))||[],o=a.length===(null==r?void 0:r.length);m({checked:o,indeterminate:!o&&a.length>0}),null===(n=l.onChange)||void 0===n||n.call(l,a,t)},tagRender:function(e){var t=e.label,a=e.isMaxTag?t.slice(0,-3).slice(1):t;return(0,Z.jsx)(Se,{bordered:!1,closable:e.closable,onClose:e.onClose,style:{height:24,backgroundColor:"var(--ant-color-fill-tertiary)",fontSize:"var(--ant-font-size)"},className:"flex-center",children:i?t:n.formatMessage({id:"common.select.count"},{count:a})})},onBlur:function(e){var t;null===(t=l.onBlur)||void 0===t||t.call(l,e)},onFocus:function(e){var t;null===(t=l.onFocus)||void 0===t||t.call(l,e)},onSearch:function(e){if(l.onSearch)l.onSearch(e);else{var t=null==o?void 0:o.filter((function(t){return t.label.toLowerCase().includes(e.toLowerCase())}));x(t||[]),w(t||[])}},filterOption:function(e,t){return!(!t||!t.label)&&t.label.toLowerCase().includes(e.toLowerCase())},onOpenChange:function(e){e||(w(o),x(o||[]))},children:e.children}))})})),Pe=n(86422),Ae=n(36618),Ie=n(25408),Le=n(79635);var Ee=60,Re=29,Ye=ue.ZP.div(ye||(ye=se()(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0px;\n  .selection {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n  }\n  .ant-select-selection-overflow-item > span {\n    height: 24px;\n  }\n"]))),ze=function(e){var t=e.query,n=e.userList,a=e.modelList,r=e.handleDateChange,o=e.handleUsersChange,i=e.handleModelsChange,l=e.handleExport,s=e.url,u=e.disabledDate,c=function(e){var t=e||{},n=t.range,a=void 0===n?60:n,r=t.disabledDate,o=(0,y.useIntl)(),i=function(e){return 12*e.year()+e.month()};return{disabledRangeDaysDate:function(e,t){var n=t.from,o=t.type;if(!r)return!1;if(n){var l=n.add(1-a,"days"),s=n.add(a-1,"days");switch(o){case"year":return e.year()<l.year()||e.year()>s.year();case"month":return i(e)<i(l)||i(e)>i(s);default:return e.isBefore(l)||e.isAfter(s)}}return!1},rangePresets:[{label:o.formatMessage({id:"dashboard.usage.datePicker.last7days"}),value:[X()().add(-6,"d"),X()()]},{label:o.formatMessage({id:"dashboard.usage.datePicker.last30days"}),value:[X()().add(-29,"d"),X()()]},{label:o.formatMessage({id:"dashboard.usage.datePicker.last60days"}),value:[X()().add(-59,"d"),X()()]}],range:a}}({range:Ee,disabledDate:u}),d=c.disabledRangeDaysDate,m=c.rangePresets,h=(0,y.useIntl)();return(0,Z.jsx)(Ye,{children:(0,Z.jsxs)("div",{className:"selection",children:[(0,Z.jsx)(Ae.Z.RangePicker,{maxDate:X()(),defaultValue:[X()().add(-Re,"d"),X()()],disabledDate:d,presets:m,allowClear:!1,style:{width:220},value:[X()(t.start_date),X()(t.end_date)],onChange:r}),(0,Z.jsx)(Te,{allowClear:!0,showSearch:!0,mode:"multiple",options:n,maxTagCount:0,placeholder:h.formatMessage({id:"dashboard.usage.selectuser"}),style:{maxWidth:200,minWidth:160},value:t.user_ids,onChange:o}),(0,Z.jsx)(Te,{allowClear:!0,showSearch:!0,mode:"multiple",options:a,maxTagCount:0,placeholder:h.formatMessage({id:"dashboard.usage.selectmodel"}),value:t.model_ids,style:{maxWidth:200,minWidth:160},onChange:i}),s===f._b&&(0,Z.jsx)(Ie.Z,{title:h.formatMessage({id:"common.button.export"}),children:(0,Z.jsx)(Le.ZP,{icon:(0,Z.jsx)(Pe.Z,{}),onClick:l})})]})})},qe=n(82243),Ne=n(88132),Ue=29,Be=function(e){return new Map(e.map((function(e){return[X()(1e3*e.timestamp).format("YYYY-MM-DD"),e.value]})))},He=function(e,t){return e.map((function(e,n){return{time:e,value:t.get(e)||0}}))};function Oe(e){var t=e||{},n=t.url,a=t.defaultData,o=(0,h.useState)(!1),l=c()(o,2),u=l[0],d=l[1],m=(0,h.useState)({start_date:X()().subtract(Ue,"days").format("YYYY-MM-DD"),end_date:X()().format("YYYY-MM-DD"),data:a}),p=c()(m,2),v=p[0],g=p[1],x=(0,h.useState)({start_date:X()().subtract(Ue,"days").format("YYYY-MM-DD"),end_date:X()().format("YYYY-MM-DD"),model_ids:[],user_ids:[]}),b=c()(x,2),y=b[0],_=b[1],k=(0,h.useState)([]),w=c()(k,2),j=w[0],D=w[1],Z=(0,h.useState)([]),C=c()(Z,2),M=C[0],S=C[1],T=(0,h.useState)(!1),P=c()(T,2),A=P[0],L=P[1],z=(0,h.useMemo)((function(){if(n===f.HY)return{requestTokenData:{requestData:[],tokenData:[],xAxisData:[]}};var e=v,t=e.start_date,a=e.end_date,o=e.data,i=t&&a?function(e,t){for(var n=X()(e),a=X()(t),r=[],o=n;o.isBefore(a)||o.isSame(a,"day");o=o.add(1,"day"))r.push(o.format("YYYY-MM-DD"));return r}(t,a):function(){for(var e=[],t=29;t>=0;t--){var n=X()().subtract(t,"day").format("YYYY-MM-DD");e.push(n)}return e}(),l=(null==o?void 0:o.completion_token_history)||[],s=(null==o?void 0:o.prompt_token_history)||[],u=(null==o?void 0:o.api_request_history)||[];if(!l.length)return{requestTokenData:{requestData:[],tokenData:[],xAxisData:[]}};var c={name:"API requests",areaStyle:{color:"rgba(13,171,219,0.15)"},color:R,data:He(i,Be(u))},d=He(i,Be(l)),m=He(i,Be(s));return{requestTokenData:{requestData:[c],tokenData:[{name:"Completion tokens",color:E,data:d.map((function(e,t){return r()(r()({},e),{},{itemStyle:{borderRadius:m[t].value?[0,0,0,0]:[2,2,0,0]}})}))},{name:"Prompt tokens",color:Y,data:m.map((function(e,t){return r()(r()({},e),{},{itemStyle:{borderRadius:[2,2,0,0]}})}))}],xAxisData:i}}}),[v,n]),q=function(){var e=s()(i()().mark((function e(){var t,n,a;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={page:-1},e.next=4,(0,qe.nb)(t);case 4:n=e.sent,a=I().map(n.items||[],(function(e){return{label:e.name,value:e.id}})),D(a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),D([]);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=s()(i()().mark((function e(){var t,n,a;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={page:-1},e.next=4,(0,Ne.YX)(t);case 4:n=e.sent,a=I().map(n.items||[],(function(e){return{label:e.username,value:e.id}})),S(a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),S([]);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=s()(i()().mark((function e(t){var a;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,L(!0),e.next=4,(0,f.Xv)(t,{url:n});case 4:a=e.sent,g({start_date:t.start_date,end_date:t.end_date,data:a}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),g({start_date:t.start_date,end_date:t.end_date,data:{}});case 11:return e.prev=11,L(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(t){return e.apply(this,arguments)}}();return{usageData:z,result:v,open:u,loading:A,userList:M,modelList:j,query:y,setQuery:_,init:function(){U(y),q(),N()},setResult:g,handleOnCancel:function(){d(!1)},handleExport:function(){d(!0)},handleDateChange:function(e,t){_((function(e){return r()(r()({},e),{},{start_date:t[0],end_date:t[1]})})),U(r()(r()({},y),{},{start_date:t[0],end_date:t[1]}))},handleUsersChange:function(e){_((function(t){return r()(r()({},t),{},{user_ids:e})})),U(r()(r()({},y),{},{user_ids:e}))},handleModelsChange:function(e){_((function(t){return r()(r()({},t),{},{model_ids:e})})),U(r()(r()({},y),{},{model_ids:e}))}}}var We,Ge,Fe,Ke,$e,Ve=function(e){var t,n=e||{},a=n.open,r=n.onCancel,o=(0,y.useIntl)(),i=Oe({url:f.HY,disabledDate:!1}),l=i.init,s=i.setResult,u=i.loading,c=i.result,d=i.userList,m=i.modelList,p=i.query,g=i.setQuery,x=(i.handleExport,i.handleDateChange),b=i.handleUsersChange,_=i.handleModelsChange,k=[{title:o.formatMessage({id:"resources.table.index"}),width:80,render:function(e,t,n){return n+1}},{title:o.formatMessage({id:"dashboard.usage.export.date"}),dataIndex:"date"},{title:o.formatMessage({id:"dashboard.usage.export.user"}),dataIndex:"user_id",render:function(e){var t;return(0,Z.jsx)(v.Z,{ghost:!0,children:null===(t=d.find((function(t){return t.value===e})))||void 0===t?void 0:t.label})}},{title:o.formatMessage({id:"dashboard.usage.export.model"}),dataIndex:"model_id",render:function(e){var t;return(0,Z.jsx)(v.Z,{ghost:!0,children:(null===(t=m.find((function(t){return t.value===e})))||void 0===t?void 0:t.label)||e})}},{title:"Completion Tokens",dataIndex:"completion_token_count",width:170,align:"right"},{title:"Prompt Tokens",dataIndex:"prompt_token_count",align:"right",width:150},{title:"API Requests",dataIndex:"request_count",align:"right",width:150}];return(0,h.useEffect)((function(){a?l():(g({start_date:X()().subtract(29,"days").format("YYYY-MM-DD"),end_date:X()().format("YYYY-MM-DD"),model_ids:[],user_ids:[]}),s({start_date:"",end_date:"",data:{items:[]}}))}),[a]),(0,Z.jsxs)(de.Z,{title:o.formatMessage({id:"dashboard.usage.export"}),open:a,centered:!1,onCancel:r,destroyOnHidden:!0,closeIcon:!0,maskClosable:!1,keyboard:!1,width:1e3,style:{top:"10%"},footer:(0,Z.jsx)(ce.Z,{onOk:function(){var e,t="usage-data_".concat(p.start_date||"","_").concat(p.end_date||"",".xlsx");!function(e){var t=e.jsonData,n=e.fields,a=e.fieldLabels,r=e.formatMap,o=e.fileName,i=void 0===o?"data.xlsx":o,l=t.map((function(e){var t,a={},o=he()(n);try{for(o.s();!(t=o.n()).done;){var i=t.value,l=e[i],s=null==r?void 0:r[i];a[i]=s?s(l,e):l}}catch(e){o.e(e)}finally{o.f()}return a})),s=fe.ZP.utils.json_to_sheet(l,{header:n});if(a){var u=n.map((function(e){return a[e]||e}));fe.ZP.utils.sheet_add_aoa(s,[u],{origin:"A1"})}var c=fe.ZP.utils.book_new();fe.ZP.utils.book_append_sheet(c,s,"Sheet1");var d=fe.ZP.write(c,{bookType:"xlsx",type:"array"}),m=new Blob([d],{type:"application/octet-stream"});(0,pe.saveAs)(m,i)}({jsonData:(null===(e=c.data)||void 0===e?void 0:e.items)||[],fileName:t,fields:k.map((function(e){return e.dataIndex})).filter(Boolean),fieldLabels:{user_id:"User",model_id:"Model",date:"Date",prompt_token_count:"Prompt Tokens",completion_token_count:"Completion Tokens",request_count:"API Requests"},formatMap:{user_id:function(e){var t;return(null===(t=d.find((function(t){return t.value===e})))||void 0===t?void 0:t.label)||e},model_id:function(e){var t;return(null===(t=m.find((function(t){return t.value===e})))||void 0===t?void 0:t.label)||e}}})},onCancel:r,okText:o.formatMessage({id:"common.button.export"})}),children:[(0,Z.jsx)(ze,{disabledDate:!1,url:f.HY,query:p,userList:d,modelList:m,handleDateChange:x,handleUsersChange:b,handleModelsChange:_}),(0,Z.jsx)(w.Z,{columns:k,tableLayout:"auto",style:{width:"100%",marginTop:"16px"},dataSource:(null===(t=c.data)||void 0===t?void 0:t.items)||[],loading:u,rowKey:"id",virtual:!0,scroll:{y:400},pagination:!1})]})},Xe=n(58281),Qe=ue.ZP.div(We||(We=se()(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n  gap: 16px;\n"]))),Je=(0,Xe.kc)((function(e){var t=e.css,n=e.token;return{wrapper:t(Ge||(Ge=se()(["\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: 100%;\n    background: ",";\n    border-radius: ","px;\n    padding: ","px;\n    justify-content: center;\n    align-items: center;\n    gap: ","px;\n    &.bordered {\n      border: 1px solid ",";\n    }\n    .title {\n      font-size: ","px;\n      font-weight: var(--font-weight-medium);\n    }\n    .content {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      font-size: ","px;\n      color: ",";\n      gap: 8px;\n      .icon {\n        display: inline-block;\n        width: 10px;\n        height: 10px;\n        gap: 10px;\n        &.roundRect {\n          border-radius: 2px;\n        }\n        &.circle {\n          border-radius: 50%;\n        }\n      }\n    }\n  "])),n.colorBgContainer,n.borderRadius,n.padding,n.padding,n.colorBorder,n.fontSize,n.fontSize,n.colorTextSecondary)}})),et=function(e){var t=Je(),n=t.styles,a=t.cx,r=e.title,o=e.content,i=e.style,l=e.bordered,s=e.iconType,u=e.color;return(0,Z.jsxs)("div",{className:a({bordered:l},n.wrapper),style:i,children:[(0,Z.jsx)("div",{className:"title",children:r}),(0,Z.jsxs)("div",{className:"content",children:[(0,Z.jsx)("span",{className:a([s],"icon"),style:{backgroundColor:u||"transparent"}}),(0,Z.jsx)("span",{children:o})]})]})},tt=function(e){var t=e.dataList,n=e.bordered;return(0,Z.jsx)(Qe,{style:{height:e.height||"100%"},children:t.map((function(e,t){return(0,Z.jsx)(et,{title:e.label,content:e.value,bordered:n,color:e.color,iconType:e.iconType},t)}))})},nt=n(82487),at=n(90064),rt=n(51461),ot=(n(6745).Z.graphic.LinearGradient,function(e){var t=e.seriesData,n=e.xAxisData,a=e.yAxisName,o=e.height,i=e.width,l=e.labelFormatter,s=e.tooltipValueFormatter,u=void 0===s?null:s,c=e.legendData,d=void 0===c?[]:c,m=e.smooth,p=e.title,f=e.chartData,v=(0,at.Z)(),g=v.grid,x=v.legend,y=v.lineItemConfig,_=v.barItemConfig,k=v.title,w=v.tooltip,j=v.xAxis,D=v.yAxis,C=f.line,M=f.bar,S={title:{text:""},grid:r()(r()({},g),{},{right:0,top:20,bottom:10}),tooltip:r()(r()({},w),{},{formatter:function(e){return u?w.formatter(e,u):w.formatter(e)}}),xAxis:r()(r()({},j),{},{axisLabel:r()(r()({},j.axisLabel),{},{formatter:l})}),yAxis:D,legend:r()(r()({},x),{},{data:d,itemGap:20,bottom:5,show:!1}),series:[]},T=(0,h.useMemo)((function(){var e=I().map(C,(function(e){(0,b.jP)({color:e.color,alpha1:.5,alpha2:.1});return r()(r()(r()({},e),y),{},{smooth:m,itemStyle:r()(r()({},y.itemStyle),{},{color:e.color}),yAxisIndex:1,lineStyle:r()(r()({},y.lineStyle),{},{color:e.color})})})),t=I().map(M,(function(e){return r()(r()(r()({},e),_),{},{stack:"total",yAxisIndex:0,itemStyle:r()(r()({},e.itemStyle),{},{color:e.color})})}));return r()(r()({},S),{},{animation:!1,title:r()(r()({},k),{},{text:p}),yAxis:[r()({},S.yAxis),r()(r()({},S.yAxis),{},{nameTextStyle:{fontSize:12,align:"right"}})],xAxis:r()(r()({},S.xAxis),{},{data:n}),series:[].concat(ie()(t),ie()(e))})}),[t,n,a,p,m,d,S]);return(0,Z.jsx)(Z.Fragment,{children:C.length||M.length?(0,Z.jsx)(nt.Z,{height:o,options:T,width:i||"100%"}):(0,Z.jsx)(rt.Z,{height:o,title:p})})}),it=((0,ue.ZP)(Le.ZP).attrs({className:"download-button"})(Fe||(Fe=se()(["\n  position: absolute;\n  top: 10px;\n  right: 10px;\n  z-index: 10;\n  display: none;\n"]))),ue.ZP.div(Ke||(Ke=se()(["\n  &:hover {\n    .download-button {\n      display: flex;\n    }\n  }\n"])))),lt=function(e){return X()(e).format("MM-DD")},st=[{label:"0",value:"Completion Tokens",key:"completionCount",iconType:"roundRect",color:E},{label:"0",value:"Prompt Tokens",key:"promptCount",iconType:"roundRect",color:Y},{label:"0",value:"API Requests",key:"requestCount",iconType:"circle",color:R}],ut=[{name:"Completion tokens",icon:"roundRect"},{name:"Prompt tokens",icon:"roundRect"},{name:"API requests",icon:"circle"}],ct=function(e){var t=e.requestData,n=e.tokenData,a=e.xAxisData,o=(0,h.useMemo)((function(){var e,a,o,i={requestCount:(null===(e=t[0])||void 0===e?void 0:e.data.reduce((function(e,t){return e+t.value}),0))||0,completionCount:(null===(a=n[0])||void 0===a?void 0:a.data.reduce((function(e,t){return e+t.value}),0))||0,promptCount:(null===(o=n[1])||void 0===o?void 0:o.data.reduce((function(e,t){return e+t.value}),0))||0};return st.map((function(e){return r()(r()({},e),{},{label:(0,b.HN)(i[e.key]||0)})}))}),[t,n]);return(0,Z.jsx)(it,{children:(0,Z.jsxs)(W,{style:{width:"100%",position:"relative"},children:[(0,Z.jsx)(tt,{dataList:o,height:80}),(0,Z.jsx)(ot,{chartData:{line:t,bar:n},seriesData:[],xAxisData:a,height:360,smooth:!1,legendData:ut,labelFormatter:lt})]})})},dt=function(e){var t=e.seriesData,n=e.xAxisData,a=e.height,o=e.width,i=e.labelFormatter,l=(e.legendData,e.maxItems),s=e.title,u=(0,at.Z)(),c=u.grid,d=u.legend,m=u.title,p=u.tooltip,f=u.xAxis,v=u.yAxis,g=(0,h.useMemo)((function(){var e={title:r()(r()({},m),{},{left:"start"}),grid:r()(r()({},c),{},{top:0,bottom:l?"".concat(1/l*(l-n.length)*100,"%"):0}),tooltip:r()({},p),xAxis:r()(r()({},f),{},{axisLabel:r()(r()({},f.axisLabel),{},{formatter:i})}),yAxis:r()(r()({},v),{},{axisLabel:r()(r()({},v.axisLabel),{},{overflow:"truncate",width:75,ellipsis:"..."})}),legend:r()(r()({},d),{},{data:[]}),series:[]},a=I().map(t,(function(e){return r()(r()({},e),{},{type:"bar",barWidth:20,stack:"Ad",barGap:"30%",label:{show:!1},itemStyle:{color:e.color}})}));return r()(r()({},e),{},{animation:!1,title:r()(r()({},e.title),{},{text:s}),yAxis:r()(r()({},e.yAxis),{},{inverse:!0,type:"category",splitLine:{show:!1},data:n,axisLine:{show:!1},axisTick:{show:!1}}),xAxis:r()(r()({},e.xAxis),{},{type:"value",splitLine:{show:!1},axisLabel:{show:!1},axisTick:{show:!1}}),series:a})}),[t,n,s,i,p,c,f,v,d]),x=(0,h.useMemo)((function(){var e;return null==t||null===(e=t.every)||void 0===e?void 0:e.call(t,(function(e){var t;return!(null!=e&&null!==(t=e.data)&&void 0!==t&&t.length)}))}),[t]);return(0,Z.jsx)(Z.Fragment,{children:x?(0,Z.jsx)(rt.Z,{height:a,title:s}):(0,Z.jsx)(nt.Z,{height:a,options:g,width:o||"100%"})})},mt=(0,h.memo)(dt),ht=function(e){var t=e.userData,n=e.topUserList;return(0,Z.jsx)(W,{children:(0,Z.jsx)(mt,{seriesData:t,xAxisData:n,height:440,maxItems:10})})},pt=ue.ZP.div($e||($e=se()(["\n  margin: 0;\n  font-weight: 700;\n"]))),ft=function(e){var t=e.maxWidth,n=(0,y.useIntl)(),a=(0,h.useContext)(j).model_usage,r=Oe({url:f._b,disabledDate:!0,defaultData:{api_request_history:[],completion_token_history:[],prompt_token_history:[]}}),o=r.usageData,i=r.query,l=r.userList,s=r.modelList,u=r.handleOnCancel,c=r.init,d=r.handleExport,m=r.handleDateChange,p=r.handleUsersChange,v=r.handleModelsChange,g=r.open,x=(0,h.useMemo)((function(){var e,t=(null==a||null===(e=a.top_users)||void 0===e?void 0:e.slice(0,10))||[],n={name:"Prompt tokens",color:Y,data:[]},r={name:"Completion tokens",color:E,data:[]},o=t.map((function(e){return n.data.push({name:e.username,value:e.prompt_token_count,itemStyle:{borderRadius:e.completion_token_count?[0,2,2,0]:[2,2,2,2]}}),r.data.push({name:e.username,value:e.completion_token_count,itemStyle:{borderRadius:e.prompt_token_count?[2,0,0,2]:[2,2,2,2]}}),e.username}));return{userData:[r,n],topUserList:ie()(new Set(o))}}),[null==a?void 0:a.top_users]);return(0,h.useEffect)((function(){c()}),[]),(0,Z.jsxs)("div",{children:[(0,Z.jsxs)(_.Z,{gutter:t<ae.Z.xl?[0,0]:[20,20],children:[(0,Z.jsxs)(k.Z,{xs:24,sm:24,md:24,lg:24,xl:16,children:[(0,Z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",margin:"20px 0 "},children:[(0,Z.jsx)(pt,{children:n.formatMessage({id:"dashboard.usage"})}),(0,Z.jsx)(ze,{url:f._b,query:i,userList:l,modelList:s,disabledDate:!0,handleDateChange:m,handleUsersChange:p,handleModelsChange:v,handleExport:d})]}),(0,Z.jsx)(ct,{requestData:null==o?void 0:o.requestTokenData.requestData,xAxisData:null==o?void 0:o.requestTokenData.xAxisData,tokenData:null==o?void 0:o.requestTokenData.tokenData})]}),(0,Z.jsxs)(k.Z,{xs:24,sm:24,md:24,lg:24,xl:8,style:{margin:0},children:[(0,Z.jsx)("div",{style:{margin:t<ae.Z.xl?"26px 0":"32px 0"},children:(0,Z.jsx)(pt,{children:n.formatMessage({id:"dashboard.topusers"})})}),(0,Z.jsx)(ht,{userData:x.userData,topUserList:x.topUserList})]})]}),(0,Z.jsx)(Ve,{open:g,onCancel:u})]})},vt=function(){var e=(0,re.Z)().size.width,t=(0,h.useState)(ae.Z.xl),n=c()(t,2),a=n[0],r=n[1];return(0,h.useEffect)((function(){r(e)}),[e]),(0,Z.jsx)(ft,{maxWidth:a})},gt=function(){return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(H,{}),(0,Z.jsx)(ne,{}),(0,Z.jsx)(vt,{}),(0,Z.jsx)(S,{})]})},xt=function(){var e=(0,h.useState)(!1),t=c()(e,2),n=t[0],a=t[1],o=(0,h.useState)({}),l=c()(o,2),u=l[0],v=l[1],g=(0,d.Z)(s()(i()().mark((function e(){var t;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a(!0),e.next=4,(0,f.mt)();case 4:t=e.sent,v(t),a(!1),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),a(!1),v({});case 13:case"end":return e.stop()}}),e,null,[[0,9]])}))));return(0,h.useEffect)((function(){g()}),[]),(0,Z.jsx)(D.Provider,{value:r()(r()({},u),{},{fetchData:f.mt}),children:(0,Z.jsx)(p.Z,{children:(0,Z.jsx)(m.Z,{spinning:n,children:(0,Z.jsx)(gt,{})})})})}},67996:function(e,t,n){"use strict";n.d(t,{$i:function(){return R},Ae:function(){return C},Cz:function(){return A},Db:function(){return E},G:function(){return u},OI:function(){return T},TM:function(){return x},Tx:function(){return m},UM:function(){return h},Uf:function(){return b},Us:function(){return S},V6:function(){return M},WA:function(){return _},XI:function(){return s},Xl:function(){return f},YB:function(){return v},YK:function(){return g},ZT:function(){return c},_3:function(){return P},bI:function(){return p},bn:function(){return I},dY:function(){return j},fx:function(){return L},hg:function(){return d},i7:function(){return y},mW:function(){return D},pw:function(){return w},s0:function(){return k},tn:function(){return Z}});n(48305);var a=n(82092),r=n.n(a),o=n(91315),i=n(13554),l=n(40562),s=[{title:l.sk.vllm,tips:"models.form.backend.vllm"},{title:l.sk.SGLang,tips:"models.form.backend.sglang"},{title:l.sk.ascendMindie,tips:"models.form.backend.mindie"},{title:l.sk.voxBox,tips:"models.form.backend.voxbox"}],u=[{title:{text:"models.localpath.gguf.tips.title",locale:!0},tips:"models.localpath.gguf.tips"},{title:{text:"models.localpath.shared.tips.title",locale:!0},tips:"models.localpath.chunks.tips"},{title:{text:"models.localpat.safe.tips.title",locale:!0},tips:"models.localpath.safe.tips"}],c=(r()(r()(r()(r()(r()({},l.sk.llamaBox,"llama-box"),l.sk.vllm,"vLLM"),l.sk.voxBox,"vox-box"),l.sk.ascendMindie,"Ascend MindIE"),l.sk.custom,"Custom"),r()(r()(r()(r()({},l.sk.llamaBox,{holder:"models.form.backend_parameters.llamabox.placeholder",tooltip:"models.form.backend_parameters.vllm.tips"}),l.sk.vllm,{holder:"models.form.backend_parameters.vllm.placeholder",tooltip:"models.form.backend_parameters.vllm.tips"}),l.sk.SGLang,{holder:"models.form.backend_parameters.sglang.placeholder",tooltip:""}),l.sk.voxBox,null)),d={textToSpeech:"text-to-speech",speechToText:"speech-to-text",textToText:"text-to-text",textToImage:"text-to-image",audio:"audio",image:"image"},m=r()(r()(r()(r()(r()({},d.textToSpeech,"text-to-speech"),d.speechToText,"auto-speech-recognition"),d.textToText,"TextToText"),d.textToImage,"text-to-image"),"audio",["text-to-speech","auto-speech-recognition"]),h=r()(r()(r()(r()(r()({},d.textToSpeech,"text-to-speech"),d.speechToText,"automatic-speech-recognition"),d.textToText,"text-2-text"),d.textToImage,"text-to-image"),"audio",["text-to-speech","automatic-speech-recognition"]),p={huggingface:"Hugging Face",huggingface_value:"huggingface",ollama_library:"Ollama Library",ollama_library_value:"ollama_library",modelScope:"ModelScope",modelscope_value:"model_scope",model_scope:"ModelScope",local_path:"Local Path",local_path_value:"local_path"},f=r()(r()(r()(r()({},p.huggingface_value,p.huggingface),p.ollama_library_value,p.ollama_library),p.modelscope_value,p.modelScope),p.local_path_value,p.local_path),v=[{label:"Hugging Face",value:p.huggingface_value,key:"huggingface"},{label:"ModelScope",value:p.modelscope_value,key:"model_scope"},{label:"models.form.localPath",locale:!0,value:p.local_path_value,key:"local_path"}],g={Initializing:"initializing",Starting:"starting",Pending:"pending",Running:"running",Scheduled:"scheduled",Error:"error",Downloading:"downloading",Unknown:"unknown",Analyzing:"analyzing",Unreachable:"unreachable"},x=[g.Downloading,g.Initializing,g.Starting],b=r()(r()(r()(r()(r()(r()(r()(r()(r()(r()({},g.Initializing,"Initializing"),g.Pending,"Pending"),g.Running,"Running"),g.Scheduled,"Scheduled"),g.Error,"Error"),g.Downloading,"Downloading"),g.Unknown,"Unknown"),g.Analyzing,"Analyzing"),g.Starting,"Starting"),g.Unreachable,"Unreachable"),y=r()(r()(r()(r()(r()(r()(r()(r()(r()(r()({},g.Running,o.iE.success),g.Pending,o.iE.transitioning),g.Initializing,o.iE.transitioning),g.Scheduled,o.iE.transitioning),g.Error,o.iE.error),g.Downloading,o.iE.transitioning),g.Unknown,o.iE.inactive),g.Analyzing,o.iE.transitioning),g.Starting,o.iE.transitioning),g.Unreachable,o.iE.error),_={Inactive:"Inactive",Degrade:"Degrade",Active:"Active"},k=r()(r()(r()({},_.Inactive,o.iE.inactive),_.Degrade,o.iE.error),_.Active,o.iE.success),w=r()(r()(r()({},_.Inactive,"models.mymodels.status.inactive"),_.Degrade,"models.mymodels.status.degrade"),_.Active,"models.mymodels.status.active"),j={Auto:"auto",Manual:"manual",SpecificGPUType:"specific_gpu_type"},D=[{label:"models.form.scheduletype.auto",locale:!0,value:j.Auto},{label:"models.form.scheduletype.manual",value:j.Manual,locale:!0}],Z=(i.Z,i.Z,i.Z,{trendingScore:"trendingScore",likes:"likes",downloads:"downloads",lastModified:"lastModified"}),C=r()(r()(r()(r()({},Z.trendingScore,"Default"),Z.likes,"StarsCount"),Z.downloads,"DownloadsCount"),Z.lastModified,"GmtModified"),M=[{label:"Spread",value:"spread"},{label:"Binpack",value:"binpack"}],S={image:"image",text_to_speech:"text_to_speech",speech_to_text:"speech_to_text",embedding:"embedding",reranker:"reranker",llm:"llm"},T=[{label:"LLM",value:S.llm},{label:"Embedding",value:S.embedding},{label:"Reranker",value:S.reranker},{label:"Image",value:S.image},{label:"Text-to-Speech",value:S.text_to_speech},{label:"Speech-to-Text",value:S.speech_to_text}],P=[{label:"common.options.auto",value:null,locale:!0}].concat(T),A=["model_scope_model_id","huggingface_repo_id","huggingface_filename","model_scope_file_path","name","description","env","source","cluster_id","quantization","size","restart_on_error","worker_selector","backend_parameters","local_path","backend_version","ollama_library_model_name","scheduleType","placement_strategy","backend","gpu_selector.gpu_ids","run_command","image_name","extended_kv_cache.enabled","extended_kv_cache.ram_size","speculative_config.enabled","speculative_config.draft_model"],I=["categories","replicas","description"],L={replicas:1,description:"",categories:null,env:{},scheduleType:j.Auto,placement_strategy:"spread",gpu_ids:null,gpu_selector:{},worker_selector:{},backend_parameters:[],backend_version:""},E=function(e){return e===l.sk.llamaBox?{backend:"llama-box",releases:"https://github.com/gpustack/llama-box/releases",link:"https://github.com/gpustack/llama-box?tab=readme-ov-file#usage",version:"v0.0.140"}:e===l.sk.vllm?{backend:"vLLM",releases:"https://github.com/vllm-project/vllm/releases",link:"https://docs.vllm.ai/en/stable/cli/serve.html",version:"v0.8.5"}:e===l.sk.ascendMindie?{backend:"Ascend MindIE",releases:"",link:"http://docs.gpustack.ai/latest/user-guide/inference-backends/#parameters-reference_2",version:"1.0.0"}:e===l.sk.SGLang?{backend:"SGLang",releases:"",link:"https://docs.sglang.ai/advanced_features/server_arguments.html",version:"v0.5.4"}:{backend:"vox-box",releases:"https://github.com/gpustack/vox-box/releases",link:"",version:"v0.0.13"}},R=function(e){return e.DEPLOYMENT="deployment",e.CATALOG="catalog",e}({})},88132:function(e,t,n){"use strict";n.d(t,{Nq:function(){return h},OL:function(){return g},YX:function(){return u},h8:function(){return f},r4:function(){return d}});var a=n(90228),r=n.n(a),o=n(87999),i=n.n(o),l=n(53231),s="/users";function u(e){return c.apply(this,arguments)}function c(){return(c=i()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(s),{methos:"GET",params:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return(m=i()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(s),{method:"POST",data:t.data}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return p.apply(this,arguments)}function p(){return(p=i()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(s,"/").concat(t.data.id),{method:"PUT",data:t.data}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return v.apply(this,arguments)}function v(){return(v=i()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(s,"/").concat(t),{method:"DELETE"}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return x.apply(this,arguments)}function x(){return(x=i()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(s,"/").concat(t.id,"/activation"),{method:"PATCH",data:t.data}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},99168:function(){}}]);
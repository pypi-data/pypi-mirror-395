"use strict";(self.webpackChunkjupyterlab_ai_commands=self.webpackChunkjupyterlab_ai_commands||[]).push([[262],{262:(e,t,o)=>{o.r(t),o.d(t,{default:()=>p});var n=o(70),i=o(256),a=o(766),c=o(816),l=o(603);var s=o(797),r=o(5);async function d(e,t,o){if(e){let o=t.findWidget(e);if(o||(o=t.openOrReveal(e)),!(o instanceof a.NotebookPanel))throw new Error(`Widget for ${e} is not a notebook panel`);return o??null}return o?.currentWidget||null}function u(e){const{commands:t,docManager:o,kernelSpecManager:n,notebookTracker:i}=e;(function(e,t,o){const n={id:"jupyterlab-ai-commands:create-notebook",label:"Create Notebook",caption:"Create a new Jupyter notebook with a kernel for the specified language",describedBy:{args:{language:{description:"The programming language for the notebook (e.g., python, r, julia, javascript, etc.). Will use system default if not specified."},name:{description:"Optional name for the notebook file (without .ipynb extension)"}}},execute:async e=>{const{language:n=null,name:i}=e,a=await async function(e,t){await e.ready;const o=e.specs;if(!o||!o.kernelspecs)return"python3";if(!t)return o.default||Object.keys(o.kernelspecs)[0]||"python3";const n=t.toLowerCase().trim();for(const[e,t]of Object.entries(o.kernelspecs))if(t&&(t.language?.toLowerCase()||"")===n)return e;return console.warn(`No kernel found for language '${t}', using default`),o.default||Object.keys(o.kernelspecs)[0]||"python3"}(o,n);if(!i)throw new Error("A name must be provided to create a notebook");const c=i.endsWith(".ipynb")?i:`${i}.ipynb`,l=await t.newUntitled({type:"notebook"});await t.services.contents.rename(l.path,c);const s=t.createNew(c,"default",{name:a});if(!(s instanceof r.DocumentWidget))throw new Error("Failed to create notebook widget");return await s.context.ready,await s.context.save(),t.openOrReveal(c),{success:!0,message:`Successfully created notebook ${c} with ${a} kernel${n?` for ${n}`:""}`,notebookPath:c,notebookName:c,kernel:a,language:n}}};e.addCommand(n.id,n)})(t,o,n),function(e,t,o){const n={id:"jupyterlab-ai-commands:add-cell",label:"Add Cell",caption:"Add a cell to the current notebook with optional content",describedBy:{args:{notebookPath:{description:"Path to the notebook file. If not provided, uses the currently active notebook"},content:{description:"Content to add to the cell"},cellType:{description:"Type of cell to add (code, markdown, raw)"},position:{description:"Position relative to current cell (above or below)"}}},execute:async e=>{const{notebookPath:n,content:i=null,cellType:a="code",position:c="below"}=e,l=await d(n,t,o);if(!l)return{success:!1,error:n?`Failed to open notebook at path: ${n}`:"No active notebook and no notebook path provided"};const r=l.content,u=r.model;if(!u)return{success:!1,error:"No notebook model available"};1===u.cells.length&&""===u.cells.get(0).sharedModel.getSource().trim()&&u.sharedModel.deleteCell(0);const f={cell_type:a,source:i||"",metadata:"code"===a?{trusted:!0}:{}};if(u.sharedModel.addCell(f),"markdown"===a&&i){const e=u.cells.length-1,t=r.widgets[e];t&&t instanceof s.MarkdownCell&&(await t.ready,t.rendered=!0)}return{success:!0,message:`${a} cell added successfully`,content:i||"",cellType:a,position:c}}};e.addCommand(n.id,n)}(t,o,i),function(e,t,o){const n={id:"jupyterlab-ai-commands:get-notebook-info",label:"Get Notebook Info",caption:"Get information about a notebook including number of cells and active cell index",describedBy:{args:{notebookPath:{description:"Path to the notebook file. If not provided, uses the currently active notebook"}}},execute:async e=>{const{notebookPath:n}=e,i=await d(n,t,o);if(!i)return{success:!1,error:n?`Failed to open notebook at path: ${n}`:"No active notebook and no notebook path provided"};const a=i.content,c=a.model;if(!c)return{success:!1,error:"No notebook model available"};const l=c.cells.length,s=a.activeCellIndex,r=a.activeCell,u=r?.model.type||"unknown";return{success:!0,notebookName:i.title.label,notebookPath:i.context.path,cellCount:l,activeCellIndex:s,activeCellType:u,isDirty:c.dirty}}};e.addCommand(n.id,n)}(t,o,i),function(e,t,o){const n={id:"jupyterlab-ai-commands:get-cell-info",label:"Get Cell Info",caption:"Get information about a specific cell including its type, source content, and outputs",describedBy:{args:{notebookPath:{description:"Path to the notebook file. If not provided, uses the currently active notebook"},cellIndex:{description:"Index of the cell to get information for (0-based). If not provided, uses the currently active cell"}}},execute:async e=>{const{notebookPath:n}=e;let{cellIndex:i}=e;const a=await d(n,t,o);if(!a)return{success:!1,error:n?`Failed to open notebook at path: ${n}`:"No active notebook and no notebook path provided"};const c=a.content,l=c.model;if(!l)return{success:!1,error:"No notebook model available"};if(null==i&&(i=c.activeCellIndex),i<0||i>=l.cells.length)return{success:!1,error:`Invalid cell index: ${i}. Notebook has ${l.cells.length} cells.`};const s=l.cells.get(i),r=s.type,u=s.sharedModel,f=u.getSource();let p=[];if("code"===r){const e=u.toJSON().outputs;p=Array.isArray(e)?e:[]}return{success:!0,cellId:s.id,cellIndex:i,cellType:r,source:f,outputs:p,executionCount:"code"===r?s.executionCount:null}}};e.addCommand(n.id,n)}(t,o,i),function(e,t,o){const n={id:"jupyterlab-ai-commands:set-cell-content",label:"Set Cell Content",caption:"Set the content of a specific cell",describedBy:{args:{notebookPath:{description:"Path to the notebook file. If not provided, uses the currently active notebook"},cellId:{description:"ID of the cell to modify. If provided, takes precedence over cellIndex"},cellIndex:{description:"Index of the cell to modify (0-based). Used if cellId is not provided. If neither is provided, targets the active cell"},content:{description:"New content for the cell"},showDiff:{description:"Whether to show a diff view of the changes (default: true)"},diffMode:{description:'Display mode for the diff view: "unified" or "split" (default: "unified")'}}},execute:async n=>{const{notebookPath:i,cellId:a,cellIndex:c,content:l,showDiff:s=!0,diffMode:r="unified"}=n,u=await d(i,t,o);if(!u)return{success:!1,error:i?`Failed to open notebook at path: ${i}`:"No active notebook and no notebook path provided"};const f=u.content,p=u.context.path,h=f.model;if(!h)return{success:!1,error:"No notebook model available"};let m;if(null!=a){m=-1;for(let e=0;e<h.cells.length;e++)if(h.cells.get(e).id===a){m=e;break}if(-1===m)return{success:!1,error:`Cell with ID '${a}' not found in notebook`}}else if(null!=c){if(c<0||c>=h.cells.length)return{success:!1,error:`Invalid cell index: ${c}. Notebook has ${h.cells.length} cells.`};m=c}else if(m=f.activeCellIndex,-1===m||m>=h.cells.length)return{success:!1,error:"No active cell or invalid active cell index"};const b=h.cells.get(m);if(!b)return{success:!1,error:`Cell at index ${m} not found`};const y=b.sharedModel,g=y.getSource(),k=b.type,v=b.id;y.setSource(l);const w=s??!0;if(w&&g!==l){const t="split"===r?"jupyterlab-diff:split-cell-diff":"jupyterlab-diff:unified-cell-diff";e.execute(t,{originalSource:g,newSource:l,cellId:v,showActionButtons:!0,openDiff:!0,notebookPath:p})}return{success:!0,message:null!=a?`Cell with ID '${a}' content replaced successfully`:null!=c?`Cell ${m} content replaced successfully`:"Active cell content replaced successfully",notebookPath:p,cellId:v,cellIndex:m,previousContent:g,previousCellType:k,newContent:l,wasActiveCell:void 0===a&&void 0===c,diffShown:w&&g!==l}}};e.addCommand(n.id,n)}(t,o,i),function(e,t,o){const n={id:"jupyterlab-ai-commands:run-cell",label:"Run Cell",caption:"Run a specific cell in the notebook by index",describedBy:{args:{notebookPath:{description:"Path to the notebook file. If not provided, uses the currently active notebook"},cellIndex:{description:"Index of the cell to run (0-based)"},recordTiming:{description:"Whether to record execution timing"}}},execute:async e=>{const{notebookPath:n,cellIndex:i,recordTiming:a=!0}=e,c=await d(n,t,o);if(!c)return{success:!1,error:n?`Failed to open notebook at path: ${n}`:"No active notebook and no notebook path provided"};const l=c.content,r=l.model;if(!r)return{success:!1,error:"No notebook model available"};if(i<0||i>=r.cells.length)return{success:!1,error:`Invalid cell index: ${i}. Notebook has ${r.cells.length} cells.`};const u=l.widgets[i];if(!u)return{success:!1,error:`Cell widget at index ${i} not found`};try{if(u instanceof s.CodeCell){const e=c.sessionContext;await s.CodeCell.execute(u,e,{recordTiming:a,deletedCells:r.deletedCells});const t=u.model;return{success:!0,message:`Cell ${i} executed successfully`,cellIndex:i,executionCount:t.executionCount,hasOutput:t.outputs.length>0}}return{success:!0,message:`Cell ${i} is not a code cell, no execution needed`,cellIndex:i,cellType:u.model.type}}catch(e){return{success:!1,error:`Failed to execute cell: ${e.message}`,cellIndex:i}}}};e.addCommand(n.id,n)}(t,o,i),function(e,t,o){const n={id:"jupyterlab-ai-commands:delete-cell",label:"Delete Cell",caption:"Delete a specific cell from the notebook by index",describedBy:{args:{notebookPath:{description:"Path to the notebook file. If not provided, uses the currently active notebook"},cellIndex:{description:"Index of the cell to delete (0-based)"}}},execute:async e=>{const{notebookPath:n,cellIndex:i}=e,a=await d(n,t,o);if(!a)return{success:!1,error:n?`Failed to open notebook at path: ${n}`:"No active notebook and no notebook path provided"};const c=a.content.model;return c?i<0||i>=c.cells.length?{success:!1,error:`Invalid cell index: ${i}. Notebook has ${c.cells.length} cells.`}:c.cells.get(i)?(c.sharedModel.deleteCell(i),{success:!0,message:`Cell ${i} deleted successfully`,cellIndex:i,remainingCells:c.cells.length}):{success:!1,error:`Cell at index ${i} not found`}:{success:!1,error:"No notebook model available"}}};e.addCommand(n.id,n)}(t,o,i),function(e,t,o){const n={id:"jupyterlab-ai-commands:save-notebook",label:"Save Notebook",caption:"Save a specific notebook to disk",describedBy:{args:{notebookPath:{description:"Path to the notebook file. If not provided, uses the currently active notebook"}}},execute:async e=>{const{notebookPath:n}=e,i=await d(n,t,o);return i?(await i.context.save(),{success:!0,message:"Notebook saved successfully",notebookName:i.title.label,notebookPath:i.context.path}):{success:!1,error:n?`Failed to open notebook at path: ${n}`:"No active notebook and no notebook path provided"}}};e.addCommand(n.id,n)}(t,o,i)}const f={id:"jupyterlab-ai-commands:plugin",description:"A set of commands for AI in JupyterLab",autoStart:!0,requires:[n.IDocumentManager],optional:[i.IEditorTracker,a.INotebookTracker,c.ISettingRegistry],activate:(e,t,o,n,i)=>{console.log("JupyterLab extension jupyterlab-ai-commands is activated!");const a=e.commands;!function(e){const{commands:t,docManager:o,editorTracker:n}=e;!function(e,t){const o={id:"jupyterlab-ai-commands:create-file",label:"Create File",caption:"Create a new file of specified type",describedBy:{args:{fileName:{description:"Name of the file to create"},fileType:{description:"Type of file to create. Common examples: text, python, markdown, json, javascript, typescript, yaml, julia, r, csv"},content:{description:"Initial content for the file (optional)"},cwd:{description:"Directory where to create the file (optional)"}}},execute:async e=>{const{fileName:o,content:n="",cwd:i,fileType:a="text"}=e,c=t.registry.getFileType(a),s=c?.extensions[0]||".txt",r=l.PathExt.extname(o)?o:`${o}${s}`,d=i?`${i}/${r}`:r,u=await t.services.contents.newUntitled({path:i||"",type:"file",ext:s});let f=u.path;u.name!==r&&(f=(await t.services.contents.rename(u.path,d)).path),n&&await t.services.contents.save(f,{type:"file",format:"text",content:n});let p=!1;return t.findWidget(f)||(t.openOrReveal(f),p=!0),{success:!0,message:`${a} file '${r}' created and opened successfully`,fileName:r,filePath:f,fileType:a,hasContent:!!n,opened:p}}};e.addCommand(o.id,o)}(t,o),function(e,t){const o={id:"jupyterlab-ai-commands:open-file",label:"Open File",caption:"Open a file in the editor",describedBy:{args:{filePath:{description:"Path to the file to open"}}},execute:async e=>{const{filePath:o}=e,n=t.openOrReveal(o);if(!n)throw new Error(`Could not open file: ${o}`);return{success:!0,message:`File '${o}' opened successfully`,filePath:o,widgetId:n.id}}};e.addCommand(o.id,o)}(t,o),function(e,t){const o={id:"jupyterlab-ai-commands:delete-file",label:"Delete File",caption:"Delete a file from the file system",describedBy:{args:{filePath:{description:"Path to the file to delete"}}},execute:async e=>{const{filePath:o}=e;return await t.services.contents.delete(o),{success:!0,message:`File '${o}' deleted successfully`,filePath:o}}};e.addCommand(o.id,o)}(t,o),function(e,t){const o={id:"jupyterlab-ai-commands:rename-file",label:"Rename File",caption:"Rename a file or move it to a different location",describedBy:{args:{oldPath:{description:"Current path of the file"},newPath:{description:"New path/name for the file"}}},execute:async e=>{const{oldPath:o,newPath:n}=e;return await t.services.contents.rename(o,n),{success:!0,message:`File renamed from '${o}' to '${n}' successfully`,oldPath:o,newPath:n}}};e.addCommand(o.id,o)}(t,o),function(e,t){const o={id:"jupyterlab-ai-commands:copy-file",label:"Copy File",caption:"Copy a file to a new location",describedBy:{args:{sourcePath:{description:"Path of the file to copy"},destinationPath:{description:"Destination path for the copied file"}}},execute:async e=>{const{sourcePath:o,destinationPath:n}=e;return await t.services.contents.copy(o,n),{success:!0,message:`File copied from '${o}' to '${n}' successfully`,sourcePath:o,destinationPath:n}}};e.addCommand(o.id,o)}(t,o),function(e){const t={id:"jupyterlab-ai-commands:navigate-to-directory",label:"Navigate to Directory",caption:"Navigate to a specific directory in the file browser",describedBy:{args:{path:{description:"Path to the directory to navigate to"}}},execute:async t=>{const{path:o}=t;return await e.execute("filebrowser:go-to-path",{path:o}),{success:!0,message:`Navigated to directory '${o}' successfully`,path:o}}};e.addCommand(t.id,t)}(t),function(e,t){const o={id:"jupyterlab-ai-commands:list-directory",label:"List Directory",caption:"List files and directories in a specific directory",describedBy:{args:{path:{description:"Path to the directory to list. If not provided, lists the root directory"},includeHidden:{description:"Whether to include hidden files (default: false)"}}},execute:async e=>{const{path:o="",includeHidden:n=!1}=e,i=await t.services.contents.get(o,{content:!0});if("directory"!==i.type)throw new Error(`Path '${o}' is not a directory`);const a=i.content||[],c=(n?a:a.filter(e=>!e.name.startsWith("."))).map(e=>({name:e.name,path:e.path,type:e.type,size:e.size||0,created:e.created,lastModified:e.last_modified,mimetype:e.mimetype||null,format:e.format||null})),l=c.filter(e=>"directory"===e.type),s=c.filter(e=>"directory"!==e.type);return{success:!0,message:`Listed ${c.length} items in directory '${o||"/"}'`,path:o||"/",totalItems:c.length,directories:l.length,files:s.length,items:c,includeHidden:n}}};e.addCommand(o.id,o)}(t,o),function(e,t,o){const n={id:"jupyterlab-ai-commands:get-file-info",label:"Get File Info",caption:"Get information about a file including its content",describedBy:{args:{filePath:{description:"Path to the file to read. If not provided, uses the currently active file in the editor."}}},execute:async e=>{const{filePath:n}=e;let i=null;if(n){if(i=t.findWidget(n)??t.openOrReveal(n)??null,!i)throw new Error(`Failed to open file at path: ${n}`)}else if(i=o?.currentWidget??null,!i)throw new Error("No active file in the editor and no file path provided");if(!i.context)throw new Error("Widget is not a document");await i.context.ready;const a=i.context.model;if(!a)throw new Error("File model not available");const c=a.sharedModel.getSource(),s=i.context.path;return{success:!0,filePath:s,fileName:i.title.label,fileExtension:l.PathExt.extname(s)||"unknown",content:c,isDirty:a.dirty,readOnly:a.readOnly,widgetType:i.constructor.name}}};e.addCommand(n.id,n)}(t,o,n),function(e,t){const o={id:"jupyterlab-ai-commands:set-file-content",label:"Set File Content",caption:"Set or update the content of an existing file",describedBy:{args:{filePath:{description:"Path to the file to update"},content:{description:"The new content to set for the file"},save:{description:"Whether to save the file after updating (default: true)"},showDiff:{description:"Whether to show a diff view of the changes (default: true)"}}},execute:async o=>{const{filePath:n,content:i,save:a=!0,showDiff:c=!0}=o;let l=t.findWidget(n);if(l||(l=t.openOrReveal(n)),!l)throw new Error(`Failed to open file at path: ${n}`);await l.context.ready;const s=l.context.model;if(!s)throw new Error("File model not available");if(s.readOnly)throw new Error("File is read-only and cannot be modified");const r=s.sharedModel,d=r.getSource();r.setSource(i);const u=c??!0;return u&&d!==i&&e.execute("jupyterlab-diff:unified-file-diff",{originalSource:d,newSource:i,filePath:n,showActionButtons:!0}),a&&await l.context.save(),{success:!0,filePath:n,fileName:l.title.label,contentLength:i.length,saved:a,isDirty:s.dirty,diffShown:u&&d!==i}}};e.addCommand(o.id,o)}(t,o)}({commands:a,docManager:t,editorTracker:o}),u({commands:a,docManager:t,kernelSpecManager:e.serviceManager.kernelspecs,notebookTracker:n}),i&&i.load(f.id).then(e=>{console.log("jupyterlab-ai-commands settings loaded:",e.composite)}).catch(e=>{console.error("Failed to load settings for jupyterlab-ai-commands.",e)})}},p=f}}]);
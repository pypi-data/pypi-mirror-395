
<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>sqlobject.tests.dbtest module &#8212; SQLObject 3.13.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bizstyle.css?v=5283bb3d" />
    
    <script src="../_static/documentation_options.js?v=ced7c45e"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">SQLObject 3.13.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">sqlobject.tests.dbtest module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-sqlobject.tests.dbtest">
<span id="sqlobject-tests-dbtest-module"></span><h1>sqlobject.tests.dbtest module<a class="headerlink" href="#module-sqlobject.tests.dbtest" title="Link to this heading">¶</a></h1>
<p>The framework for making database tests.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sqlobject.tests.dbtest.Dummy">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">sqlobject.tests.dbtest.</span></span><span class="sig-name descname"><span class="pre">Dummy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sqlobject/tests/dbtest.html#Dummy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sqlobject.tests.dbtest.Dummy" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Used for creating fake objects; a really poor ‘mock object’.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sqlobject.tests.dbtest.deprecated_module">
<span class="sig-prename descclassname"><span class="pre">sqlobject.tests.dbtest.</span></span><span class="sig-name descname"><span class="pre">deprecated_module</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sqlobject/tests/dbtest.html#deprecated_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sqlobject.tests.dbtest.deprecated_module" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sqlobject.tests.dbtest.getConnection">
<span class="sig-prename descclassname"><span class="pre">sqlobject.tests.dbtest.</span></span><span class="sig-name descname"><span class="pre">getConnection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sqlobject/tests/dbtest.html#getConnection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sqlobject.tests.dbtest.getConnection" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sqlobject.tests.dbtest.getConnectionURI">
<span class="sig-prename descclassname"><span class="pre">sqlobject.tests.dbtest.</span></span><span class="sig-name descname"><span class="pre">getConnectionURI</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sqlobject/tests/dbtest.html#getConnectionURI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sqlobject.tests.dbtest.getConnectionURI" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sqlobject.tests.dbtest.inserts">
<span class="sig-prename descclassname"><span class="pre">sqlobject.tests.dbtest.</span></span><span class="sig-name descname"><span class="pre">inserts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sqlobject/tests/dbtest.html#inserts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sqlobject.tests.dbtest.inserts" title="Link to this definition">¶</a></dt>
<dd><p>Creates a bunch of rows.</p>
<p>You can use it like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inserts</span><span class="p">(</span><span class="n">Person</span><span class="p">,</span> <span class="p">[{</span><span class="s1">&#39;fname&#39;</span><span class="p">:</span> <span class="s1">&#39;blah&#39;</span><span class="p">,</span> <span class="s1">&#39;lname&#39;</span><span class="p">:</span> <span class="s1">&#39;doe&#39;</span><span class="p">},</span> <span class="o">...</span><span class="p">])</span>
</pre></div>
</div>
<p>Or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inserts</span><span class="p">(</span><span class="n">Person</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;blah&#39;</span><span class="p">,</span> <span class="s1">&#39;doe&#39;</span><span class="p">)],</span> <span class="n">schema</span><span class="o">=</span>
        <span class="p">[</span><span class="s1">&#39;fname&#39;</span><span class="p">,</span> <span class="s1">&#39;lname&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>If you give a single string for the <cite>schema</cite> then it’ll split
that string to get the list of column names.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sqlobject.tests.dbtest.raises">
<span class="sig-prename descclassname"><span class="pre">sqlobject.tests.dbtest.</span></span><span class="sig-name descname"><span class="pre">raises</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected_exception</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sqlobject.tests.test_indexes.html#sqlobject.tests.test_indexes.AddressIndexGet2.type" title="sqlobject.tests.test_indexes.AddressIndexGet2.type"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="pre">E</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sqlobject.tests.test_indexes.html#sqlobject.tests.test_indexes.AddressIndexGet2.type" title="sqlobject.tests.test_indexes.AddressIndexGet2.type"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="pre">E</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Pattern</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">E</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RaisesExc</span><span class="p"><span class="pre">[</span></span><span class="pre">E</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/_pytest/raises.html#raises"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sqlobject.tests.dbtest.raises" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">sqlobject.tests.dbtest.</span></span><span class="sig-name descname"><span class="pre">raises</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Pattern</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">BaseException</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RaisesExc</span><span class="p"><span class="pre">[</span></span><span class="pre">BaseException</span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">sqlobject.tests.dbtest.</span></span><span class="sig-name descname"><span class="pre">raises</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">BaseException</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RaisesExc</span><span class="p"><span class="pre">[</span></span><span class="pre">BaseException</span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">sqlobject.tests.dbtest.</span></span><span class="sig-name descname"><span class="pre">raises</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected_exception</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sqlobject.tests.test_indexes.html#sqlobject.tests.test_indexes.AddressIndexGet2.type" title="sqlobject.tests.test_indexes.AddressIndexGet2.type"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="pre">E</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sqlobject.tests.test_indexes.html#sqlobject.tests.test_indexes.AddressIndexGet2.type" title="sqlobject.tests.test_indexes.AddressIndexGet2.type"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="pre">E</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ExceptionInfo</span><span class="p"><span class="pre">[</span></span><span class="pre">E</span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Assert that a code block/function call raises an exception type, or one of its subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expected_exception</strong> – <p>The expected exception type, or a tuple if one of multiple possible
exception types are expected. Note that subclasses of the passed exceptions
will also match.</p>
<p>This is not a required parameter, you may opt to only use <code class="docutils literal notranslate"><span class="pre">match</span></code> and/or
<code class="docutils literal notranslate"><span class="pre">check</span></code> for verifying the raised exception.</p>
</p></li>
<li><p><strong>match</strong> (<em>str</em><em> | </em><em>re.Pattern</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – <p>If specified, a string containing a regular expression,
or a regular expression object, that is tested against the string
representation of the exception and its <span class="target" id="index-0"></span><a class="pep reference external" href="https://peps.python.org/pep-0678/"><strong>PEP 678</strong></a> <cite>__notes__</cite>
using <code class="xref py py-func docutils literal notranslate"><span class="pre">re.search()</span></code>.</p>
<p>To match a literal string that may contain <span class="xref std std-ref">special characters</span>, the pattern can first be escaped with <code class="xref py py-func docutils literal notranslate"><span class="pre">re.escape()</span></code>.</p>
<p>(This is only used when <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> is used as a context manager,
and passed through to the function otherwise.
When using <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> as a function, you can use:
<code class="docutils literal notranslate"><span class="pre">pytest.raises(Exc,</span> <span class="pre">func,</span> <span class="pre">match=&quot;passed</span> <span class="pre">on&quot;).match(&quot;my</span> <span class="pre">pattern&quot;)</span></code>.)</p>
</p></li>
<li><p><strong>check</strong> (<em>Callable</em><em>[</em><em>[</em><em>BaseException</em><em>]</em><em>, </em><em>bool</em><em>]</em>) – <div class="versionadded">
<p><span class="versionmodified added">Added in version 8.4.</span></p>
</div>
<p>If specified, a callable that will be called with the exception as a parameter
after checking the type and the match regex if specified.
If it returns <code class="docutils literal notranslate"><span class="pre">True</span></code> it will be considered a match, if not it will
be considered a failed match.</p>
</p></li>
</ul>
</dd>
</dl>
<p>Use <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> as a context manager, which will capture the exception of the given
type, or any of its subclasses:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ZeroDivisionError</span><span class="p">):</span>
<span class="gp">... </span>   <span class="mi">1</span><span class="o">/</span><span class="mi">0</span>
</pre></div>
</div>
<p>If the code block does not raise the expected exception (<code class="xref py py-class docutils literal notranslate"><span class="pre">ZeroDivisionError</span></code> in the example
above), or no exception at all, the check will fail instead.</p>
<p>You can also use the keyword argument <code class="docutils literal notranslate"><span class="pre">match</span></code> to assert that the
exception matches a text or regex:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s1">&#39;must be 0 or None&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;value must be 0 or None&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;must be \d+$&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;value must be 42&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">match</span></code> argument searches the formatted exception string, which includes any
<a class="reference external" href="https://peps.python.org/pep-0678/">PEP-678</a> <code class="docutils literal notranslate"><span class="pre">__notes__</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;had a note added&quot;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">e</span> <span class="o">=</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;value must be 42&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">e</span><span class="o">.</span><span class="n">add_note</span><span class="p">(</span><span class="s2">&quot;had a note added&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">raise</span> <span class="n">e</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">check</span></code> argument, if provided, must return True when passed the raised exception
for the match to be successful, otherwise an <code class="xref py py-exc docutils literal notranslate"><span class="pre">AssertionError</span></code> is raised.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">errno</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errno</span><span class="o">.</span><span class="n">EACCES</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">EACCES</span><span class="p">,</span> <span class="s2">&quot;no permission to view&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The context manager produces an <code class="xref py py-class docutils literal notranslate"><span class="pre">ExceptionInfo</span></code> object which can be used to inspect the
details of the captured exception:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;value must be 42&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">exc_info</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="ne">ValueError</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">exc_info</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;value must be 42&quot;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Given that <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> matches subclasses, be wary of using it to match <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code> like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Careful, this will catch ANY exception raised.</span>
<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="n">some_function</span><span class="p">()</span>
</pre></div>
</div>
<p>Because <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code> is the base class of almost all exceptions, it is easy for this to hide
real bugs, where the user wrote this expecting a specific exception, but some other exception is being
raised due to a bug introduced during a refactoring.</p>
<p>Avoid using <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> to catch <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code> unless certain that you really want to catch
<strong>any</strong> exception raised.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> as a context manager, it’s worthwhile to
note that normal context manager rules apply and that the exception
raised <em>must</em> be the final line in the scope of the context manager.
Lines of code after that, within the scope of the context manager will
not be executed. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;value must be &lt;= 10&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">exc_info</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="ne">ValueError</span>  <span class="c1"># This will not execute.</span>
</pre></div>
</div>
<p>Instead, the following approach must be taken (note the difference in
scope):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;value must be &lt;= 10&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">exc_info</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="ne">ValueError</span>
</pre></div>
</div>
</div>
<p><strong>Expecting exception groups</strong></p>
<p>When expecting exceptions wrapped in <code class="xref py py-exc docutils literal notranslate"><span class="pre">BaseExceptionGroup</span></code> or
<code class="xref py py-exc docutils literal notranslate"><span class="pre">ExceptionGroup</span></code>, you should instead use <code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.RaisesGroup</span></code>.</p>
<p><strong>Using with</strong> <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code></p>
<p>When using <span class="xref std std-ref">pytest.mark.parametrize ref</span>
it is possible to parametrize tests such that
some runs raise an exception and others do not.</p>
<p>See <span class="xref std std-ref">parametrizing_conditional_raising</span> for an example.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><span class="xref std std-ref">assertraises</span> for more examples and detailed discussion.</p>
</div>
<p><strong>Legacy form</strong></p>
<p>It is possible to specify a callable by passing a to-be-called lambda:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">raises</span><span class="p">(</span><span class="ne">ZeroDivisionError</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&lt;ExceptionInfo ...&gt;</span>
</pre></div>
</div>
<p>or you can specify an arbitrary callable with arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raises</span><span class="p">(</span><span class="ne">ZeroDivisionError</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">&lt;ExceptionInfo ...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raises</span><span class="p">(</span><span class="ne">ZeroDivisionError</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&lt;ExceptionInfo ...&gt;</span>
</pre></div>
</div>
<p>The form above is fully supported but discouraged for new code because the
context manager form is regarded as more readable and less error-prone.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Similar to caught exception objects in Python, explicitly clearing
local references to returned <code class="docutils literal notranslate"><span class="pre">ExceptionInfo</span></code> objects can
help the Python interpreter speed up its garbage collection.</p>
<p>Clearing those references breaks a reference cycle
(<code class="docutils literal notranslate"><span class="pre">ExceptionInfo</span></code> –&gt; caught exception –&gt; frame stack raising
the exception –&gt; current frame stack –&gt; local variables –&gt;
<code class="docutils literal notranslate"><span class="pre">ExceptionInfo</span></code>) which makes Python keep all objects referenced
from that cycle (including all local variables in the current
frame) alive until the next cyclic garbage collection run.
More detailed information can be found in the official Python
documentation for <span class="xref std std-ref">the try statement</span>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sqlobject.tests.dbtest.setupClass">
<span class="sig-prename descclassname"><span class="pre">sqlobject.tests.dbtest.</span></span><span class="sig-name descname"><span class="pre">setupClass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">soClasses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sqlobject/tests/dbtest.html#setupClass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sqlobject.tests.dbtest.setupClass" title="Link to this definition">¶</a></dt>
<dd><p>Makes sure the classes have a corresponding and correct table.
This won’t recreate the table if it already exists.  It will check
that the table is properly defined (in case you change your table
definition).</p>
<p>You can provide a single class or a list of classes; if a list
then classes will be created in the order you provide, and
destroyed in the opposite order.  So if class A depends on class
B, then do setupClass([B, A]) and B won’t be destroyed or cleared
until after A is destroyed or cleared.</p>
<p>If force is true, then the database will be recreated no matter
what.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sqlobject.tests.dbtest.setupCyclicClasses">
<span class="sig-prename descclassname"><span class="pre">sqlobject.tests.dbtest.</span></span><span class="sig-name descname"><span class="pre">setupCyclicClasses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">classes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sqlobject/tests/dbtest.html#setupCyclicClasses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sqlobject.tests.dbtest.setupCyclicClasses" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sqlobject.tests.dbtest.setupLogging">
<span class="sig-prename descclassname"><span class="pre">sqlobject.tests.dbtest.</span></span><span class="sig-name descname"><span class="pre">setupLogging</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sqlobject/tests/dbtest.html#setupLogging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sqlobject.tests.dbtest.setupLogging" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sqlobject.tests.dbtest.setup_module">
<span class="sig-prename descclassname"><span class="pre">sqlobject.tests.dbtest.</span></span><span class="sig-name descname"><span class="pre">setup_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mod</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sqlobject/tests/dbtest.html#setup_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sqlobject.tests.dbtest.setup_module" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sqlobject.tests.dbtest.supports">
<span class="sig-prename descclassname"><span class="pre">sqlobject.tests.dbtest.</span></span><span class="sig-name descname"><span class="pre">supports</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sqlobject/tests/dbtest.html#supports"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sqlobject.tests.dbtest.supports" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sqlobject.tests.dbtest.teardown_module">
<span class="sig-prename descclassname"><span class="pre">sqlobject.tests.dbtest.</span></span><span class="sig-name descname"><span class="pre">teardown_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sqlobject/tests/dbtest.html#teardown_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sqlobject.tests.dbtest.teardown_module" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">sqlobject.tests.dbtest module</a><ul>
<li><a class="reference internal" href="#sqlobject.tests.dbtest.Dummy"><code class="docutils literal notranslate"><span class="pre">Dummy</span></code></a></li>
<li><a class="reference internal" href="#sqlobject.tests.dbtest.deprecated_module"><code class="docutils literal notranslate"><span class="pre">deprecated_module()</span></code></a></li>
<li><a class="reference internal" href="#sqlobject.tests.dbtest.getConnection"><code class="docutils literal notranslate"><span class="pre">getConnection()</span></code></a></li>
<li><a class="reference internal" href="#sqlobject.tests.dbtest.getConnectionURI"><code class="docutils literal notranslate"><span class="pre">getConnectionURI()</span></code></a></li>
<li><a class="reference internal" href="#sqlobject.tests.dbtest.inserts"><code class="docutils literal notranslate"><span class="pre">inserts()</span></code></a></li>
<li><a class="reference internal" href="#sqlobject.tests.dbtest.raises"><code class="docutils literal notranslate"><span class="pre">raises()</span></code></a></li>
<li><a class="reference internal" href="#sqlobject.tests.dbtest.setupClass"><code class="docutils literal notranslate"><span class="pre">setupClass()</span></code></a></li>
<li><a class="reference internal" href="#sqlobject.tests.dbtest.setupCyclicClasses"><code class="docutils literal notranslate"><span class="pre">setupCyclicClasses()</span></code></a></li>
<li><a class="reference internal" href="#sqlobject.tests.dbtest.setupLogging"><code class="docutils literal notranslate"><span class="pre">setupLogging()</span></code></a></li>
<li><a class="reference internal" href="#sqlobject.tests.dbtest.setup_module"><code class="docutils literal notranslate"><span class="pre">setup_module()</span></code></a></li>
<li><a class="reference internal" href="#sqlobject.tests.dbtest.supports"><code class="docutils literal notranslate"><span class="pre">supports()</span></code></a></li>
<li><a class="reference internal" href="#sqlobject.tests.dbtest.teardown_module"><code class="docutils literal notranslate"><span class="pre">teardown_module()</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api/sqlobject.tests.dbtest.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">SQLObject 3.13.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">sqlobject.tests.dbtest module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2004-2025, Ian Bicking and contributors.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.0.4.
    </div>
  </body>
</html>
{
    "connection": {
        "type": {
            "displayName": "Carbon Black Cloud",
            "group": "carbonblack",
            "type": "connectorType"
        },
        "host": {
            "type": "text",
            "regex": "^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9_:/\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9_:/\\-]*[A-Za-z0-9])$"
        },
        "port": {
            "type": "number",
            "default": 443,
            "min": 1,
            "max": 65535
        },
        "help": {
            "type": "link",
            "default": "data-sources.html"
        },
        "options": {
            "type": "fields",
            "async_call": {
                "type": "text",
                "hidden": true,
                "optional": true
            },
            "result_limit": {
                "default": 10000,
                "min": 1,
                "max": 10000000,
                "type": "number",
                "previous": "connection.resultSizeLimit"
            },
            "batch_size": {
                "default": 2000,
                "min": 1,
                "max": 10000,
                "type": "number",
                "optional": true,
                "hidden": true
            },
            "time_range": {
                "default": 5,
                "min": 1,
                "max": 10000,
                "type": "number",
                "previous": "connection.timerange",
                "nullable": true
            },
            "timeout": {
                "default": 30,
                "min": 1,
                "max": 3600,
                "hidden": true,
                "type": "number",
                "previous": "connection.timeoutLimit"
            },
            "dialects": {
                "type": "array",
                "hidden": true,
                "optional": true
            },
            "language": {
                "type": "string",
                "default": "stix",
                "optional": true,
                "hidden": true
            },
            "validate_pattern": {
                "type": "boolean",
                "optional": true,
                "hidden": true,
                "previous": "connection.validate_pattern"
            },
            "stix_validator": {
                "type": "boolean",
                "default": false,
                "optional": true,
                "hidden": true,
                "previous": "connection.stix_validator"
            },
            "mapping": {
                "type": "json",
                "optional": true,
                "previous": "connection.mapping",
                "default": {
                    "to_stix_map": {
                        "process_username": [
                            {
                                "key": "user-account.user_id",
                                "object": "process_creator"
                            },
                            {
                                "key": "process.creator_user_ref",
                                "object": "process",
                                "references": "process_creator"
                            }
                        ],
                        "process_start_time": [
                            {
                                "key": "process.created",
                                "object": "process"
                            }
                        ],
                        "process_name": [
                            {
                                "key": "file.name",
                                "object": "process_file"
                            },
                            {
                                "key": "process.name",
                                "object": "process"
                            },
                            {
                                "key": "process.binary_ref",
                                "object": "process",
                                "references": "process_file"
                            }
                        ],
                        "process_pid": {
                            "key": "process.pid",
                            "object": "process"
                        },
                        "process_guid": {
                            "key": "process.x_unique_id",
                            "object": "process"
                        },
                        "process_md5": {
                            "key": "file.hashes.MD5",
                            "object": "process_file"
                        },
                        "process_sha256": {
                            "key": "file.hashes.SHA-256",
                            "object": "process_file"
                        },
                        "process_cmdline": {
                            "key": "process.command_line",
                            "object": "process"
                        },
                        "process_path": [
                            {
                                "key": "directory.path",
                                "object": "process_dir"
                            },
                            {
                                "key": "file.parent_directory_ref",
                                "object": "process_file",
                                "references": "process_dir"
                            }
                        ],
                        "parent_name": [
                            {
                                "key": "file.name",
                                "object": "parent_file"
                            },
                            {
                                "key": "process.name",
                                "object": "parent"
                            },
                            {
                                "key": "process.binary_ref",
                                "object": "parent",
                                "references": "parent_file"
                            },
                            {
                                "key": "process.parent_ref",
                                "object": "process",
                                "references": "parent"
                            }
                        ],
                        "parent_pid": {
                            "key": "process.pid",
                            "object": "parent"
                        },
                        "parent_guid": {
                            "key": "process.x_unique_id",
                            "object": "parent"
                        },
                        "parent_md5": {
                            "key": "file.hashes.MD5",
                            "object": "parent_file"
                        },
                        "parent_sha256": {
                            "key": "file.hashes.SHA-256",
                            "object": "parent_file"
                        },
                        "parent_cmdline": {
                            "key": "process.command_line",
                            "object": "parent"
                        },
                        "parent_path": [
                            {
                                "key": "directory.path",
                                "object": "parent_dir"
                            },
                            {
                                "key": "file.parent_directory_ref",
                                "object": "parent_file",
                                "references": "parent_dir"
                            }
                        ],
                        "device_name": {
                            "key": "x-cbcloud.device_name",
                            "object": "x_cbcloud"
                        },
                        "device_internal_ip": {
                            "key": "x-cbcloud.device_internal_ip",
                            "object": "x_cbcloud"
                        },
                        "device_external_ip": {
                            "key": "x-cbcloud.device_external_ip",
                            "object": "x_cbcloud"
                        },
                        "device_os": {
                            "key": "x-cbcloud.device_os",
                            "object": "x_cbcloud"
                        },
                        "device_id": {
                            "key": "x-cbcloud.device_id",
                            "object": "x_cbcloud"
                        },
                        "device_timestamp": [
                            {
                                "key": "first_observed"
                            },
                            {
                                "key": "last_observed"
                            },
                            {
                                "key": "x-cbcloud.device_timestamp",
                                "object": "x_cbcloud"
                            }
                        ],
                        "org_id": {
                            "key": "x-cbcloud.org_id",
                            "object": "x_cbcloud"
                        },
                        "device_group_id": {
                            "key": "x-cbcloud.device_group_id",
                            "object": "x_cbcloud"
                        },
                        "process_terminated": {
                            "key": "x-cbcloud.process_terminated",
                            "object": "x_cbcloud"
                        },
                        "regmod_count": {
                            "key": "x-cbcloud.regmod_count",
                            "object": "x_cbcloud"
                        },
                        "netconn_count": {
                            "key": "x-cbcloud.netconn_count",
                            "object": "x_cbcloud"
                        },
                        "filemod_count": {
                            "key": "x-cbcloud.filemod_count",
                            "object": "x_cbcloud"
                        },
                        "modload_count": {
                            "key": "x-cbcloud.modload_count",
                            "object": "x_cbcloud"
                        },
                        "childproc_count": {
                            "key": "x-cbcloud.childproc_count",
                            "object": "x_cbcloud"
                        },
                        "crossproc_count": {
                            "key": "x-cbcloud.crossproc_count",
                            "object": "x_cbcloud"
                        },
                        "scriptload_count": {
                            "key": "x-cbcloud.scriptload_count",
                            "object": "x_cbcloud"
                        }
                    },
                    "from_stix_map": {
                        "ipv4-addr": {
                            "fields": {
                                "value": [
                                    "netconn_ipv4",
                                    "netconn_local_ipv4"
                                ]
                            }
                        },
                        "ipv6-addr": {
                            "fields": {
                                "value": [
                                    "netconn_ipv6",
                                    "netconn_local_ipv6"
                                ]
                            }
                        },
                        "file": {
                            "fields": {
                                "name": [
                                    "process_name"
                                ],
                                "hashes.MD5": [
                                    "process_hash"
                                ],
                                "hashes.'SHA-256'": [
                                    "process_hash",
                                    "process_sha256"
                                ]
                            }
                        },
                        "process": {
                            "fields": {
                                "created": [
                                    "process_start_time"
                                ],
                                "creator_user_ref.account_login": [
                                    "process_username"
                                ],
                                "service_name": [
                                    "process_service_name"
                                ],
                                "command_line": [
                                    "process_cmdline"
                                ],
                                "pid": [
                                    "process_pid"
                                ],
                                "name": [
                                    "process_name"
                                ],
                                "binary_ref.name": [
                                    "process_name"
                                ],
                                "binary_ref.hashes.MD5": [
                                    "process_hash"
                                ],
                                "binary_ref.hashes.'SHA-256'": [
                                    "process_hash",
                                    "process_sha256"
                                ],
                                "parent_ref.command_line": [
                                    "parent_cmdline"
                                ],
                                "parent_ref.pid": [
                                    "parent_pid"
                                ],
                                "parent_ref.name": [
                                    "parent_name"
                                ],
                                "parent_ref.binary_ref.name": [
                                    "parent_name"
                                ],
                                "parent_ref.binary_ref.hashes.MD5": [
                                    "parent_hash"
                                ],
                                "parent_ref.binary_ref.hashes.'SHA-256'": [
                                    "parent_hash"
                                ],
                                "x_unique_id": [
                                    "process_guid",
                                    "parent_guid"
                                ]
                            }
                        },
                        "software": {
                            "fields": {
                                "name": [
                                    "process_file_description",
                                    "process_internal_name"
                                ],
                                "vendor": [
                                    "process_company_name",
                                    "process_publisher"
                                ],
                                "version": [
                                    "process_product_version"
                                ]
                            }
                        },
                        "network-traffic": {
                            "fields": {
                                "src_port": [
                                    "netconn_port"
                                ],
                                "dst_port": [
                                    "netconn_port"
                                ],
                                "protocols[*]": [
                                    "netconn_protocol"
                                ],
                                "src_ref.value": [
                                    "netconn_local_ipv4",
                                    "netconn_local_ipv6"
                                ],
                                "dst_ref.value": [
                                    "netconn_ipv4",
                                    "netconn_ipv6"
                                ]
                            }
                        },
                        "user-account": {
                            "fields": {
                                "user_id": [
                                    "process_username"
                                ]
                            }
                        },
                        "url": {
                            "fields": {
                                "value": [
                                    "netconn_domain"
                                ]
                            }
                        },
                        "domain-name": {
                            "fields": {
                                "value": [
                                    "netconn_domain"
                                ]
                            }
                        },
                        "x-cbcloud": {
                            "fields": {
                                "device_name": [
                                    "device_name"
                                ],
                                "device_internal_ip": [
                                    "device_internal_ip"
                                ],
                                "device_external_ip": [
                                    "device_external_ip"
                                ],
                                "device_os": [
                                    "device_os"
                                ],
                                "device_os_version": [
                                    "device_os_version"
                                ],
                                "device_id": [
                                    "device_id"
                                ],
                                "device_group": [
                                    "device_group"
                                ],
                                "device_policy": [
                                    "device_policy"
                                ],
                                "device_timestamp": [
                                    "device_timestamp"
                                ],
                                "process_terminated": [
                                    "process_terminated"
                                ],
                                "regmod_count": [
                                    "regmod_count"
                                ],
                                "netconn_count": [
                                    "netconn_count"
                                ],
                                "filemod_count": [
                                    "filemod_count"
                                ],
                                "modload_count": [
                                    "modload_count"
                                ],
                                "childproc_count": [
                                    "childproc_count"
                                ],
                                "crossproc_count": [
                                    "crossproc_count"
                                ],
                                "scriptload_count": [
                                    "scriptload_count"
                                ],
                                "parent_cmdline_length": [
                                    "parent_cmdline_length"
                                ],
                                "process_cmdline_length": [
                                    "process_cmdline_length"
                                ],
                                "parent_publisher_state": [
                                    "parent_publisher_state"
                                ],
                                "process_publisher_state": [
                                    "process_publisher_state"
                                ],
                                "parent_reputation": [
                                    "parent_reputation"
                                ],
                                "process_reputation": [
                                    "process_reputation"
                                ],
                                "parent_effective_reputation": [
                                    "parent_effective_reputation"
                                ],
                                "process_effective_reputation": [
                                    "process_effective_reputation"
                                ],
                                "netconn_location": [
                                    "netconn_location"
                                ],
                                "netconn_inbound": [
                                    "netconn_inbound"
                                ],
                                "netconn_failed": [
                                    "netconn_failed"
                                ],
                                "regmod_name": [
                                    "regmod_name"
                                ],
                                "scriptload_name": [
                                    "scriptload_name"
                                ],
                                "scriptload_hash": [
                                    "scriptload_hash"
                                ],
                                "scriptload_publisher_state": [
                                    "scriptload_publisher_state"
                                ],
                                "fileless_scriptload_hash": [
                                    "fileless_scriptload_hash"
                                ],
                                "fileless_scriptload_cmdline": [
                                    "fileless_scriptload_cmdline"
                                ],
                                "fileless_scriptload_cmdline_length": [
                                    "fileless_scriptload_cmdline_length"
                                ],
                                "modload_name": [
                                    "modload_name"
                                ],
                                "modload_hash": [
                                    "modload_hash"
                                ],
                                "modload_publisher_state": [
                                    "modload_publisher_state"
                                ],
                                "filemod_name": [
                                    "filemod_name"
                                ],
                                "filemod_hash": [
                                    "filemod_hash"
                                ],
                                "filemod_publisher_state": [
                                    "filemod_publisher_state"
                                ],
                                "crossproc_action": [
                                    "crossproc_action"
                                ],
                                "crossproc_api": [
                                    "crossproc_api"
                                ],
                                "crossproc_hash": [
                                    "crossproc_hash"
                                ],
                                "crossproc_name": [
                                    "crossproc_name"
                                ],
                                "crossproc_target": [
                                    "crossproc_target"
                                ],
                                "childproc_cmdline": [
                                    "childproc_cmdline"
                                ],
                                "childproc_cmdline_length": [
                                    "childproc_cmdline_length"
                                ],
                                "childproc_effective_reputation": [
                                    "childproc_effective_reputation"
                                ],
                                "childproc_guid": [
                                    "childproc_guid"
                                ],
                                "childproc_hash": [
                                    "childproc_hash"
                                ],
                                "childproc_name": [
                                    "childproc_name"
                                ],
                                "childproc_publisher_state": [
                                    "childproc_publisher_state"
                                ],
                                "childproc_reputation": [
                                    "childproc_reputation"
                                ],
                                "hash": [
                                    "hash"
                                ],
                                "process_original_filename": [
                                    "process_original_filename"
                                ],
                                "process_product_name": [
                                    "process_product_name"
                                ],
                                "backend_timestamp": [
                                    "backend_timestamp"
                                ],
                                "process_duration": [
                                    "process_duration"
                                ],
                                "process_elevated": [
                                    "process_elevated"
                                ],
                                "process_integrity_level": [
                                    "process_integrity_level"
                                ],
                                "process_privileges": [
                                    "process_privileges"
                                ]
                            }
                        }
                    },
                    "operators": {
                        "ComparisonExpressionOperators.And": "AND",
                        "ComparisonExpressionOperators.Or": "OR",
                        "ComparisonComparators.Equal": ":",
                        "ComparisonComparators.NotEqual": ":",
                        "ComparisonComparators.GreaterThan": ":",
                        "ComparisonComparators.GreaterThanOrEqual": ":",
                        "ComparisonComparators.LessThan": ":",
                        "ComparisonComparators.LessThanOrEqual": ":",
                        "ComparisonComparators.In": ":",
                        "ObservationOperators.Or": "OR",
                        "ObservationOperators.And": "AND"
                    }
                }
            },
            "unmapped_fallback": {
                "type": "boolean",
                "default": false,
                "optional": true,
                "hidden": true
            },
            "stix_2.1": {
                "type": "boolean",
                "default": false,
                "optional": true,
                "hidden": true
            }
        }
    },
    "configuration": {
        "auth": {
            "type": "fields",
            "org_key": {
                "type": "password"
            },
            "token": {
                "type": "password"
            }
        }
    }
}
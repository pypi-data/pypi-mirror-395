"use strict";(self.webpackChunk_jupyterlite_terminal=self.webpackChunk_jupyterlite_terminal||[]).push([[173],{585:(e,t,s)=>{s.d(t,{Df:()=>i,Ju:()=>h,XI:()=>l,tZ:()=>r});var i,r,n=s(9399),a=s(3291);!function(e){e[e.TOP=0]="TOP",e[e.MIDDLE=1]="MIDDLE",e[e.BOTTOM=2]="BOTTOM"}(i||(i={})),function(e){e[e.LEFT=0]="LEFT",e[e.INNER=1]="INNER",e[e.RIGHT=2]="RIGHT"}(r||(r={}));class o{options;constructor(e){this.options=e}addHeaderRow(e){this._headerRows.push(e),this._updateColumnWidths(e)}addRow(e){this._rows.push(e),this._updateColumnWidths(e)}static defaultColorByColumn(){return new Map([[1,n.Q.styleBrightBlue],[2,n.Q.styleBrightPurple],[3,n.Q.styleGreen],[4,n.Q.styleYellow]])}*lines(e="",t=""){const{sortByColumn:s}=this.options;if(void 0!==s){const e=(t,i,r)=>{const n=s[t];return i[n]<r[n]?-1:i[n]>r[n]?1:s.length>t+1?e(t+1,i,r):0};this._rows.sort((t,s)=>e(0,t,s))}const o=this._columnWidths.length,l=this.horizontalSpacer(i.TOP);void 0!==l&&(yield e+(0,a.BO)(l)+t);for(const s of this._headerRows){let i="";for(let e=0;e<o;e++){i+=this.verticalSpacer(0===e?r.LEFT:r.INNER);const t=s[e]??"";i+=t+" ".repeat(this._columnWidths[e]-t.length)}i+=this.verticalSpacer(r.RIGHT),yield e+(0,a.BO)(i)+t}if(this._headerRows.length>0){const s=this.horizontalSpacer(i.MIDDLE);void 0!==s&&(yield e+(0,a.BO)(s)+t)}for(const s of this._rows){let i="";for(let e=0;e<o;e++){i+=this.verticalSpacer(0===e?r.LEFT:r.INNER);const t=s[e]??"";if(t){const s=this.options.colorByColumn?.get(e);i+=void 0!==s?s+t+n.Q.styleReset:t}i+=" ".repeat(this._columnWidths[e]-t.length)}i+=this.verticalSpacer(r.RIGHT),yield e+(0,a.BO)(i)+t}const h=this.horizontalSpacer(i.BOTTOM);void 0!==h&&(yield e+(0,a.BO)(h)+t)}get rowCount(){return this._rows.length}write(e,t="",s="\n"){for(const i of this.lines(t,s))e.write(i)}_updateColumnWidths(e){const t=e.map(e=>e.length),s=Math.min(this._columnWidths.length,t.length);for(let e=0;e<s;e++)this._columnWidths[e]=Math.max(this._columnWidths[e],t[e]);t.length>s&&this._columnWidths.push(...t.slice(s))}_columnWidths=[];_headerRows=[];_rows=[]}class l extends o{constructor(e={}){super(e);const t=e.spacerSize??2;this._spacer=" ".repeat(t),this._spacersAtEnds=e.spacersAtEnds??!1}horizontalSpacer(e){if(e===i.MIDDLE){const e=this._columnWidths.reduce((e,t)=>e+t)+this._totalSeparatorSize();return"─".repeat(e)}}verticalSpacer(e){return e===r.INNER||this._spacersAtEnds?this._spacer:""}_totalSeparatorSize(){let e=this._columnWidths.length-1;return this._spacersAtEnds&&(e+=2),e*this._spacer.length}_spacer;_spacersAtEnds}class h extends o{constructor(e={}){super(e)}horizontalSpacer(e){const t=(e=>{switch(e){case i.TOP:return"╭┬╮";case i.MIDDLE:return"├┼┤";case i.BOTTOM:return"╰┴╯"}})(e);return t[0]+this._columnWidths.map(e=>"─".repeat(e+2)).join(t[1])+t[2]}verticalSpacer(e){return e===r.LEFT?"│ ":e===r.RIGHT?" │":" │ "}}},2199:(e,t,s)=>{s.d(t,{BT:()=>a,C8:()=>n,ET:()=>l,Tl:()=>o,ef:()=>r});var i=s(7095);class r{shortName;longName;description;constructor(e,t,s){if(this.shortName=e,this.longName=t,this.description=s,0!==e.length&&1!==e.length)throw new i.$g(`Argument shortName ${e} must be a string of length 1`);if(!(0===t.length||t.length>1))throw new i.$g(`Argument longName ${t} must be a string of length greater than 1`)}get isSet(){return this._isSet}parse(e,t){return this.set(),t}set(){this._isSet=!0}_isSet=!1}class n extends r{constructor(e,t,s){super(e,t,s)}}class a extends n{constructor(e,t,s){super(e,t,s)}get string(){return this._string}parse(e,t){return this.set(),t.length>0&&!t[0].startsWith("-")&&(this._string=t.shift()),t}_string}class o extends r{options;constructor(e={}){super("","",""),this.options=e;const{max:t,min:s}=e;if(void 0!==s){if(s<0)throw new i.$g("Negative min for positional arguments");if(void 0!==t&&t<s)throw new i.$g("max must be greater than min for positional arguments")}}get length(){return this._strings.length}parse(e,t){this._strings.push(e),this.set();for(const e of t){if(e.startsWith("-"))throw new i.$g("Cannot have named argument after positional arguments");this._strings.push(e)}return[]}get strings(){return this._strings}_strings=[]}class l extends o{options;constructor(e={}){super(e),this.options=e}}},3173:(e,t,s)=>{s.r(t),s.d(t,{Aliases:()=>i.D,Argument:()=>n.ef,BaseShell:()=>k,BaseShellWorker:()=>b.g,BooleanArgument:()=>n.C8,BorderTable:()=>X.Ju,BufferedOutput:()=>E.j,CommandArguments:()=>a.k,ConsoleOutput:()=>S,DummyInput:()=>T.X,DummyOutput:()=>O.y,ExitCode:()=>w.y,ExternalEnvironment:()=>f,ExternalInput:()=>I,ExternalOutput:()=>y,ExternalTermios:()=>v,FileInput:()=>C.z,FileOutput:()=>A.M,HorizontalSpacerType:()=>X.Df,InputAll:()=>M.S,JavaScriptInput:()=>W._,OptionalStringArgument:()=>n.BT,PathType:()=>F.y,Pipe:()=>B.n,PipeInput:()=>x.J,PositionalArguments:()=>n.Tl,PositionalPathArguments:()=>n.ET,RedirectOutput:()=>R,Shell:()=>L,ShellManager:()=>z,SubcommandArguments:()=>a.s,Table:()=>X.XI,TerminalInput:()=>D.d,TerminalOutput:()=>N.m,Termios:()=>$.G,VerticalSpacerType:()=>X.tZ,ansi:()=>r.Q,delay:()=>d.cb,parse:()=>U.qg,tokenize:()=>j.q});var i=s(7450),r=s(9399),n=s(2199),a=s(5874),o=s(7262),l=s(4602),h=s(9017),d=s(3291);class c{constructor(){}async disable(){if(this._enabled){for(const e of this._readBuffer)this._sendStdinNow(e);this._readBuffer="",void 0!==this._stdinPromise&&(this._stdinPromise.reject("stdin no longer required"),this._stdinPromise=void 0),this._enabled=!1}}dispose(){this._isDisposed||(this._isDisposed=!0)}async enable(){this._enabled=!0}get enabled(){return this._enabled}get isDisposed(){return this._isDisposed}async push(e){if(!this._enabled)throw new Error("MainIO.push when disabled");void 0!==this._stdinPromise?(this._stdinPromise.resolve(e),this._stdinPromise=void 0):this._readBuffer+=e}registerSendStdinNow(e){this._sendStdinNow=e}async _handleStdinImpl(e){if(void 0!==this._stdinPromise&&console.error("MainIO stdin promise should not exist"),this._readBuffer.length>0){const e=this._readBuffer;return this._readBuffer="",e}if(0===e)return"";const t=new o.PromiseDelegate;e>0&&(0,d.cb)(e).then(()=>{t.resolve("")}),this._stdinPromise=t;const s=await t.promise;return this._stdinPromise=void 0,s}_enabled=!1;_readBuffer="";_sendStdinNow;_isDisposed=!1;_stdinPromise}var _=s(763);class u extends c{constructor(){super();const e=Int32Array.BYTES_PER_ELEMENT,t=_.X.maxChars+4;this._sharedArrayBuffer=new SharedArrayBuffer(t*e),this._intArray=new Int32Array(this._sharedArrayBuffer,0,t),this._intArray[_.X.REQUEST_INDEX]=_.X.NO_REQUEST_VALUE}async disable(){this._enabled&&(Atomics.store(this._intArray,_.X.REQUEST_INDEX,_.X.ABORT_VALUE),Atomics.notify(this._intArray,_.X.REQUEST_INDEX,1),await super.disable())}async enable(){await super.enable(),this._intArray[_.X.REQUEST_INDEX]=_.X.NO_REQUEST_VALUE,this._waitForRequest()}async _handleStdin(){const e=_.X.decodeTimeout(Atomics.load(this._intArray,_.X.TIMEOUT_INDEX)),t=await this._handleStdinImpl(e);await this._sendResult(t)}async _sendResult(e){const t=e.length;Atomics.store(this._intArray,_.X.LENGTH_INDEX,t);for(let s=0;s<t;s++)Atomics.store(this._intArray,_.X.START_INDEX+s,e.charCodeAt(s));Atomics.store(this._intArray,_.X.REQUEST_INDEX,_.X.NO_REQUEST_VALUE),this._waitForRequest(),Atomics.notify(this._intArray,_.X.REQUEST_INDEX,1)}_waitForRequest(){const{async:e,value:t}=Atomics.waitAsync(this._intArray,_.X.REQUEST_INDEX,_.X.NO_REQUEST_VALUE);e?t.then(()=>{Atomics.load(this._intArray,_.X.REQUEST_INDEX)!==_.X.ABORT_VALUE&&this._handleStdin()}):Atomics.load(this._intArray,_.X.REQUEST_INDEX)!==_.X.ABORT_VALUE&&this._handleStdin()}get sharedArrayBuffer(){return this._sharedArrayBuffer}_intArray;_sharedArrayBuffer}var p=s(8301);class m extends c{constructor(e,t,s){super(),this._utils=new p.F(e,t,s)}async handleStdin(e){if(!this._enabled)throw new Error("ServiceWorkerMainIO.handleStdin when disabled");const{test:t,timeoutMs:s}=e;return t?{text:"ok:"+e.shellId}:{text:await this._handleStdinImpl(s)}}async testWithTimeout(e){if(!this._enabled)throw new Error("ServiceWorkerMainIO.testWithTimeout when disabled");const t=this._utils.getStdinAsync(-1,!0),s=new Promise(t=>setTimeout(()=>t(null),e)),i=await Promise.race([t,s]);return null===i?(console.warn("Timeout accessing service worker"),!1):i==="ok:"+this._utils.shellId||(console.warn("Error accessing service worker"),!1)}_utils}class g{packageName;moduleName;outputCallback;constructor(e,t,s){this.packageName=e,this.moduleName=t,this.outputCallback=s}dispose(){this._isDisposed||(this.stop(),this._isDisposed=!0)}get isDisposed(){return this._isDisposed}start(){void 0!==this._intervalId&&this.stop(),this._intervalId=setInterval(this._callback.bind(this),this._delayMs)}stop(){void 0!==this._intervalId&&(clearTimeout(this._intervalId),this._intervalId=void 0,this._callbackCount=0,this._displayed&&this.outputCallback(r.Q.eraseEndLine+r.Q.showCursor),this._displayed=!1)}_callback(){if(this._callbackCount<this._initialIgnore);else if(this._displayed){const e=this._dots[(this._callbackCount-this._initialIgnore)%this._dots.length];this.outputCallback(e+r.Q.cursorLeft(1))}else{const e=` downloading wasm module '${this.moduleName}'`,t=e.length;this.outputCallback(r.Q.hideCursor+this._dots[0]+e+r.Q.cursorLeft(t+1)),this._displayed=!0}this._callbackCount++}_callbackCount=0;_delayMs=100;_dots="⠇⠋⠙⠸⠴⠦";_initialIgnore=3;_intervalId;_isDisposed=!1;_displayed=!1}var w=s(3482);class f extends Map{delete(e){return void 0===this._changed&&(this._changed=new Set),this._changed.add(e),super.delete(e)}get changed(){if(void 0===this._changed)return;const e={};return this._changed.forEach(t=>e[t]=this.get(t)),e}set(e,t){return void 0===this._changed&&(this._changed=new Set),this._changed.add(e),super.set(e,t),this}_changed}class v{setTermios;constructor(e,t){this.setTermios=t,this._termiosFlags=e}get(){return this._termiosFlags}set(e){this._termiosFlags=e,this.setTermios(e)}_termiosFlags}class I{callback;constructor(e,t){this.callback=e,this._isTerminal=t}isTerminal(){return this._isTerminal}async readAsync(e){return this.callback(e)}_isTerminal}class y{callback;constructor(e,t){this.callback=e,this._isTerminal=t}flush(){}isTerminal(){return this._isTerminal}supportsAnsiEscapes(){return this._isTerminal}write(e){this.callback(e)}_isTerminal}class k{options;constructor(e){this.options=e,this._shellId=e.shellId??o.UUID.uuid4(),void 0!==this.options.shellManager&&this.options.shellManager.registerShell(this._shellId,this,this._serviceWorkerHandleStdin.bind(this)),this._initialize()}async callExternalCommand(e,t,s,i,r,n,a){const o=this._externalCommands.get(e);if(void 0===o)return{exitCode:w.y.CANNOT_FIND_COMMAND};const{command:l}=o,h=new f(Object.entries(s)),d=new I(e=>this._remote.externalInput(e),i),c=new y(e=>this._remote.externalOutput(e,!1),r),_=new y(e=>this._remote.externalOutput(e,!0),n),u=new v(a,this._remote.externalSetTermios),p={name:e,args:t,environment:h,shellId:this._shellId,stdin:d,stdout:c,stderr:_,size:()=>this.size,termios:u};return{exitCode:await l(p),environmentChanges:h.changed}}async callExternalTabComplete(e,t){const s=this._externalCommands.get(e);if(void 0===s)return console.warn("'{name} is not a registered external command"),{};const{tabComplete:i}=s;return void 0===i?(console.warn("External command '{name} does not support tab completion"),{}):await i({name:e,args:t,shellId:this._shellId})}dispose(){this._isDisposed||(console.log("Cockle Shell disposed"),this._isDisposed=!0,this._remote=void 0,this._worker.terminate(),void 0!==this._downloadTracker&&(this._downloadTracker.dispose(),this._downloadTracker=void 0),void 0!==this._sharedArrayBufferMainIO&&(this._sharedArrayBufferMainIO.dispose(),this._sharedArrayBufferMainIO=void 0),void 0!==this._serviceWorkerMainIO&&(this._serviceWorkerMainIO.dispose(),this._serviceWorkerMainIO=void 0),this._mainIO=void 0,this._disposed.emit())}get disposed(){return this._disposed}downloadWasmModuleCallback(e,t,s){s?(void 0!==this._downloadTracker&&this._downloadTracker.dispose(),this._downloadTracker=new g(e,t,this.options.outputCallback),this._downloadTracker.start()):void 0!==this._downloadTracker&&e===this._downloadTracker.packageName&&t===this._downloadTracker.moduleName&&this._downloadTracker.stop()}async exitCode(){return await(this._remote?.exitCode)??1}get isDisposed(){return this._isDisposed}async enableBufferedStdinCallback(e){this.isDisposed||(e?await(this._mainIO?.enable()):await(this._mainIO?.disable()))}async input(e){this.isDisposed||(this._mainIO?.enabled?await this._mainIO.push(e):await this._remote.input(e))}get ready(){return this._ready.promise}async setSize(e,t){this.isDisposed||(e<0&&(e=0),t<0&&(t=0),this._size=[e,t],await this._remote.setSize(e,t))}get shellId(){return this._shellId}get size(){return this._size}async start(){this.isDisposed||(await this.ready,await this._remote.start())}async themeChange(e){await(this._remote?.themeChange(e))}async _initialize(){const e=window.crossOriginIsolated;e&&(this._sharedArrayBufferMainIO=new u);let t=!1;if(void 0!==this.options.browsingContextId){this._serviceWorkerMainIO=new m(this.options.baseUrl,this.options.browsingContextId,this.shellId),await this._serviceWorkerMainIO.enable();const e=await this._serviceWorkerMainIO.testWithTimeout(1e3);await this._serviceWorkerMainIO.disable(),e?(console.log("Service worker supports terminal stdin"),t=!0):(console.log("Service worker does not support terminal stdin"),this._serviceWorkerMainIO.dispose(),this._serviceWorkerMainIO=void 0)}if(!e&&!t){let e="ERROR: Terminal needs either SharedArrayBuffer or ServiceWorker available.";return console.error(e),(this.options.color??1)&&(e=r.Q.styleBoldRed+e+r.Q.styleReset),this.options.outputCallback(e),void this.dispose()}this._mainIO=this._sharedArrayBufferMainIO??this._serviceWorkerMainIO,this.options.externalCommands?.forEach(e=>this._externalCommands.set(e.name,e)),this._worker=this.initWorker(this.options),this._initRemote(this.options).then(this._ready.resolve.bind(this._ready))}async _initRemote(e){this._remote=(0,h.LV)(this._worker);const t=this._sharedArrayBufferMainIO?.sharedArrayBuffer??void 0,s=void 0!==this._serviceWorkerMainIO,i=e.externalCommands?.map(e=>({name:e.name,hasTabComplete:void 0!==e.tabComplete}));await this._remote.initialize({shellId:this.shellId,color:e.color??!0,mountpoint:e.mountpoint,wasmBaseUrl:e.wasmBaseUrl,baseUrl:e.baseUrl,browsingContextId:e.browsingContextId,aliases:e.aliases??{},environment:e.environment??{},externalCommandConfigs:i??[],sharedArrayBuffer:t,supportsServiceWorker:s,initialDirectories:e.initialDirectories,initialFiles:e.initialFiles},(0,h.BX)(this.callExternalCommand.bind(this)),(0,h.BX)(this.callExternalTabComplete.bind(this)),(0,h.BX)(this.downloadWasmModuleCallback.bind(this)),(0,h.BX)(this.enableBufferedStdinCallback.bind(this)),(0,h.BX)(e.outputCallback),(0,h.BX)(this._setMainIO.bind(this)),(0,h.BX)(this.dispose.bind(this))),void 0!==this._sharedArrayBufferMainIO&&this._sharedArrayBufferMainIO.registerSendStdinNow(this._remote.input),void 0!==this._serviceWorkerMainIO&&this._serviceWorkerMainIO.registerSendStdinNow(this._remote.input)}async _serviceWorkerHandleStdin(e){if(void 0!==this._serviceWorkerMainIO)return await this._serviceWorkerMainIO.handleStdin(e);throw new Error("No serviceWorker handleStdin exists")}_setMainIO(e){const t=this._mainIO;if("sab"===e&&void 0!==this._sharedArrayBufferMainIO)this._mainIO=this._sharedArrayBufferMainIO;else{if("sw"!==e||void 0===this._serviceWorkerMainIO)throw new Error(`Cannot set MainIO to '${e}'`);this._mainIO=this._serviceWorkerMainIO}t?.disable()}_disposed=new l.Signal(this);_isDisposed=!1;_ready=new o.PromiseDelegate;_shellId;_size=[0,0];_worker;_remote;_externalCommands=new Map;_serviceWorkerMainIO;_sharedArrayBufferMainIO;_mainIO;_downloadTracker}var b=s(385),E=s(5670);class S{flush(){}isTerminal(){return!1}supportsAnsiEscapes(){return!1}write(e){console.log(e)}}var T=s(312),O=s(2251),C=s(2958),A=s(5981),M=s(1315),W=s(1203),B=s(4207),x=s(952);class R extends E.j{constructor(e){super(),this.target=e}flush(){this.data.forEach(e=>this.target.write(e)),this.clear(),this.target.flush()}target}var D=s(8316),N=s(7703),X=s(585),U=s(7497);class L extends k{options;constructor(e){super(e),this.options=e}initWorker(e){return console.log("Cockle Shell.initWorker"),new Worker(new URL(s.p+s.u(63),s.b),{type:void 0})}}var P=s(3694);class Q{baseUrl;shellManager;constructor(e,t){this.baseUrl=e,this.shellManager=t,this._browsingContextId=o.UUID.uuid4(),this._broadcastChannel=new BroadcastChannel("/cockle/service-worker"),this._broadcastChannel.addEventListener("message",this._onBroadcastMessage),this._initialize().catch(console.warn)}get enabled(){return null!==this._registration}get browsingContextId(){return this._browsingContextId}get ready(){return this._ready.promise}async _initialize(){const{serviceWorker:e}=navigator;let t=null;if(e){if(e.controller){const s=e.controller.scriptURL;await this._unregisterOldServiceWorkers(s),t=await e.getRegistration(s)||null,console.info("JupyterLite ServiceWorker was already registered")}if(!t&&e)try{console.info("Registering new ServiceWorker"),t=await e.register(new URL(s(5466),s.b),{type:"module"}),console.info("ServiceWorker successfully registered")}catch(e){console.warn(e),console.warn(`JupyterLite ServiceWorker registration unexpectedly failed: ${e}`)}this._setRegistration(t),t?(this._ready.resolve(void 0),setTimeout(this._pingServiceWorker,2e4)):this._ready.reject(void 0)}else console.warn("ServiceWorkers not supported in this browser")}_onBroadcastMessage=async e=>{const{browsingContextId:t,data:s,pathname:i}=e.data;if(t!==this._browsingContextId)return;if(!i.includes("/api/stdin/terminal"))return;const r=await this.shellManager.handleStdin(s);this._broadcastChannel.postMessage({response:r,browsingContextId:this._browsingContextId})};async _pingServiceWorker(){const e=await fetch("/api/service-worker-heartbeat");"ok"===await e.text()&&setTimeout(this._pingServiceWorker,2e4)}_setRegistration(e){this._registration=e}async _unregisterOldServiceWorkers(e){const t=`${e}-version`,s=localStorage.getItem(t);if(s&&s!==P.Z||!s){console.info("New version, unregistering existing service workers.");const e=await navigator.serviceWorker.getRegistrations();await Promise.all(e.map(e=>e.unregister())),console.info("All existing service workers have been unregistered.")}localStorage.setItem(t,P.Z)}_registration=null;_ready=new o.PromiseDelegate;_broadcastChannel;_browsingContextId}class z{async handleStdin(e){const{shellId:t}=e,s=this._shells.get(t);return void 0===s?{error:`Unrecognised shellId ${t}`}:await s(e)}async installServiceWorker(e){return void 0===this._serviceWorkerManager?(this._serviceWorkerManager=new Q(e,this),await this._serviceWorkerManager.ready,await(0,d.cb)(100),this._serviceWorkerManager.browsingContextId):(console.warn("Service Worker already installed"),this._serviceWorkerManager.browsingContextId)}registerShell(e,t,s){if(""===e)throw new Error("shellId not set");if(this._shells.has(e))throw new Error(`Duplicate shellId: ${e}`);this._shells.set(e,s),t.disposed.connect(()=>this._shells.delete(e))}shellIds(){return[...this._shells.keys()]}_shells=new Map;_serviceWorkerManager}var F=s(955),$=s(4133),j=s(9685)},3291:(e,t,s)=>{async function i(e=10){await new Promise(t=>setTimeout(t,e))}function r(e){return e>=65&&e<=90||e>=97&&e<=122}function n(e,t){return`${e=e.replace(/\/+$/,"")}/${t=t.replace(/^\/+/,"")}`}function a(e,t=0){if(e.length<1)return"";const s=Math.min(...e.map(e=>e.length)),i=e[0];let r=t;for(;r<s&&e.every(e=>e[r]===i[r]);)r++;return i.slice(0,r)}function o(e){return e.replace(/\s+$/,"")}function l(e,t){if(e.length<1)return[];if(t<1)return[e.join("  ")];const s=e.length,i=Math.max(...e.map(e=>e.length)),r=Math.min(Math.floor(t/(i+2)),s),n=Math.ceil(s/r),a=[];for(let t=0;t<n;++t){let o="";for(let a=0;a<r;++a){const r=a*n+t;if(r>=s)continue;const l=e[r];o+=l,r+n<s&&(o+=" ".repeat(i+2-l.length))}a.push(o)}return a}s.d(t,{BO:()=>o,D$:()=>r,Il:()=>a,cb:()=>i,oq:()=>n,tp:()=>l})},5466:()=>{const e=new BroadcastChannel("/cockle/service-worker");self.addEventListener("install",function(e){self.skipWaiting()}),self.addEventListener("activate",function(e){e.waitUntil(self.clients.claim())}),self.addEventListener("fetch",async function(t){const{request:s}=t,i=new URL(s.url),r=i.pathname;if("/api/service-worker-heartbeat"!==r){if(r.endsWith("/api/stdin/terminal")){const r=async function(t,s){const i=await t.json(),r=new Promise(t=>{const s=r=>{const n=r.data;if(n.browsingContextId!==i.browsingContextId)return;const a=n.response;t(new Response(JSON.stringify(a))),e.removeEventListener("message",s)};e.addEventListener("message",s)});return i.pathname=s.pathname,e.postMessage(i),await r}(s,i);t.respondWith(r)}}else t.respondWith(new Response("ok"))})}}]);
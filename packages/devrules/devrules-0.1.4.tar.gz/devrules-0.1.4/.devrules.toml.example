# DevRules Configuration File
# Copy this to .devrules.toml and customize

[branch]
# Branch naming pattern (regex)
pattern = "^(feature|bugfix|hotfix|release|docs)/(\\d+-)?[a-z0-9-]+"
prefixes = ["feature", "bugfix", "hotfix", "release", "docs"]
require_issue_number = false

[commit]
# Commit message tags
tags = ["WIP", "FTR", "SCR", "CLP", "CRO", "TST", "!!!", "FIX", "RFR", "ADD", "REM", "REV", "MOV", "REL", "IMP", "MERGE", "I18N", "DOCS"]
pattern = "^\\[({tags})\\].+"
min_length = 10
max_length = 100
restrict_branch_to_owner = true
append_issue_number = true
# GPG sign commits (requires git config user.signingkey to be set)
gpg_sign = false
# Protected branches that should not receive direct commits (merge-only)
# Useful for staging branches that combine multiple features for testing
protected_branch_prefixes = ["staging-"]

[pr]
# Pull Request validation
max_loc = 400
max_files = 20
require_title_tag = true
title_pattern = "^\\[({tags})\\].+"
# Enable issue status validation before PR creation (default: false)
require_issue_status_check = false
# List of statuses that allow PR creation (e.g., ["In review", "Ready"])
allowed_pr_statuses = []
# List of project keys from [github.projects] to check status against
# If empty, checks all configured projects
project_for_status_check = []

[github]
# GitHub API settings
api_url = "https://api.github.com"
timeout = 30

[deployment]
# Jenkins configuration
jenkins_url = "https://jenkins.yourcompany.com"
jenkins_user = "your-username"  # Optional: can use env var JENKINS_USER
jenkins_token = "your-api-token"  # Optional: can use env var JENKINS_TOKEN

# Set to true if using Jenkins multibranch pipelines
# This changes the URL format from /job/{name}/build to /job/{name}/job/{branch}/build
multibranch_pipeline = false

# Migration detection (Alembic)
migration_detection_enabled = true
migration_paths = ["migrations/", "alembic/versions/"]

# Deployment behavior
auto_rollback_on_failure = true
require_confirmation = true

# Environment configurations
[deployment.environments.dev]
name = "dev"
default_branch = "develop"
# jenkins_job_name is optional - if not set, uses github.repo name
jenkins_job_name = "deploy-backend-dev"

[deployment.environments.staging]
name = "staging"
default_branch = "staging"
jenkins_job_name = "deploy-backend-staging"

[deployment.environments.prod]
name = "prod"
default_branch = "main"
jenkins_job_name = "deploy-backend-prod"

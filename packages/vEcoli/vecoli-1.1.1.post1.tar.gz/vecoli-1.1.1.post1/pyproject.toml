[build-system]
requires = [
    "setuptools",
    "wheel",
    "Cython",
    "numpy"
]
build-backend = "setuptools.build_meta"

[project]
name = "vEcoli"
version = "1.1.1.post1"
description = "Whole Cell E. coli Model"
requires-python = "==3.12.9"
readme = "README.md"
dependencies = [
    "numpy",
    "scipy",
    "biopython",
    "cvxpy",
    "cython",
    "dill",
    "duckdb",
    "gcsfs",
    "pyarrow",
    "ipdb",
    "ipython",
    "line-profiler",
    "altair",
    "numba",
    "orjson",
    # Constraint can be removed once cvxpy supports newer ortools
    # than 9.12, need 9.11 to support newer protobuf (see gh-326)
    "ortools<9.11",
    "pandas",
    "polars",
    "pymunk",
    "scikit-image",
    "scikit-learn",
    "seaborn",
    "swiglpk",
    "sympy",
    "tqdm",
    "unum",
    "vivarium-core",
    "imageio[ffmpeg]",
    "statsmodels",
    "ecos",
    "matplotlib",
    "iteround",
    "stochastic-arrow",
    "autograd",
    "xmltodict",
    # Required to save Altair charts as PNG
    "vl-convert-python",
]

[project.optional-dependencies]
dev = [
    "pytest",
    "pytest-cov",
    "mypy",
    "ruff",
    "pre-commit",
    "jupyter",
    "marimo[sql,lsp]"
]
docs = [
    "Sphinx",
    "sphinx-rtd-theme",
    "nbsphinx"
]

[tool.setuptools]
packages = {find = {include = ["configs*", "ecoli*", "reconstruction*", "runscripts*", "validation*", "wholecell*"]}}
include-package-data = true

[dependency-groups]
deployment = [
    "build>=1.3.0",
    "twine>=6.2.0",
]
dev = [
    "pre-commit>=4.3.0",
]

[tool.pytest.ini_options]
testpaths = ["tests"]
addopts = "--cov-report=html"

[tool.deptry]
exclude = [".venv/*", "data/*", "doc/*", "configs/*"]
ignore = ["DEP002", "DEP003", "DEP004"]

[tool.ruff]
target-version = "py39"
line-length = 120
fix = true

[tool.ruff.lint]
select = [
    "YTT",
    "S",
    "B",
    "A",
    "C4",
    "T10",
    "SIM",
    "I",
    "C90",
    "E", "W",
    "F",
    "PGH",
    "UP",
    "RUF",
    "TRY",
]
ignore = [
    "A001",
    "A002",
    "B904",
    "RUF012",
    "TRY002",
    "TRY003",
    "TRY201",
    "TRY300",
    "UP006",
]
exclude = [".venv/*", "data/*", "doc/*", "configs/*"]

[tool.ruff.format]
preview = true

[tool.coverage.report]
skip_empty = true

[tool.coverage.run]
branch = true
source = ["ecoli", "reconstruction", "runscripts", "validation", "wholecell"]



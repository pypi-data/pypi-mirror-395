Refactored settings management to support test isolation and improved maintainability, along with several bug fixes and general code quality enhancements.
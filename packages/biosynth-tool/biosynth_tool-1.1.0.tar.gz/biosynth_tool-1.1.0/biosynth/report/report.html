<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>BioSynth Report ðŸ§¬</title>
    <meta content="A flexible and comprehensive software app for design of synthetic DNA sequences without unwanted patterns"
          name="description">
    <meta content="Hadar Pur" name="author">

    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif:wght@400;700&family=Open+Sans:ital,wght@0,400;0,700;1,600&display=swap"
          rel="stylesheet">
    <script crossorigin="anonymous" defer
            integrity="sha384-0pzryjIRos8mFBWMzSSZApWtPl/5++eIfzYmTgBBmXYdhvxPc+XcFEk+zJwDgWbP"
            src="https://use.fontawesome.com/releases/v5.7.2/js/all.js"></script>

    <style>
        html, body {
            scroll-behavior: smooth;
            overflow-x: hidden;
            max-width: 100%;
            margin: 0;
            font-family: 'Open Sans', sans-serif;
            color: #333;
        }

        h1, h2, h3 {
            font-family: 'Noto Serif', serif;
            color: #333;
        }

        h1 {
            font-size: 39px;
            line-height: 42px;
            margin-bottom: 20px;
        }

        h2 {
            font-size: 28px;
            line-height: 30px;
            margin-bottom: 20px;
        }

        h3 {
            font-size: 18px;
            line-height: 30px;
            margin-bottom: 20px;
        }

        p {
            font-size: 16px;
            line-height: 24px;
            max-width: 100%;
            margin-right: auto;
            overflow-wrap: break-word;
        }

        pre {
            font-size: 16px;
            line-height: 24px;
            max-width: 75%;
            margin-right: auto;
            overflow-wrap: break-word;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        a:hover {
            text-decoration: underline;
        }

        .navbar {
            background-color: #fff;
            color: #fff;
            width: 100%;
            position: fixed;
            top: 0;
            z-index: 10;
            padding: 10px 0;
        }

        .navbar .row.content {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            max-width: 70rem;
            margin: auto;
            padding: 0 20px;
        }

        .navbar a {
            color: #000;
            margin: 10px;
            white-space: nowrap;
        }

        .container {
            margin-top: 130px;
            padding: 0 20px 0 20px;
        }

        .row.wrapper {
            display: flex;
            flex-wrap: nowrap;
            max-width: 70rem;
            margin: auto;
        }

        .sidepanel {
            flex: 0 0 200px;
            padding: 20px;
            position: relative;
        }

        .sidepanel a.title {
            font-weight: 600;
            display: block;
            margin: 20px 0 10px;
        }

        .sidepanel a.section {
            display: block;
            margin-bottom: 10px;
        }

        .nav-top {
            border-top: 8px solid #245076;
        }

        .divider {
            width: 40px;
            height: 4px;
            background: #245076;
            border-radius: 30px;
            margin: 20px 0;
        }

        .right-col {
            flex: 1;
            padding: 20px;
            min-width: 0; /* âœ… Allow shrinking below content width */
            margin-right: 20px;
        }


        .scrollable-paragraph {
            max-height: 200px;
            overflow-y: auto;
            font-size: 16px;
            font-family: monospace;
            white-space: nowrap;
            word-break: break-word;
            padding: 0; /* Remove internal padding */
            margin: 0; /* Remove external margin */
            list-style-position: inside; /* Optional: numbers inside the block */
        }

        .pre-scrollable-paragraph {
            max-height: 250px;
            overflow-y: auto;
            font-size: 16px;
            font-family: monospace;
            white-space: pre-wrap;
            word-break: break-word;
            padding: 0; /* Remove internal padding */
            margin: 0; /* Remove external margin */
            list-style-position: inside; /* Optional: numbers inside the block */
        }

        .scrollable-paragraph li {
            margin: 0; /* Remove spacing between items */
            padding: 0; /* Remove internal li padding */
            line-height: 0; /* Optional: tighter or looser lines */
            font-size: 16px;
        }

        .pre-scrollable-paragraph li {
            margin: 0; /* Remove spacing between items */
            padding: 0; /* Remove internal li padding */
            line-height: 0; /* Optional: tighter or looser lines */
            font-size: 16px;
        }

        .horizontal-scroll {
            white-space: nowrap;
            overflow-x: auto;
            font-size: 16px;
            height: fit-content;
            max-width: 100%;
        }

        .highlight-block {
            font-family: monospace;
            font-size: 16px;
            line-height: 24px;
            white-space: normal; /* âœ… allow wrapping */
            word-break: break-word; /* âœ… break long spans */
            overflow-y: auto;
            max-height: 250px; /* âœ… vertical scroll */
        }


        /* Scrollbar style */
        ::-webkit-scrollbar {
            width: 5px;
            height: 5px;
        }

        ::-webkit-scrollbar-track {
            box-shadow: inset 0 0 5px grey;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: #245076;
            border-radius: 10px;
        }

        /* Responsive styles */
        @media (max-width: 768px) {
            .row.wrapper {
                flex-direction: column;
                flex-wrap: wrap; /* âœ… Allow wrapping on small screens */
                padding: 0;
            }

            .sidepanel {
                width: 100%;
                margin-top: 120px; /* Same or more than navbar height */
                text-align: center;
                border-bottom: 1px solid #ccc;
                padding: 0;
            }

            .sidepanel a {
                display: inline-block;
                margin: 5px 10px;
            }

            .right-col {
                margin: 0;
                width: 95%;
                max-width: 95%; /* âœ… Force full width on small screens */
            }

            .navbar .row.content {
                flex-direction: column;
                align-items: center;
            }

            .navbar a {
                float: none;
                margin: 5px 0;
            }

            .divider {
                width: 50%;
                margin: 20px auto; /* centers it horizontally */
            }

            h1 {
                font-size: 28px;
            }

            h2 {
                font-size: 22px;
            }

            p, pre {
                font-size: 14px;
            }
        }

        /* Print-specific styling */
        @media print {
            body {
                padding-top: 0.5in;
            }

            /* Hide navbar and sidepanel in print */
            .sidepanel,
            .no-print {
                display: none !important;
            }

            .navbar {
                position: absolute;
                display: block !important;
                margin-bottom: 30px; /* space below navbar */
                padding-bottom: 10px;
                border-bottom: 8px solid #245076;
            }

            .navbar .row.content {
                flex-direction: row !important;
                justify-content: space-between !important;
                align-items: center !important;
                flex-wrap: nowrap !important;
            }

            .navbar a {
                color: #000;
                margin: 5px;
                white-space: nowrap;
            }

            .container {
                margin-right: 0.5in;
                margin-left: 0.5in;
            }

            .right-col {
                max-width: 100%;
                margin: 0;
                padding: 0;
            }

            .horizontal-scroll {
                white-space: nowrap;
                overflow-x: auto;
                height: fit-content;
                max-width: 90%;
            }

            h1 {
                font-size: 28px;
            }

            h2 {
                font-size: 22px;
            }

            p, pre {
                font-size: 14px;
            }

            .scrollable-paragraph {
                max-height: 100%;
            }

            .pre-scrollable-paragraph {
                max-height: 100%;
            }

            .divider {
                background: none !important;
                border-top: 4px solid #245076 !important;
                height: 0 !important;
                width: 50%;
                margin: 20px 0 !important;
            }

            /* Page layout */
            @page :first {
                margin: 0 0 1in 0; /* top, right, bottom, left */
            }

            @page {
                size: A4 portrait;
                margin: 1in 0 1in 0; /* top, right, bottom, left */
            }
        }

    </style>


</head>

<body>

<div class="navbar clear nav-top">
    <div class="row content">
        <a><img alt="logo" class="logo"
                src="https://raw.githubusercontent.com/HadarPur/RU-BioSynth/main/biosynth/images/BioSynth.png"
                style="height: 100px;"></a>
        <a href="https://www.runi.ac.il" target="_blank"><i class="fas fa-book"></i> runi.ac.il</a>
        <a href="mailto:hadar.pur@post.runi.ac.il" target="_blank"><i class="fas fa-paper-plane"></i>
            hadar.pur@post.runi.ac.il</a>
        <a><i class='fas fa-calendar-alt'></i> {{today_date}}</a>
    </div>
</div>

<div class="container">
    <div class="row wrapper">

        <div class="sidepanel">
            <a class="title" href="#">Input</a>
            <a class="section" href="#dna-sequence">Target Sequence</a>
            <a class="section" href="#unwanted-patterns">Unwanted Patterns</a>

            <div class="divider"></div>

            <a class="title" href="#elimination">Elimination</a>
            <a class="section" href="#elimination-process">Elimination Process</a>

            <div class="divider"></div>

            <a class="title" href="#results">Results</a>
            <a class="section" href="#dna-sequences-difference">DNA Sequences Difference</a>
            <a class="section" href="#dna-detailed_changes">Detailed substitutions relative to the target sequence</a>
            <a class="section" href="#optimized-dna-sequence">Optimized Sequence</a>
        </div>

        <div class="right-col">
            <div>
                <h1 id="dna-sequence">Input</h1>
                <h2>Target Sequence:</h2>
                <p class="pre-scrollable-paragraph" style="font-family: monospace;">{{input}}</p>
            </div>

            <div>
                <h2 id="unwanted-patterns">Unwanted Patterns:</h2>
                <p class="scrollable-paragraph">{{patterns}}</p>
            </div>

            <div class="divider" style="width:24%; margin:30px 0;"></div>

            <div>
                <h1 id="elimination">Elimination</h1>

                {% if num_of_coding_regions > 0 %}
                <p>The following ORFs were identified in the target sequence:</p>
                <div class="highlight-block pre-scrollable-paragraph">
                    {{ highlight_input | safe }}
                </div>

                <p>A total of {{ num_of_coding_regions }} ORFs have been identified:</p>
                <ol class="horizontal-scroll">
                    {% for key, value in regions_list -%}
                    <li value="{{ key }}">{{ value }}</li>
                    {% endfor %}
                </ol>

                {% if excluded_regions_list and excluded_regions_list|length > 0 %}
                <p>The specific ORFs that the user designated as non-coding are as follows:</p>
                <ol class="horizontal-scroll">
                    {% for key, value in excluded_regions_list -%}
                    <li value="{{ key }}">{{ value }}</li>
                    {% endfor %}
                </ol>
                <p>These coding regions will be reclassified as non-coding areas.</p>

                <p><br>The target sequence has been updated based on the selected coding regions:</p>
                <p class="highlight-block pre-scrollable-paragraph">{{ highlight_selected | safe }}</p>
                {% else %}
                    {% if execution_mode == 'GUI' %}
                        <p>All ORFs are assumed to be coding regions since none were selected using GUI.</p>
                    {% else %}
                        <p>All ORFs are assumed to be coding regions because BioSynth was executed using CLI.</p>
                    {% endif %}
                {% endif %}

                {% else %}
                <p>No ORFs were identified in the provided target sequence.</p>
                {% endif %}
            </div>

            <div>
                <h2 id="elimination-process">Elimination Process</h2>
                <p>{{elimination_process_description}}</p>
            </div>

            <div>
                <h3>Non-Coding regions:</h3>
                <p>{{non_coding_region_cost_description}}</p>
            </div>

            <div>
                <h3>Coding regions:</h3>
                <p>{{coding_region_cost_description}}</p>
            </div>

            <div class="divider" style="width:24%; margin:30px 0;"></div>

            <div>
                <h1 id="results">Results</h1>

                <h2 id="dna-sequences-difference">DNA Sequences Difference:</h2>
                <div class="horizontal-scroll">
                    <pre style="color: lightgray;">{{index_seq_str}}</pre>
                    <pre>{{marked_input_seq}}</pre>
                    <pre>{{marked_optimized_seq}}</pre>
                </div>
            </div>

            <div>
                <h2 id="dna-detailed_changes">Detailed substitutions relative to the target sequence:</h2>
                <div class="scrollable-paragraph">
                    <pre>{{detailed_changes}}</pre>
                </div>
            </div>

            <div>
                <h2 id="optimized-dna-sequence">Optimized Sequence:</h2>
                <p class="highlight-block pre-scrollable-paragraph">{{ highlight_optimized_selected | safe }}</p>
            </div>

        </div>

    </div>
</div>

</body>
</html>



<mxfile host="Electron" modified="2025-09-03T00:15:17.222Z" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/24.0.4 Chrome/120.0.6099.109 Electron/28.1.0 Safari/537.36" etag="4FJYRINfpESAMCRcWpKx" version="24.0.4" type="device">
  <diagram name="File Structure" id="file-structure">
    <mxGraphModel dx="1674" dy="844" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="ðŸ“ ORCA File Structure &amp; Model Workflow Flexibility" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1;fontColor=#1f4e79;" parent="1" vertex="1">
          <mxGeometry x="200" y="20" width="769" height="40" as="geometry" />
        </mxCell>
        <mxCell id="databank-title" value="ðŸ›ï¸ Databank Structure (db_scenario/)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=#1f4e79;" parent="1" vertex="1">
          <mxGeometry x="80" y="80" width="350" height="30" as="geometry" />
        </mxCell>
        <mxCell id="databank-structure" value="ðŸ“ db_scenario/&lt;br&gt;â”œâ”€â”€ ðŸ“„ orca_model_config.yaml     ðŸŽ›ï¸ Main Config&lt;br&gt;â”œâ”€â”€ ðŸ“Š orca_model_state.json      ðŸ“ˆ Runtime State&lt;br&gt;â”œâ”€â”€ ðŸ“ orca_20251030_172324.log   ðŸ“‹ Execution Log&lt;br&gt;â”‚&lt;br&gt;â”œâ”€â”€ ðŸ“‚ a1_popsim/                 ðŸ‘¥ Population Synthesis&lt;br&gt;â”‚   â”œâ”€â”€ ðŸ“ config/&lt;br&gt;â”‚   â”œâ”€â”€ ðŸ“ data/                  ðŸ“Š Input Data&lt;br&gt;â”‚   â””â”€â”€ ðŸ“ output/                ðŸ“¦ Step Results&lt;br&gt;â”‚&lt;br&gt;â”œâ”€â”€ ðŸ“‚ b1_activitysim/            ðŸŽ¯ Travel Demand Model&lt;br&gt;â”‚   â”œâ”€â”€ ðŸ“ configs/&lt;br&gt;â”‚   â”œâ”€â”€ ðŸ“ data/&lt;br&gt;â”‚   â””â”€â”€ ðŸ“ outputs/&lt;br&gt;â”‚&lt;br&gt;â”œâ”€â”€ ðŸ“‚ b2_cvm/                    ðŸš› Commercial Vehicle Model&lt;br&gt;â”‚   â”œâ”€â”€ ðŸ“ configs/&lt;br&gt;â”‚   â”œâ”€â”€ ðŸ“ data/&lt;br&gt;â”‚   â””â”€â”€ ðŸ“ outputs/&lt;br&gt;â”‚&lt;br&gt;â”œâ”€â”€ ðŸ“‚ b3_quetzal/                ðŸŒ Traffic Assignment&lt;br&gt;â”‚   â”œâ”€â”€ ðŸ“ demand/&lt;br&gt;â”‚   â”œâ”€â”€ ðŸ“ supply/&lt;br&gt;â”‚   â””â”€â”€ ðŸ“ outputs/&lt;br&gt;â”‚&lt;br&gt;â””â”€â”€ ðŸ“¦ outputs/                   ðŸ—ƒï¸ Archived Results&lt;br&gt;    â”œâ”€â”€ ðŸ—œï¸ a1_popsim_outputs_iter1.zip&lt;br&gt;    â”œâ”€â”€ ðŸ—œï¸ a1_popsim_logs_iter1.zip&lt;br&gt;    â”œâ”€â”€ ðŸ—œï¸ b1_activitysim_outputs_iter1.zip&lt;br&gt;    â”œâ”€â”€ ðŸ—œï¸ b1_activitysim_trips_iter1.zip&lt;br&gt;    â”œâ”€â”€ ðŸ—œï¸ b2_cvm_outputs_iter1.zip&lt;br&gt;    â””â”€â”€ ðŸ—œï¸ b3_quetzal_skims_iterN.zip" style="rounded=0&#xa;;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=10;align=left;verticalAlign=top;fontFamily=Courier New;" parent="1" vertex="1">
          <mxGeometry x="80" y="120" width="350" height="410" as="geometry" />
        </mxCell>
        <mxCell id="config-title" value="âš™ï¸ Configuration Flexibility" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=#1f4e79;" parent="1" vertex="1">
          <mxGeometry x="480" y="80" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yaml-config" value="ðŸ“„ orca_model_config.yaml&lt;br&gt;&lt;br&gt;ðŸ”§ Configurable Elements:&lt;br&gt;â€¢ Model execution sequence&lt;br&gt;â€¢ Environment paths&lt;br&gt;â€¢ Command templates&lt;br&gt;â€¢ Input data sources&lt;br&gt;â€¢ Output archive patterns&lt;br&gt;â€¢ Cloud storage settings&lt;br&gt;â€¢ Iteration control&lt;br&gt;â€¢ Performance monitoring" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="480" y="120" width="300" height="150" as="geometry" />
        </mxCell>
        <mxCell id="env-vars" value="ðŸ”§ Environment Variables&lt;br&gt;&lt;br&gt;â€¢ ORCA_POPSIM_ENV&lt;br&gt;â€¢ ORCA_ACTIVITYSIM_ENV&lt;br&gt;â€¢ ORCA_CVM_ENV&lt;br&gt;â€¢ ORCA_QUETZAL_ENV&lt;br&gt;â€¢ UPLOAD_OUTPUTS_ONLY" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="480" y="290" width="300" height="100" as="geometry" />
        </mxCell>
        <mxCell id="cli-overrides" value="ðŸ’» Command-Line Overrides&lt;br&gt;&lt;br&gt;â€¢ --iterations N&lt;br&gt;â€¢ --steps component1 component2&lt;br&gt;â€¢ --mode cloud_production&lt;br&gt;â€¢ --project custom_name&lt;br&gt;â€¢ --dry-run&lt;br&gt;â€¢ --overwrite" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="480" y="410" width="300" height="120" as="geometry" />
        </mxCell>
        <mxCell id="workflow-title" value="ðŸš€ Flexible Model Workflow Examples" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=#1f4e79;" parent="1" vertex="1">
          <mxGeometry x="80" y="860" width="400" height="30" as="geometry" />
        </mxCell>
        <mxCell id="workflow1-title" value="ðŸŽ¯ Standard Transportation Model" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="80" y="900" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="workflow1" value="1ï¸âƒ£ PopSim â†’ 2ï¸âƒ£ ActivitySim â†’ 3ï¸âƒ£ CVM â†’ 4ï¸âƒ£ Quetzal" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="80" y="930" width="400" height="40" as="geometry" />
        </mxCell>
        <mxCell id="workflow2-title" value="âš¡ Quick Testing (Skip PopSim)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="80" y="990" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="workflow2" value="1ï¸âƒ£ ActivitySim â†’ 2ï¸âƒ£ CVM â†’ 3ï¸âƒ£ Quetzal" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=12;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="80" y="1020" width="400" height="40" as="geometry" />
        </mxCell>
        <mxCell id="workflow3-title" value="ðŸ”¬ Assignment Only (Pre-computed Demand)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="80" y="1080" width="300" height="20" as="geometry" />
        </mxCell>
        <mxCell id="workflow3" value="1ï¸âƒ£ Quetzal Only" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="80" y="1110" width="400" height="40" as="geometry" />
        </mxCell>
        <mxCell id="python-title" value="ðŸ Python Environment Flexibility" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=#1f4e79;" parent="1" vertex="1">
          <mxGeometry x="530" y="860" width="350" height="30" as="geometry" />
        </mxCell>
        <mxCell id="env-example1" value="ðŸ  Local Development&lt;br&gt;&lt;br&gt;ORCA_ACTIVITYSIM_ENV=&lt;br&gt;C:\\miniconda3\\envs\\activitysim&lt;br&gt;&lt;br&gt;ORCA_QUETZAL_ENV=&lt;br&gt;C:\\miniconda3\\envs\\quetzal" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;align=left;verticalAlign=top;fontFamily=Courier New;" parent="1" vertex="1">
          <mxGeometry x="530" y="900" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="env-example2" value="â˜ï¸ Cloud Production&lt;br&gt;&lt;br&gt;ORCA_ACTIVITYSIM_ENV=&lt;br&gt;/opt/conda/envs/activitysim&lt;br&gt;&lt;br&gt;ORCA_QUETZAL_ENV=&lt;br&gt;/opt/conda/envs/quetzal" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;align=left;verticalAlign=top;fontFamily=Courier New;" parent="1" vertex="1">
          <mxGeometry x="750" y="900" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="env-example3" value="ðŸ”¬ Research Cluster&lt;br&gt;&lt;br&gt;ORCA_ACTIVITYSIM_ENV=&lt;br&gt;/apps/activitysim/2.0.2&lt;br&gt;&lt;br&gt;ORCA_QUETZAL_ENV=&lt;br&gt;/apps/quetzal/latest" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;align=left;verticalAlign=top;fontFamily=Courier New;" parent="1" vertex="1">
          <mxGeometry x="530" y="1020" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="env-example4" value="ðŸ³ Docker Containers&lt;br&gt;&lt;br&gt;ORCA_ACTIVITYSIM_ENV=&lt;br&gt;docker run activitysim:latest&lt;br&gt;&lt;br&gt;ORCA_QUETZAL_ENV=&lt;br&gt;docker run quetzal:latest" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;align=left;verticalAlign=top;fontFamily=Courier New;" parent="1" vertex="1">
          <mxGeometry x="750" y="1020" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="dataflow-title" value="ðŸ“Š Shared Input Data Management" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#1f4e79;" parent="1" vertex="1">
          <mxGeometry x="820" y="80" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="shared-data" value="ðŸ”— Centralized Input Data&lt;br&gt;&lt;br&gt;ðŸ“ ABM/BaseNetworks/Inputs/&lt;br&gt;â”œâ”€â”€ ðŸ™ï¸ landuse_synpop_2017.zip&lt;br&gt;â”œâ”€â”€ ðŸ™ï¸ landuse_synpop_2023.zip&lt;br&gt;â”œâ”€â”€ ðŸŒ base_network_*.txt&lt;br&gt;â”œâ”€â”€ ðŸŒ‰ bridge_crossing_gy.csv&lt;br&gt;â”œâ”€â”€ ðŸ“Š dist_factors_gy.csv.gz&lt;br&gt;â”œâ”€â”€ ðŸ‘¥ PopSim/&lt;br&gt;â””â”€â”€ ðŸŽ¯ ActivitySim/&lt;br&gt;&lt;br&gt;â¬‡ï¸ Automatically copied to all&lt;br&gt;   sub-component directories" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;align=left;verticalAlign=top;fontFamily=Courier New;" parent="1" vertex="1">
          <mxGeometry x="820" y="120" width="280" height="200" as="geometry" />
        </mxCell>
        <mxCell id="output-archives" value="ðŸ“¦ Output Archive Patterns&lt;br&gt;&lt;br&gt;ðŸŽ¯ ActivitySim:&lt;br&gt;â€¢ outputs: output/*.csv, *.h5&lt;br&gt;â€¢ trips: output/final_trips.csv&lt;br&gt;&lt;br&gt;ðŸš› CVM:&lt;br&gt;â€¢ outputs: output/*.csv&lt;br&gt;&lt;br&gt;ðŸŒ Quetzal:&lt;br&gt;â€¢ skims: outputs/skims/*.omx&lt;br&gt;â€¢ results: outputs/assignment/*&lt;br&gt;&lt;br&gt;âœ¨ Flexible patterns support&lt;br&gt;   any file structure!" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="820" y="340" width="280" height="190" as="geometry" />
        </mxCell>
        <mxCell id="features-box" value="ðŸŒŸ Key Flexibility Features&lt;br&gt;&lt;br&gt;âœ… Any Python model workflow&lt;br&gt;âœ… Multiple environment support&lt;br&gt;âœ… Configurable execution order&lt;br&gt;âœ… Flexible file patterns&lt;br&gt;âœ… Custom command templates&lt;br&gt;âœ… Environment variable overrides&lt;br&gt;âœ… Command-line customization&lt;br&gt;âœ… Shared input data management&lt;br&gt;âœ… Multi-archive output support&lt;br&gt;âœ… Cross-platform compatibility" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="530" y="1140" width="280" height="180" as="geometry" />
        </mxCell>
        <mxCell id="benefits-box" value="ðŸŽ¯ Benefits for Model Developers&lt;br&gt;&lt;br&gt;ðŸš€ Rapid prototyping &amp; testing&lt;br&gt;ðŸ”§ Easy integration of new models&lt;br&gt;ðŸŒ Support for different environments&lt;br&gt;ðŸ“Š Automatic data management&lt;br&gt;â˜ï¸ Seamless local-to-cloud transition&lt;br&gt;ðŸ”„ Iterative model development&lt;br&gt;ðŸ“ˆ Performance monitoring&lt;br&gt;ðŸ›¡ï¸ Robust error handling&lt;br&gt;ðŸ“ Comprehensive logging&lt;br&gt;ðŸ‘¥ Multi-user collaboration" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="820" y="550" width="280" height="170" as="geometry" />
        </mxCell>
        <mxCell id="additional-title" value="ðŸ› ï¸ Advanced Features" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#1f4e79;" parent="1" vertex="1">
          <mxGeometry x="480" y="560" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="additional-features" value="ðŸ”„ Resume from any step&lt;br&gt;ðŸ“Š Performance profiling&lt;br&gt;ðŸ—œï¸ Automatic compression&lt;br&gt;ðŸ§¹ Cleanup patterns&lt;br&gt;ðŸ” Dry-run mode&lt;br&gt;âš ï¸ Error dump collection&lt;br&gt;ðŸŽ›ï¸ Multiple operational modes&lt;br&gt;ðŸ“‹ State tracking &amp; recovery" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="480" y="600" width="280" height="120" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>

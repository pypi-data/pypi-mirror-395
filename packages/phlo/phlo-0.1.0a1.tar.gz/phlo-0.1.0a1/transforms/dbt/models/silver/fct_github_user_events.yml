# fct_github_user_events.yml - Schema and business logic tests for GitHub user events fact table

version: 2

models:
  - name: fct_github_user_events
    description: "Silver layer fact table for enriched GitHub user events"
    meta:
      dagster:
        asset_key: ["fct_github_user_events"]
    columns:
      - name: event_id
        description: "Unique identifier for the GitHub event"
        tests:
          - not_null
          - unique

      - name: event_type
        description: "Type of GitHub event"
        tests:
          - not_null
          - accepted_values:
              values: ['CommitCommentEvent', 'CreateEvent', 'DeleteEvent', 'ForkEvent',
                      'GollumEvent', 'IssueCommentEvent', 'IssuesEvent', 'MemberEvent',
                      'PublicEvent', 'PullRequestEvent', 'PullRequestReviewEvent',
                      'PullRequestReviewCommentEvent', 'PushEvent', 'ReleaseEvent',
                      'SponsorshipEvent', 'WatchEvent']

      - name: event_category
        description: "Categorized event type"
        tests:
          - not_null
          - accepted_values:
              values: ['code_contribution', 'issue_management', 'pull_request',
                      'repository_management', 'social', 'collaboration', 'release_management',
                      'documentation', 'visibility', 'other']

      - name: actor_login
        description: "GitHub username of the actor"
        tests:
          - not_null

      - name: actor_id
        description: "GitHub actor ID"
        tests:
          - not_null

      - name: repo_name
        description: "Repository name"
        tests:
          - not_null

      - name: repo_full_name
        description: "Full repository name (owner/repo)"
        tests:
          - not_null

      - name: public
        description: "Whether the event is public"
        tests:
          - not_null
          - accepted_values:
              values: [true, false]

      - name: is_repo_public
        description: "Whether the repository is public"
        tests:
          - not_null
          - accepted_values:
              values: [true, false]

      - name: involves_organization
        description: "Whether the event involves an organization"
        tests:
          - not_null
          - accepted_values:
              values: [true, false]

      - name: created_at
        description: "Event creation timestamp"
        tests:
          - not_null

      - name: event_date
        description: "Date of the event"
        tests:
          - not_null

      - name: hour_of_day
        description: "Hour when event occurred (0-23)"
        tests:
          - not_null
          - accepted_values:
              values: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]

      - name: day_of_week
        description: "Day of week (1-7, Monday-Sunday)"
        tests:
          - not_null
          - accepted_values:
              values: [1, 2, 3, 4, 5, 6, 7]

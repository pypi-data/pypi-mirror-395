# fct_daily_glucose_metrics.yml - Schema tests for daily glucose metrics fact table

version: 2

models:
  - name: fct_daily_glucose_metrics
    description: "Daily glucose metrics fact table"
    columns:
      - name: reading_date
        description: "Date of glucose readings"
        tests:
          - not_null
          - unique

      - name: day_name
        description: "Name of the day"
        tests:
          - not_null
          - accepted_values:
              values: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']

      - name: day_of_week
        description: "Day of week (1-7)"
        tests:
          - not_null
          - accepted_values:
              values: [1, 2, 3, 4, 5, 6, 7]
              quote: false

      - name: week_of_year
        description: "Week of year"
        tests:
          - not_null

      - name: month
        description: "Month number"
        tests:
          - not_null
          - accepted_values:
              values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
              quote: false

      - name: year
        description: "Year"
        tests:
          - not_null

      - name: reading_count
        description: "Number of readings for the day"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: bigint

      - name: avg_glucose_mg_dl
        description: "Average glucose level"
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: double

      - name: min_glucose_mg_dl
        description: "Minimum glucose level"
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: bigint

      - name: max_glucose_mg_dl
        description: "Maximum glucose level"
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: bigint

      - name: time_in_range_pct
        description: "Percentage of time in range"
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: double

      - name: estimated_a1c_pct
        description: "Estimated A1C percentage"
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: double

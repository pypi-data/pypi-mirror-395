version: 3
sources:
  - name: postgres
    kind: postgres
    tables:
      - table:
          name: glucose_overview
          schema: api
        object_relationships: []
        select_permissions:
          - role: analyst
            permission:
              columns:
                - reading_date
                - day_name
                - week_of_year
                - month
                - year
                - reading_count
                - avg_glucose_mg_dl
                - min_glucose_mg_dl
                - max_glucose_mg_dl
                - stddev_glucose_mg_dl
                - time_in_range_pct
                - time_below_range_pct
                - time_above_range_pct
                - estimated_a1c_pct
                - estimated_a1c_7d_avg
                - glucose_change_from_prev_day
                - coefficient_of_variation
              filter: {}
          - role: admin
            permission:
              columns: '*'
              filter: {}

      - table:
          name: hourly_patterns
          schema: api
        object_relationships: []
        select_permissions:
          - role: analyst
            permission:
              columns:
                - hour_of_day
                - avg_glucose_mg_dl
                - reading_count
                - coefficient_of_variation
              filter: {}
          - role: admin
            permission:
              columns: '*'
              filter: {}

# CLI commands used to generate this metadata:
# phlo api hasura track --schema api
# phlo api hasura export --output .phlo/api/hasura-metadata.yaml
#
# To apply this metadata:
# phlo api hasura apply --input .phlo/api/hasura-metadata.yaml

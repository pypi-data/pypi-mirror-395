import{g as X,p as Y}from"./chunk-SVHROGNI.js";import{I as k,M as R,O as p}from"./chunk-DLJYFRIS.js";import{x as w}from"./chunk-MAT3H5WR.js";import"./chunk-KYPE3LET.js";function C(){let t=this.getObject(),a=t.fPhimin===0&&t.fPhimax===360,l=t._typename==="TCrown";this.createAttLine({attr:t}),this.createAttFill({attr:t});let d=this.createG(),s=this.getAxisToSvgFunc(),n=s.x(t.fX1),c=s.y(t.fY1),o=l&&t.fR1<=0?s.x(t.fX1+t.fR2)-n:s.x(t.fX1+t.fR1)-n,f=c-s.y(t.fY1+t.fR2),r=Math.PI/180,e="";if(l&&t.fR1>0){let h=t.fYXRatio??1,i=o,x=h*f,$=h*(c-s.y(t.fY1+t.fR1)),y=s.x(t.fX1+t.fR2)-n;if(a)e=`M${-i},0A${i},${$},0,1,0,${i},0A${i},${$},0,1,0,${-i},0M${-y},0A${y},${x},0,1,0,${y},0A${y},${x},0,1,0,${-y},0`;else{let A=t.fPhimax-t.fPhimin>=180?1:0,g=t.fPhimin*r,u=t.fPhimax*r,v=Math.round(i*Math.cos(g)),T=Math.round($*Math.sin(g)),P=Math.round(i*Math.cos(u)),S=Math.round($*Math.sin(u)),M=Math.round(y*Math.cos(g)),m=Math.round(x*Math.sin(g)),O=Math.round(y*Math.cos(u)),G=Math.round(x*Math.sin(u));e=`M${P},${S}A${i},${$},0,${A},0,${v},${T}L${M},${m}A${y},${x},0,${A},1,${O},${G}Z`}}else if(t.fTheta===0)if(a)e=`M${-o},0A${o},${f},0,1,0,${o},0A${o},${f},0,1,0,${-o},0Z`;else{let h=Math.round(o*Math.cos(t.fPhimin*r)),i=Math.round(f*Math.sin(t.fPhimin*r)),x=Math.round(o*Math.cos(t.fPhimax*r)),$=Math.round(f*Math.sin(t.fPhimax*r));e=`M0,0L${h},${i}A${o},${f},0,1,1,${x},${$}Z`}else{let h=Math.cos(t.fTheta*r),i=Math.sin(t.fTheta*r),x=t.fPhimin*r,$=t.fPhimax*r,y=200,A=($-x)/(y-(a?0:1)),g=0,u=0;a||(e="M0,0");for(let v=0;v<y;++v){let T=x+v*A,P=t.fR1*Math.cos(T),S=t.fR2*Math.sin(T),M=s.x(t.fX1+P*h-S*i)-n,m=s.y(t.fY1+P*i+S*h)-c;e?g===M?e+=`v${m-u}`:u===m?e+=`h${M-g}`:e+=`l${M-g},${m-u}`:e=`M${M},${m}`,g=M,u=m}e+="Z"}this.x=n,this.y=c,p(d.append("svg:path"),n,c).attr("d",e).call(this.lineatt.func).call(this.fillatt.func),Y(this),X(this),this.moveDrag=function(h,i){this.x+=h,this.y+=i,p(this.getG().select("path"),this.x,this.y)},this.moveEnd=function(h){if(h)return;let i=this.getObject();i.fX1=this.svgToAxis("x",this.x),i.fY1=this.svgToAxis("y",this.y),this.submitCanvExec(`SetX1(${i.fX1});;SetY1(${i.fY1});;Notify();;`)}}function D(){let t=this.createG(),a=this.getObject(),l=a.fPieSlices.length,d=this.axisToSvg("x",a.fX),s=this.axisToSvg("y",a.fY),n=this.axisToSvg("x",a.fX+a.fRadius)-d,c=this.axisToSvg("y",a.fY+a.fRadius)-s;p(t,d,s);let o=0,f=a.fAngularOffset*Math.PI/180,r=Math.round(n*Math.cos(f)),e=Math.round(c*Math.sin(f));for(let h=0;h<l;h++)o+=a.fPieSlices[h].fValue;for(let h=0;h<l;h++){let i=a.fPieSlices[h];this.createAttLine({attr:i}),this.createAttFill({attr:i}),f+=i.fValue/o*2*Math.PI;let x=Math.round(n*Math.cos(f)),$=Math.round(c*Math.sin(f));t.append("svg:path").attr("d",`M0,0L${r},${e}A${n},${c},0,0,0,${x},${$}z`).call(this.lineatt.func).call(this.fillatt.func),r=x,e=$}}function F(){let t=this.getObject(),a=w(14);this.isndc=t.TestBit(a);let l=new k(this.getDrawOpt()),d=this.isndc?!1:l.check("FRAME"),s=d&&this.getFramePainter()?.swap_xy();this.createAttMarker({attr:t});let n=this.createG(d?"frame2d":void 0),c=this.axisToSvg("x",t.fX,this.isndc),o=this.axisToSvg("y",t.fY,this.isndc);s&&([c,o]=[o,c]);let f=this.markeratt.create(c,o);f&&n.append("svg:path").attr("d",f).call(this.markeratt.func),!l.check("NO_INTERACTIVE")&&(Y(this),X(this),this.dx=this.dy=0,this.moveDrag=function(r,e){this.dx+=r,this.dy+=e,this.getG()&&p(this.getG().select("path"),this.dx,this.dy)},this.moveEnd=function(r){if(r||!this.getG())return;let e=this.getObject(),h=this.svgToAxis("x",this.axisToSvg("x",e.fX,this.isndc)+this.dx,this.isndc),i=this.svgToAxis("y",this.axisToSvg("y",e.fY,this.isndc)+this.dy,this.isndc);s&&([h,i]=[i,h]),e.fX=h,e.fY=i,this.submitCanvExec(`SetX(${h});;SetY(${i});;Notify();;`),this.redraw()})}function I(){let t=this.getObject(),a=this.getAxisToSvgFunc();this.createAttMarker({attr:t});let l=this.createG(),d="";for(let s=0;s<=t.fLastPoint;++s)d+=this.markeratt.create(a.x(t.fX[s]),a.y(t.fY[s]));d&&l.append("svg:path").attr("d",d).call(this.markeratt.func),Y(this),X(this),this.dx=this.dy=0,this.moveDrag=function(s,n){this.dx+=s,this.dy+=n,this.getG()&&p(this.getG().select("path"),this.dx,this.dy)},this.moveEnd=function(s){if(s||!this.getG())return;let n=this.getObject(),c=this.getAxisToSvgFunc(),o="";for(let f=0;f<=n.fLastPoint;++f){let r=this.svgToAxis("x",c.x(n.fX[f])+this.dx),e=this.svgToAxis("y",c.y(n.fY[f])+this.dy);n.fX[f]=r,n.fY[f]=e,o+=`SetPoint(${f},${r},${e});;`}this.submitCanvExec(o+"Notify();;"),this.redraw()}}function L(t,a,l){let d=new R(t),s=d.selectDom(),n=s.append("img").attr("src",a.fName).attr("title",a.fTitle||a.fName);return l&&l.indexOf("scale")>=0?n.style("width","100%").style("height","100%"):l&&l.indexOf("center")>=0&&(s.style("position","relative"),n.attr("style","margin: 0; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);")),d.setTopPainter(),d}export{C as drawEllipse,L as drawJSImage,F as drawMarker,D as drawPie,I as drawPolyMarker};

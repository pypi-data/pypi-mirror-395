import{b as g}from"./chunk-3Y4HYQCO.js";import{d as P}from"./chunk-STN7OMLL.js";import"./chunk-JFO4ENDF.js";import"./chunk-3W3OTHNE.js";import{f as _}from"./chunk-HB357Z3Y.js";import"./chunk-FENW22PV.js";import"./chunk-K2P6CES6.js";import"./chunk-LNTKXTVM.js";import"./chunk-MFPRCIVI.js";import"./chunk-SVHROGNI.js";import{B as x,ea as S}from"./chunk-DLJYFRIS.js";import{f as C,gb as h,lb as d,ra as m}from"./chunk-MAT3H5WR.js";import{k as l}from"./chunk-KYPE3LET.js";var y=class H extends g{#e;#t;cleanup(){this.clearHistPalette(),this.#t=void 0,super.cleanup()}getGraph(){return this.getObject()?.fGraph}getContour(){return this.#t}isScatter(){return!0}getHistRangeMargin(){return this.getObject()?.fMargin??.1}drawAxisHisto(){return l(this,null,function*(){let e=this.isDummyHistogram("x"),i=this.isDummyHistogram("y"),t=this.createHistogram(e,i);return P.draw(this.getDrawDom(),t,this.getOptions().Axis+";IGNORE_PALETTE")})}getPalette(){let e=this.getGraph(),i=e?.fFunctions?.arr?.find(t=>t._typename===m);if(!i&&e){i=d(m);let t=this.get_fp();Object.assign(i,{fX1NDC:t.fX2NDC+.005,fX2NDC:t.fX2NDC+.05,fY1NDC:t.fY1NDC,fY2NDC:t.fY2NDC,fInit:1,$can_move:!0}),Object.assign(i.fAxis,{fChopt:"+",fLineColor:1,fLineSyle:1,fLineWidth:1,fTextAngle:0,fTextAlign:11,fNdiv:510}),e.fFunctions.AddFirst(i,"")}return i}_updateMembers(e,i){return e.fBits=i.fBits,e.fTitle=i.fTitle,e.fNpoints=i.fNpoints,e.fColor=i.fColor,e.fSize=i.fSize,e.fMargin=i.fMargin,e.fMinMarkerSize=i.fMinMarkerSize,e.fMaxMarkerSize=i.fMaxMarkerSize,super._updateMembers(e.fGraph,i.fGraph)}getZaxis(){return this.getHistogram()?.fZaxis}canZoomInside(e,i,t){if(e!=="z")return super.canZoomInside(e,i,t);let a=this.#t?.getLevels();if(!a)return!1;for(let f=0;f<a.length-1;++f)if(i<=a[f]&&t>=a[f+1])return!0;return!1}getHistPalette(e){let i=e?null:this.#e;if(i)return i;let t=this.getPadPainter();return C(t?.getCustomPalette)&&(i=t.getCustomPalette()),i||(i=x(this.getOptions().Palette,t?.isGrayscale())),this.#e=i,i}clearHistPalette(){this.#e=void 0}drawGraph(){return l(this,null,function*(){let e=this.get_fp(),i=this.getMainPainter(),t=this.getObject(),a=this.getHistogram(),f=1,u=0,p;if(!e||!i||!t)return;if(t.fColor){let n=this.getPalette();n&&(n.$main_painter=this),p=this.getHistPalette();let r=t.fColor[0],s=t.fColor[0];for(let o=1;o<t.fColor.length;++o)r=Math.min(r,t.fColor[o]),s=Math.max(s,t.fColor[o]);s<=r?s=r<0?.9*r:r>0?1.1*r:1:r>0&&r<.3*s&&(r=0),this.#t=new _(r,s),this.#t.createNormal(30),this.#t.configIndicies(0,0),e.zmin=r,e.zmax=s,!e.zoomChangedInteractive("z")&&a&&a.fMinimum!==h&&a.fMaximum!==h&&(e.zoom_zmin=a.fMinimum,e.zoom_zmax=a.fMaximum)}if(t.fSize){let n=t.fSize[0],r=t.fSize[0];for(let s=1;s<t.fSize.length;++s)n=Math.min(n,t.fSize[s]),r=Math.max(r,t.fSize[s]);r<=n&&(r=n<0?.9*n:n>0?1.1*n:1),f=(t.fMaxMarkerSize-t.fMinMarkerSize)/(r-n),u=n}let N=this.createG(!e.pad_layer),c=e.getGrFuncs(),k=e.zoom_zmin!==e.zoom_zmax&&t.fColor,z=this._getBins();for(let n=0;n<z.length;++n){if(k&&(t.fColor[n]<e.zoom_zmin||t.fColor[n]>e.zoom_zmax))continue;let r=z[n],s=c.grx(r.x),o=c.gry(r.y),D=t.fSize?t.fMinMarkerSize+f*(t.fSize[n]-u):t.fMarkerSize,G=t.fColor?this.#t.getPaletteColor(p,t.fColor[n]):this.getColor(t.fMarkerColor),M=new S({color:G,size:D,style:t.fMarkerStyle});N.append("svg:path").attr("d",M.create(s,o)).call(M.func)}return this})}static draw(e,i,t){return l(this,null,function*(){return g._drawGraph(new H(e,i),t)})}};export{y as TScatterPainter};

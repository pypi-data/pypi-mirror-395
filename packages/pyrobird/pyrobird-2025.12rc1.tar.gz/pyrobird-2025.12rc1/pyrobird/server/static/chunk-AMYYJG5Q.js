import{b as w}from"./chunk-LNTKXTVM.js";import{g as u,p as _}from"./chunk-SVHROGNI.js";import{I as m,O as g,ka as T}from"./chunk-DLJYFRIS.js";import{ua as x,va as p,wa as l,x as d}from"./chunk-MAT3H5WR.js";import{k as h}from"./chunk-KYPE3LET.js";var O=d(14),v=class y extends T{_redrawText(e,t,i){return h(this,null,function*(){let s=this.getObject(),a=this.getPadPainter(),b=this.getFramePainter(),n=s.fName.startsWith("http://")||s.fName.startsWith("https://"),f=1,c=!1;this.createAttText({attr:s}),i==="3d"||s.TestBit(O)?this.isndc=!0:!i&&a?.getRootPad(!0)?c=new m(this.getDrawOpt()).check("FRAME"):i||(this.isndc=!0,e=t=.5,s.fTextAlign=22);let r=this.createG(c?"frame2d":void 0,n);r.attr("transform",null),e=this.axisToSvg("x",e,this.isndc),t=this.axisToSvg("y",t,this.isndc),this.swap_xy=c&&b?.swap_xy(),this.swap_xy&&([e,t]=[t,e]);let o=this.textatt.createArg({x:e,y:t,text:s.fTitle,latex:0});return this.matchObjectType(p)||i?o.latex=1:this.matchObjectType(l)&&(o.latex=2,f=.8),n&&(r.attr("href",s.fName),this.isBatchMode()||r.append("svg:title").text(`link on ${s.fName}`)),this.startTextDrawingAsync(this.textatt.font,this.textatt.getSize(a,f)).then(()=>this.drawText(o)).then(()=>this.finishTextDrawing()).then(()=>this.isBatchMode()?this:a.isButton()&&!a.isEditable()?(r.on("click",()=>this.getCanvPainter().selectActivePad(a)),this):(Object.assign(this,{pos_x:e,pos_y:t,pos_dx:0,pos_dy:0}),i!=="3d"&&u(this,!0,n),_(this),this.matchObjectType(x)&&r.style("cursor","pointer").on("click",()=>this.submitCanvExec("ExecuteEvent(kButton1Up, 0, 0);;")),this))})}redraw(){return h(this,null,function*(){return this._redrawText(this.getObject().fX,this.getObject().fY)})}moveDrag(e,t){this.pos_dx+=e,this.pos_dy+=t,g(this.getG(),this.pos_dx,this.pos_dy)}moveEnd(e){if(e)return;let t=this.getObject(),i=this.svgToAxis("x",this.pos_x+this.pos_dx,this.isndc),s=this.svgToAxis("y",this.pos_y+this.pos_dy,this.isndc);this.swap_xy&&([i,s]=[s,i]),t.fX=i,t.fY=s,this.submitCanvExec(`SetX(${i});;SetY(${s});;`)}fillContextMenuItems(e){let t=this.getObject();e.add("Change text",()=>e.input("Enter new text",t.fTitle).then(i=>{t.fTitle=i,this.interactiveRedraw("pad",`exec:SetTitle("${i}")`)}))}static draw(e,t,i){return h(this,null,function*(){let s=new y(e,t,i);return w(s,!1).then(()=>s.redraw())})}};export{v as a};

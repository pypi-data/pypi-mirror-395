import{e as o}from"./chunk-WGXGZ22G.js";import"./chunk-RHEMMLWD.js";import{b as u}from"./chunk-JFO4ENDF.js";import"./chunk-3W3OTHNE.js";import"./chunk-HB357Z3Y.js";import"./chunk-FENW22PV.js";import"./chunk-K2P6CES6.js";import"./chunk-LNTKXTVM.js";import"./chunk-MFPRCIVI.js";import"./chunk-SVHROGNI.js";import{I as m,ka as c}from"./chunk-DLJYFRIS.js";import{Aa as f,d as h}from"./chunk-MAT3H5WR.js";import{k as n}from"./chunk-KYPE3LET.js";var d=class a extends c{#t;#i;#r;#e;constructor(e,t,i){super(e,t,i),this.decodeOptions(i),this.#i="grtime_"+h.id_counter++}redraw(){this.#t===void 0&&this.startDrawing()}decodeOptions(e){let t=new m(e||"REPEAT");this.setOptions({once:t.check("ONCE"),repeat:t.check("REPEAT"),first:t.check("FIRST")}),this.storeDrawOpt(e)}drawPrimitives(e){return n(this,null,function*(){let t=this.getObject()?.fSteps.arr[this.#t];if(!t||e>=t.arr.length)return;let i=t.arr[e],r=t.opt[e]+(i._typename===f?";no_interactive":"");return o(this.getPadPainter(),i,r).then(s=>(s&&(s.$grtimeid=this.#i,s.$grstep=this.#t),this.drawPrimitives(e+1)))})}continueDrawing(){let e=this.getObject(),t=this.getOptions();if(t.first){this.#t=void 0;return}if(this.#r){this.#r=void 0;let i=this.getPadPainter();if(!i){this.#t=void 0;return}this.drawPrimitives(0).then(()=>{i.cleanPrimitives(r=>r.$grtimeid===this.#i&&r.$grstep!==this.#t),this.continueDrawing()})}else if(this.#e)clearTimeout(this.#e),this.#e=void 0,this.#r=!0,requestAnimationFrame(()=>this.continueDrawing());else{let i=Math.max(e.fSleepTime,10);if(++this.#t>e.fSteps.arr.length)if(t.repeat)this.#t=0,i=Math.max(5e3,5*i);else{this.#t=void 0;return}this.#e=setTimeout(()=>this.continueDrawing(),i)}}startDrawing(){return this.#t=0,this.drawPrimitives(0).then(()=>(this.continueDrawing(),this))}static draw(e,t,i){return n(this,null,function*(){if(!t.fFrame)return console.error("Frame histogram not exists"),null;let r=new a(e,t,i);if(r.getMainPainter())return console.error("Cannot draw graph time on top of other histograms"),null;if(!t.fFrame.fTitle&&t.fTitle){let s=t.fTitle.split(";");t.fFrame.fTitle=s[0],s[1]&&(t.fFrame.fXaxis.fTitle=s[1]),s[2]&&(t.fFrame.fYaxis.fTitle=s[2])}return u.draw(e,t.fFrame,"").then(()=>(r.addToPadPrimitives(),r.startDrawing()))})}};function T(a,e){return n(this,null,function*(){return o(a,e._hist,"hist").then(t=>n(null,null,function*(){let i=[];for(let r=0;r<e._items.arr.length;++r)i.push(o(a,e._items.arr[r],e._items.opt[r]));return Promise.all(i).then(()=>t)}))})}export{d as TGraphTimePainter,T as drawRooPlot};

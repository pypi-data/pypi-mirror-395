import{a as U,b as Y}from"./chunk-BMJ6ZVV2.js";import{a as z}from"./chunk-H6ALVAPY.js";import{a as G}from"./chunk-QVRPMYCM.js";import{f as M}from"./chunk-KYPE3LET.js";var pe=M((_e,m)=>{var a=G(),C=U(),f=z(),O=Y(),d={fs:a.constants,os:C.constants},g="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",T=/XXXXXX/,H=3,k=(d.O_CREAT||d.fs.O_CREAT)|(d.O_EXCL||d.fs.O_EXCL)|(d.O_RDWR||d.fs.O_RDWR),J=C.platform()==="win32",K=d.EBADF||d.os.errno.EBADF,Q=d.ENOENT||d.os.errno.ENOENT,w=448,F=384,V="exit",_=[],j=a.rmdirSync.bind(a),I=!1;function Z(e,r){return a.rm(e,{recursive:!0},r)}function X(e){return a.rmSync(e,{recursive:!0})}function N(e,r){let t=h(e,r),n=t[0],i=t[1];le(n,function(c,u){if(c)return i(c);let l=u.tries;(function p(){try{let s=B(u);a.stat(s,function(E){if(!E)return l-- >0?p():i(new Error("Could not get a unique tmp filename, max tries reached "+s));i(null,s)})}catch(s){i(s)}})()})}function R(e){let r=h(e),t=r[0],n=oe(t),i=n.tries;do{let c=B(n);try{a.statSync(c)}catch{return c}}while(i-- >0);throw new Error("Could not get a unique tmp filename, max tries reached")}function ee(e,r){let t=h(e,r),n=t[0],i=t[1];N(n,function(u,l){if(u)return i(u);a.open(l,k,n.mode||F,function(s,E){if(s)return i(s);if(n.discardDescriptor)return a.close(E,function(W){return i(W,l,void 0,S(l,-1,n,!1))});{let x=n.discardDescriptor||n.detachDescriptor;i(null,l,E,S(l,x?-1:E,n,!1))}})})}function te(e){let r=h(e),t=r[0],n=t.discardDescriptor||t.detachDescriptor,i=R(t),c=a.openSync(i,k,t.mode||F);return t.discardDescriptor&&(a.closeSync(c),c=void 0),{name:i,fd:c,removeCallback:S(i,n?-1:c,t,!0)}}function re(e,r){let t=h(e,r),n=t[0],i=t[1];N(n,function(u,l){if(u)return i(u);a.mkdir(l,n.mode||w,function(s){if(s)return i(s);i(null,l,$(l,n,!1))})})}function ne(e){let r=h(e),t=r[0],n=R(t);return a.mkdirSync(n,t.mode||w),{name:n,removeCallback:$(n,t,!0)}}function ie(e,r){let t=function(n){if(n&&!v(n))return r(n);r()};0<=e[0]?a.close(e[0],function(){a.unlink(e[1],t)}):a.unlink(e[1],t)}function ce(e){let r=null;try{0<=e[0]&&a.closeSync(e[0])}catch(t){if(!se(t)&&!v(t))throw t}finally{try{a.unlinkSync(e[1])}catch(t){v(t)||(r=t)}}if(r!==null)throw r}function S(e,r,t,n){let i=y(ce,[r,e],n),c=y(ie,[r,e],n,i);return t.keep||_.unshift(i),n?i:c}function $(e,r,t){let n=r.unsafeCleanup?Z:a.rmdir.bind(a),i=r.unsafeCleanup?X:j,c=y(i,e,t),u=y(n,e,t,c);return r.keep||_.unshift(c),t?c:u}function y(e,r,t,n){let i=!1;return function c(u){if(!i){let l=n||c,p=_.indexOf(l);return p>=0&&_.splice(p,1),i=!0,t||e===j||e===X?e(r):e(r,u||function(){})}}}function ae(){if(I)for(;_.length;)try{_[0]()}catch{}}function D(e){let r=[],t=null;try{t=O.randomBytes(e)}catch{t=O.pseudoRandomBytes(e)}for(let n=0;n<e;n++)r.push(g[t[n]%g.length]);return r.join("")}function o(e){return typeof e>"u"}function h(e,r){if(typeof e=="function")return[{},e];if(o(e))return[{},r];let t={};for(let n of Object.getOwnPropertyNames(e))t[n]=e[n];return[t,r]}function ue(e,r,t){let n=f.isAbsolute(e)?e:f.join(r,e);a.stat(n,function(i){i?a.realpath(f.dirname(n),function(c,u){if(c)return t(c);t(null,f.join(u,f.basename(n)))}):a.realpath(n,t)})}function fe(e,r){let t=f.isAbsolute(e)?e:f.join(r,e);try{return a.statSync(t),a.realpathSync(t)}catch{let i=a.realpathSync(f.dirname(t));return f.join(i,f.basename(t))}}function B(e){let r=e.tmpdir;if(!o(e.name))return f.join(r,e.dir,e.name);if(!o(e.template))return f.join(r,e.dir,e.template).replace(T,D(6));let t=[e.prefix?e.prefix:"tmp","-",process.pid,"-",D(12),e.postfix?"-"+e.postfix:""].join("");return f.join(r,e.dir,t)}function q(e){if(!o(e.name)){let r=e.name;if(f.isAbsolute(r))throw new Error(`name option must not contain an absolute path, found "${r}".`);let t=f.basename(r);if(t===".."||t==="."||t!==r)throw new Error(`name option must not contain a path, found "${r}".`)}if(!o(e.template)&&!e.template.match(T))throw new Error(`Invalid template, found "${e.template}".`);if(!o(e.tries)&&isNaN(e.tries)||e.tries<0)throw new Error(`Invalid tries, found "${e.tries}".`);e.tries=o(e.name)?e.tries||H:1,e.keep=!!e.keep,e.detachDescriptor=!!e.detachDescriptor,e.discardDescriptor=!!e.discardDescriptor,e.unsafeCleanup=!!e.unsafeCleanup,e.prefix=o(e.prefix)?"":e.prefix,e.postfix=o(e.postfix)?"":e.postfix}function b(e,r,t,n){if(o(r))return n(null);ue(r,t,function(i,c){if(i)return n(i);let u=f.relative(t,c);if(!c.startsWith(t))return n(new Error(`${e} option must be relative to "${t}", found "${u}".`));n(null,u)})}function A(e,r,t){if(o(r))return;let n=fe(r,t),i=f.relative(t,n);if(!n.startsWith(t))throw new Error(`${e} option must be relative to "${t}", found "${i}".`);return i}function le(e,r){me(e,function(t,n){if(t)return r(t);e.tmpdir=n;try{q(e,n)}catch(i){return r(i)}b("dir",e.dir,n,function(i,c){if(i)return r(i);e.dir=o(c)?"":c,b("template",e.template,n,function(u,l){if(u)return r(u);e.template=l,r(null,e)})})})}function oe(e){let r=e.tmpdir=P(e);q(e,r);let t=A("dir",e.dir,r);return e.dir=o(t)?"":t,e.template=A("template",e.template,r),e}function se(e){return L(e,-K,"EBADF")}function v(e){return L(e,-Q,"ENOENT")}function L(e,r,t){return J?e.code===t:e.code===t&&e.errno===r}function de(){I=!0}function me(e,r){return a.realpath(e&&e.tmpdir||C.tmpdir(),r)}function P(e){return a.realpathSync(e&&e.tmpdir||C.tmpdir())}process.addListener(V,ae);Object.defineProperty(m.exports,"tmpdir",{enumerable:!0,configurable:!1,get:function(){return P()}});m.exports.dir=re;m.exports.dirSync=ne;m.exports.file=ee;m.exports.fileSync=te;m.exports.tmpName=N;m.exports.tmpNameSync=R;m.exports.setGracefulCleanup=de});export default pe();

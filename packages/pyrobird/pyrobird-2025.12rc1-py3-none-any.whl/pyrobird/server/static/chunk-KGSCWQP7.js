import{a as T}from"./chunk-3W3OTHNE.js";import"./chunk-K2P6CES6.js";import{b as P}from"./chunk-LNTKXTVM.js";import{c as p,i as b}from"./chunk-MFPRCIVI.js";import{g as y,k as X,p as Y}from"./chunk-SVHROGNI.js";import{O as d,i as _,j as l,ta as v}from"./chunk-DLJYFRIS.js";import{Va as m}from"./chunk-MAT3H5WR.js";import{k as u}from"./chunk-KYPE3LET.js";var F=class w extends p{convertTo(s){let t=this.getObject(),n=this.axisToSvg("x",t.fX1),i=this.axisToSvg("y",t.fY1),e=this.axisToSvg("x",t.fX2),f=this.axisToSvg("y",t.fY2);if(s==="ndc"){let a=this.getPadPainter().getPadWidth(),r=this.getPadPainter().getPadHeight();t.fX1=n/a,t.fX2=e/a,t.fY1=(r-i)/r,t.fY2=(r-f)/r,this.use_ndc=!0}else if(s==="frame"){let a=this.getFramePainter().getFrameRect();t.fX1=(n-a.x)/a.width,t.fX2=(e-a.x)/a.width,t.fY1=(i-a.y)/a.height,t.fY2=(f-a.y)/a.height,this.bind_frame=!0}}moveDrag(s,t){this.gaxis_x+=s,this.gaxis_y+=t,d(this.getG(),this.gaxis_x,this.gaxis_y)}moveEnd(s){if(s)return;let t=this.getObject(),n,i;if(this.bind_frame){let e=this.getFramePainter().getFrameRect();n=(this.gaxis_x-e.x)/e.width,i=(this.gaxis_y-e.y)/e.height}else n=this.svgToAxis("x",this.gaxis_x,this.use_ndc),i=this.svgToAxis("y",this.gaxis_y,this.use_ndc);this.vertical?(t.fX1=t.fX2=n,this.reverse?(t.fY2=i+(t.fY2-t.fY1),t.fY1=i):(t.fY1=i+(t.fY1-t.fY2),t.fY2=i)):(this.reverse?(t.fX1=n+(t.fX1-t.fX2),t.fX2=n):(t.fX2=n+(t.fX2-t.fX1),t.fX1=n),t.fY1=t.fY2=i),this.submitAxisExec(`SetX1(${t.fX1});;SetX2(${t.fX2});;SetY1(${t.fY1});;SetY2(${t.fY2})`,!0)}redraw(){let s=this.getObject(),t=s.fWmin,n=s.fWmax,i,e,f,a;if(this.bind_frame){let h=this.getFramePainter().getFrameRect();i=Math.round(h.x+s.fX1*h.width),f=Math.round(h.x+s.fX2*h.width),e=Math.round(h.y+s.fY1*h.height),a=Math.round(h.y+s.fY2*h.height)}else i=this.axisToSvg("x",s.fX1,this.use_ndc),e=this.axisToSvg("y",s.fY1,this.use_ndc),f=this.axisToSvg("x",s.fX2,this.use_ndc),a=this.axisToSvg("y",s.fY2,this.use_ndc);let r=f-i,o=e-a,c=Math.abs(r)<Math.abs(o),x=c?o:r,g=!1;return x<0&&(g=!0,x=-x,c?a=e:i=f),this.configureAxis(c?"yaxis":"xaxis",t,n,t,n,c,[0,x],{time_scale:s.fChopt.indexOf("t")>=0,log:s.fChopt.indexOf("G")>=0?1:0,reverse:g,swap_side:g,axis_func:this.axis_func}),this.gaxis_x=i,this.gaxis_y=a,this.drawAxis(this.createG(),Math.abs(r),Math.abs(o),d(this.gaxis_x,this.gaxis_y)||"").then(()=>(y(this),Y(this,X),this))}fillContextMenuItems(s){s.addTAxisMenu(v,this,this.getObject(),"")}checkFuncion(){return u(this,null,function*(){let s=this.getObject();if(!s.fFunctionName){this.axis_func=null;return}let t=this.getPadPainter()?.findInPrimitives(s.fFunctionName,m),n=Promise.resolve(t);if(!t){let i=b(),e=i?.findItem({name:s.fFunctionName,check_keys:!0});e&&(n=i.getObject({item:e}).then(f=>f?.obj?._typename===m?f.obj:null))}return n.then(i=>{this.axis_func=i,i&&T(i)})})}createFuncHandle(s,t,n,i){let e=function(r){return e.toGraph(r)};e._func=s,e._domain=[n,i],e._scale=t?l().base(t):_(),e._scale.domain(e._domain).range([0,100]),e.eval=function(r){try{r=e._func.evalPar(r)}catch{r=0}return Number.isFinite(r)?r:0};let f=e.eval(n),a=e.eval(i);return f<a==n<i?(e._vmin=f,e._vk=1/(a-f)):f===a?(e._vmin=0,e._vk=1):(e._vmin=a,e._vk=1/(f-a)),e._range=[0,100],e.range=function(r){return r?(e._range=r,e):e._range},e.domain=function(){return e._domain},e.toGraph=function(r){let o=(e.eval(r)-e._vmin)*e._vk;return e._range[0]*(1-o)+e._range[1]*o},e.ticks=function(r){return e._scale.ticks(r)},e}static draw(s,t,n){return u(this,null,function*(){let i=new w(s,t,!1);return P(i,!1).then(()=>(n&&i.convertTo(n),i.checkFuncion())).then(()=>i.redraw())})}};export{F as TGaxisPainter};

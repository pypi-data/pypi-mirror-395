import{b as m}from"./chunk-LNTKXTVM.js";import{g as c,p as d}from"./chunk-SVHROGNI.js";import{I as x,ka as o}from"./chunk-DLJYFRIS.js";import{x as f}from"./chunk-MAT3H5WR.js";import{k as n}from"./chunk-KYPE3LET.js";var y=f(14),p=class u extends o{#t;moveStart(t,s){let i=Math.max(1,Math.sqrt((this.x1-this.x2)**2+(this.y1-this.y2)**2)),e=Math.sqrt((t-this.x1)**2+(s-this.y1)**2)/i,h=Math.sqrt((t-this.x2)**2+(s-this.y2)**2)/i;e>.9?this.#t=1:h>.9?this.#t=-1:this.#t=0}moveDrag(t,s){this.#t!==1&&(this.x1+=t,this.y1+=s),this.#t!==-1&&(this.x2+=t,this.y2+=s),this.getG().select("path").attr("d",this.createPath())}moveEnd(t){if(t)return;let s=this.getObject(),i="",e=this.svgToAxis("x",this.x1,this.isndc),h=this.svgToAxis("x",this.x2,this.isndc),a=this.svgToAxis("y",this.y1,this.isndc),r=this.svgToAxis("y",this.y2,this.isndc);this.swap_xy&&([e,a,h,r]=[a,e,r,h]),s.fX1=e,s.fX2=h,s.fY1=a,s.fY2=r,this.#t!==1&&(i+=`SetX1(${e});;SetY1(${a});;`),this.#t!==-1&&(i+=`SetX2(${h});;SetY2(${r});;`),this.submitCanvExec(i+"Notify();;")}getUserRanges(){let t=this.getObject();if(t.TestBit(y))return null;let i=Math.min(t.fX1,t.fX2),e=Math.max(t.fX1,t.fX2),h=Math.min(t.fY1,t.fY2),a=Math.max(t.fY1,t.fY2);return{minx:i,miny:h,maxx:e,maxy:a}}prepareDraw(){let t=this.getObject();this.isndc=t.TestBit(y);let s=this.isndc?!1:new x(this.getDrawOpt()).check("FRAME");this.createG(s?"frame2d":void 0),this.swap_xy=s&&this.getFramePainter()?.swap_xy();let i=this.getAxisToSvgFunc(this.isndc,!0);this.x1=i.x(t.fX1),this.y1=i.y(t.fY1),this.x2=i.x(t.fX2),this.y2=i.y(t.fY2),this.swap_xy&&([this.x1,this.y1,this.x2,this.y2]=[this.y1,this.x1,this.y2,this.x2]),this.createAttLine({attr:t})}createPath(){let t=Math.round(this.x1),s=Math.round(this.x2),i=Math.round(this.y1),e=Math.round(this.y2);return`M${t},${i}`+(t===s?`V${e}`:i===e?`H${s}`:`L${s},${e}`)}addExtras(){}redraw(){this.prepareDraw();let t=this.appendPath(this.createPath()).call(this.lineatt.func);return this.getObject()?.$do_not_draw?t.remove():(this.addExtras(t),c(this),d(this)),this}static draw(t,s,i){return n(this,null,function*(){let e=new u(t,s,i);return m(e,!1).then(()=>e.redraw())})}};export{p as a};

import{a as u,e as w}from"./chunk-JPOZZ6CV.js";import{e as k}from"./chunk-MFPRCIVI.js";import"./chunk-SVHROGNI.js";import{O as y}from"./chunk-DLJYFRIS.js";import{t as m}from"./chunk-MAT3H5WR.js";import{k as c}from"./chunk-KYPE3LET.js";var g={kTopLeft:1,kTopRight:2,kBottomLeft:3,kBottomRight:4},x=class v extends u{drawContent(){return c(this,null,function*(){return this})}drawPave(){return c(this,null,function*(){let t=this.getPadPainter().getPadRect(),s=this.getFramePainter();this.onFrame=s&&this.v7EvalAttr("onFrame",!0),this.corner=this.v7EvalAttr("corner",g.kTopRight);let n=this.v7EvalAttr("visible",!0),e=this.v7EvalLength("offsetX",t.width,.02),a=this.v7EvalLength("offsetY",t.height,.02),o=this.v7EvalLength("width",t.width,.3),i=this.v7EvalLength("height",t.height,.3),r=this.createG();if(r.classed("most_upper_primitives",!0),!n)return this;this.createv7AttLine("border_"),this.createv7AttFill();let h=this.onFrame?s.getFrameRect():t,d=0,f=0;switch(this.corner){case g.kTopLeft:d=h.x+e,f=h.y+a;break;case g.kBottomLeft:d=h.x+e,f=h.y+h.height-a-i;break;case g.kBottomRight:d=h.x+h.width-e-o,f=h.y+h.height-a-i;break;case g.kTopRight:default:d=h.x+h.width-e-o,f=h.y+a}return y(r,d,f),r.append("svg:rect").attr("x",0).attr("width",o).attr("y",0).attr("height",i).call(this.lineatt.func).call(this.fillatt.func),this.pave_width=o,this.pave_height=i,this.drawContent().then(()=>(this.isBatchMode()||(m.ContextMenu&&this.paveContextMenu&&r.on("contextmenu",p=>this.paveContextMenu(p)),k(this,{x:d,y:f,width:o,height:i,minwidth:20,minheight:20,redraw:p=>this.sizeChanged(p)})),this))})}sizeChanged(t){this.pave_width=t.width,this.pave_height=t.height;let s=t.x,n=t.y,e=this.getPadPainter().getPadRect(),a=this.onFrame?this.getFramePainter().getFrameRect():e,o={},i,r;switch(this.corner){case g.kTopLeft:i=s-a.x,r=n-a.y;break;case g.kBottomLeft:i=s-a.x,r=a.y+a.height-n-this.pave_height;break;case g.kBottomRight:i=a.x+a.width-s-this.pave_width,r=a.y+a.height-n-this.pave_height;break;case g.kTopRight:default:i=a.x+a.width-s-this.pave_width,r=n-a.y}this.v7AttrChange(o,"offsetX",i/e.width),this.v7AttrChange(o,"offsetY",r/e.height),this.v7AttrChange(o,"width",this.pave_width/e.width),this.v7AttrChange(o,"height",this.pave_height/e.height),this.v7SendAttrChanges(o,!1),this.getG().selectChild("rect").attr("width",this.pave_width).attr("height",this.pave_height),this.drawContent()}redraw(){return c(this,null,function*(){return this.drawPave()})}static draw(t,s,n){return c(this,null,function*(){let e=new v(t,s,n,"pave");return w(e,!1).then(()=>e.drawPave())})}},_=class v extends x{drawContent(){return c(this,null,function*(){let t=this.getObject(),s=this.v7EvalFont("text",{size:12,color:"black",align:22}),n=this.pave_width,e=this.pave_height,a=this.getPadPainter(),o=t.fEntries.length;if(t.fTitle&&o++,!o||!a)return this;let i=e/o,r=.02*n;return s.setSize(e/(o*1.2)),this.startTextDrawingAsync(s,"font").then(()=>{let h=0;t.fTitle&&(this.drawText({latex:1,width:n-2*r,height:i,x:r,y:h,text:t.fTitle}),h+=i);for(let d=0;d<t.fEntries.length;++d){let f=t.fEntries[d],p=Math.round(n/4),l=null;this.drawText({latex:1,width:.75*n-3*r,height:i,x:2*r+p,y:h,text:f.fLabel}),f.fDrawableId!=="custom"?l=a.findSnap(f.fDrawableId,!0):f.fDrawable.fIO&&(l=new u(this.getPadPainter(),f.fDrawable.fIO),f.fLine&&l.createv7AttLine(),f.fFill&&l.createv7AttFill(),f.fMarker&&l.createv7AttMarker()),f.fFill&&l?.fillatt&&this.appendPath(`M${Math.round(r)},${Math.round(h+i*.1)}h${p}v${Math.round(i*.8)}h${-p}z`).call(l.fillatt.func),f.fLine&&l?.lineatt&&this.appendPath(`M${Math.round(r)},${Math.round(h+i/2)}h${p}`).call(l.lineatt.func),f.fError&&l?.lineatt&&this.appendPath(`M${Math.round(r+n/8)},${Math.round(h+i*.2)}v${Math.round(i*.6)}`).call(l.lineatt.func),f.fMarker&&l?.markeratt&&this.appendPath(l.markeratt.create(r+n/8,h+i/2)).call(l.markeratt.func),h+=i}return this.finishTextDrawing()})})}static draw(t,s,n){return c(this,null,function*(){let e=new v(t,s,n,"legend");return w(e,!1).then(()=>e.drawPave())})}},b=class v extends x{drawContent(){return c(this,null,function*(){let t=this.getObject(),s=t?.fText.length;if(!s)return;let n=this.v7EvalFont("text",{size:12,color:"black",align:22}),e=this.pave_width,a=this.pave_height,o=a/s,i=.02*e;return n.setSize(a/(s*1.2)),this.startTextDrawingAsync(n,"font").then(()=>{for(let r=0,h=0;r<t.fText.length;++r,h+=o)this.drawText({latex:1,width:e-2*i,height:o,x:i,y:h,text:t.fText[r]});return this.finishTextDrawing(void 0,!0)})})}static draw(t,s,n){return c(this,null,function*(){let e=new v(t,s,n,"pavetext");return w(e,!1).then(()=>e.drawPave())})}};export{_ as RLegendPainter,x as RPavePainter,b as RPaveTextPainter};

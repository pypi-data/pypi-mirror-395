name: trigger-readthedocs

on:
  push:
    branches: ["main"]
    tags:
      - "[v]?[0-9]+.[0-9]+.[0-9]+"
  workflow_dispatch:

# Entendo que é só um webhook, não precisaria nem de dar um `git clone`
# https://rtds-action.readthedocs.io/en/latest/#set-up-readthedocs
jobs:
  build_docs:
    name: "Build readthedocs"
    runs-on: ubuntu-latest
    steps:
      - name: Trigger RTDs build
        uses: dfm/rtds-action@v1
        with:
          webhook_url: ${{ secrets.RTDS_WEBHOOK_URL }}
          webhook_token: ${{ secrets.RTDS_WEBHOOK_TOKEN }}
          commit_ref: ${{ github.ref }}

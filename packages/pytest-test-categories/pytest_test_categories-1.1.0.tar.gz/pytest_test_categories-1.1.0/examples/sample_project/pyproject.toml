# Sample Project Configuration
# ============================
#
# This pyproject.toml demonstrates various pytest-test-categories
# configuration options for different use cases.

[project]
name = "sample-project"
version = "0.1.0"
description = "Example project demonstrating pytest-test-categories best practices"
readme = "README.md"
requires-python = ">=3.11"
dependencies = [
    "httpx>=0.27.0",
]

[project.optional-dependencies]
test = [
    # Core testing dependencies
    "pytest>=8.0.0",
    "pytest-test-categories>=0.7.0",
    "pytest-httpx>=0.30.0",
    "coverage>=7.0.0",

    # Optional: for medium tests with containers
    "testcontainers>=4.0.0",
    "psycopg2-binary>=2.9.0",
]
dev = [
    "ruff>=0.3.0",
    "mypy>=1.0.0",
]

# ==============================================================================
# pytest Configuration
# ==============================================================================
#
# This section shows the full range of pytest-test-categories options.
# Uncomment/modify based on your project's needs.

[tool.pytest.ini_options]
# Test discovery
testpaths = ["tests"]
python_files = ["test_*.py"]
python_functions = ["it_*", "test_*"]
python_classes = ["Describe*", "Test*"]

# Add src to Python path for imports
pythonpath = ["src"]

# --------------------------------------------------------------------------
# pytest-test-categories: Enforcement Mode
# --------------------------------------------------------------------------
# Controls how strictly the plugin enforces test hermeticity.
#
# Options:
#   - "off"    : No enforcement (default) - good for migration
#   - "warn"   : Emit warnings on violations - good for gradual adoption
#   - "strict" : Fail tests on violations - recommended for new projects
#
test_categories_enforcement = "warn"

# --------------------------------------------------------------------------
# pytest-test-categories: Distribution Enforcement
# --------------------------------------------------------------------------
# Controls validation of test size distribution percentages.
#
# Options:
#   - "off"    : No validation (default)
#   - "warn"   : Warn if distribution is outside targets
#   - "strict" : Fail if distribution is outside targets
#
# Target distribution (from Google's SWE book):
#   - 80% small tests (fast, hermetic)
#   - 15% medium tests (may use localhost, containers)
#   - 5% large tests (full integration)
#
test_categories_distribution_enforcement = "warn"

# --------------------------------------------------------------------------
# pytest-test-categories: Custom Time Limits
# --------------------------------------------------------------------------
# Override default time limits for each test size.
# Useful for projects with different performance requirements.
#
# Default values:
#   - small:  1.0 seconds
#   - medium: 300.0 seconds (5 minutes)
#   - large:  900.0 seconds (15 minutes)
#   - xlarge: 900.0 seconds (15 minutes)
#
# Uncomment to customize:
# test_categories_small_time_limit = "2.0"
# test_categories_medium_time_limit = "600.0"
# test_categories_large_time_limit = "1800.0"
# test_categories_xlarge_time_limit = "1800.0"

# --------------------------------------------------------------------------
# pytest-test-categories: Allowed Filesystem Paths
# --------------------------------------------------------------------------
# Additional paths that small tests are allowed to access.
# By default, only tmp_path and system temp directories are allowed.
#
# Uncomment to allow access to test fixtures:
# test_categories_allowed_paths = ["tests/fixtures/"]

# ==============================================================================
# Coverage Configuration
# ==============================================================================

[tool.coverage.run]
source = ["src"]
branch = true
omit = ["*/tests/*"]

[tool.coverage.report]
exclude_lines = [
    "pragma: no cover",
    "if TYPE_CHECKING:",
    "raise NotImplementedError",
]

# ==============================================================================
# Code Quality Configuration
# ==============================================================================

[tool.ruff]
line-length = 88
target-version = "py311"

[tool.ruff.lint]
select = ["E", "F", "I", "N", "W", "UP", "B"]
ignore = ["E501"]

[tool.mypy]
python_version = "3.11"
strict = true
warn_return_any = true

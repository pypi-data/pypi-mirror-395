(self.webpackChunkipyspeck=self.webpackChunkipyspeck||[]).push([[509],{249:(t,e,i)=>{var o=i(983),s=i(79);const n=i(686),r=i(212),l=i(572),a=i(156),c=(i(741),i(609));var h=o.DOMWidgetModel.extend({defaults:s.extend(o.DOMWidgetModel.prototype.defaults(),{_model_name:"SpeckModel",_view_name:"SpeckView",_model_module:"ipyspeck",_view_module:"ipyspeck",_model_module_version:"0.6.2",_view_module_version:"0.6.2",data:"",bonds:!0,atomScale:.24,relativeAtomScale:.64,bondScale:.5,brightness:.5,outline:0,spf:32,bondThreshold:1.2,bondShade:.5,atomShade:.5,dofStrength:0,dofPosition:.5})}),d=o.DOMWidgetView.extend({initialize:function(){this.system=r.new(),this.view=l.new(),this.view.resolution.x=200,this.view.resolution.y=200,this.view.bonds=this.model.get("bonds"),this.view.atomScale=this.model.get("atomScale"),this.view.relativeAtomScale=this.model.get("relativeAtomScale"),this.view.bondScale=this.model.get("bondScale"),this.view.brightness=this.model.get("brightness"),this.view.outline=this.model.get("outline"),this.view.spf=this.model.get("spf"),this.view.bondThreshold=this.model.get("bondThreshold"),this.view.bondShade=this.model.get("bondShade"),this.view.atomShade=this.model.get("atomShade"),this.view.dofStrength=this.model.get("dofStrength"),this.view.dofPosition=this.model.get("dofPosition"),this.renderer=null,this.needReset=!1,this.current_schema="speck";let t=this;t.container=document.createElement("div"),t.canvas=document.createElement("canvas"),t.canvas.addEventListener("dblclick",function(){t.center()}),t.topbar=document.createElement("div"),t.topbar.style.top="0px",t.topbar.style.height="20px",t.topbar.style.right="0px",t.topbar.style.position="absolute",t.topbar.style.background="rgba(255,255,255,0.5)",t.topbar.style.flexDirection="row",t.topbar.style.alignContent="flex-end",t.topbar.style.display="flex",t.infoc=document.createElement("div"),t.infoc.style.fontSize="10px",t.infoc.style.color="#AAA",t.infoc.innerHTML="Colors: "+t.current_schema,t.autoscale=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.autoscale.setAttribute("width","16"),t.autoscale.setAttribute("height","16"),t.autoscale.setAttribute("viewBox","0 0 16 16"),t.autoscale.setAttribute("fill","#AAAAAA"),t.autoscale.addEventListener("mouseover",function(){t.autoscale.setAttribute("fill","#666666")}),t.autoscale.addEventListener("mouseout",function(){t.autoscale.setAttribute("fill","#AAAAAA")}),t.autoscale.innerHTML='<g><path d="M 1 5 v -4 h 4 M 15 5 v -4 h -4 M 1 11 v 4 h 4 M 11 15 h 4 v -4 M 5 8 l 3 -3 l 3 3 l -3 3 l -3 -3"></path></g>',t.autoscale.addEventListener("click",function(){t.center()}),t.autoscalec=document.createElement("div"),t.autoscalec.style.padding="2px",t.autoscalec.append(t.autoscale),t.camera=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.camera.setAttribute("width","16"),t.camera.setAttribute("height","16"),t.camera.setAttribute("viewBox","0 0 16 16"),t.camera.setAttribute("fill","#AAAAAA"),t.camera.addEventListener("mouseover",function(){t.camera.setAttribute("fill","#666666")}),t.camera.addEventListener("mouseout",function(){t.camera.setAttribute("fill","#AAAAAA")}),t.camera.innerHTML='<g><path d="M 10.421875 8.773438 C 10.421875 10.09375 9.355469 11.160156 8.039062 11.160156 C 6.71875 11.160156 5.652344 10.09375 5.652344 8.773438 C 5.652344 7.457031 6.71875 6.390625 8.039062 6.390625 C 9.355469 6.390625 10.421875 7.457031 10.421875 8.773438 Z M 10.421875 8.773438"></path><path d="M 14.746094 4.007812 L 12.484375 4.007812 C 12.289062 4.007812 12.117188 3.929688 11.992188 3.785156 C 10.816406 2.457031 10.371094 2.015625 9.882812 2.015625 L 6.320312 2.015625 C 5.828125 2.015625 5.359375 2.460938 4.15625 3.785156 C 4.035156 3.929688 3.835938 4.007812 3.664062 4.007812 L 3.492188 4.007812 L 3.492188 3.664062 C 3.492188 3.492188 3.347656 3.320312 3.148438 3.320312 L 2.066406 3.320312 C 1.894531 3.320312 1.722656 3.464844 1.722656 3.664062 L 1.722656 4.007812 L 1.398438 4.007812 C 0.664062 4.007812 0 4.546875 0 5.285156 L 0 12.609375 C 0 13.347656 0.664062 13.984375 1.398438 13.984375 L 14.722656 13.984375 C 15.460938 13.984375 16 13.320312 16 12.609375 L 16 5.257812 C 16.023438 4.546875 15.484375 4.007812 14.746094 4.007812 Z M 8.210938 12.335938 C 6.121094 12.433594 4.398438 10.714844 4.496094 8.625 C 4.570312 6.804688 6.042969 5.332031 7.886719 5.234375 C 9.976562 5.136719 11.695312 6.855469 11.601562 8.945312 C 11.503906 10.765625 10.027344 12.242188 8.210938 12.335938 Z M 12.042969 6.414062 C 11.75 6.414062 11.503906 6.167969 11.503906 5.875 C 11.503906 5.582031 11.75 5.335938 12.042969 5.335938 C 12.335938 5.335938 12.585938 5.582031 12.585938 5.875 C 12.585938 6.167969 12.335938 6.414062 12.042969 6.414062 Z M 12.042969 6.414062 "></path></g>',t.camera.addEventListener("click",function(){t.saveSnapshot()}),t.camerac=document.createElement("div"),t.camerac.style.padding="2px",t.camerac.append(t.camera),t.palette=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.palette.setAttribute("width","16"),t.palette.setAttribute("height","16"),t.palette.setAttribute("viewBox","0 0 16 16"),t.palette.setAttribute("fill","#AAAAAA"),t.palette.addEventListener("mouseover",function(){t.palette.setAttribute("fill","#666666")}),t.palette.addEventListener("mouseout",function(){t.palette.setAttribute("fill","#AAAAAA")}),t.palette.innerHTML='<g><path d="M 7.984375 0.015625 C 3.601562 0.015625 0 3.617188 0 8 C 0 12.382812 3.601562 15.984375 7.984375 15.984375 C 8.742188 15.984375 9.320312 15.402344 9.320312 14.648438 C 9.320312 14.300781 9.175781 13.980469 8.96875 13.75 C 8.738281 13.519531 8.617188 13.226562 8.617188 12.851562 C 8.617188 12.09375 9.199219 11.515625 9.953125 11.515625 L 11.550781 11.515625 C 13.992188 11.515625 15.992188 9.511719 15.992188 7.070312 C 15.972656 3.210938 12.367188 0.015625 7.984375 0.015625 Z M 3.105469 8 C 2.351562 8 1.773438 7.417969 1.773438 6.664062 C 1.773438 5.914062 2.351562 5.332031 3.105469 5.332031 C 3.859375 5.332031 4.441406 5.914062 4.441406 6.664062 C 4.441406 7.417969 3.863281 8 3.105469 8 Z M 5.777344 4.457031 C 5.023438 4.457031 4.445312 3.875 4.445312 3.121094 C 4.445312 2.367188 5.023438 1.789062 5.777344 1.789062 C 6.53125 1.789062 7.113281 2.367188 7.113281 3.121094 C 7.085938 3.878906 6.535156 4.457031 5.777344 4.457031 Z M 10.195312 4.457031 C 9.4375 4.457031 8.859375 3.875 8.859375 3.121094 C 8.859375 2.367188 9.441406 1.789062 10.195312 1.789062 C 10.945312 1.789062 11.527344 2.367188 11.527344 3.121094 C 11.527344 3.878906 10.945312 4.457031 10.195312 4.457031 Z M 12.863281 8 C 12.105469 8 11.527344 7.417969 11.527344 6.664062 C 11.527344 5.914062 12.109375 5.332031 12.863281 5.332031 C 13.617188 5.332031 14.195312 5.914062 14.195312 6.664062 C 14.195312 7.417969 13.617188 8 12.863281 8 Z M 12.863281 8"/></g>',t.palette.addEventListener("click",function(){t.switchColorSchema(),t.infoc.innerHTML="Colors: "+t.current_schema}),t.palettec=document.createElement("div"),t.palettec.style.padding="2px",t.palettec.append(t.palette),t.front=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.front.setAttribute("width","16"),t.front.setAttribute("height","16"),t.front.setAttribute("viewBox","0 0 16 16"),t.front.setAttribute("fill","#AAAAAA"),t.front.setAttribute("stroke","#AAAAAA"),t.front.addEventListener("mouseover",function(){t.front.setAttribute("fill","#666666"),t.front.setAttribute("stroke","#666666")}),t.front.addEventListener("mouseout",function(){t.front.setAttribute("fill","#AAAAAA"),t.front.setAttribute("stroke","#AAAAAA")}),t.front.innerHTML='<g><path d="M 0 5 h 10 v 10 h -10 v -10" fill="none"/><path d="M 4 0 h 10 l -4 4 h -10 l -4 4" stroke="none"/><path d="M 11 5 l 4 -4 v 10 l -4 4 v -10" stroke="none"/></g>',t.front.addEventListener("click",function(){t.frontview()}),t.frontc=document.createElement("div"),t.frontc.style.padding="2px",t.frontc.append(t.front),t.top=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.top.setAttribute("width","16"),t.top.setAttribute("height","16"),t.top.setAttribute("viewBox","0 0 16 16"),t.top.setAttribute("fill","#AAAAAA"),t.top.setAttribute("stroke","#AAAAAA"),t.top.addEventListener("mouseover",function(){t.top.setAttribute("fill","#666666"),t.top.setAttribute("stroke","#666666")}),t.top.addEventListener("mouseout",function(){t.top.setAttribute("fill","#AAAAAA"),t.top.setAttribute("stroke","#AAAAAA")}),t.top.innerHTML='<g><path d="M 0 5 h 10 v 10 h -10 v -10" stroke="none"/><path d="M 4 0 h 10 l -4 4 h -10 l -4 4" fill="none"/><path d="M 11 5 l 4 -4 v 10 l -4 4 v -10" stroke="none"/></g>',t.top.addEventListener("click",function(){t.topview()}),t.topc=document.createElement("div"),t.topc.style.padding="2px",t.topc.append(t.top),t.right=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.right.setAttribute("width","16"),t.right.setAttribute("height","16"),t.right.setAttribute("viewBox","0 0 16 16"),t.right.setAttribute("fill","#AAAAAA"),t.right.setAttribute("stroke","#AAAAAA"),t.right.addEventListener("mouseover",function(){t.right.setAttribute("fill","#666666"),t.right.setAttribute("stroke","#666666")}),t.right.addEventListener("mouseout",function(){t.right.setAttribute("fill","#AAAAAA"),t.right.setAttribute("stroke","#AAAAAA")}),t.right.innerHTML='<g><path d="M 0 5 h 10 v 10 h -10 v -10" stroke="none"/><path d="M 4 0 h 10 l -4 4 h -10 l -4 4" stroke="none"/><path d="M 11 5 l 4 -4 v 10 l -4 4 v -10" fill="none"/></g>',t.right.addEventListener("click",function(){t.rightview()}),t.rightc=document.createElement("div"),t.rightc.style.padding="2px",t.rightc.append(t.right),t.sti=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.sti.setAttribute("width","16"),t.sti.setAttribute("height","16"),t.sti.setAttribute("viewBox","0 0 16 16"),t.sti.setAttribute("fill","#AAAAAA"),t.sti.setAttribute("stroke","#AAAAAA"),t.sti.addEventListener("mouseover",function(){t.sti.setAttribute("fill","#666666"),t.sti.setAttribute("stroke","#666666")}),t.sti.addEventListener("mouseout",function(){t.sti.setAttribute("fill","#AAAAAA"),t.sti.setAttribute("stroke","#AAAAAA")}),t.sti.innerHTML='<g><circle cx="4" cy="4" r="2"/><circle cx="10" cy="2" r="1"/><circle cx="10" cy="12" r="3"/><path d="M 5 5 l 3 4 M 6 3 l 3 -1" ></path></g>',t.sti.addEventListener("click",function(){t.stickball(),t.updateModel()}),t.stic=document.createElement("div"),t.stic.style.padding="2px",t.stic.append(t.sti),t.too=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.too.setAttribute("width","16"),t.too.setAttribute("height","16"),t.too.setAttribute("viewBox","0 0 16 16"),t.too.setAttribute("fill","#AAAAAA"),t.too.setAttribute("stroke","#AAAAAA"),t.too.addEventListener("mouseover",function(){t.too.setAttribute("fill","#666666"),t.too.setAttribute("stroke","#666666")}),t.too.addEventListener("mouseout",function(){t.too.setAttribute("fill","#AAAAAA"),t.too.setAttribute("stroke","#AAAAAA")}),t.too.innerHTML='<g><circle cx="4" cy="4" r="1"/><circle cx="10" cy="2" r="1"/><circle cx="10" cy="12" r="1"/><path d="M 4 5 l 5 6 M 5 3 l 4 -1" ></path></g>',t.too.addEventListener("click",function(){t.toon(),t.updateModel()}),t.tooc=document.createElement("div"),t.tooc.style.padding="2px",t.tooc.append(t.too),t.lic=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.lic.setAttribute("width","16"),t.lic.setAttribute("height","16"),t.lic.setAttribute("viewBox","0 0 16 16"),t.lic.setAttribute("fill","#AAAAAA"),t.lic.setAttribute("stroke","#AAAAAA"),t.lic.addEventListener("mouseover",function(){t.lic.setAttribute("fill","#666666"),t.lic.setAttribute("stroke","#666666")}),t.lic.addEventListener("mouseout",function(){t.lic.setAttribute("fill","#AAAAAA"),t.lic.setAttribute("stroke","#AAAAAA")}),t.lic.innerHTML='<g><circle cx="4" cy="4" r="2" fill="none"/><circle cx="10" cy="2" r="1" fill="none"/><circle cx="10" cy="12" r="3" fill="none"/><path d="M 5 5 l 3 4 M 6 3 l 3 -1" ></path></g>',t.lic.addEventListener("click",function(){t.licorice(),t.updateModel()}),t.licc=document.createElement("div"),t.licc.style.padding="2px",t.licc.append(t.lic),t.fil=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.fil.setAttribute("width","16"),t.fil.setAttribute("height","16"),t.fil.setAttribute("viewBox","0 0 16 16"),t.fil.setAttribute("fill","#AAAAAA"),t.fil.setAttribute("stroke","#AAAAAA"),t.fil.addEventListener("mouseover",function(){t.fil.setAttribute("fill","#666666"),t.fil.setAttribute("stroke","#666666")}),t.fil.addEventListener("mouseout",function(){t.fil.setAttribute("fill","#AAAAAA"),t.fil.setAttribute("stroke","#AAAAAA")}),t.fil.innerHTML='<g><circle cx="4" cy="4" r="2"/><circle cx="10" cy="2" r="1"/><circle cx="10" cy="12" r="3"/></g>',t.fil.addEventListener("click",function(){t.fill(),t.updateModel()}),t.filc=document.createElement("div"),t.filc.style.padding="2px",t.filc.append(t.fil),t.container.append(t.canvas),t.topbar.append(t.infoc),t.topbar.append(t.stic),t.topbar.append(t.tooc),t.topbar.append(t.licc),t.topbar.append(t.filc),t.topbar.append(t.frontc),t.topbar.append(t.topc),t.topbar.append(t.rightc),t.topbar.append(t.palettec),t.topbar.append(t.camerac),t.topbar.append(t.autoscalec),t.el.append(t.topbar),t.el.append(t.container),t.el.style.width="100%",t.el.style.height="100%",a({container:t.container,scrollZoom:!0,getRotation:function(){return t.view.rotation},setRotation:function(e){t.view.rotation=e},getTranslation:function(){return t.view.translation},setTranslation:function(e){t.view.translation=e},getZoom:function(){return t.view.zoom},setZoom:function(e){t.view.zoom=e},refreshView:function(){t.needReset=!0}})},saveSnapshot:function(){this.renderer.render(this.view);var t=this.canvas.toDataURL("image/png"),e=document.createElement("a");e.href=t,e.download="speck.png",document.body.appendChild(e),e.click()},setAtomsColor:function(t){for(const e in t)e in this.view.elements&&(this.view.elements[e].color=t[e],this.needReset=!0);this.needReset&&(r.calculateBonds(this.system,this.view),this.renderer.setSystem(this.system,this.view))},setColorSchema:function(t){t in c&&(this.current_schema=t,this.setAtomsColor(c[t]))},switchColorSchema:function(){let t,e=!1;for(color in c){if(null==t&&(t=color),e)return void this.setColorSchema(color);color==this.current_schema&&(e=!0)}this.setColorSchema(t)},stickball:function(){this.needReset=!0,this.view.atomScale=.24,this.view.relativeAtomScale=.64,this.view.bondScale=.5,this.view.bonds=!0,this.view.bondThreshold=1.2,this.view.brightness=.5,this.view.outline=0,this.view.spf=32,this.view.bondShade=.5,this.view.atomShade=.5,this.view.dofStrength=0,this.view.dofPosition=.5,this.view.ao=.75,this.view.spf=32,this.view.outline=0},toon:function(){this.stickball(),this.view.atomScale=.1,this.view.relativeAtomScale=0,this.view.bondScale=1,this.view.bonds=!0,this.view.bondThreshold=1.2},fill:function(){this.stickball(),this.view.atomScale=.6,this.view.relativeAtomScale=1,this.view.bonds=!1},licorice:function(){this.stickball(),this.view.ao=0,this.view.spf=0,this.view.outline=1,this.view.bonds=!0},updateModel:function(){this.model.set("bonds",this.view.bonds),this.model.set("atomScale",this.view.atomScale),this.model.set("relativeAtomScale",this.view.relativeAtomScale),this.model.set("bondScale",this.view.bondScale),this.model.set("brightness",this.view.brightness),this.model.set("outline",this.view.outline),this.model.set("spf",this.view.spf),this.model.set("bondShade",this.view.bondShade),this.model.set("atomShade",this.view.atomShade),this.model.set("dofStrength",this.view.dofStrength),this.model.set("dofPosition",this.view.dofPosition),this.model.save_changes()},loadStructure:function(){let t=this;t.system=void 0;var e=t.xyz(t.model.get("data"))[0];if(e){t.system=r.new();for(var i=0;i<e.length;i++){var o=e[i],s=o.position[0],n=o.position[1],l=o.position[2];r.addAtom(t.system,o.symbol,s,n,l)}t.center()}},center:function(){let t=this;t.system&&(r.center(t.system),r.calculateBonds(t.system,t.view),this.renderer.setSystem(t.system,t.view),l.center(t.view,t.system),t.needReset=!0)},topview:function(){let t=this;t.system&&(l.rotateX(t.view,Math.PI/2),t.center())},frontview:function(){let t=this;t.system&&(l.rotateX(t.view,0),t.center())},rightview:function(){let t=this;t.system&&(l.rotateY(t.view,-Math.PI/2),t.center())},xyz:function(t){for(var e=t.split("\n"),i=parseInt(e[0]),o=Math.floor(e.length/(i+2)),s=[],n=0;n<o;n++){for(var r=[],l=0;l<i;l++){for(var a=e[n*(i+2)+l+2].split(/\s+/),c={},h=0;""==a[h];)h++;c.symbol=a[h++],c.position=[parseFloat(a[h++]),parseFloat(a[h++]),parseFloat(a[h++])],r.push(c)}s.push(r)}return s},reflow:function(){let t=this;var e=t.container.parentElement.clientWidth,i=t.container.parentElement.clientHeight;0==e&&(e=t.view.resolution.x),0==i&&(i=t.view.resolution.y),t.view.resolution.x==e&&t.view.resolution.y==i||(t.container.style.height=i+"px",t.container.style.width=e+"px",t.container.style.left="0px",t.container.style.top="0px",t.view.resolution.x=e,t.view.resolution.y=i,t.renderer=new n(t.canvas,t.view.resolution,t.view.aoRes))},loop:function(){let t=this;t.needReset&&(t.renderer.reset(),t.needReset=!1),t.renderer.render(t.view),requestAnimationFrame(function(){t.loop()})},handleCustomMessage:function(t){"do"in t&&("frontView"==t.do?this.frontview():"topView"==t.do?this.topview():"rightView"==t.do?this.rightview():"changeAtomsColor"==t.do?this.setAtomsColor(t.atoms):"changeColorSchema"==t.do?this.setColorSchema(t.schema):"switchColorSchema"==t.do&&this.switchColorSchema())},render:function(){this.model.on("change:data",this.loadStructure,this),this.model.on("change:bonds",function(){this.view.bonds=this.model.get("bonds"),this.needReset=!0},this),this.model.on("change:atomScale",function(){this.view.atomScale=this.model.get("atomScale"),this.needReset=!0},this),this.model.on("change:relativeAtomScale",function(){this.view.relativeAtomScale=this.model.get("relativeAtomScale"),this.needReset=!0},this),this.model.on("change:bondScale",function(){this.view.bondScale=this.model.get("bondScale"),this.needReset=!0},this),this.model.on("change:brightness",function(){this.view.brightness=this.model.get("brightness"),this.needReset=!0},this),this.model.on("change:outline",function(){this.view.outline=this.model.get("outline"),this.needReset=!0},this),this.model.on("change:spf",function(){this.view.spf=this.model.get("spf"),this.needReset=!0},this),this.model.on("change:bondThreshold",function(){this.view.bondThreshold=this.model.get("bondThreshold"),this.loadStructure()},this),this.model.on("change:bondShade",function(){this.view.bondShade=this.model.get("bondShade"),this.needReset=!0},this),this.model.on("change:atomShade",function(){this.view.atomShade=this.model.get("atomShade"),this.needReset=!0},this),this.model.on("change:dofStrength",function(){this.view.dofStrength=this.model.get("dofStrength"),this.needReset=!0},this),this.model.on("change:dofPosition",function(){this.view.dofPosition=this.model.get("dofPosition"),this.needReset=!0},this),this.model.on("msg:custom",this.handleCustomMessage,this)},processPhosphorMessage:function(t){d.__super__.processPhosphorMessage.apply(this,arguments),this._handleMessage(t)},processLuminoMessage:function(t){d.__super__.processLuminoMessage.apply(this,arguments),this._handleMessage(t)},_handleMessage:function(t){let e=this;switch(t.type){case"before-attach":window.addEventListener("resize",function(){e.reflow(),e.loadStructure()});break;case"after-attach":e.reflow(),e.loop(),e.loadStructure();break;case"resize":e.reflow(),e.center()}}});t.exports={SpeckModel:h,SpeckView:d}},509:(t,e,i)=>{t.exports=i(249),t.exports.version=i(330).version},741:t=>{t.exports={default:{atomScale:.6,relativeAtomScale:1,bondScale:.5,ao:.75,aoRes:256,brightness:.5,outline:0,spf:32,bonds:!1,bondThreshold:1.2,bondShade:.5,atomShade:.5,dofStrength:0,dofPosition:.5,fxaa:1},stickball:{atomScale:.24,relativeAtomScale:.64,bondScale:.5,bonds:!0,bondThreshold:1.2},toon:{ao:0,spf:0,brightness:.5,outline:1},licorice:{atomScale:.1,relativeAtomScale:0,bondScale:1,bonds:!0,bondThreshold:1.2}}}}]);
# --- DataModule ---
data:
  class_path: assi.datasets.dataset_segmented.SegmentedDataModule
  init_args:
    storage:
      class_path: assi.datastorage.LocalStorage
      init_args:
        dataset_base_folder: .cache\mimii\
        metadata_path: .cache\mimii\0_dB_pump\metadata.csv

    frame_length: 512
    frame_hop: 512
    batch_size: 200
    metadata_query: split == 'train'
    num_workers: 4
    use_cache: false

# --- Model ---
model:
  class_path: assi.models.NFLOWSModel
  init_args:
    frame_length: ${data.init_args.frame_length}
    channels: [0, ]
    num_layers: 2
    transform_n_fft: 512
    transform_win_length: 512
    transform_hop_length: 64
    
# --- Seed ---
seed_everything: 42

# --- Trainer ---
trainer:
  max_epochs: 30
  callbacks:
    - class_path: lightning.pytorch.callbacks.ModelCheckpoint
      init_args:
        save_weights_only: true
        save_top_k: 3
        monitor: val_loss
  logger:
    class_path: lightning.pytorch.loggers.CSVLogger
    init_args:
      save_dir: ${assi.lightning_logs_dir:}
  gradient_clip_val: 1

# --- Optimizer ---
optimizer:
  class_path: Adam
  init_args:
    lr: 0.001

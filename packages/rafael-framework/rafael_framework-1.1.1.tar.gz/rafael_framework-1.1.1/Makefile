# RAFAEL Framework Makefile
# Convenient commands for development and deployment

.PHONY: help install test lint format clean build deploy docker

help:
	@echo "ğŸ”± RAFAEL Framework - Available Commands"
	@echo "========================================"
	@echo ""
	@echo "Development:"
	@echo "  make install     - Install dependencies"
	@echo "  make test        - Run tests"
	@echo "  make lint        - Run linters"
	@echo "  make format      - Format code"
	@echo "  make clean       - Clean build artifacts"
	@echo ""
	@echo "Deployment:"
	@echo "  make build       - Build package"
	@echo "  make deploy      - Deploy to PyPI"
	@echo "  make docker      - Build Docker image"
	@echo "  make docker-push - Push Docker image"
	@echo ""
	@echo "Examples:"
	@echo "  make run-fintech - Run fintech example"
	@echo "  make run-game    - Run game example"
	@echo ""

install:
	@echo "ğŸ“¦ Installing dependencies..."
	pip install -e ".[dev]"
	@echo "âœ… Installation complete"

test:
	@echo "ğŸ§ª Running tests..."
	python -m pytest tests/ -v --cov=core --cov=chaos_forge --cov=vault --cov=guardian
	@echo "âœ… Tests complete"

lint:
	@echo "ğŸ” Running linters..."
	flake8 core/ chaos_forge/ vault/ guardian/ devkit/ --max-line-length=100
	mypy core/ --ignore-missing-imports || true
	@echo "âœ… Linting complete"

format:
	@echo "âœ¨ Formatting code..."
	black core/ chaos_forge/ vault/ guardian/ devkit/ examples/ tests/
	@echo "âœ… Formatting complete"

clean:
	@echo "ğŸ§¹ Cleaning build artifacts..."
	rm -rf build/ dist/ *.egg-info
	find . -type d -name __pycache__ -exec rm -rf {} + 2>/dev/null || true
	find . -type f -name "*.pyc" -delete
	find . -type f -name "*.pyo" -delete
	@echo "âœ… Cleanup complete"

build: clean
	@echo "ğŸ”¨ Building package..."
	python -m build
	twine check dist/*
	@echo "âœ… Build complete"

deploy: build test
	@echo "ğŸš€ Deploying to PyPI..."
	twine upload dist/*
	@echo "âœ… Deployment complete"

docker:
	@echo "ğŸ³ Building Docker image..."
	docker build -t rafaelframework/rafael:latest .
	@echo "âœ… Docker image built"

docker-push: docker
	@echo "ğŸ“¤ Pushing Docker image..."
	docker push rafaelframework/rafael:latest
	@echo "âœ… Docker image pushed"

run-fintech:
	@echo "ğŸ’³ Running fintech example..."
	python examples/fintech_example.py

run-game:
	@echo "ğŸ® Running game example..."
	python examples/game_example.py

# Quick commands
all: clean install test lint build

dev: install format test

release: test lint build deploy

.DEFAULT_GOAL := help

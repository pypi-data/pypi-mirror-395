"use strict";(self.webpackChunk_jupytergis_jupytergis_core=self.webpackChunk_jupytergis_jupytergis_core||[]).push([[397],{67397:(e,t,r)=>{r.r(t),r.d(t,{IAnnotationToken:()=>f,IJGISExternalCommandRegistryToken:()=>_,IJGISFormSchemaRegistryToken:()=>m,IJGISLayerBrowserRegistryToken:()=>S,IJupyterGISDocTracker:()=>p,JupyterGISDoc:()=>l,JupyterGISModel:()=>c,ProcessingCommandIDs:()=>C,ProcessingLogicType:()=>v,ProcessingMerge:()=>T,SCHEMA_VERSION:()=>d,processingList:()=>L});var s=r(74602),a=r(26803),i=r.n(a),o=r(28e3),n=r(67262);const d="0.5.0";class l extends o.YDocument{constructor(){super(),this.editable=!0,this._optionsObserver=e=>{this._optionsChanged.emit(e.keys)},this._metaObserver=e=>{this._metadataChanged.emit(e.keys)},this._optionsChanged=new s.Signal(this),this._layersChanged=new s.Signal(this),this._layerTreeChanged=new s.Signal(this),this._sourcesChanged=new s.Signal(this),this._metadataChanged=new s.Signal(this),this._options=this.ydoc.getMap("options"),this._layers=this.ydoc.getMap("layers"),this._layerTree=this.ydoc.getArray("layerTree"),this._sources=this.ydoc.getMap("sources"),this._metadata=this.ydoc.getMap("metadata"),this.undoManager.addToScope(this._layers),this.undoManager.addToScope(this._sources),this.undoManager.addToScope(this._layerTree),this._layers.observeDeep(this._layersObserver.bind(this)),this._layerTree.observe(this._layerTreeObserver.bind(this)),this._sources.observeDeep(this._sourcesObserver.bind(this)),this._options.observe(this._optionsObserver.bind(this)),this._metadata.observe(this._metaObserver.bind(this))}getSource(){const e=this._layers.toJSON(),t=this._layerTree.toJSON(),r=this._options.toJSON();return{layers:e,layerTree:t,sources:this._sources.toJSON(),options:r,metadata:this._metadata.toJSON()}}setSource(e){e&&("string"==typeof e&&(e=JSON.parse(e)),this.transact(()=>{var t,r,s,a,i;const o=null!==(t=e.layers)&&void 0!==t?t:{};Object.entries(o).forEach(([e,t])=>this._layers.set(e,t)),(null!==(r=e.layerTree)&&void 0!==r?r:[]).forEach(e=>{this._layerTree.push([e])});const n=null!==(s=e.options)&&void 0!==s?s:{};Object.entries(n).forEach(([e,t])=>this._options.set(e,t));const d=null!==(a=e.sources)&&void 0!==a?a:{};Object.entries(d).forEach(([e,t])=>this._sources.set(e,t));const l=null!==(i=e.metadata)&&void 0!==i?i:{};Object.entries(l).forEach(([e,t])=>this._metadata.set(e,t))}))}dispose(){super.dispose()}get version(){return d}get layers(){return n.JSONExt.deepCopy(this._layers.toJSON())}set layers(e){this.transact(()=>{for(const[t,r]of Object.entries(e))this._layers.set(t,r)})}set sources(e){this.transact(()=>{for(const[t,r]of Object.entries(e))this._sources.set(t,r)})}get sources(){return n.JSONExt.deepCopy(this._sources.toJSON())}get layerTree(){return n.JSONExt.deepCopy(this._layerTree.toJSON())}set layerTree(e){this.transact(()=>{this._layerTree.delete(0,this._layerTree.length),this._layerTree.push(e)})}getLayer(e){if(this._layers.has(e))return n.JSONExt.deepCopy(this._layers.get(e))}getLayerSource(e){if(this._sources.has(e))return n.JSONExt.deepCopy(this._sources.get(e))}set options(e){this.transact(()=>{for(const[t,r]of Object.entries(e))this._options.set(t,r)})}get options(){return n.JSONExt.deepCopy(this._options.toJSON())}get layersChanged(){return this._layersChanged}get layerTreeChanged(){return this._layerTreeChanged}get sourcesChanged(){return this._sourcesChanged}get optionsChanged(){return this._optionsChanged}layerExists(e){return Boolean(this._getLayerAsYMap(e))}removeLayer(e){this.transact(()=>{this._layers.delete(e)})}addLayer(e,t){this.transact(()=>{this._layers.set(e,t)})}updateLayer(e,t){this.transact(()=>{this._layers.set(e,t)})}addLayerTreeItem(e,t){this.transact(()=>{this._layerTree.insert(e,[t])})}updateLayerTreeItem(e,t){this.transact(()=>{this._layerTree.delete(e),t&&this._layerTree.insert(e,[t])})}getObject(e){const t=this.getLayer(e);if(t)return t;return this.getLayerSource(e)||void 0}updateObjectParameters(e,t){const r=this.getLayer(e);r&&(r.parameters=Object.assign(Object.assign({},r.parameters),t),this.updateLayer(e,r));const s=this.getLayerSource(e);s&&(s.parameters=Object.assign(Object.assign({},s.parameters),t),this.updateSource(e,s))}sourceExists(e){return Boolean(this._getSourceAsYMap(e))}removeSource(e){this.transact(()=>{this._sources.delete(e)})}addSource(e,t){this.transact(()=>{this._sources.set(e,t)})}updateSource(e,t){this.transact(()=>this._sources.set(e,t))}getOption(e){const t=this._options.get(e);if(t)return n.JSONExt.deepCopy(t)}setOption(e,t){this.transact(()=>{this._options.set(e,t)})}getMetadata(e){return this._metadata.get(e)}setMetadata(e,t){this.transact(()=>{this._metadata.set(e,t)})}removeMetadata(e){this._metadata.has(e)&&this._metadata.delete(e)}get metadata(){return n.JSONExt.deepCopy(this._metadata.toJSON())}set metadata(e){this.transact(()=>{for(const[t,r]of Object.entries(e))this._metadata.set(t,r)})}get metadataChanged(){return this._metadataChanged}static create(){return new l}_getLayerAsYMap(e){if(this._layers.has(e))return this._layers.get(e)}_getSourceAsYMap(e){if(this._sources.has(e))return this._sources.get(e)}_layersObserver(e){const t=[];let r=!1;e.forEach(e=>{e.keys.forEach((s,a)=>{r||(r=!0),t.push({id:a,oldValue:s.oldValue,newValue:n.JSONExt.deepCopy(e.target.toJSON()[a])})})}),r=0===t.length||r,r&&this._layersChanged.emit({layerChange:t})}_layerTreeObserver(e){const t=e.delta;this._layerTreeChanged.emit({layerTreeChange:t})}_sourcesObserver(e){const t=[];let r=!1;e.forEach(e=>{e.keys.forEach((s,a)=>{r||(r=!0),t.push({id:a,newValue:n.JSONExt.deepCopy(e.target.toJSON()[a])})})}),r=0===t.length||r,r&&this._sourcesChanged.emit({sourceChange:t})}}const h=JSON.parse('{"type":"object","title":"IJGISContent","required":["layers","sources"],"additionalProperties":false,"properties":{"schemaVersion":{"type":"string","default":"0.5.0"},"layers":{"$ref":"#/definitions/jGISLayers"},"sources":{"$ref":"#/definitions/jGISSources"},"layerTree":{"$ref":"#/definitions/jGISLayerTree"},"options":{"$ref":"#/definitions/jGISOptions"},"metadata":{"type":"object","patternProperties":{"^.*$":{"type":"string"}},"additionalProperties":false}},"definitions":{"layerType":{"type":"string","enum":["RasterLayer","VectorLayer","VectorTileLayer","HillshadeLayer","WebGlLayer","ImageLayer","HeatmapLayer","StacLayer"]},"sourceType":{"type":"string","enum":["RasterSource","VectorTileSource","GeoJSONSource","RasterDemSource","VideoSource","ImageSource","ShapefileSource","GeoTiffSource","GeoParquetSource","MarkerSource"]},"jGISLayer":{"title":"IJGISLayer","type":"object","additionalProperties":false,"required":["name","type","visible"],"properties":{"name":{"type":"string"},"type":{"$ref":"#/definitions/layerType"},"visible":{"type":"boolean","default":true},"parameters":{"type":"object"},"filters":{"$ref":"#/definitions/jGISFilter"}}},"jGISSource":{"title":"IJGISSource","type":"object","additionalProperties":false,"required":["name","type"],"properties":{"name":{"type":"string"},"type":{"$ref":"#/definitions/sourceType"},"parameters":{"type":"object"}}},"jGISLayerGroup":{"title":"IJGISLayerGroup","type":"object","additionalProperties":false,"required":["name","layers"],"properties":{"name":{"type":"string"},"layers":{"type":"array","default":[],"items":{"$ref":"#/definitions/jGISLayerItem"}},"visible":{"type":"boolean","default":true},"parameters":{"type":"object"}}},"jGISLayerItem":{"title":"IJGISLayerItem","oneOf":[{"type":"string"},{"$ref":"#/definitions/jGISLayerGroup"}]},"jGISLayers":{"title":"IJGISLayers","type":"object","default":{},"additionalProperties":{"$ref":"#/definitions/jGISLayer"}},"jGISSources":{"title":"IJGISSources","type":"object","default":{},"additionalProperties":{"$ref":"#/definitions/jGISSource"}},"jGISLayerTree":{"title":"IJGISLayerTree","type":"array","default":[],"items":{"$ref":"#/definitions/jGISLayerItem"}},"jGISOptions":{"title":"IJGISOptions","type":"object","default":{},"required":[],"additionalProperties":false,"properties":{"latitude":{"type":"number","default":0},"longitude":{"type":"number","default":0},"zoom":{"type":"number","default":0},"bearing":{"type":"number","default":0},"pitch":{"type":"number","default":0},"extent":{"type":"array","default":null,"items":{"type":"number"}},"projection":{"type":"string","default":"EPSG:3857"},"useExtent":{"type":"boolean","default":false}}},"jGISFilterItem":{"title":"IJGISFilterItem","type":"object","default":{},"required":["operator","feature","value"],"additionalProperties":false,"properties":{"operator":{"type":"string","enum":["==","!=",">","<",">=","<=","between"],"default":"=="},"feature":{"type":"string","default":""},"value":{"type":["string","number"]},"betweenMin":{"type":["number"]},"betweenMax":{"type":["number"]}}},"jGISFilter":{"title":"IJGISFilter","type":"object","required":["logicalOp","appliedFilters"],"additionalProperties":false,"properties":{"logicalOp":{"type":"string","default":"all"},"appliedFilters":{"type":"array","default":[],"items":{"$ref":"#/definitions/jGISFilterItem"}}}}}}'),g="@jupytergis/jupytergis-core:jupytergis-settings",u={proxyUrl:"https://corsproxy.io",leftPanelDisabled:!1,rightPanelDisabled:!1,layersDisabled:!1,stacBrowserDisabled:!1,filtersDisabled:!1,objectPropertiesDisabled:!1,annotationsDisabled:!1,identifyDisabled:!1};class c{constructor(e){this._onSharedModelChanged=(e,t)=>{var r;t&&(null===(r=null==t?void 0:t.objectChange)||void 0===r?void 0:r.length)&&(this._contentChanged.emit(void 0),this.dirty=!0)},this.collaborative=void 0===document.querySelectorAll("[data-jupyter-lite-root]")[0],this.flyToGeometrySignal=new s.Signal(this),this.highlightFeatureSignal=new s.Signal(this),this.updateBboxSignal=new s.Signal(this),this._onClientStateChanged=e=>{const t=this.sharedModel.awareness.getStates();this._clientStateChanged.emit(t),(e.added.length||e.removed.length)&&this._userChanged.emit(this.users)},this.addFeatureAsMs=(e,t)=>{this.addFeatureAsMsSignal.emit(JSON.stringify({id:e,selectedFeature:t}))},this.triggerLayerUpdate=(e,t)=>{this.updateLayerSignal.emit(JSON.stringify({layerId:e,layer:t}))},this.defaultKernelName="",this.defaultKernelLanguage="",this._dirty=!1,this._readOnly=!1,this._isDisposed=!1,this._userChanged=new s.Signal(this),this._disposed=new s.Signal(this),this._contentChanged=new s.Signal(this),this._stateChanged=new s.Signal(this),this._themeChanged=new s.Signal(this),this._clientStateChanged=new s.Signal(this),this._sharedMetadataChanged=new s.Signal(this),this._zoomToPositionSignal=new s.Signal(this),this._addFeatureAsMsSignal=new s.Signal(this),this._updateLayerSignal=new s.Signal(this),this._isTemporalControllerActive=!1,this._editing=null,this._editingChanged=new s.Signal(this),this._geolocationChanged=new s.Signal(this),this._tileFeatureCache=new Map;const{annotationModel:t,sharedModel:r,settingRegistry:a}=e;r?this._sharedModel=r:(this._sharedModel=l.create(),this._sharedModel.changed.connect(this._onSharedModelChanged)),this.sharedModel.awareness.on("change",this._onClientStateChanged),this._sharedModel.metadataChanged.connect(this._metadataChangedHandler,this),this.annotationModel=t,this.settingRegistry=a,this._pathChanged=new s.Signal(this),this._settingsChanged=new s.Signal(this),this._jgisSettings=Object.assign({},u),this.initSettings()}async initSettings(){if(this.settingRegistry)try{const e=await this.settingRegistry.load(g);this._settings=e,this._updateLocalSettings(),e.changed.connect(()=>{const e=Object.assign({},this._jgisSettings);this._updateLocalSettings();const t=this._jgisSettings;Object.keys(u).forEach(r=>{e[r]!==t[r]&&this._settingsChanged.emit(r)})})}catch(e){console.error(`Failed to load settings for ${g}:`,e),this._jgisSettings=Object.assign({},u)}}_updateLocalSettings(){const e=this._settings.composite;this._jgisSettings=Object.entries(u).reduce((t,[r,s])=>{const a=r,i=e[a];return t[a]=null!=i?i:s,t},{})}get jgisSettings(){return this._jgisSettings}get settingsChanged(){return this._settingsChanged}async getSettings(){return this._settings}getFeaturesForCurrentTile({sourceId:e}){var t;return Array.from(null!==(t=this._tileFeatureCache.get(e))&&void 0!==t?t:[])}syncTileFeatures({sourceId:e,features:t}){let r=this._tileFeatureCache.get(e);r||(r=new Set,this._tileFeatureCache.set(e,r)),t.forEach(e=>r.add(e))}get sharedModel(){return this._sharedModel}get isDisposed(){return this._isDisposed}get contentChanged(){return this._contentChanged}get stateChanged(){return this._stateChanged}get pathChanged(){return this._pathChanged}get themeChanged(){return this._themeChanged}get currentUserId(){var e;return null===(e=this.sharedModel)||void 0===e?void 0:e.awareness.clientID}get users(){var e;this._usersMap=null===(e=this._sharedModel)||void 0===e?void 0:e.awareness.getStates();const t=[];return this._usersMap&&this._usersMap.forEach((e,r)=>{t.push({userId:r,userData:e.user})}),t}get userChanged(){return this._userChanged}get dirty(){return this._dirty}set dirty(e){this._dirty=e}get readOnly(){return this._readOnly}set readOnly(e){this._readOnly=e}get localState(){return this.sharedModel.awareness.getLocalState()}get clientStateChanged(){return this._clientStateChanged}get sharedOptionsChanged(){return this.sharedModel.optionsChanged}get sharedLayersChanged(){return this.sharedModel.layersChanged}get sharedLayerTreeChanged(){return this.sharedModel.layerTreeChanged}get sharedSourcesChanged(){return this.sharedModel.sourcesChanged}get disposed(){return this._disposed}get sharedMetadataChanged(){return this._sharedMetadataChanged}get zoomToPositionSignal(){return this._zoomToPositionSignal}set isTemporalControllerActive(e){this._isTemporalControllerActive=e}get isTemporalControllerActive(){return this._isTemporalControllerActive}centerOnPosition(e){this._zoomToPositionSignal.emit(e)}_metadataChangedHandler(e,t){this._sharedMetadataChanged.emit(t)}addMetadata(e,t){this.sharedModel.setMetadata(e,t)}removeMetadata(e){this.sharedModel.removeMetadata(e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._sharedModel.dispose(),this._disposed.emit(),s.Signal.clearData(this))}toString(){return JSON.stringify(this.getContent(),null,2)}fromString(e){const t=JSON.parse(e),r=(new(i())).compile(h);if(!r(t)){let e="JupyterGIS format errors:\n";for(const t of r.errors||[])e=`${e}- ${t.instancePath} ${t.message}\n`;console.warn(e)}this.sharedModel.transact(()=>{var e,r,s,a,i;this.sharedModel.sources=null!==(e=t.sources)&&void 0!==e?e:{},this.sharedModel.layers=null!==(r=t.layers)&&void 0!==r?r:{},this.sharedModel.layerTree=null!==(s=t.layerTree)&&void 0!==s?s:[],this.sharedModel.options=null!==(a=t.options)&&void 0!==a?a:{latitude:0,longitude:0,zoom:0,bearing:0,pitch:0,projection:"EPSG:3857"},this.sharedModel.metadata=null!==(i=t.metadata)&&void 0!==i?i:{}}),this.dirty=!0}toJSON(){return JSON.parse(this.toString())}fromJSON(e){}initialize(){}getWorker(){return c.worker}getContent(){return{sources:this.sharedModel.sources,layers:this.sharedModel.layers,layerTree:this.sharedModel.layerTree,options:this.sharedModel.options,metadata:this.sharedModel.metadata}}get contentsManager(){return this._contentsManager}set contentsManager(e){this._contentsManager=e}get filePath(){return this._filePath}set filePath(e){this._filePath=e,this._pathChanged.emit(e)}getLayers(){return this.sharedModel.layers}getSources(){return this.sharedModel.sources}getLayerTree(){return this.sharedModel.layerTree}getLayer(e){return this.sharedModel.getLayer(e)}getSource(e){return this.sharedModel.getLayerSource(e)}getSourcesByType(e){const t={};for(const r of Object.keys(this.getSources()||{})){const s=this.getSource(r);(null==s?void 0:s.type)===e&&(t[r]=s.name)}return t}getLayersBySource(e){const t=[];return Object.entries(this.getLayers()||{}).forEach(([r,s])=>{var a;(null===(a=s.parameters)||void 0===a?void 0:a.source)===e&&t.push(r)}),t}addGroup(e,t,r){if(y.findItemPath(this.getLayerTree(),e).length)return void console.warn(`The group "${t}" already exist in the layer tree`);const s={name:e,layers:[]};this._addLayerTreeItem(s,t,r)}addLayer(e,t,r,s){this.getLayer(e)||this.sharedModel.addLayer(e,t),this._addLayerTreeItem(e,r,s)}removeLayer(e){var t;const r=this._sharedModel.getLayer(e),s=null===(t=null==r?void 0:r.parameters)||void 0===t?void 0:t.source;this._removeLayerTreeLayer(this.getLayerTree(),e),this.sharedModel.removeLayer(e),this.sharedModel.removeSource(s)}setOptions(e){this._sharedModel.options=e}getOptions(){return this._sharedModel.options}syncViewport(e,t){this.sharedModel.awareness.setLocalStateField("viewportState",{value:e,emitter:t})}syncPointer(e,t){this.sharedModel.awareness.setLocalStateField("pointer",{value:e,emitter:t})}syncSelected(e,t){this.sharedModel.awareness.setLocalStateField("selected",{value:e,emitter:t})}get selected(){var e,t;return null===(t=null===(e=this.localState)||void 0===e?void 0:e.selected)||void 0===t?void 0:t.value}set selected(e){this.syncSelected(e||{},this.getClientId().toString())}syncIdentifiedFeatures(e,t){this.sharedModel.awareness.setLocalStateField("identifiedFeatures",{value:e,emitter:t})}setUserToFollow(e){this._sharedModel&&this._sharedModel.awareness.setLocalStateField("remoteUser",e)}setEditingItem(e,t){this._editing={type:e,itemId:t},this._editingChanged.emit(this._editing)}clearEditingItem(){this._editing=null,this._editingChanged.emit(null)}get editing(){return this._editing}get editingChanged(){return this._editingChanged}getClientId(){return this.sharedModel.awareness.clientID}_addLayerTreeItem(e,t,r){if(t){const s=this._getLayerTreeInfo(t);s&&(s.workingGroup.layers.splice(null!=r?r:s.workingGroup.layers.length,0,e),this._sharedModel.updateLayerTreeItem(s.mainGroupIndex,s.mainGroup))}else this.sharedModel.addLayerTreeItem(null!=r?r:this.getLayerTree().length,e)}moveItemsToGroup(e,t,r){const s=this.getLayerTree();for(const a of e)if(this.getLayer(a))this._removeLayerTreeLayer(s,a),this._addLayerTreeItem(a,t,r);else{const e=this._getLayerTreeInfo(a);if(void 0===e)continue;const i=Object.assign({},e.workingGroup);this._removeLayerTreeGroup(s,a),this._addLayerTreeItem(i,t,r)}}moveItemRelatedTo(e,t,r){var s;const a=this.getLayerTree();let i;if(this.getLayer(e))this._removeLayerTreeLayer(a,e),i=e;else{const t=this._getLayerTreeInfo(e);if(void 0===t)return;i=Object.assign({},t.workingGroup),this._removeLayerTreeGroup(a,e)}const o=y.findItemPath(a,t),n=(null!==(s=o.pop())&&void 0!==s?s:0)+(r?1:0);let d="",l=o.shift();if(void 0!==l){let e=a[l];for(;o.length&&(l=o.shift(),void 0!==l);)e=e.layers[l];d=e.name}this._addLayerTreeItem(i,d,n)}addNewLayerGroup(e,t){const r=this.getLayerTree();for(const t in e)this._removeLayerTreeLayer(r,t);this._addLayerTreeItem(t)}_removeLayerTreeLayer(e,t){this._removeLayerTreeItem(e,t,!0),this.sharedModel.layerTree=e}_removeLayerTreeGroup(e,t){this._removeLayerTreeItem(e,t,!1),this.sharedModel.layerTree=e}_removeLayerTreeItem(e,t,r){for(let s=0;s<e.length;s++){const a=e[s];(r?"string"==typeof a&&a===t:"string"!=typeof a&&a.name===t)?(e.splice(s,1),s--):"string"!=typeof a&&"layers"in a&&this._removeLayerTreeItem(a.layers,t,r)}}renameLayerGroup(e,t){const r=this._getLayerTreeInfo(e);r?(r.workingGroup.name=t,this._sharedModel.updateLayerTreeItem(r.mainGroupIndex,r.mainGroup)):console.error("Layer group rename failed -- could not get layer tree.")}removeLayerGroup(e){const t=this.getLayerTree(),r=this._getLayerTreeInfo(e),s=function e(t,r){const s=[];for(const a of t)if("string"==typeof a)s.push(a);else if(a.name!==r){const t=e(a.layers,r);s.push(Object.assign(Object.assign({},a),{layers:t}))}return s}(t,e);r&&this._sharedModel.updateLayerTreeItem(r.mainGroupIndex,s[r.mainGroupIndex])}toggleMode(e){this._currentMode=this._currentMode===e?"panning":e}get currentMode(){return this._currentMode}set currentMode(e){this._currentMode=e}toggleTemporalController(){this._isTemporalControllerActive=!this._isTemporalControllerActive,this.sharedModel.awareness.setLocalStateField("isTemporalControllerActive",this._isTemporalControllerActive)}_getLayerTreeInfo(e){const t=this.getLayerTree(),r=y.findItemPath(t,e);if(!r.length)return void console.warn(`The group "${e}" does not exist in the layer tree`);const s=r.shift();if(void 0===s)return;const a=t[s];let i=a;for(;r.length;){const e=r.shift();if(void 0===e)break;i=i.layers[e]}return{mainGroup:a,workingGroup:i,mainGroupIndex:s}}get addFeatureAsMsSignal(){return this._addFeatureAsMsSignal}get updateLayerSignal(){return this._updateLayerSignal}get geolocation(){return this._geolocation}set geolocation(e){this._geolocation=e,this.geolocationChanged.emit(this.geolocation)}get geolocationChanged(){return this._geolocationChanged}}var y;!function(e){e.getOrderedLayerIds=function(e){return y.layerTreeRecursion(e.sharedModel.layerTree)}}(c||(c={})),function(e){e.layerTreeRecursion=function e(t,r=[]){for(const s of t)"string"==typeof s?r.push(s):r.push(...e(s.layers));return r},e.findItemPath=function e(t,r,s=[]){for(let a=0;a<t.length;a++){const i=t[a];if("string"==typeof i){if(i===r){const e=[...s];return e.push(a),e}}else{const t=[...s];if(t.push(a),i.name===r)return t;const o=e(i.layers,r,t);if(o.length>t.length)return o}}return s}}(y||(y={}));const p=new n.Token("jupyterGISDocTracker"),m=new n.Token("jupytergisFormSchemaRegistry"),_=new n.Token("jupytergisExternalCommandRegistry"),S=new n.Token("jupytergisExternalCommandRegistry"),f=new n.Token("jupytergisAnnotationModel"),v={vector:"vector"},T=JSON.parse('[{"description":"Centroids","name":"centroids","operationParams":[],"label":"Centroids","operations":{"gdalFunction":"ogr2ogr","sql":"SELECT ST_Centroid(geometry) AS geometry, * FROM \\"{layerName}\\""},"type":"vector"},{"description":"ConvexHull","name":"convexHull","operationParams":[],"label":"Convex Hull","operations":{"sql":"SELECT ST_ConvexHull(geometry) AS geometry, * FROM \\"{layerName}\\"","gdalFunction":"ogr2ogr"},"type":"vector"},{"description":"ConcaveHull","name":"concaveHull","operationParams":["pctconvex","allowHoles"],"label":"Concave Hull","operations":{"sql":"SELECT ST_ConcaveHull(geometry,{pctconvex},{allowHoles}) AS geometry, * FROM \\"{layerName}\\"","gdalFunction":"ogr2ogr"},"type":"vector"},{"description":"Buffer","name":"buffer","label":"Buffer","operationParams":["bufferDistance"],"operations":{"gdalFunction":"ogr2ogr","sql":"SELECT ST_Union(ST_Buffer(geometry, {bufferDistance})) AS geometry, * FROM \\"{layerName}\\""},"type":"vector"},{"description":"Dissolve","name":"dissolve","operationParams":["dissolveField"],"label":"Dissolve","operations":{"gdalFunction":"ogr2ogr","sql":"SELECT ST_Union(geometry) AS geometry, {dissolveField} FROM \\"{layerName}\\" GROUP BY {dissolveField}"},"type":"vector"},{"description":"BoundingBoxes","name":"boundingBoxes","operationParams":[],"label":"Bounding Boxes","operations":{"sql":"SELECT ST_Envelope(geometry) AS geometry, * FROM \\"{layerName}\\"","gdalFunction":"ogr2ogr"},"type":"vector"}]'),C={};for(const e of T)C[e.name]=`jupytergis:${e.name}`;const L=["Centroids","ConvexHull","ConcaveHull","Buffer","Dissolve","BoundingBoxes"]}}]);
export const __webpack_id__="6502";export const __webpack_ids__=["6502"];export const __webpack_modules__={55e3:function(e,t,o){o(65315),o(22416),e.exports=function e(t){return Object.freeze(t),Object.getOwnPropertyNames(t).forEach(function(o){!t.hasOwnProperty(o)||null===t[o]||"object"!=typeof t[o]&&"function"!=typeof t[o]||Object.isFrozen(t[o])||e(t[o])}),t}},68289:function(e,t,o){o.d(t,{Vw:()=>n,kG:()=>i,y6:()=>s});const a=(e,t,o)=>new Promise((a,s)=>{const i=document.createElement(e);let n="src",r="body";switch(i.onload=()=>a(t),i.onerror=()=>s(t),e){case"script":i.async=!0,o&&(i.type=o);break;case"link":i.type="text/css",i.rel="stylesheet",n="href",r="head"}i[n]=t,document[r].appendChild(i)}),s=e=>a("link",e),i=e=>a("script",e),n=e=>a("script",e,"module")},54531:function(e,t,o){o.d(t,{EG:()=>a});const a=(e,t,o)=>e.subscribeEvents(e=>{e.data.url_path===t&&o()},"lovelace_updated")},15538:function(e,t,o){o.d(t,{Uh:()=>i,Zg:()=>s,kZ:()=>a,o8:()=>n});const a=e=>e.sendMessagePromise({type:"lovelace/resources"}),s=(e,t)=>e.callWS({type:"lovelace/resources/create",...t}),i=(e,t,o)=>e.callWS({type:"lovelace/resources/update",resource_id:t,...o}),n=(e,t)=>e.callWS({type:"lovelace/resources/delete",resource_id:t})},85288:function(e,t,o){o.a(e,async function(e,a){try{o.r(t);var s=o(69868),i=o(84922),n=o(22019),r=o(77240),h=(o(65442),o(17372)),c=(o(45148),o(94124),e([h]));h=(c.then?(await c)():c)[0];class l extends i.WF{render(){return i.qy` ${this.toolbar?i.qy`<div class="toolbar"> ${this.rootnav||history.state?.root?i.qy` <ha-menu-button .hass="${this.hass}" .narrow="${this.narrow}"></ha-menu-button> `:i.qy` <ha-icon-button-arrow-prev .hass="${this.hass}" @click="${this._handleBack}"></ha-icon-button-arrow-prev> `} </div>`:""} <div class="content"> <ha-alert alert-type="error">${this.error}</ha-alert> <slot> <ha-button appearance="plain" size="small" @click="${this._handleBack}"> ${this.hass?.localize("ui.common.back")} </ha-button> </slot> </div> `}_handleBack(){(0,r.O)()}static get styles(){return[i.AH`:host{display:block;height:100%;background-color:var(--primary-background-color)}.toolbar{display:flex;align-items:center;font-size:var(--ha-font-size-xl);height:var(--header-height);padding:8px 12px;pointer-events:none;background-color:var(--app-header-background-color);font-weight:var(--ha-font-weight-normal);color:var(--app-header-text-color,#fff);border-bottom:var(--app-header-border-bottom,none);box-sizing:border-box}@media (max-width:599px){.toolbar{padding:4px}}ha-icon-button-arrow-prev{pointer-events:auto}.content{color:var(--primary-text-color);height:calc(100% - var(--header-height));display:flex;padding:16px;align-items:center;justify-content:center;flex-direction:column;box-sizing:border-box}a{color:var(--primary-color)}ha-alert{margin-bottom:16px}`]}constructor(...e){super(...e),this.toolbar=!0,this.rootnav=!1,this.narrow=!1}}(0,s.__decorate)([(0,n.MZ)({attribute:!1})],l.prototype,"hass",void 0),(0,s.__decorate)([(0,n.MZ)({type:Boolean})],l.prototype,"toolbar",void 0),(0,s.__decorate)([(0,n.MZ)({type:Boolean})],l.prototype,"rootnav",void 0),(0,s.__decorate)([(0,n.MZ)({type:Boolean})],l.prototype,"narrow",void 0),(0,s.__decorate)([(0,n.MZ)()],l.prototype,"error",void 0),l=(0,s.__decorate)([(0,n.EM)("hass-error-screen")],l),a()}catch(e){a(e)}})},70890:function(e,t,o){o.a(e,async function(e,a){try{o.r(t);var s=o(69868),i=o(84922),n=o(22019),r=o(77240),h=o(96635),c=(o(65442),o(45148),o(50809)),l=e([h]);h=(l.then?(await l)():l)[0];class d extends i.WF{render(){return i.qy` ${this.noToolbar?"":i.qy`<div class="toolbar"> ${this.rootnav||history.state?.root?i.qy` <ha-menu-button .hass="${this.hass}" .narrow="${this.narrow}"></ha-menu-button> `:i.qy` <ha-icon-button-arrow-prev .hass="${this.hass}" @click="${this._handleBack}"></ha-icon-button-arrow-prev> `} </div>`} <div class="content"> <ha-spinner></ha-spinner> ${this.message?i.qy`<div id="loading-text">${this.message}</div>`:i.s6} </div> `}_handleBack(){(0,r.O)()}static get styles(){return[c.RF,i.AH`:host{display:block;height:100%;background-color:var(--primary-background-color)}.toolbar{display:flex;align-items:center;font-size:var(--ha-font-size-xl);height:var(--header-height);padding:8px 12px;pointer-events:none;background-color:var(--app-header-background-color);font-weight:var(--ha-font-weight-normal);color:var(--app-header-text-color,#fff);border-bottom:var(--app-header-border-bottom,none);box-sizing:border-box}@media (max-width:599px){.toolbar{padding:4px}}ha-icon-button-arrow-prev,ha-menu-button{pointer-events:auto}.content{height:calc(100% - var(--header-height));display:flex;flex-direction:column;align-items:center;justify-content:center}#loading-text{max-width:350px;margin-top:16px}`]}constructor(...e){super(...e),this.noToolbar=!1,this.rootnav=!1,this.narrow=!1}}(0,s.__decorate)([(0,n.MZ)({attribute:!1})],d.prototype,"hass",void 0),(0,s.__decorate)([(0,n.MZ)({type:Boolean,attribute:"no-toolbar"})],d.prototype,"noToolbar",void 0),(0,s.__decorate)([(0,n.MZ)({type:Boolean})],d.prototype,"rootnav",void 0),(0,s.__decorate)([(0,n.MZ)({type:Boolean})],d.prototype,"narrow",void 0),(0,s.__decorate)([(0,n.MZ)()],d.prototype,"message",void 0),d=(0,s.__decorate)([(0,n.EM)("hass-loading-screen")],d),a()}catch(e){a(e)}})},47434:function(e,t,o){o.d(t,{eX:()=>n});o(65315),o(12840),o(837),o(37089);var a=o(60704),s=o(61830),i=o(37230);const n=e=>{if((0,s.Wu)(e))return e;const t={...e};return t.views&&(t.views=t.views.map(r)),t},r=e=>{if((0,i.R)(e))return e;const t={...e};return t.badges&&!t.badges.every(Boolean)&&(t.badges=t.badges.filter(Boolean)),t.sections&&(t.sections=t.sections.map(h)),t},h=e=>{const t={...e};if(e.title){if(!(0,a.H)(t)){const e={type:"heading",heading:t.title};t.cards=[e,...t.cards||[]]}delete t.title}return t}},39799:function(e,t,o){o.d(t,{n:()=>n});o(65315),o(22416),o(81071),o(92714),o(55885);var a=o(68289);const s={},i={},n=(e,t)=>{e.forEach(e=>{const o=new URL(e.url,t.auth.data.hassUrl).toString();switch(e.type){case"css":if(o in s)break;s[o]=(0,a.y6)(o);break;case"js":if(o in i)break;i[o]=(0,a.kG)(o);break;case"module":(0,a.Vw)(o);break;default:console.warn(`Unknown resource type specified: ${e.type}`)}})}},26213:function(e,t,o){o.a(e,async function(e,a){try{o.r(t),o.d(t,{LovelacePanel:()=>N});var s=o(69868),i=o(55e3),n=o.n(i),r=o(84922),h=o(22019),c=o(15676),l=o(94372),d=o(51849),p=o(29561),g=o(61964),u=o(54531),v=o(61830),_=o(15538),f=o(85288),y=o(70890),b=o(91197),w=o(47434),m=o(39799),C=o(14522),x=o(120),k=o(17372),$=o(49077),M=e([f,y,x,k]);[f,y,x,k]=M.then?(await M)():M,window.loadCardHelpers=()=>Promise.all([o.e("78525"),o.e("15116"),o.e("37533")]).then(o.bind(o,67717));const S={strategy:{type:"original-states"}};let U=!1,E=!1;class N extends r.WF{connectedCallback(){super.connectedCallback(),this.lovelace&&this.hass&&this.lovelace.locale!==this.hass.locale?this._setLovelaceConfig(this.lovelace.config,this.lovelace.rawConfig,this.lovelace.mode):this.lovelace&&"generated"===this.lovelace.mode?(this._panelState="loading",this._regenerateConfig()):this._fetchConfigOnConnect&&this._fetchConfig(!1),window.addEventListener("connection-status",this._handleConnectionStatus)}disconnectedCallback(){super.disconnectedCallback(),null!==this.urlPath&&this._unsubUpdates&&(this._unsubUpdates.then(e=>e()),this._unsubUpdates=void 0),window.removeEventListener("connection-status",this._handleConnectionStatus)}render(){const e=this._panelState;return"loaded"===e?r.qy` <hui-root .panel="${this.panel}" .hass="${this.hass}" .lovelace="${this.lovelace}" .route="${this.route}" .narrow="${this.narrow}" @config-refresh="${this._forceFetchConfig}" @strategy-config-changed="${this._strategyConfigChanged}"></hui-root> `:"error"===e?r.qy` <hass-error-screen .hass="${this.hass}" title="${(0,g.p$)(this.hass.localize,"lovelace")}" .error="${this._errorMsg}"> <ha-button @click="${this._forceFetchConfig}"> ${this.hass.localize("ui.panel.lovelace.reload_lovelace")} </ha-button> </hass-error-screen> `:"yaml-editor"===e?r.qy` <hui-editor .narrow="${this.narrow}" .hass="${this.hass}" .lovelace="${this.lovelace}" .closeEditor="${this._closeEditor}"></hui-editor> `:r.qy` <hass-loading-screen rootnav .hass="${this.hass}" .narrow="${this.narrow}"></hass-loading-screen> `}willUpdate(e){super.willUpdate(e),this.lovelace||"error"===this._panelState||this._loading||this._fetchConfig(!1)}firstUpdated(e){super.firstUpdated(e),this._unsubUpdates||this._subscribeUpdates()}updated(e){if(super.updated(e),!e.has("hass"))return;const t=e.get("hass");t&&this.hass&&this.lovelace&&(0,v.Wu)(this.lovelace.rawConfig)&&(t.entities===this.hass.entities&&t.devices===this.hass.devices&&t.areas===this.hass.areas&&t.floors===this.hass.floors||"RUNNING"===this.hass.config.state&&this._debounceRegistriesChanged(),"RUNNING"===this.hass.config.state&&"RUNNING"!==t.config.state&&this._regenerateStrategyConfig())}async _regenerateStrategyConfig(){if(!this.hass||!this.lovelace)return;const e=this.lovelace.rawConfig;if((0,v.Wu)(e))try{const t=await(0,$.uN)(e,this.hass);this._setLovelaceConfig(t,e,"generated")}catch(e){console.error(e)}}async _regenerateConfig(){const e=await(0,$.uN)(S,this.hass);this._setLovelaceConfig(e,S,"generated"),this._panelState="loaded"}async _subscribeUpdates(){this._unsubUpdates=(0,u.EG)(this.hass.connection,this.urlPath,()=>this._lovelaceChanged())}_lovelaceChanged(){this._ignoreNextUpdateEvent?this._ignoreNextUpdateEvent=!1:this.isConnected?(0,b.P)(this,{message:this.hass.localize("ui.panel.lovelace.changed_toast.message"),action:{action:()=>this._fetchConfig(!1),text:this.hass.localize("ui.common.refresh")},duration:-1,dismissable:!1}):this._fetchConfigOnConnect=!0}get urlPath(){return"lovelace"===this.panel.url_path?null:this.panel.url_path}_forceFetchConfig(){this._fetchConfig(!0)}async _fetchConfig(e){let t,o;this._loading=!0;let a,s=this.panel.config.mode;const i=window;i.llConfProm&&(a=i.llConfProm,i.llConfProm=void 0),E||(E=!0,(i.llResProm||(0,_.kZ)(this.hass.connection)).then(e=>(0,m.n)(e,this.hass))),null===this.urlPath&&a||(this.lovelace&&"yaml"===this.lovelace.mode&&(this._ignoreNextUpdateEvent=!0),a=(0,v.Dz)(this.hass.connection,this.urlPath,e));try{if(o=await a,(0,v.Wu)(o)){if(!this.hass?.entities||!this.hass.devices||!this.hass.areas)return;t=await(0,$.uN)(o,this.hass)}else t=o}catch(e){if("config_not_found"!==e.code)return console.log(e),this._panelState="error",void(this._errorMsg=e.message);if(!this.hass?.entities||!this.hass.devices||!this.hass.areas)return;t=await(0,$.uN)(S,this.hass),o=S,s="generated"}finally{this._loading=!1,this.lovelace&&"yaml"===this.lovelace.mode&&setTimeout(()=>{this._ignoreNextUpdateEvent=!1},2e3)}this._panelState="yaml-editor"===this._panelState?this._panelState:"loaded",this._setLovelaceConfig(t,o,s)}_checkLovelaceConfig(e){const t=(0,w.eX)(e);return n()(t)}_setLovelaceConfig(e,t,a){e=this._checkLovelaceConfig(e);const s=this.urlPath;this.lovelace={config:e,rawConfig:t,mode:a,urlPath:this.urlPath,editMode:!!this.lovelace&&this.lovelace.editMode,locale:this.hass.locale,enableFullEditMode:()=>{U||(U=!0,Promise.all([o.e("61080"),o.e("68478")]).then(o.bind(o,62157))),this._panelState="yaml-editor"},setEditMode:e=>{"generated"===this.lovelace.mode&&e?(0,C.z)(this,{lovelace:this.lovelace,mode:this.panel.config.mode,narrow:this.narrow}):(0,v.Wu)(this.lovelace.rawConfig)&&e?this.lovelace.enableFullEditMode():this._updateLovelace({editMode:e})},saveConfig:async e=>{const{config:t,rawConfig:o,mode:a}=this.lovelace;let i;e=this._checkLovelaceConfig(e),i=(0,v.Wu)(e)?await(0,$.uN)(e,this.hass):e;try{this._updateLovelace({config:i,rawConfig:e,mode:"storage"}),this._ignoreNextUpdateEvent=!0,await(0,v.ql)(this.hass,s,e)}catch(e){throw console.error(e),this._updateLovelace({config:t,rawConfig:o,mode:a}),e}},deleteConfig:async()=>{const{config:e,rawConfig:t,mode:o}=this.lovelace;try{const e=await(0,$.uN)(S,this.hass);this._updateLovelace({config:e,rawConfig:S,mode:"generated",editMode:!1}),this._ignoreNextUpdateEvent=!0,await(0,v.io)(this.hass,s)}catch(a){throw console.error(a),this._updateLovelace({config:e,rawConfig:t,mode:o}),a}},showToast:e=>(0,b.P)(this,e)}}_updateLovelace(e){this.lovelace={...this.lovelace,...e},"editMode"in e&&window.history.replaceState(null,"",(0,c.Z)(e.editMode?(0,l.$X)({edit:"1"}):(0,l.s8)("edit")))}constructor(...e){super(...e),this.narrow=!1,this._panelState="loading",this._ignoreNextUpdateEvent=!1,this._fetchConfigOnConnect=!1,this._loading=!1,this._debounceRegistriesChanged=(0,d.s)(()=>this._registriesChanged(),200),this._registriesChanged=async()=>{if(!this.hass||!this.lovelace)return;const e=this.lovelace.rawConfig;if(!(0,v.Wu)(e))return;const t=this.lovelace.config,o=await(0,$.uN)(e,this.hass),a=(0,w.eX)(o);(0,p.b)(a,t)||this._askRegenerateStrategyConfig()},this._strategyConfigChanged=e=>{e.stopPropagation(),this._askRegenerateStrategyConfig()},this._askRegenerateStrategyConfig=()=>{(0,b.P)(this,{message:this.hass.localize("ui.panel.lovelace.changed_toast.message"),action:{action:()=>this._regenerateStrategyConfig(),text:this.hass.localize("ui.common.refresh")},duration:-1,id:"regenerate-strategy-config",dismissable:!1})},this._handleConnectionStatus=e=>{"connected"===e.detail&&this._fetchConfig(!1)},this._closeEditor=()=>{this._panelState="loaded"}}}(0,s.__decorate)([(0,h.MZ)({attribute:!1})],N.prototype,"panel",void 0),(0,s.__decorate)([(0,h.MZ)({attribute:!1})],N.prototype,"hass",void 0),(0,s.__decorate)([(0,h.MZ)({type:Boolean})],N.prototype,"narrow",void 0),(0,s.__decorate)([(0,h.MZ)({attribute:!1})],N.prototype,"route",void 0),(0,s.__decorate)([(0,h.wk)()],N.prototype,"_panelState",void 0),(0,s.__decorate)([(0,h.wk)()],N.prototype,"_errorMsg",void 0),(0,s.__decorate)([(0,h.wk)()],N.prototype,"lovelace",void 0),N=(0,s.__decorate)([(0,h.EM)("ha-panel-lovelace")],N),a()}catch(e){a(e)}})}};
//# sourceMappingURL=6502.29a719b02d10a36f.js.map
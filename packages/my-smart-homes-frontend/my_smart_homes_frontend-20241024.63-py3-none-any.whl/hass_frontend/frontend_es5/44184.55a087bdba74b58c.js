"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["44184"],{94327:function(t,e,n){n.d(e,{Vy:function(){return o},fI:function(){return s},ux:function(){return l}});var i=n(65940),r=n(83510);const a=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function o(t){return a[t%a.length]}function s(t,e){const n=e.getPropertyValue(`--graph-color-${t+1}`)||o(t);return(0,r.RQ)(n)}const l=(0,i.A)(t=>a.map((e,n)=>s(n,t)),(t,e)=>t[0].getPropertyValue("--graph-color-1")===e[0].getPropertyValue("--graph-color-1"))},37382:function(t,e,n){n.d(e,{D:function(){return a}});var i=n(10416),r=n.n(i);const a=t=>r()(t,{whiteList:{},stripIgnoreTag:!0,stripIgnoreTagBody:!0})},80475:function(t,e,n){n.a(t,async function(t,e){try{n(91949),n(35748),n(99342),n(9724),n(35058),n(41846),n(65315),n(837),n(84136),n(22416),n(37089),n(48169),n(88238),n(34536),n(16257),n(20152),n(44711),n(72108),n(77030),n(95013);var i=n(69868),r=n(11991),a=n(84922),o=n(65940),s=n(88006),l=n(8147),c=n(35083),u=n(37382),d=n(68717),f=n(83034),h=(n(94124),t([d,s]));[d,s]=h.then?(await h)():h;let p,y,g=t=>t;const v=5,b=12,m=6,_=5;class x extends a.WF{render(){var t;const e={grid:{top:0,bottom:0,left:0,right:0},tooltip:{trigger:"item",formatter:this._renderTooltip,appendTo:document.body}};return(0,a.qy)(p||(p=g`<ha-chart-base .data="${0}" .options="${0}" height="100%" .extraComponents="${0}"></ha-chart-base>`),this._createData(this.data,null===(t=this._sizeController.value)||void 0===t?void 0:t.width),e,[l.A])}_processLinks(t,e){const n=new Map,i=new Map,r=[];return e.forEach(e=>{var a;const o=t.find(t=>t.id===e.source),s=t.find(t=>t.id===e.target);if(!o||!s)return;const l=i.get(o.id)||0,c=n.get(s.id)||0,u=o.value-l,d=s.value-c,f=Math.min(null!==(a=e.value)&&void 0!==a?a:u,u,d);n.set(s.id,c+f),i.set(o.id,l+f),f>0&&r.push(Object.assign(Object.assign({},e),{},{value:f}))}),r}_findParentIndex(t,e,n){var i;const r=null===(i=e.find(e=>e.target===t))||void 0===i?void 0:i.source;if(!r)return-1;let a=0;for(let o=n.length-1;o>=0;o--){const t=n[o],e=t.findIndex(t=>t.id===r);if(-1!==e)return a+e;a+=t.length}return-1}constructor(...t){super(...t),this.data={nodes:[],links:[]},this.vertical=!1,this._sizeController=new s.P(this,{callback:t=>{var e;return null===(e=t[0])||void 0===e?void 0:e.contentRect}}),this._renderTooltip=t=>{const e=t.data,n=this.valueFormatter?this.valueFormatter(e.value):e.value;if(e.id){var i;const r=this.data.nodes.find(t=>t.id===e.id);return`${t.marker} ${(0,u.D)(null!==(i=null==r?void 0:r.label)&&void 0!==i?i:e.id)}<br>${n}`}if(e.source&&e.target){var r,a;const t=this.data.nodes.find(t=>t.id===e.source),i=this.data.nodes.find(t=>t.id===e.target);return`${(0,u.D)(null!==(r=null==t?void 0:t.label)&&void 0!==r?r:e.source)} → ${(0,u.D)(null!==(a=null==i?void 0:i.label)&&void 0!==a?a:e.target)}<br>${n}`}return null},this._createData=(0,o.A)((t,e=0)=>{const n=t.nodes.filter(t=>t.value>0),i=[...new Set(n.map(t=>t.index))].sort(),r=new Map,a=[];i.forEach((e,i)=>{r.set(e,i);const o=n.filter(t=>t.index===e);o.length>0&&a.push(a.length>0?o.sort((e,n)=>{const i=this._findParentIndex(e.id,t.links,a),r=this._findParentIndex(n.id,t.links,a);return i===r?0:-1===i?1:-1===r?-1:i-r}):o)});const o=this._processLinks(n,t.links),s=e/i.length-f.hD-_;return{id:"sankey",type:"sankey",nodes:a.flat().map(t=>({id:t.id,value:t.value,itemStyle:{color:t.color},depth:r.get(t.index)})),links:o,draggable:!1,orient:this.vertical?"vertical":"horizontal",nodeWidth:15,nodeGap:m,lineStyle:{color:"gradient",opacity:.4,curveness:.5},layoutIterations:0,label:{formatter:e=>{var n,i;return null!==(n=null===(i=t.nodes.find(t=>t.id===e.data.id))||void 0===i?void 0:i.label)&&void 0!==n?n:e.data.id},position:this.vertical?"bottom":"right",distance:_,minMargin:5,overflow:"break"},labelLayout:t=>{if(this.vertical){const e=t.text.split(" ").reduce((t,e)=>t.length>e.length?t:e,""),n=(0,c.W)(e,b),i=t.rect.width+6,r=Math.min(b,i/n*b);return{fontSize:r>1?r:0,width:i,align:"center",dy:-2}}const e=t.rect.height+8,n=Math.min(e/t.labelRect.height*b,b);return{fontSize:n,lineHeight:n,width:s,height:t.rect.height}},top:this.vertical?0:v,bottom:this.vertical?25:v,left:this.vertical?v:0,right:this.vertical?v:s+_,emphasis:{focus:"adjacency"}}})}}x.styles=(0,a.AH)(y||(y=g`:host{display:block;flex:1;background:var(--ha-card-background,var(--card-background-color))}ha-chart-base{width:100%;height:100%}`)),(0,i.__decorate)([(0,r.MZ)({attribute:!1})],x.prototype,"hass",void 0),(0,i.__decorate)([(0,r.MZ)({attribute:!1})],x.prototype,"data",void 0),(0,i.__decorate)([(0,r.MZ)({type:Boolean})],x.prototype,"vertical",void 0),(0,i.__decorate)([(0,r.MZ)({type:String,attribute:!1})],x.prototype,"valueFormatter",void 0),(0,i.__decorate)([(0,r.wk)()],x.prototype,"_sizeController",void 0),x=(0,i.__decorate)([(0,r.EM)("ha-sankey-chart")],x),e()}catch(p){e(p)}})},71770:function(t,e,n){n(35748),n(95013);var i=n(69868),r=n(30103),a=n(86811),o=n(49377),s=n(34800),l=n(84922),c=n(11991);let u,d,f,h,p=t=>t;class y extends r.k{renderOutline(){return this.filled?(0,l.qy)(u||(u=p`<span class="filled"></span>`)):super.renderOutline()}getContainerClasses(){return Object.assign(Object.assign({},super.getContainerClasses()),{},{active:this.active})}renderPrimaryContent(){return(0,l.qy)(d||(d=p` <span class="leading icon" aria-hidden="true"> ${0} </span> <span class="label">${0}</span> <span class="touch"></span> <span class="trailing leading icon" aria-hidden="true"> ${0} </span> `),this.renderLeadingIcon(),this.label,this.renderTrailingIcon())}renderTrailingIcon(){return(0,l.qy)(f||(f=p`<slot name="trailing-icon"></slot>`))}constructor(...t){super(...t),this.filled=!1,this.active=!1}}y.styles=[o.R,s.R,a.R,(0,l.AH)(h||(h=p`:host{--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-surface:var(--primary-text-color);--md-assist-chip-container-shape:var(
          --ha-assist-chip-container-shape,
          16px
        );--md-assist-chip-outline-color:var(--outline-color);--md-assist-chip-label-text-weight:400}.filled{display:flex;pointer-events:none;border-radius:inherit;inset:0;position:absolute;background-color:var(--ha-assist-chip-filled-container-color)}::slotted([slot=icon]),::slotted([slot=trailing-icon]){display:flex;--mdc-icon-size:var(--md-input-chip-icon-size, 18px);font-size:var(--_label-text-size)!important}.trailing.icon ::slotted(*),.trailing.icon svg{margin-inline-end:unset;margin-inline-start:var(--_icon-label-space)}::before{background:var(--ha-assist-chip-container-color,transparent);opacity:var(--ha-assist-chip-container-opacity, 1)}:where(.active)::before{background:var(--ha-assist-chip-active-container-color);opacity:var(--ha-assist-chip-active-container-opacity)}.label{font-family:var(--ha-font-family-body)}`))],(0,i.__decorate)([(0,c.MZ)({type:Boolean,reflect:!0})],y.prototype,"filled",void 0),(0,i.__decorate)([(0,c.MZ)({type:Boolean})],y.prototype,"active",void 0),y=(0,i.__decorate)([(0,c.EM)("ha-assist-chip")],y)},83034:function(t,e,n){n.d(e,{Es:function(){return i},dc:function(){return a},hD:function(){return r}});const i=10,r=30,a=20},63002:function(t,e,n){n.a(t,async function(t,i){try{n.d(e,{$3:function(){return v},$O:function(){return V},$j:function(){return b},ED:function(){return s},JE:function(){return I},OQ:function(){return T},PU:function(){return M},Ph:function(){return y},Uf:function(){return w},W1:function(){return g},Wr:function(){return f},Z:function(){return u},gF:function(){return m},iY:function(){return _},jU:function(){return l},nN:function(){return S},p3:function(){return d},pJ:function(){return p},r_:function(){return c},sz:function(){return h}});n(79827),n(35748),n(65315),n(59023),n(95013);var r=n(72652),a=n(50654),o=t([a]);a=(o.then?(await o)():o)[0];var s=function(t){return t[t.NONE=0]="NONE",t[t.ARITHMETIC=1]="ARITHMETIC",t[t.CIRCULAR=2]="CIRCULAR",t}({});const l=59509==n.j?["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"]:null,c=["L","gal","ft³","m³","CCF","MCF"],u=t=>t.sendMessagePromise({type:"recorder/info"}),d=(t,e)=>t.callWS({type:"recorder/list_statistic_ids",statistic_type:e}),f=(t,e)=>t.callWS({type:"recorder/get_statistics_metadata",statistic_ids:e}),h=(t,e,n,i,r="hour",a,o)=>t.callWS({type:"recorder/statistics_during_period",start_time:e.toISOString(),end_time:null==n?void 0:n.toISOString(),statistic_ids:i,period:r,units:a,types:o}),p=(t,e,n,i)=>t.callWS({type:"recorder/statistic_during_period",statistic_id:e,units:i,fixed_period:n.fixed_period?{start_time:n.fixed_period.start instanceof Date?n.fixed_period.start.toISOString():n.fixed_period.start,end_time:n.fixed_period.end instanceof Date?n.fixed_period.end.toISOString():n.fixed_period.end}:void 0,calendar:n.calendar?Object.assign(Object.assign({},"week"===n.calendar.period?{first_weekday:(0,a.D)(t.locale).substring(0,3)}:{}),n.calendar):void 0,rolling_window:n.rolling_window}),y=t=>t.callWS({type:"recorder/validate_statistics"}),g=(t,e,n,i)=>t.callWS({type:"recorder/update_statistics_metadata",statistic_id:e,unit_of_measurement:n,unit_class:i}),v=(t,e)=>t.callWS({type:"recorder/clear_statistics",statistic_ids:e}),b=t=>{let e=null;if(!t)return null;for(const n of t)null!==n.change&&void 0!==n.change&&(null===e?e=n.change:e+=n.change);return e},m=(t,e)=>{let n=null;for(const i of e){if(!(i in t))continue;const e=b(t[i]);null!==e&&(null===n?n=e:n+=e)}return n},_=(t,e)=>t.some(t=>void 0!==t[e]&&null!==t[e]),x=["mean","min","max"],z=["sum","state","change"],S=(t,e)=>!(!x.includes(e)||0===t.mean_type)||!(!z.includes(e)||!t.has_sum),w=(t,e,n,i,r)=>{const a=new Date(n).toISOString();return t.callWS({type:"recorder/adjust_sum_statistics",statistic_id:e,start_time:a,adjustment:i,adjustment_unit_of_measurement:r})},V=(t,e,n)=>{const i=t.states[e];return i?(0,r.u)(i):(null==n?void 0:n.name)||e},I=(t,e,n)=>{let i;var r;e&&(i=null===(r=t.states[e])||void 0===r?void 0:r.attributes.unit_of_measurement);return void 0===i?null==n?void 0:n.statistics_unit_of_measurement:i},T=t=>t.includes(":"),M=t=>t.callWS({type:"recorder/update_statistics_issues"});i()}catch(l){i(l)}})},75335:function(t,e,n){n.d(e,{Q:function(){return s}});n(35748),n(95013);var i=n(69868),r=n(11991),a=n(48125),o=n(32211);const s=t=>{class e extends t{connectedCallback(){super.connectedCallback(),this._unsubMql=(0,o.m)("all and (max-width: 450px), all and (max-height: 500px)",t=>{this._isMobileSize=t})}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._unsubMql)||void 0===t||t.call(this),this._unsubMql=void 0}constructor(...t){super(...t),this._isMobileSize=!1,this._isMobileClient=a.M}}return(0,i.__decorate)([(0,r.wk)()],e.prototype,"_isMobileSize",void 0),e}},8147:function(t,e,n){n.d(e,{A:function(){return h}});var i=n(50291),r=(n(43114),n(35748),n(99342),n(9724),n(35058),n(93225),n(65315),n(837),n(84136),n(12791),n(22416),n(37089),n(48169),n(88238),n(34536),n(16257),n(20152),n(44711),n(72108),n(77030),n(95013),n(41160));function a(t){return"passThrough"in t}const o=1;function s(t,e){t.eachSeriesByType("sankey",t=>{if("justify"!==t.get("nodeAlign"))return;const n=t.get("nodeWidth"),i=t.get("nodeGap"),s=(0,r.Lj)(t,e).refContainer,{width:u,height:d}=s,f=t.getGraph();!function(t,e,n,i,r,s,u){const d=t.filter(t=>t.getLayout().value>0),f=[...new Set(d.map(t=>t.hostGraph.data.getRawDataItem(t.dataIndex).depth||0))].sort(),h=function(t,e){const n=[];return e.forEach(e=>{const i=function(t,e,n){if(0===t.getLayout().value)return[];const i=l(t.node1,e),r=l(t.node2,e),a=function(t){const e=t.hostGraph.edgeData.getRawDataItem(t.dataIndex);return e.value}(t),o=function(t,e,n){return n.slice(t+1,e)}(i.depthIndex,r.depthIndex,e),s=t.node1.hostGraph.data.getRawDataItem(t.node1.dataIndex),c=t.node2.hostGraph.data.getRawDataItem(t.node2.dataIndex),u=o.map(t=>{const e=function(t,e,n,i){return{passThrough:!0,id:`${t}-${e}-${n}`,value:i,depth:n}}(s.id,c.id,t,a);return n.push(e),e.id});return u}(e,t,n);e.passThroughNodeIds=i}),n}(f,e),p=function(t,e,n,i,r,s,l){const{sectionSize:u,sectionDepthSize:d}=function(t,e,n,i,r){const a=("vertical"===t?e:n)-2*r,o="vertical"===t?n/i.length:e/i.length;return{sectionSize:a,sectionDepthSize:o}}(s,i,r,n,l),f=function(t,e){const n={};return t.forEach(t=>{const e=t.getLayout().depth;n[e]?n[e].push(t):n[e]=[t]}),e.forEach(t=>{n[t.depth]?n[t.depth].push(t):n[t.depth]=[t]}),n}(t,e);let h=0;const p=n.map(t=>{const e=function(t){return t.map(t=>({node:t,id:t.id,value:a(t)?t.value:t.getLayout().value,x:0,y:0,dx:0,dy:0,size:0}))}(f[t]||[]),n=u-(e.length+1)*l,i=e.reduce((t,e)=>t+e.value,0),{nodes:r,valueToSizeRatio:o}=c(e,n,i,h);return o>h&&(h=o),{nodes:r,depth:t,totalValue:i,valueToSizeRatio:o}});return p.forEach((t,e)=>{!function(t,e,n,i,r,a){let s=0;t.valueToSizeRatio!==r?t.nodes.forEach(t=>{const e=Math.max(o,Math.floor(t.value/r));s+=e,t.size=e}):s=t.nodes.reduce((t,e)=>t+e.size,0);const l=n-s;let c=l/(t.nodes.length+1);t.nodes.forEach(n=>{"vertical"===a?(n.x=c,n.y=e*i):(n.x=e*i,n.y=c),c+=n.size+l/(t.nodes.length+1)})}(t,e,u,d,h,s)}),p.flatMap(t=>t.nodes)}(d,h,f,r,s,u,i);!function(t,e,n){const i=function(t){return"vertical"===t?{breadth:"x",depth:"y",breadthSize:"dx",depthSize:"dy"}:{breadth:"y",depth:"x",breadthSize:"dy",depthSize:"dx"}}(n),r="vertical"===n?"curveVertical":"curveHorizontal";(function(t,e,n){t.forEach(t=>{t[n.breadthSize]=t.size,t[n.depthSize]=e,a(t.node)||t.node.setLayout({x:t.x,y:t.y,dx:t.dx,dy:t.dy},!0)})})(t,e,i),function(t,e){t.forEach(t=>{a(t.node)||t.node.outEdges.forEach(n=>{const i=n.hostGraph.edgeData.getRawDataItem(n.dataIndex).value/t.value*t.size;n.setLayout({[e.breadthSize]:i,[e.depthSize]:0},!0)})})}(t,i),function(t,e){t.forEach(t=>{a(t.node)||(t.node.outEdges.sort((t,n)=>t.node2.getLayout()[e.breadth]-n.node2.getLayout()[e.breadth]),t.node.inEdges.sort((t,n)=>t.node1.getLayout()[e.breadth]-n.node1.getLayout()[e.breadth]))})}(t,i),t.forEach(e=>{a(e.node)||(function(t,e,n){if(a(t.node))return;let i=0;t.node.outEdges.forEach(r=>{r.setLayout({x:"vertical"===e?t.x+i:t.x+t.dx,y:"vertical"===e?t.y+t.dy:t.y+i},!0),i+=r.getLayout()[n.breadthSize]})}(e,n,i),function(t,e,n,i,r){if(a(t.node))return;let o=0;t.node.inEdges.forEach(a=>{const s=function(t,e,n,i){const r=[];return t.passThroughNodeIds.forEach(t=>{const a=e.find(e=>e.id===t);r.push({x:a.x,y:a.y,type:i}),"vertical"===n?r.push({x:a.x,y:a.y+a.dy,type:"line"}):r.push({x:a.x+a.dx,y:a.y,type:"line"})}),r}(a,e,n,r);a.setLayout({targets:[...s,{x:"vertical"===n?t.x+o:t.x,y:"vertical"===n?t.y:t.y+o,type:r}]},!0),o+=a.getLayout()[i.breadthSize]})}(e,t,n,i,r))})}(p,n,u)}(f.nodes,f.edges,n,i,u,d,t.get("orient"))})}function l(t,e){const n=t.hostGraph.data.getRawDataItem(t.dataIndex).depth||0,i=e.findIndex(t=>t===n);return{depth:n,depthIndex:i}}function c(t,e,n,i=0){let r=n/e;r<i&&(r=i);let a=0;const s=t.map(t=>{if(t.size===o)return t;let e=Math.floor(t.value/r);return e<o&&(a+=o-e,e=o),Object.assign(Object.assign({},t),{},{size:e})});return a>0?c(s,e-a,n,r):{nodes:s,valueToSizeRatio:r}}var u=n(68730);class d extends u.A{render(t,e,n){super.render(t,e,n);const i=t.getData("edge");t.getGraph().eachEdge(t=>{const e=t.getLayout(),n=t.getModel().getModel("lineStyle").get("curveness"),r=i.getItemGraphicEl(t.dataIndex);r.buildPath=t=>function(t,e,n){var i;if(null===(i=e.targets)||void 0===i||!i.length)return;t.moveTo(e.x,e.y);const r=e.targets[e.targets.length-1],a=[{x:e.x,y:e.y,type:r.type},...e.targets];for(let o=1;o<a.length;o++){const e=a[o],i=a[o-1];"curveHorizontal"===e.type?t.bezierCurveTo(i.x*(1-n)+e.x*n,i.y,e.x*(1-n)+i.x*n,e.y,e.x,e.y):"curveVertical"===e.type?t.bezierCurveTo(i.x,i.y*(1-n)+e.y*n,e.x,e.y*(1-n)+i.y*n,e.x,e.y):t.lineTo(e.x,e.y)}t.lineTo(r.x+e.dx,r.y+e.dy);for(let o=a.length-2;o>=0;o--){const i={x:a[o+1].x+e.dx,y:a[o+1].y+e.dy,type:a[o+1].type},r={x:a[o].x+e.dx,y:a[o].y+e.dy,type:i.type};"curveHorizontal"===r.type?t.bezierCurveTo(i.x*(1-n)+r.x*n,i.y,r.x*(1-n)+i.x*n,r.y,r.x,r.y):"curveVertical"===r.type?t.bezierCurveTo(i.x,i.y*(1-n)+r.y*n,r.x,r.y*(1-n)+i.y*n,r.x,r.y):t.lineTo(r.x,r.y)}t.closePath()}(t,e,n),r.dirtyShape()})}}var f=d;function h(t){(0,i.a)(t),t.registerLayout(s),t.registerChartView(f)}},48125:function(t,e,n){n.d(e,{M:function(){return i}});n(67579);const i=/(?:iphone|android|ipad)/i.test(navigator.userAgent)},35083:function(t,e,n){let i;function r(t,e,n="Roboto, Noto, sans-serif"){i||(i=document.createElement("canvas"));const r=i.getContext("2d");if(!r)return 0;r.font=`${e}px ${n}`;const a=r.measureText(t);return Math.ceil(Math.max(a.actualBoundingBoxRight+a.actualBoundingBoxLeft,a.width))}n.d(e,{W:function(){return r}})},74879:function(t,e,n){var i=n(87642),r=n(36196),a=n(48630),o=n(85456),s=TypeError,l=Object.defineProperty,c=r.self!==r;try{if(o){var u=Object.getOwnPropertyDescriptor(r,"self");!c&&u&&u.get&&u.enumerable||a(r,"self",{get:function(){return r},set:function(t){if(this!==r)throw new s("Illegal invocation");l(r,"self",{value:t,writable:!0,configurable:!0,enumerable:!0})},configurable:!0,enumerable:!0})}else i({global:!0,simple:!0,forced:c},{self:r})}catch(d){}},23336:function(t,e,n){n.d(e,{e:function(){return r}});var i=n(9151);function r(t,e,n){return(0,i.P)(t,12*e,n)}},6014:function(t,e,n){n(99342),n(35058);var i=n(83107),r=n(73345),a=n(4955),o=i.each,s=i.isObject,l=-1,c=function(){function t(e){var n=e.mappingMethod,r=e.type,a=this.option=i.clone(e);this.type=r,this.mappingMethod=n,this._normalizeData=m[n];var s=t.visualHandlers[r];this.applyVisual=s.applyVisual,this.getColorMapper=s.getColorMapper,this._normalizedToVisual=s._normalizedToVisual[n],"piecewise"===n?(u(a),function(t){var e=t.pieceList;t.hasSpecialVisual=!1,i.each(e,function(e,n){e.originIndex=n,null!=e.visual&&(t.hasSpecialVisual=!0)})}(a)):"category"===n?a.categories?function(t){var e=t.categories,n=t.categoryMap={},r=t.visual;if(o(e,function(t,e){n[t]=e}),!i.isArray(r)){var a=[];i.isObject(r)?o(r,function(t,e){var i=n[e];a[null!=i?i:l]=t}):a[-1]=r,r=b(t,a)}for(var s=e.length-1;s>=0;s--)null==r[s]&&(delete n[e[s]],e.pop())}(a):u(a,!0):(i.assert("linear"!==n||a.dataExtent),u(a))}return t.prototype.mapValueToVisual=function(t){var e=this._normalizeData(t);return this._normalizedToVisual(e,t)},t.prototype.getNormalizer=function(){return i.bind(this._normalizeData,this)},t.listVisualTypes=function(){return i.keys(t.visualHandlers)},t.isValidType=function(e){return t.visualHandlers.hasOwnProperty(e)},t.eachVisual=function(t,e,n){i.isObject(t)?i.each(t,e,n):e.call(n,t)},t.mapVisual=function(e,n,r){var a,o=i.isArray(e)?[]:i.isObject(e)?{}:(a=!0,null);return t.eachVisual(e,function(t,e){var i=n.call(r,t,e);a?o=i:o[e]=i}),o},t.retrieveVisuals=function(e){var n,i={};return e&&o(t.visualHandlers,function(t,r){e.hasOwnProperty(r)&&(i[r]=e[r],n=!0)}),n?i:null},t.prepareVisualTypes=function(t){if(i.isArray(t))t=t.slice();else{if(!s(t))return[];var e=[];o(t,function(t,n){e.push(n)}),t=e}return t.sort(function(t,e){return"color"===e&&"color"!==t&&0===t.indexOf("color")?1:-1}),t},t.dependsOn=function(t,e){return"color"===e?!(!t||0!==t.indexOf(e)):t===e},t.findPieceIndex=function(t,e,n){for(var r,a=1/0,o=0,s=e.length;o<s;o++){var l=e[o].value;if(null!=l){if(l===t||i.isString(l)&&l===t+"")return o;n&&f(l,o)}}for(o=0,s=e.length;o<s;o++){var c=e[o],u=c.interval,d=c.close;if(u){if(u[0]===-1/0){if(_(d[1],t,u[1]))return o}else if(u[1]===1/0){if(_(d[0],u[0],t))return o}else if(_(d[0],u[0],t)&&_(d[1],t,u[1]))return o;n&&f(u[0],o),n&&f(u[1],o)}}if(n)return t===1/0?e.length-1:t===-1/0?0:r;function f(e,n){var i=Math.abs(e-t);i<a&&(a=i,r=n)}},t.visualHandlers={color:{applyVisual:h("color"),getColorMapper:function(){var t=this.option;return i.bind("category"===t.mappingMethod?function(t,e){return!e&&(t=this._normalizeData(t)),p.call(this,t)}:function(e,n,i){var a=!!i;return!n&&(e=this._normalizeData(e)),i=r.fastLerp(e,t.parsedVisual,i),a?i:r.stringify(i,"rgba")},this)},_normalizedToVisual:{linear:function(t){return r.stringify(r.fastLerp(t,this.option.parsedVisual),"rgba")},category:p,piecewise:function(t,e){var n=v.call(this,e);return null==n&&(n=r.stringify(r.fastLerp(t,this.option.parsedVisual),"rgba")),n},fixed:y}},colorHue:d(function(t,e){return r.modifyHSL(t,e)}),colorSaturation:d(function(t,e){return r.modifyHSL(t,null,e)}),colorLightness:d(function(t,e){return r.modifyHSL(t,null,null,e)}),colorAlpha:d(function(t,e){return r.modifyAlpha(t,e)}),decal:{applyVisual:h("decal"),_normalizedToVisual:{linear:null,category:p,piecewise:null,fixed:null}},opacity:{applyVisual:h("opacity"),_normalizedToVisual:g([0,1])},liftZ:{applyVisual:h("liftZ"),_normalizedToVisual:{linear:y,category:y,piecewise:y,fixed:y}},symbol:{applyVisual:function(t,e,n){n("symbol",this.mapValueToVisual(t))},_normalizedToVisual:{linear:f,category:p,piecewise:function(t,e){var n=v.call(this,e);return null==n&&(n=f.call(this,t)),n},fixed:y}},symbolSize:{applyVisual:h("symbolSize"),_normalizedToVisual:g([0,1])}},t}();function u(t,e){var n=t.visual,r=[];i.isObject(n)?o(n,function(t){r.push(t)}):null!=n&&r.push(n);e||1!==r.length||{color:1,symbol:1}.hasOwnProperty(t.type)||(r[1]=r[0]),b(t,r)}function d(t){return{applyVisual:function(e,n,i){var r=this.mapValueToVisual(e);i("color",t(n("color"),r))},_normalizedToVisual:g([0,1])}}function f(t){var e=this.option.visual;return e[Math.round((0,a.Cb)(t,[0,1],[0,e.length-1],!0))]||{}}function h(t){return function(e,n,i){i(t,this.mapValueToVisual(e))}}function p(t){var e=this.option.visual;return e[this.option.loop&&t!==l?t%e.length:t]}function y(){return this.option.visual[0]}function g(t){return{linear:function(e){return(0,a.Cb)(e,t,this.option.visual,!0)},category:p,piecewise:function(e,n){var i=v.call(this,n);return null==i&&(i=(0,a.Cb)(e,t,this.option.visual,!0)),i},fixed:y}}function v(t){var e=this.option,n=e.pieceList;if(e.hasSpecialVisual){var i=n[c.findPieceIndex(t,n)];if(i&&i.visual)return i.visual[this.type]}}function b(t,e){return t.visual=e,"color"===t.type&&(t.parsedVisual=i.map(e,function(t){var e=r.parse(t);return e||[0,0,0,1]})),e}var m={linear:function(t){return(0,a.Cb)(t,this.option.dataExtent,[0,1],!0)},piecewise:function(t){var e=this.option.pieceList,n=c.findPieceIndex(t,e,!0);if(null!=n)return(0,a.Cb)(n,[0,e.length-1],[0,1],!0)},category:function(t){var e=this.option.categories?this.option.categoryMap[t]:t;return null==e?l:e},fixed:i.noop};function _(t,e,n){return t?e<=n:e<n}e.A=c}}]);
//# sourceMappingURL=44184.55a087bdba74b58c.js.map
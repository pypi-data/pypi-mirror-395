"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["33835"],{63002:function(e,t,a){a.a(e,async function(e,r){try{a.d(t,{$3:function(){return p},$O:function(){return S},$j:function(){return b},ED:function(){return o},JE:function(){return x},OQ:function(){return W},PU:function(){return R},Ph:function(){return y},Uf:function(){return k},W1:function(){return m},Wr:function(){return u},Z:function(){return d},gF:function(){return f},iY:function(){return v},jU:function(){return c},nN:function(){return C},p3:function(){return _},pJ:function(){return g},r_:function(){return i},sz:function(){return h}});a(79827),a(35748),a(65315),a(59023),a(95013);var s=a(72652),l=a(50654),n=e([l]);l=(n.then?(await n)():n)[0];var o=function(e){return e[e.NONE=0]="NONE",e[e.ARITHMETIC=1]="ARITHMETIC",e[e.CIRCULAR=2]="CIRCULAR",e}({});const c=59509==a.j?["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"]:null,i=["L","gal","ft³","m³","CCF","MCF"],d=e=>e.sendMessagePromise({type:"recorder/info"}),_=(e,t)=>e.callWS({type:"recorder/list_statistic_ids",statistic_type:t}),u=(e,t)=>e.callWS({type:"recorder/get_statistics_metadata",statistic_ids:t}),h=(e,t,a,r,s="hour",l,n)=>e.callWS({type:"recorder/statistics_during_period",start_time:t.toISOString(),end_time:null==a?void 0:a.toISOString(),statistic_ids:r,period:s,units:l,types:n}),g=(e,t,a,r)=>e.callWS({type:"recorder/statistic_during_period",statistic_id:t,units:r,fixed_period:a.fixed_period?{start_time:a.fixed_period.start instanceof Date?a.fixed_period.start.toISOString():a.fixed_period.start,end_time:a.fixed_period.end instanceof Date?a.fixed_period.end.toISOString():a.fixed_period.end}:void 0,calendar:a.calendar?Object.assign(Object.assign({},"week"===a.calendar.period?{first_weekday:(0,l.D)(e.locale).substring(0,3)}:{}),a.calendar):void 0,rolling_window:a.rolling_window}),y=e=>e.callWS({type:"recorder/validate_statistics"}),m=(e,t,a,r)=>e.callWS({type:"recorder/update_statistics_metadata",statistic_id:t,unit_of_measurement:a,unit_class:r}),p=(e,t)=>e.callWS({type:"recorder/clear_statistics",statistic_ids:t}),b=e=>{let t=null;if(!e)return null;for(const a of e)null!==a.change&&void 0!==a.change&&(null===t?t=a.change:t+=a.change);return t},f=(e,t)=>{let a=null;for(const r of t){if(!(r in e))continue;const t=b(e[r]);null!==t&&(null===a?a=t:a+=t)}return a},v=(e,t)=>e.some(e=>void 0!==e[t]&&null!==e[t]),$=["mean","min","max"],w=["sum","state","change"],C=(e,t)=>!(!$.includes(t)||0===e.mean_type)||!(!w.includes(t)||!e.has_sum),k=(e,t,a,r,s)=>{const l=new Date(a).toISOString();return e.callWS({type:"recorder/adjust_sum_statistics",statistic_id:t,start_time:l,adjustment:r,adjustment_unit_of_measurement:s})},S=(e,t,a)=>{const r=e.states[t];return r?(0,s.u)(r):(null==a?void 0:a.name)||t},x=(e,t,a)=>{let r;var s;t&&(r=null===(s=e.states[t])||void 0===s?void 0:s.attributes.unit_of_measurement);return void 0===r?null==a?void 0:a.statistics_unit_of_measurement:r},W=e=>e.includes(":"),R=e=>e.callWS({type:"recorder/update_statistics_issues"});r()}catch(c){r(c)}})},42029:function(e,t,a){a.d(t,{g:function(){return l}});a(39118);var r=a(83510),s=a(6788);function l(e,t,a,l,n,o){const c=e.getPropertyValue(n+"-"+o).trim(),i=c.length>0?c:e.getPropertyValue(n).trim();let d=(0,r.RQ)(i);return 0===c.length&&o&&(d=(0,r.v2)((0,r.BE)(t?(0,s.T)((0,r.Nc)((0,r.xp)(d)),o):(0,s.d)((0,r.Nc)((0,r.xp)(d)),o)))),l?d+=a?"32":"7F":a&&(d+="7F"),d}},90470:function(e,t,a){a.a(e,async function(e,r){try{a.r(t),a.d(t,{HuiEnergySourcesTableCard:function(){return V}});a(79827),a(35748),a(65315),a(837),a(37089),a(59023),a(52885),a(95013);var s=a(69868),l=a(83214),n=a(84922),o=a(11991),c=a(75907),i=a(48893),d=a(8868),_=a(42029),u=(a(70490),a(43716)),h=a(63002),g=a(40328),y=a(8510),m=a(44017),p=e([d,u,h]);[d,u,h]=p.then?(await p)():p;let b,f,v,$,w,C,k,S,x,W,R,q,O,j,z,I,E,D,T=e=>e;const M={grid_return:"--energy-grid-return-color",grid_consumption:"--energy-grid-consumption-color",battery_in:"--energy-battery-in-color",battery_out:"--energy-battery-out-color",solar:"--energy-solar-color",gas:"--energy-gas-color",water:"--energy-water-color"};class V extends((0,g.E)(n.WF)){hassSubscribe(){var e;return[(0,u.tb)(this.hass,{key:null===(e=this._config)||void 0===e?void 0:e.collection_key}).subscribe(e=>{this._data=e})]}getCardSize(){return 3}setConfig(e){this._config=e}shouldUpdate(e){return(0,y.xP)(this,e)||e.size>1||!e.has("hass")}_renderRow(e,t,a,r,s,l,o,u,g,y,m){var p;return(0,n.qy)(b||(b=T`<tr class="mdc-data-table__row ${0}" @click="${0}" .entity="${0}"> <td class="mdc-data-table__cell cell-bullet"> <div class="bullet" style="${0}"></div> </td> <th class="mdc-data-table__cell" scope="row"> ${0} </th> ${0} <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} ${0} </td> ${0} </tr>`),(0,c.H)({clickable:!(0,h.OQ)(a)}),this._handleMoreInfo,a,(0,i.W)({borderColor:(0,_.g)(e,this.hass.themes.darkMode,!1,!1,M[t],r),backgroundColor:(0,_.g)(e,this.hass.themes.darkMode,!0,!1,M[t],r)}),(0,h.$O)(this.hass,a,null===(p=this._data)||void 0===p?void 0:p.statsMetadata[a]),m?(0,n.qy)(f||(f=T`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} ${0} </td> ${0}`),(0,d.ZV)(l,this.hass.locale),o,y?(0,n.qy)(v||(v=T`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} </td>`),null!==g?(0,d.ZV)(g,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""):""):"",(0,d.ZV)(s,this.hass.locale),o,y?(0,n.qy)($||($=T` <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} </td>`),null!==u?(0,d.ZV)(u,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""):"")}_renderTotalRow(e,t,a,r,s,l,o,c){return(0,n.qy)(w||(w=T` <tr class="mdc-data-table__row total"> <td class="mdc-data-table__cell"></td> <th class="mdc-data-table__cell" scope="row">${0}</th> ${0} <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} </td> ${0} </tr>`),e,c?(0,n.qy)(C||(C=T`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} </td> ${0}`),null===a?"":`${(0,d.ZV)(a,this.hass.locale)} ${r}`,o?(0,n.qy)(k||(k=T`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} </td>`),null!==l?(0,d.ZV)(l,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""):""):"",null===t?"":`${(0,d.ZV)(t,this.hass.locale)} ${r}`,o?(0,n.qy)(S||(S=T`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} </td>`),null!==s?(0,d.ZV)(s,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""):"")}render(){var e,t,a,r,s,l,o,c,i;if(!this.hass||!this._config)return n.s6;if(!this._data)return(0,n.qy)(x||(x=T`${0}`),this.hass.localize("ui.panel.lovelace.cards.energy.loading"));let d=0,_=0,g=0,y=!1,m=0,p=0,b=0;const f={gas:0,water:0,solar:0},v={gas:0,water:0,solar:0},$={gas:0,water:0},w={gas:0,water:0},C={gas:!1,water:!1},k=(0,u.E$)(this._data.prefs),S=null===(e=this._config)||void 0===e?void 0:e.types,D=S?Object.fromEntries(Object.entries(k).filter(([e])=>S.includes(e))):k,M=getComputedStyle(this),V=!!(null!==(t=D.grid)&&void 0!==t&&t[0].flow_from.some(e=>e.stat_cost||e.entity_energy_price||e.number_energy_price)||null!==(a=D.grid)&&void 0!==a&&a[0].flow_to.some(e=>e.stat_compensation||e.entity_energy_price||e.number_energy_price)||null!==(r=D.gas)&&void 0!==r&&r.some(e=>e.stat_cost||e.entity_energy_price||e.number_energy_price)||null!==(s=D.water)&&void 0!==s&&s.some(e=>e.stat_cost||e.entity_energy_price||e.number_energy_price)),Z={solar:"kWh",gas:this._data.gasUnit,water:this._data.waterUnit},U=void 0!==this._data.statsCompare,N=(e,t)=>{const a=(0,h.$j)(this._data.stats[e]),r=U&&(0,h.$j)(this._data.statsCompare[e]),s=t&&(0,h.$j)(this._data.stats[t])||0,l=U&&t&&(0,h.$j)(this._data.statsCompare[t])||0;return null!==a||U&&null!==r?{hasData:!0,energy:a||0,energyCompare:r||0,cost:s,costCompare:l}:{hasData:!1,energy:a||0,energyCompare:r||0,cost:s,costCompare:l}},P=e=>{var t;return(0,n.qy)(W||(W=T` ${0} ${0}`),null===(t=D[e])||void 0===t?void 0:t.map((t,a)=>{const r=e in C&&(t.stat_cost||this._data.info.cost_sensors[t.stat_energy_from]),{hasData:s,energy:l,energyCompare:o,cost:c,costCompare:i}=N(t.stat_energy_from,r||null);return s||c||i?(f[e]+=l,v[e]+=o,r&&(C[e]=!0,$[e]+=c,w[e]+=i),this._renderRow(M,e,t.stat_energy_from,a,l,o,Z[e],r?c:null,r?i:null,V,U)):n.s6}),D[e]?this._renderTotalRow(this.hass.localize(`ui.panel.lovelace.cards.energy.energy_sources_table.${e}_total`),f[e],v[e],Z[e],C[e]?$[e]:null,C[e]?w[e]:null,V,U):"")};return(0,n.qy)(R||(R=T` <ha-card> ${0} <div class="mdc-data-table"> <div class="mdc-data-table__table-container"> <table class="mdc-data-table__table" aria-label="Energy sources"> <thead> <tr class="mdc-data-table__header-row"> <th class="mdc-data-table__header-cell"></th> <th class="mdc-data-table__header-cell" role="columnheader" scope="col"> ${0} </th> ${0} <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${0} </th> ${0} </tr> </thead> <tbody class="mdc-data-table__content"> ${0} ${0} ${0} ${0} ${0} ${0} ${0} ${0} </tbody> </table> </div> </div> </ha-card>`),this._config.title?(0,n.qy)(q||(q=T`<h1 class="card-header">${0}</h1>`),this._config.title):"",this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.source"),U?(0,n.qy)(O||(O=T`<th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${0} </th> ${0}`),this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.previous_energy"),V?(0,n.qy)(j||(j=T`<th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${0} </th>`),this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.previous_cost")):""):"",this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.energy"),V?(0,n.qy)(z||(z=T` <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${0} </th>`),this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.cost")):"",P("solar"),null===(l=D.battery)||void 0===l?void 0:l.map((e,t)=>{const{hasData:a,energy:r,energyCompare:s}=N(e.stat_energy_from,null),{hasData:l,energy:o,energyCompare:c}=N(e.stat_energy_to,null);return a||l?(g+=r-o,b+=s-c,(0,n.qy)(I||(I=T` ${0}${0}`),this._renderRow(M,"battery_out",e.stat_energy_from,t,r,s,"kWh",null,null,V,U),this._renderRow(M,"battery_in",e.stat_energy_to,t,-o,-c,"kWh",null,null,V,U))):n.s6}),D.battery?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.battery_total"),g,b,"kWh",null,null,V,U):"",null===(o=D.grid)||void 0===o?void 0:o.map(e=>(0,n.qy)(E||(E=T`${0} ${0}`),e.flow_from.map((e,t)=>{const a=e.stat_cost||this._data.info.cost_sensors[e.stat_energy_from],{hasData:r,energy:s,energyCompare:l,cost:o,costCompare:c}=N(e.stat_energy_from,a||null);return r||o||c?(d+=s,m+=l,a&&(y=!0,_+=o,p+=c),this._renderRow(M,"grid_consumption",e.stat_energy_from,t,s,l,"kWh",o,c,V,U)):n.s6}),e.flow_to.map((e,t)=>{const a=e.stat_compensation||this._data.info.cost_sensors[e.stat_energy_to],{hasData:r,energy:s,energyCompare:l,cost:o,costCompare:c}=N(e.stat_energy_to,a||null);return r||o||c?(d-=s,m-=l,null!==a&&(y=!0,_-=o,p-=c),this._renderRow(M,"grid_return",e.stat_energy_to,t,-s,-l,"kWh",-o,-c,V,U)):n.s6}))),D.grid&&(null!==(c=D.grid)&&void 0!==c&&null!==(c=c[0].flow_from)&&void 0!==c&&c.length||null!==(i=D.grid)&&void 0!==i&&null!==(i=i[0].flow_to)&&void 0!==i&&i.length)?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.grid_total"),d,m,"kWh",y?_:null,y?p:null,V,U):"",P("gas"),P("water"),[C.gas,C.water,y].filter(Boolean).length>1?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.total_costs"),null,null,"",$.gas+_+$.water,w.gas+p+w.water,V,U):"")}_handleMoreInfo(e){var t;const a=null===(t=e.currentTarget)||void 0===t?void 0:t.entity;a&&!(0,h.OQ)(a)&&(0,m.r)(this,"hass-more-info",{entityId:a})}static get styles(){return(0,n.AH)(D||(D=T`${0} .mdc-data-table{width:100%;border:0}.mdc-data-table__cell,.mdc-data-table__header-cell{color:var(--primary-text-color);border-bottom-color:var(--divider-color);text-align:var(--float-start)}.mdc-data-table__row:not(.mdc-data-table__row--selected):hover{background-color:rgba(var(--rgb-primary-text-color),.04)}.clickable{cursor:pointer}.total{--mdc-typography-body2-font-weight:var(--ha-font-weight-medium)}.total .mdc-data-table__cell{border-top:1px solid var(--divider-color)}ha-card{height:100%;overflow:hidden}.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}.cell-bullet{width:32px;padding-right:0;padding-inline-end:0;padding-inline-start:16px;direction:var(--direction)}.bullet{border-width:1px;border-style:solid;border-radius:var(--ha-border-radius-sm);height:16px;width:32px}.mdc-data-table__cell--numeric{direction:ltr}`),(0,n.iz)(l))}constructor(...e){super(...e),this.hassSubscribeRequiredHostProps=["_config"]}}(0,s.__decorate)([(0,o.MZ)({attribute:!1})],V.prototype,"hass",void 0),(0,s.__decorate)([(0,o.wk)()],V.prototype,"_config",void 0),(0,s.__decorate)([(0,o.wk)()],V.prototype,"_data",void 0),V=(0,s.__decorate)([(0,o.EM)("hui-energy-sources-table-card")],V),r()}catch(b){r(b)}})}}]);
//# sourceMappingURL=33835.0e661a5bd930b899.js.map
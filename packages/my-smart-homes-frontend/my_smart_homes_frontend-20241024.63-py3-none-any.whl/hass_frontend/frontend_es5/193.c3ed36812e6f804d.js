"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["193"],{3320:function(t,i,s){s.a(t,async function(t,e){try{s.r(i),s.d(i,{HuiGraphHeaderFooter:function(){return x}});s(46852),s(79827),s(35748),s(5934),s(95013);var o=s(69868),r=s(84922),n=s(11991),a=s(26946),h=s(88341),c=s(96635),d=s(69006),_=s(44630),u=s(23459),l=(s(42086),t([c,d]));[c,d]=l.then?(await l)():l;let b,f,p,g,y,v=t=>t;const m=6e4,w=60*m,k=["counter","input_number","number","sensor"];class x extends r.WF{static async getConfigElement(){return await Promise.all([s.e("42153"),s.e("30199"),s.e("70184"),s.e("53904"),s.e("61717"),s.e("56030"),s.e("68614")]).then(s.bind(s,12461)),document.createElement("hui-graph-footer-editor")}static getStubConfig(t,i,s){return{type:"graph",entity:(0,_.B)(t,1,i,s,k,t=>!isNaN(Number(t.state))&&!!t.attributes.unit_of_measurement)[0]||""}}getCardSize(){return 3}setConfig(t){if(null==t||!t.entity||!k.includes((0,h.m)(t.entity)))throw new Error("Specify an entity from within the sensor domain");const i=Object.assign({detail:1,hours_to_show:24},t);i.hours_to_show=Number(i.hours_to_show),i.detail=1===i.detail||2===i.detail?i.detail:1,this._config=i}render(){return this._config&&this.hass?this._error?(0,r.qy)(b||(b=v`<div class="errors">${0}</div>`),this._error):this._coordinates?this._coordinates.length?(0,r.qy)(g||(g=v` <hui-graph-base .coordinates="${0}"></hui-graph-base> `),this._coordinates):(0,r.qy)(p||(p=v` <div class="container"> <div class="info">No state history found.</div> </div> `)):(0,r.qy)(f||(f=v` <div class="container"> <ha-spinner size="small"></ha-spinner> </div> `)):r.s6}connectedCallback(){super.connectedCallback(),this.hasUpdated&&this._config&&this._subscribeHistory()}disconnectedCallback(){super.disconnectedCallback(),this._unsubscribeHistory()}_subscribeHistory(){(0,a.x)(this.hass,"history")&&!this._subscribed&&this._config&&(this._subscribed=(0,d.IQ)(this.hass,t=>{var i,s;if(!this._subscribed||!this._config)return;const e=this.clientWidth||this.offsetWidth,o=Math.max(10,this._config.detail>1?Math.max(e/5,this._config.hours_to_show):this._config.hours_to_show),r=2!==this._config.detail,{points:n}=(0,u.a)(t[this._config.entity],e,e/5,o,{minY:null===(i=this._config.limits)||void 0===i?void 0:i.min,maxY:null===(s=this._config.limits)||void 0===s?void 0:s.max},r);this._coordinates=n},this._config.hours_to_show,[this._config.entity]).catch(t=>{this._subscribed=void 0,this._error=t}),this._setRedrawTimer())}_redrawGraph(){this._coordinates&&(this._coordinates=[...this._coordinates])}_setRedrawTimer(){clearInterval(this._interval),this._interval=window.setInterval(()=>this._redrawGraph(),this._config.hours_to_show>24?w:m)}_unsubscribeHistory(){clearInterval(this._interval),this._subscribed&&(this._subscribed.then(t=>null==t?void 0:t()),this._subscribed=void 0)}updated(t){if(!this._config||!this.hass||!t.has("_config"))return;const i=t.get("_config");i&&this._subscribed&&i.entity===this._config.entity||(this._unsubscribeHistory(),this._subscribeHistory())}}x.styles=(0,r.AH)(y||(y=v`:host{display:block}ha-spinner{position:absolute;top:calc(50% - 14px)}.container{display:flex;justify-content:center;position:relative;padding-bottom:20%}.info{position:absolute;top:calc(50% - 16px);color:var(--secondary-text-color)}`)),(0,o.__decorate)([(0,n.MZ)({attribute:!1})],x.prototype,"hass",void 0),(0,o.__decorate)([(0,n.MZ)()],x.prototype,"type",void 0),(0,o.__decorate)([(0,n.wk)()],x.prototype,"_config",void 0),(0,o.__decorate)([(0,n.wk)()],x.prototype,"_coordinates",void 0),x=(0,o.__decorate)([(0,n.EM)("hui-graph-header-footer")],x),e()}catch(b){e(b)}})}}]);
//# sourceMappingURL=193.c3ed36812e6f804d.js.map
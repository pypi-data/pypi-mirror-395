(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["6502"],{55e3:function(e,t,o){o(65315),o(22416),e.exports=function e(t){return Object.freeze(t),Object.getOwnPropertyNames(t).forEach(function(o){!t.hasOwnProperty(o)||null===t[o]||"object"!=typeof t[o]&&"function"!=typeof t[o]||Object.isFrozen(t[o])||e(t[o])}),t}},68289:function(e,t,o){"use strict";o.d(t,{Vw:function(){return n},kG:function(){return i},y6:function(){return s}});o(5934);const a=(e,t,o)=>new Promise((a,s)=>{const i=document.createElement(e);let n="src",r="body";switch(i.onload=()=>a(t),i.onerror=()=>s(t),e){case"script":i.async=!0,o&&(i.type=o);break;case"link":i.type="text/css",i.rel="stylesheet",n="href",r="head"}i[n]=t,document[r].appendChild(i)}),s=e=>a("link",e),i=e=>a("script",e),n=e=>a("script",e,"module")},54531:function(e,t,o){"use strict";o.d(t,{EG:function(){return a}});const a=(e,t,o)=>e.subscribeEvents(e=>{e.data.url_path===t&&o()},"lovelace_updated")},15538:function(e,t,o){"use strict";o.d(t,{Uh:function(){return i},Zg:function(){return s},kZ:function(){return a},o8:function(){return n}});const a=e=>e.sendMessagePromise({type:"lovelace/resources"}),s=(e,t)=>e.callWS(Object.assign({type:"lovelace/resources/create"},t)),i=(e,t,o)=>e.callWS(Object.assign({type:"lovelace/resources/update",resource_id:t},o)),n=(e,t)=>e.callWS({type:"lovelace/resources/delete",resource_id:t})},85288:function(e,t,o){"use strict";o.a(e,async function(e,a){try{o.r(t);o(35748),o(95013);var s=o(69868),i=o(84922),n=o(11991),r=o(77240),c=(o(65442),o(17372)),h=(o(45148),o(94124),e([c]));c=(h.then?(await h)():h)[0];let l,d,u,g,p,v=e=>e;class f extends i.WF{render(){var e,t;return(0,i.qy)(l||(l=v` ${0} <div class="content"> <ha-alert alert-type="error">${0}</ha-alert> <slot> <ha-button appearance="plain" size="small" @click="${0}"> ${0} </ha-button> </slot> </div> `),this.toolbar?(0,i.qy)(d||(d=v`<div class="toolbar"> ${0} </div>`),this.rootnav||null!==(e=history.state)&&void 0!==e&&e.root?(0,i.qy)(u||(u=v` <ha-menu-button .hass="${0}" .narrow="${0}"></ha-menu-button> `),this.hass,this.narrow):(0,i.qy)(g||(g=v` <ha-icon-button-arrow-prev .hass="${0}" @click="${0}"></ha-icon-button-arrow-prev> `),this.hass,this._handleBack)):"",this.error,this._handleBack,null===(t=this.hass)||void 0===t?void 0:t.localize("ui.common.back"))}_handleBack(){(0,r.O)()}static get styles(){return[(0,i.AH)(p||(p=v`:host{display:block;height:100%;background-color:var(--primary-background-color)}.toolbar{display:flex;align-items:center;font-size:var(--ha-font-size-xl);height:var(--header-height);padding:8px 12px;pointer-events:none;background-color:var(--app-header-background-color);font-weight:var(--ha-font-weight-normal);color:var(--app-header-text-color,#fff);border-bottom:var(--app-header-border-bottom,none);box-sizing:border-box}@media (max-width:599px){.toolbar{padding:4px}}ha-icon-button-arrow-prev{pointer-events:auto}.content{color:var(--primary-text-color);height:calc(100% - var(--header-height));display:flex;padding:16px;align-items:center;justify-content:center;flex-direction:column;box-sizing:border-box}a{color:var(--primary-color)}ha-alert{margin-bottom:16px}`))]}constructor(...e){super(...e),this.toolbar=!0,this.rootnav=!1,this.narrow=!1}}(0,s.__decorate)([(0,n.MZ)({attribute:!1})],f.prototype,"hass",void 0),(0,s.__decorate)([(0,n.MZ)({type:Boolean})],f.prototype,"toolbar",void 0),(0,s.__decorate)([(0,n.MZ)({type:Boolean})],f.prototype,"rootnav",void 0),(0,s.__decorate)([(0,n.MZ)({type:Boolean})],f.prototype,"narrow",void 0),(0,s.__decorate)([(0,n.MZ)()],f.prototype,"error",void 0),f=(0,s.__decorate)([(0,n.EM)("hass-error-screen")],f),a()}catch(l){a(l)}})},70890:function(e,t,o){"use strict";o.a(e,async function(e,a){try{o.r(t);o(35748),o(95013);var s=o(69868),i=o(84922),n=o(11991),r=o(77240),c=o(96635),h=(o(65442),o(45148),o(50809)),l=e([c]);c=(l.then?(await l)():l)[0];let d,u,g,p,v,f,_=e=>e;class b extends i.WF{render(){var e;return(0,i.qy)(d||(d=_` ${0} <div class="content"> <ha-spinner></ha-spinner> ${0} </div> `),this.noToolbar?"":(0,i.qy)(u||(u=_`<div class="toolbar"> ${0} </div>`),this.rootnav||null!==(e=history.state)&&void 0!==e&&e.root?(0,i.qy)(g||(g=_` <ha-menu-button .hass="${0}" .narrow="${0}"></ha-menu-button> `),this.hass,this.narrow):(0,i.qy)(p||(p=_` <ha-icon-button-arrow-prev .hass="${0}" @click="${0}"></ha-icon-button-arrow-prev> `),this.hass,this._handleBack)),this.message?(0,i.qy)(v||(v=_`<div id="loading-text">${0}</div>`),this.message):i.s6)}_handleBack(){(0,r.O)()}static get styles(){return[h.RF,(0,i.AH)(f||(f=_`:host{display:block;height:100%;background-color:var(--primary-background-color)}.toolbar{display:flex;align-items:center;font-size:var(--ha-font-size-xl);height:var(--header-height);padding:8px 12px;pointer-events:none;background-color:var(--app-header-background-color);font-weight:var(--ha-font-weight-normal);color:var(--app-header-text-color,#fff);border-bottom:var(--app-header-border-bottom,none);box-sizing:border-box}@media (max-width:599px){.toolbar{padding:4px}}ha-icon-button-arrow-prev,ha-menu-button{pointer-events:auto}.content{height:calc(100% - var(--header-height));display:flex;flex-direction:column;align-items:center;justify-content:center}#loading-text{max-width:350px;margin-top:16px}`))]}constructor(...e){super(...e),this.noToolbar=!1,this.rootnav=!1,this.narrow=!1}}(0,s.__decorate)([(0,n.MZ)({attribute:!1})],b.prototype,"hass",void 0),(0,s.__decorate)([(0,n.MZ)({type:Boolean,attribute:"no-toolbar"})],b.prototype,"noToolbar",void 0),(0,s.__decorate)([(0,n.MZ)({type:Boolean})],b.prototype,"rootnav",void 0),(0,s.__decorate)([(0,n.MZ)({type:Boolean})],b.prototype,"narrow",void 0),(0,s.__decorate)([(0,n.MZ)()],b.prototype,"message",void 0),b=(0,s.__decorate)([(0,n.EM)("hass-loading-screen")],b),a()}catch(d){a(d)}})},47434:function(e,t,o){"use strict";o.d(t,{eX:function(){return n}});o(35748),o(65315),o(12840),o(837),o(37089),o(95013);var a=o(60704),s=o(61830),i=o(37230);const n=e=>{if((0,s.Wu)(e))return e;const t=Object.assign({},e);return t.views&&(t.views=t.views.map(r)),t},r=e=>{if((0,i.R)(e))return e;const t=Object.assign({},e);return t.badges&&!t.badges.every(Boolean)&&(t.badges=t.badges.filter(Boolean)),t.sections&&(t.sections=t.sections.map(c)),t},c=e=>{const t=Object.assign({},e);if(e.title){if(!(0,a.H)(t)){const e={type:"heading",heading:t.title};t.cards=[e,...t.cards||[]]}delete t.title}return t}},39799:function(e,t,o){"use strict";o.d(t,{n:function(){return n}});o(35748),o(65315),o(22416),o(95013),o(45460),o(18332),o(13484),o(81071),o(92714),o(55885);var a=o(68289);const s={},i={},n=(e,t)=>{e.forEach(e=>{const o=new URL(e.url,t.auth.data.hassUrl).toString();switch(e.type){case"css":if(o in s)break;s[o]=(0,a.y6)(o);break;case"js":if(o in i)break;i[o]=(0,a.kG)(o);break;case"module":(0,a.Vw)(o);break;default:console.warn(`Unknown resource type specified: ${e.type}`)}})}},26213:function(e,t,o){"use strict";o.a(e,async function(e,a){try{o.r(t),o.d(t,{LovelacePanel:function(){return O}});o(35748),o(5934),o(95013);var s=o(69868),i=o(55e3),n=o.n(i),r=o(84922),c=o(11991),h=o(15676),l=o(94372),d=o(51849),u=o(29561),g=o(61964),p=o(54531),v=o(61830),f=o(15538),_=o(85288),b=o(70890),y=o(91197),w=o(47434),m=o(39799),C=o(14522),k=o(120),x=o(17372),$=o(49077),M=e([_,b,k,x]);[_,b,k,x]=M.then?(await M)():M;let S,U,E,N,P=e=>e;window.loadCardHelpers=()=>Promise.all([o.e("78525"),o.e("15116"),o.e("37533")]).then(o.bind(o,67717));const z={strategy:{type:"original-states"}};let L=!1,Z=!1;class O extends r.WF{connectedCallback(){super.connectedCallback(),this.lovelace&&this.hass&&this.lovelace.locale!==this.hass.locale?this._setLovelaceConfig(this.lovelace.config,this.lovelace.rawConfig,this.lovelace.mode):this.lovelace&&"generated"===this.lovelace.mode?(this._panelState="loading",this._regenerateConfig()):this._fetchConfigOnConnect&&this._fetchConfig(!1),window.addEventListener("connection-status",this._handleConnectionStatus)}disconnectedCallback(){super.disconnectedCallback(),null!==this.urlPath&&this._unsubUpdates&&(this._unsubUpdates.then(e=>e()),this._unsubUpdates=void 0),window.removeEventListener("connection-status",this._handleConnectionStatus)}render(){const e=this._panelState;return"loaded"===e?(0,r.qy)(S||(S=P` <hui-root .panel="${0}" .hass="${0}" .lovelace="${0}" .route="${0}" .narrow="${0}" @config-refresh="${0}" @strategy-config-changed="${0}"></hui-root> `),this.panel,this.hass,this.lovelace,this.route,this.narrow,this._forceFetchConfig,this._strategyConfigChanged):"error"===e?(0,r.qy)(U||(U=P` <hass-error-screen .hass="${0}" title="${0}" .error="${0}"> <ha-button @click="${0}"> ${0} </ha-button> </hass-error-screen> `),this.hass,(0,g.p$)(this.hass.localize,"lovelace"),this._errorMsg,this._forceFetchConfig,this.hass.localize("ui.panel.lovelace.reload_lovelace")):"yaml-editor"===e?(0,r.qy)(E||(E=P` <hui-editor .narrow="${0}" .hass="${0}" .lovelace="${0}" .closeEditor="${0}"></hui-editor> `),this.narrow,this.hass,this.lovelace,this._closeEditor):(0,r.qy)(N||(N=P` <hass-loading-screen rootnav .hass="${0}" .narrow="${0}"></hass-loading-screen> `),this.hass,this.narrow)}willUpdate(e){super.willUpdate(e),this.lovelace||"error"===this._panelState||this._loading||this._fetchConfig(!1)}firstUpdated(e){super.firstUpdated(e),this._unsubUpdates||this._subscribeUpdates()}updated(e){if(super.updated(e),!e.has("hass"))return;const t=e.get("hass");t&&this.hass&&this.lovelace&&(0,v.Wu)(this.lovelace.rawConfig)&&(t.entities===this.hass.entities&&t.devices===this.hass.devices&&t.areas===this.hass.areas&&t.floors===this.hass.floors||"RUNNING"===this.hass.config.state&&this._debounceRegistriesChanged(),"RUNNING"===this.hass.config.state&&"RUNNING"!==t.config.state&&this._regenerateStrategyConfig())}async _regenerateStrategyConfig(){if(!this.hass||!this.lovelace)return;const e=this.lovelace.rawConfig;if((0,v.Wu)(e))try{const t=await(0,$.uN)(e,this.hass);this._setLovelaceConfig(t,e,"generated")}catch(t){console.error(t)}}async _regenerateConfig(){const e=await(0,$.uN)(z,this.hass);this._setLovelaceConfig(e,z,"generated"),this._panelState="loaded"}async _subscribeUpdates(){this._unsubUpdates=(0,p.EG)(this.hass.connection,this.urlPath,()=>this._lovelaceChanged())}_lovelaceChanged(){this._ignoreNextUpdateEvent?this._ignoreNextUpdateEvent=!1:this.isConnected?(0,y.P)(this,{message:this.hass.localize("ui.panel.lovelace.changed_toast.message"),action:{action:()=>this._fetchConfig(!1),text:this.hass.localize("ui.common.refresh")},duration:-1,dismissable:!1}):this._fetchConfigOnConnect=!0}get urlPath(){return"lovelace"===this.panel.url_path?null:this.panel.url_path}_forceFetchConfig(){this._fetchConfig(!0)}async _fetchConfig(e){let t,o;this._loading=!0;let a,s=this.panel.config.mode;const i=window;i.llConfProm&&(a=i.llConfProm,i.llConfProm=void 0),Z||(Z=!0,(i.llResProm||(0,f.kZ)(this.hass.connection)).then(e=>(0,m.n)(e,this.hass))),null===this.urlPath&&a||(this.lovelace&&"yaml"===this.lovelace.mode&&(this._ignoreNextUpdateEvent=!0),a=(0,v.Dz)(this.hass.connection,this.urlPath,e));try{if(o=await a,(0,v.Wu)(o)){var n;if(null===(n=this.hass)||void 0===n||!n.entities||!this.hass.devices||!this.hass.areas)return;t=await(0,$.uN)(o,this.hass)}else t=o}catch(c){var r;if("config_not_found"!==c.code)return console.log(c),this._panelState="error",void(this._errorMsg=c.message);if(null===(r=this.hass)||void 0===r||!r.entities||!this.hass.devices||!this.hass.areas)return;t=await(0,$.uN)(z,this.hass),o=z,s="generated"}finally{this._loading=!1,this.lovelace&&"yaml"===this.lovelace.mode&&setTimeout(()=>{this._ignoreNextUpdateEvent=!1},2e3)}this._panelState="yaml-editor"===this._panelState?this._panelState:"loaded",this._setLovelaceConfig(t,o,s)}_checkLovelaceConfig(e){const t=(0,w.eX)(e);return n()(t)}_setLovelaceConfig(e,t,a){e=this._checkLovelaceConfig(e);const s=this.urlPath;this.lovelace={config:e,rawConfig:t,mode:a,urlPath:this.urlPath,editMode:!!this.lovelace&&this.lovelace.editMode,locale:this.hass.locale,enableFullEditMode:()=>{L||(L=!0,Promise.all([o.e("61080"),o.e("68478")]).then(o.bind(o,62157))),this._panelState="yaml-editor"},setEditMode:e=>{"generated"===this.lovelace.mode&&e?(0,C.z)(this,{lovelace:this.lovelace,mode:this.panel.config.mode,narrow:this.narrow}):(0,v.Wu)(this.lovelace.rawConfig)&&e?this.lovelace.enableFullEditMode():this._updateLovelace({editMode:e})},saveConfig:async e=>{const{config:t,rawConfig:o,mode:a}=this.lovelace;let i;e=this._checkLovelaceConfig(e),i=(0,v.Wu)(e)?await(0,$.uN)(e,this.hass):e;try{this._updateLovelace({config:i,rawConfig:e,mode:"storage"}),this._ignoreNextUpdateEvent=!0,await(0,v.ql)(this.hass,s,e)}catch(n){throw console.error(n),this._updateLovelace({config:t,rawConfig:o,mode:a}),n}},deleteConfig:async()=>{const{config:e,rawConfig:t,mode:o}=this.lovelace;try{const e=await(0,$.uN)(z,this.hass);this._updateLovelace({config:e,rawConfig:z,mode:"generated",editMode:!1}),this._ignoreNextUpdateEvent=!0,await(0,v.io)(this.hass,s)}catch(a){throw console.error(a),this._updateLovelace({config:e,rawConfig:t,mode:o}),a}},showToast:e=>(0,y.P)(this,e)}}_updateLovelace(e){this.lovelace=Object.assign(Object.assign({},this.lovelace),e),"editMode"in e&&window.history.replaceState(null,"",(0,h.Z)(e.editMode?(0,l.$X)({edit:"1"}):(0,l.s8)("edit")))}constructor(...e){super(...e),this.narrow=!1,this._panelState="loading",this._ignoreNextUpdateEvent=!1,this._fetchConfigOnConnect=!1,this._loading=!1,this._debounceRegistriesChanged=(0,d.s)(()=>this._registriesChanged(),200),this._registriesChanged=async()=>{if(!this.hass||!this.lovelace)return;const e=this.lovelace.rawConfig;if(!(0,v.Wu)(e))return;const t=this.lovelace.config,o=await(0,$.uN)(e,this.hass),a=(0,w.eX)(o);(0,u.b)(a,t)||this._askRegenerateStrategyConfig()},this._strategyConfigChanged=e=>{e.stopPropagation(),this._askRegenerateStrategyConfig()},this._askRegenerateStrategyConfig=()=>{(0,y.P)(this,{message:this.hass.localize("ui.panel.lovelace.changed_toast.message"),action:{action:()=>this._regenerateStrategyConfig(),text:this.hass.localize("ui.common.refresh")},duration:-1,id:"regenerate-strategy-config",dismissable:!1})},this._handleConnectionStatus=e=>{"connected"===e.detail&&this._fetchConfig(!1)},this._closeEditor=()=>{this._panelState="loaded"}}}(0,s.__decorate)([(0,c.MZ)({attribute:!1})],O.prototype,"panel",void 0),(0,s.__decorate)([(0,c.MZ)({attribute:!1})],O.prototype,"hass",void 0),(0,s.__decorate)([(0,c.MZ)({type:Boolean})],O.prototype,"narrow",void 0),(0,s.__decorate)([(0,c.MZ)({attribute:!1})],O.prototype,"route",void 0),(0,s.__decorate)([(0,c.wk)()],O.prototype,"_panelState",void 0),(0,s.__decorate)([(0,c.wk)()],O.prototype,"_errorMsg",void 0),(0,s.__decorate)([(0,c.wk)()],O.prototype,"lovelace",void 0),O=(0,s.__decorate)([(0,c.EM)("ha-panel-lovelace")],O),a()}catch(S){a(S)}})}}]);
//# sourceMappingURL=6502.f79fa59ed3bae933.js.map
"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[7797],{17797:(e,s,t)=>{t.r(s),t.d(s,{CourseTakeLesson:()=>k,default:()=>v});var a=t(9387),n=t(20568),l=t(92584),o=t(98754),r=t(3556),c=t(61574),d=t(80006),i=t(49261),u=t(99180),m=t(12338),h=t(2159),x=t(16476),f=t(93159),p=t(17788),j=t(41273),g=t(99179),y=t(23267),C=t(18683);const k=()=>{const e=(0,a.useMemo)(()=>[new h._],[]),{accountHandle:s,spaceHandle:t,courseId:k,lessonId:v}=(0,n.g)();if(!v)return(0,C.jsx)(C.Fragment,{});const I=(0,g.J)(),S=(0,y.mt)(),b=(0,x.Gx)(),{useConfirmCourseItemCompletion:A,useLesson:w,useStudent:L,useRefreshLesson:_,useRefreshStudent:z}=(0,f.E6)(),E=w(v),F=_(),H=(L(k??"",I?.id??""),z()),T=A(),{data:M}=E,[O,R]=(0,a.useState)("lesson"),[$,B]=(0,a.useState)(M);(0,a.useEffect)(()=>{M&&(B(M),S.layout().setItem(M))},[M]);const[P,q]=(0,a.useState)(!1),[D,G]=(0,a.useState)(!1),J=(0,p.Z)(),{enqueueToast:Q}=(0,j.d)(),Z=(e,s)=>{s.preventDefault(),S.layout().resetRightPortal(),R(e)};return(0,a.useEffect)(()=>(S.layout().showBackdrop(),F.mutate(v,{onSuccess:e=>{if(e.success){const{data:e}=w(v);e||J("/")}},onSettled:()=>{S.layout().hideBackdrop()}}),()=>{B(void 0),b.reset(),S.layout().setItem(void 0)}),[v]),(0,a.useEffect)(()=>(H.mutate({courseId:k??"",studentHandle:I?.handle??""},{onSuccess:e=>{if(e.success){const{data:e}=L(k??"",I?.id??""),s=e?.studentItems?.get(v);s&&q(s.completed)}}}),()=>{B(void 0),b.reset(),S.layout().setItem(void 0)}),[v]),(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(i.z,{children:(0,C.jsxs)(o.A,{display:"flex",children:[(0,C.jsx)(o.A,{flex:1,children:(0,C.jsx)(r.A,{sx:{fontSize:3},children:"Course lesson"})}),(0,C.jsxs)(o.A,{children:[(0,C.jsx)(d.A,{children:"Completed"}),(0,C.jsx)(c.A,{onClick:()=>{G(!0),T.mutate({courseId:k??"",itemType:"lesson",itemId:v,completed:!P},{onSuccess:e=>{e.success&&(Q(e.message,{variant:"success"}),q(!P))},onSettled:()=>{G(!1)}})},checked:P,size:"small",loading:D,"aria-labelledby":"switchLabel"})]}),(0,C.jsx)(o.A,{ml:3,children:(0,C.jsx)(u.Q,{variant:"default",size:"small",onClick:()=>J(`/${s}/${t}/course/${k}/progress`),children:"My course progress"})})]})}),$&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(l.O,{sx:{mt:3,mb:3},children:[(0,C.jsx)(l.O.Item,{href:"","aria-label":"","aria-current":"lesson"===O?"page":void 0,onClick:e=>Z("lesson",e),children:"Lesson"}),(0,C.jsx)(l.O.Item,{href:"","aria-label":"","aria-current":"comments"===O?"page":void 0,onClick:e=>Z("comments",e),children:"Comments"})]}),"lesson"===O&&(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(o.A,{children:$.nbformat&&(0,C.jsx)(m.g,{id:v,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",readonly:!1,cellMetadataPanel:!1,nbformat:$.nbformat,extensions:e})})}),"comments"===O&&(0,C.jsx)(o.A,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,C.jsx)(o.A,{})})]})]})},v=k}}]);
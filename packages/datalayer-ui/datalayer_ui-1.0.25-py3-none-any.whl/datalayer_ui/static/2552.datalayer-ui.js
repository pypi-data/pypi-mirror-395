"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[2552],{42552:(e,s,t)=>{t.r(s),t.d(s,{ExerciseEdit:()=>D,default:()=>R});var i=t(9387),n=t(20568),r=t(3345),a=t(80736),o=t(98754),c=t(46508),l=t(3556),d=t(48453),h=t(80006),u=t(92243),x=t(84514),p=t(24860),j=t(49261),m=t(99180),g=t(38621),f=t(42968),A=t(9663),b=t(55388),y=t(93159),k=t(17788),v=t(41273),C=t(99179),w=t(47769),S=t(23267),E=t(9570),T=t(18683);const D=()=>{const{accountHandle:e,spaceHandle:s,exerciseId:t}=(0,n.g)();if(!t)return(0,T.jsx)(T.Fragment,{});const D=(0,C.J)(),{kernelManager:R,defaultKernel:_}=(0,f.PD)(),L=(0,S.mt)(),$=((0,E._O)(),(0,b.LC)()),z=(L.layout().organization,L.layout().space),P=(0,i.useMemo)(()=>_,[R]),{useCloneExercise:Q,useExercise:I,useDatasetsBySpace:V,useRefreshExercise:q,useRefreshSpaceDatasets:H,useUpdateExercise:N}=(0,y.E6)(),W=I(t),F=q(),U=N(),B=Q(),M=V(z?.id??""),O=H(),{data:J}=W,{data:K}=M,[Z,G]=(0,i.useState)(J),[X,Y]=(0,i.useState)(K??[]);(0,i.useEffect)(()=>{J&&(G(J),L.layout().setItem(J),de({name:J.name,description:J.description,help:J.help}))},[J]),(0,i.useEffect)(()=>{K&&Y(K)},[K]);const ee=$.outputs?.get("exercise-pre")?.input,se=$.outputs?.get("exercise-solution")?.input,te=$.outputs?.get("exercise-question")?.input,ie=$.outputs?.get("exercise-test")?.input,ne=(0,r.S)(),[re,ae]=(0,i.useState)(!1),oe=(0,k.Z)(),{enqueueToast:ce}=(0,v.d)();(0,i.useEffect)(()=>{F.mutate(t,{onSuccess:e=>{if(e.success){const{data:e}=I(t);e||oe("/")}}})},[t]),(0,i.useEffect)(()=>{z&&O.mutate(z.id,{onSuccess:e=>{if(e.success){const{data:e}=V(z.id);Y(e??[])}}})},[z]);const[le,de]=(0,i.useState)({name:"",description:"",help:'Use the assignment operator "=" to create the variable "x".'}),[he,ue]=(0,i.useState)({name:!1,description:!1,help:!0});(0,i.useEffect)(()=>{ue({...he,name:le.name.length>2,description:le.description.length>2})},[le]);const xe=(0,i.useCallback)(async e=>{ne({title:"Are you sure?",content:"Please confirm you want to clone this exercise in your private library."}).then(e=>{e&&B.mutate(t,{onSuccess:e=>{e.success&&(ce(e.message,{variant:"success"}),L.layout().triggerItemsRefresh(),oe(`/${D?.handle}/library/exercises`))}})})},[ne,Z,B,t,ce,oe,D?.handle]);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(j.z,{children:(0,T.jsxs)(o.A,{display:"flex",children:[(0,T.jsx)(o.A,{flex:1,children:(0,T.jsx)(l.A,{sx:{fontSize:3},children:"Exercise editor"})}),(0,T.jsx)(o.A,{children:(0,T.jsxs)(c.A,{children:[(0,T.jsx)(m.Q,{variant:"default",size:"small",onClick:()=>oe(`/${e}/${s}/exercises/${Z?.id}/take`),children:"Take this exercise"}),z&&(0,T.jsx)(m.Q,{variant:"default",size:"small",leadingVisual:g.Nc$,onClick:xe,children:"Clone"})]})})]})}),Z&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(o.A,{children:[(0,T.jsxs)(o.A,{sx:{label:{marginTop:2}},children:[(0,T.jsxs)(x.A,{children:[(0,T.jsx)(x.A.Label,{children:"Name"}),(0,T.jsx)(p.A,{block:!0,value:le.name,onChange:e=>{de(s=>({...s,name:e.target.value}))}}),!he.name&&(0,T.jsx)(x.A.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,T.jsxs)(x.A,{children:[(0,T.jsx)(x.A.Label,{children:"Description"}),(0,T.jsx)(u.Ay,{block:!0,value:le.description,onChange:e=>{de(s=>({...s,description:e.target.value}))}}),!he.description&&(0,T.jsx)(x.A.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,T.jsxs)(o.A,{display:"grid",gridTemplateColumns:"1fr 1fr",sx:{gap:3},children:[(0,T.jsxs)(o.A,{children:[(0,T.jsxs)(x.A,{children:[(0,T.jsx)(x.A.Label,{children:"Preliminary code"}),(0,T.jsx)(x.A.Caption,{children:"This is the preliminary code that will be run before the exercise is taken."})]}),(0,T.jsx)(A.k,{showEditor:!0,autoRun:!0,kernel:P,code:Z.codePre,id:"exercise-pre"})]}),(0,T.jsxs)(o.A,{children:[(0,T.jsxs)(x.A,{children:[(0,T.jsx)(x.A.Label,{children:"Datasets"}),(0,T.jsx)(x.A.Caption,{children:"Select the datasets to be used in the prelimary code."})]}),(0,T.jsx)(a.l,{showDividers:!0,role:"listbox","aria-label":"Select assignees",children:X.map(e=>(0,T.jsxs)(a.l.Item,{role:"option",onClick:s=>{s.preventDefault(),$.setDataset("exercise-pre",e)},children:[(0,T.jsx)(a.l.LeadingVisual,{children:(0,T.jsx)(g.bN0,{})}),e.name,(0,T.jsxs)(a.l.Description,{children:[e.mimeType," ",(0,w.b)(e.description)]})]},e.id))})]})]}),(0,T.jsxs)(x.A,{children:[(0,T.jsx)(x.A.Label,{children:"Solution Code"}),(0,T.jsx)(x.A.Caption,{children:"This is the expected solution code. The student will never see this content."})]}),(0,T.jsx)(A.k,{showEditor:!0,autoRun:!0,kernel:P,id:"exercise-solution",code:Z.codeSolution}),(0,T.jsxs)(x.A,{children:[(0,T.jsx)(x.A.Label,{children:"Question code"}),(0,T.jsx)(x.A.Caption,{children:"This the question code that will be shown to the student."})]}),(0,T.jsx)(A.k,{showEditor:!0,autoRun:!1,kernel:P,id:"exercise-question",code:Z.codeQuestion}),(0,T.jsx)(o.A,{children:(0,T.jsxs)(x.A,{children:[(0,T.jsx)(x.A.Label,{children:"Help for the student"}),(0,T.jsx)(x.A.Caption,{children:"This a help that will be shown to the student if he asks for it."}),(0,T.jsx)(u.Ay,{block:!0,value:le.help,onChange:e=>{de(s=>({...s,help:e.target.value}))}}),!he.help&&(0,T.jsx)(x.A.Validation,{variant:"error",children:"Hint must have more than 2 characters"})]})}),(0,T.jsxs)(x.A,{children:[(0,T.jsx)(x.A.Label,{children:"Test the Solution code"}),(0,T.jsxs)(x.A.Caption,{children:["Write the test code that will be run on the student's code during the exercise. Please refer to the ",(0,T.jsx)(d.A,{href:"https://nbgrader.readthedocs.io/en/latest/user_guide/autograding_resources.html",target:"_blank",children:"nbgrader"})," documentation."]})]}),(0,T.jsx)(A.k,{showEditor:!0,autoRun:!1,disableRun:!0,kernel:P,id:"exercise-test",code:Z.codeTest})]}),(0,T.jsx)(h.A,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:'Validate you tests with this button. It will run the "Preliminary code", then will run the "Test code" on the "Solution code". When a student will take the exercise, the "Test code" will be run on the "Student code".'}),(0,T.jsx)(m.Q,{variant:"danger",leadingVisual:g.Qvf,sx:{marginTop:2,marginBottom:2},onClick:e=>{e.preventDefault(),$.setExecuteRequest("exercise-test",`\nsetup_state(stu_code = """${Z.codePre}\n${te}""", sol_code = """${Z.codePre}\n${se}""")\n${ie}\n`)},children:"Test"}),(0,T.jsx)(h.A,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:"Once you are confident with your test, you can create the exercise. Don't worry, you can still update it before making it public."}),(0,T.jsx)(m.Q,{variant:"primary",disabled:!he.name||!he.description,sx:{marginTop:2},onClick:async()=>{U.mutate({id:Z?.id??"",name:le.name,description:le.description,help:le.help,codePre:ee??"",codeSolution:se??"",codeQuestion:te??"",codeTest:ie??""},{onSuccess:e=>{e.success&&(ce("The exercise is successfully updated.",{variant:"success"}),L.layout().triggerItemsRefresh())}})},children:"Update exercise"})]}),(0,T.jsxs)(o.A,{children:[(0,T.jsx)(l.A,{as:"h2",sx:{fontSize:4,fontWeight:"normal",color:"danger.fg",mb:2},children:"Danger zone"}),(0,T.jsxs)(o.A,{sx:{border:"1px solid",borderColor:"danger.emphasis",borderRadius:2,p:3,display:"flex",alignItems:"center",justifyContent:"space-between",gap:3},children:[(0,T.jsxs)(o.A,{sx:{display:"grid",gap:1},children:[(0,T.jsx)(h.A,{sx:{fontSize:1,fontWeight:"bold",color:"danger.fg"},children:"Delete exercise"}),(0,T.jsx)(h.A,{sx:{fontSize:1,color:"fg.muted"},children:"Are you sure you don't want to just upgrade your account?"})]}),(0,T.jsx)(m.Q,{variant:"danger",onClick:e=>ae(!0),disabled:!0,children:"Delete exercise"})]})]})]})]})},R=D}}]);
"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[2384],{17523:(e,t,n)=>{n.d(t,{WS:()=>c});var r=n(88037),s=n(41630),a=n(98754),i=n(18683);function o(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class l extends r._Q{constructor(e){super(),o(this,"_rows",void 0),o(this,"_mimeType",void 0),this._mimeType=e.mimeType,this._rows=[]}renderModel(e){const t=e.data[this._mimeType].split("\n").map(e=>e.split(";"));return this._rows=t,Promise.resolve()}render(){return 0===(this._rows.length>0?this._rows[0].length:0)?(0,i.jsx)("div",{children:"No data found!"}):(0,i.jsx)(s.NP,{children:this._rows.map(e=>(0,i.jsx)(a.A,{mt:3,children:e}))})}}const c={safe:!0,mimeTypes:["application/vnd.datalayer.csv"],createRenderer:e=>new l(e)}},38607:(e,t,n)=>{n.d(t,{H:()=>S});var r=n(14809),s=n(20568),a=n(88037),i=n(9448),o=n(9387),l=n(41630),c=n(15115),d=n(58875),u=n(80736),m=n(84514),p=n(24860),h=n(38621),v=n(94247),x=n(35903),b=n(18683);const f=e=>{const{cell:t}=e,{datasources:n}=(0,x.Gr)(),[r,s]=(0,o.useState)(),[a,f]=(0,o.useState)("df");(0,o.useEffect)(()=>{const e=(e,t)=>{if("datalayer"===(t?.key??"datalayer")){const t=(e=>{const t=e.getMetadata("datalayer");if(t){const e=t.datasource;if(e)return e.id}})(e);if(t)for(const e of n)if(t===e.id){s(t);break}}};return e(t.model),t.model.metadataChanged.connect(e),()=>{t.model?.metadataChanged.disconnect(e)}},[t,n]);const g=e=>{const n=t.model.getMetadata("datalayer");e?(t.model.setMetadata("datalayer",{...n,sql:!0,datasource:{id:e.id,variant:e.variant,name:e.name,description:e.description,database:e.database,outputBucket:e.outputBucket,destinationVar:a??"df"}}),s(e.id),t.editor.model.mimeType=v.bd):(t.model.setMetadata("datalayer",{...n,sql:!1,datasource:{}}),s(void 0),t.editor.model.mimeType=v.dC)};return(0,b.jsx)(l.NP,{children:(0,b.jsx)(i.az,{display:"flex",style:{justifyContent:"right"},children:(0,b.jsx)(i.az,{className:"dla-Cell-datasource-button",children:(0,b.jsxs)(c.W,{children:[(0,b.jsx)(c.W.Anchor,{id:"custom-anchor-id",children:(0,b.jsx)(d.K,{icon:h.bN0,variant:"invisible","aria-label":"Open Datasources menu"})}),(0,b.jsx)(c.W.Overlay,{width:"medium",children:(0,b.jsx)(u.l,{selectionVariant:"single",showDividers:!0,children:(0,b.jsxs)(u.l.Group,{children:[(0,b.jsx)(u.l.GroupHeading,{children:"Datasources"}),0===n.length&&(0,b.jsxs)(u.l.Item,{onSelect:()=>{},children:["No Datasource available",(0,b.jsx)(u.l.Description,{variant:"block",children:"Create a new Datasource to connect your cell."})]}),n.map(e=>(0,b.jsxs)(u.l.Item,{onSelect:()=>g(e),selected:e.id===r,children:[e.name,(0,b.jsx)(u.l.Description,{variant:"block",children:e.description})]},e.id)),(0,b.jsx)(u.l.Divider,{}),(0,b.jsx)(u.l.Item,{onSelect:e=>{e.preventDefault()},children:(0,b.jsxs)(m.A,{children:[(0,b.jsx)(m.A.Label,{children:"Destination variable"}),(0,b.jsx)(p.A,{size:"small",value:a,disabled:!r,onChange:e=>(e=>{f(e);const n=t.model.getMetadata("datalayer");t.model.setMetadata("datalayer",{...n,sql:!0,datasource:{...n.datasource,destinationVar:e??"df"}})})(e.target.value)})]})}),(0,b.jsx)(u.l.Divider,{}),(0,b.jsx)(u.l.Item,{variant:"danger",onSelect:()=>g(void 0),children:"None"})]})})})]})})})})};function g(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const j="dla-CellToolbar-Container";class y extends a._Q{constructor(e,t){super(),g(this,"_cell",void 0),g(this,"_props",void 0),this._cell=e,this._props=t,this.addClass(j)}render(){return(0,b.jsxs)(i.az,{display:"flex",children:[(0,b.jsx)(i.az,{flexGrow:1}),(0,b.jsx)(s.fS,{initialEntries:["/"],children:(0,b.jsx)(f,{cell:this._cell,extensionProps:this._props})})]})}}function k(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class C extends r.x0{constructor(e,t){super(),k(this,"_panel",void 0),k(this,"_props",void 0),this._panel=e,this._props=t,this.updateConnectedCell=this.updateConnectedCell.bind(this);const n=()=>{const e=this._panel.content.model?.cells;if(e){e.changed.connect(this.updateConnectedCell);for(let t=0;t<e.length;++t)this._registerCellChanges(e.get(t))}};n(),this._panel.content.modelChanged.connect(()=>{n()})}updateConnectedCell(e,t){t.oldValues.forEach(this._deregisterCellChanges.bind(this)),t.newValues.forEach(this._registerCellChanges.bind(this))}_deregisterCellChanges(e){}_registerCellChanges(e){const t=this._getCodeCell(e);t?(t.displayChanged.connect(()=>{this._updateCodeCell(t)}),t.inViewportChanged.connect(()=>{this._updateCodeCell(t)}),this._updateCodeCell(t)):"code"===e.type&&console.error(`Could not find code cell for model: ${e}`)}_getCodeCell(e){return"code"===e.type?this._panel.content.widgets.find(t=>t.model===e):null}_updateCodeCell(e){if(e.inputArea){const t=e.layout;if(t){const n=t;n.widgets[1].hasClass(j)||n.insertWidget(1,new y(e,this._props))}}}}class S{constructor(){var e,t,n;e=this,n=void 0,(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t="_props"))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}init(e){this._props=e}createNew(e,t){new C(e,this._props)}get component(){return null}}},52384:(e,t,n)=>{n.a(e,async(e,r)=>{try{n.r(t),n.d(t,{NotebookEdit:()=>me,default:()=>pe});var s=n(9387),a=n(20568),i=n(97789),o=n(16950),l=n(3345),c=n(80736),d=n(3556),u=n(48453),m=n(80006),p=n(92243),h=n(93054),v=n(15115),x=n(84514),b=n(24860),f=n(49261),g=n(99180),j=n(58875),y=n(38621),k=n(32916),C=n(34477),S=n(2606),w=n(5700),_=n(75860),A=n(42389),N=n(2159),M=n(16476),P=n(27446),z=n(14551),U=n(9448),I=n(20232),D=n(46871),T=n(98970),$=n(6543),L=n(87474),R=n(75345),E=n(96834),O=n(56944),V=n(34279),F=n(93159),W=n(17788),B=n(66210),G=n(41273),J=n(99179),H=n(10069),K=n(9570),Q=n(35903),q=n(26127),X=n(14178),Y=n(92131),Z=n(83626),ee=n(36687),te=n(5362),ne=n(17523),re=n(1162),se=n(74349),ae=n(38607),ie=n(53537),oe=n(60294),le=n(18683),ce=e([re]),de=ce.then?(await ce)():ce;re=de[0];const ue=new A.Od;function me(){const{notebookId:e}=(0,a.g)();if(!e)return(0,le.jsx)(le.Fragment,{});const t=(0,J.J)(),r=(0,l.S)(),A=(0,W.Z)(),ce=(0,B.G)(e),{checkIsPlatformFeaturesPreviewer:de}=(0,V.x)(),me=de(t),{configuration:pe}=(0,K._O)(),{credits:he,token:ve}=(0,q.Y)(),{configuration:xe,multiServiceManager:be,runtimeModels:fe}=(0,Y.c6)(),{jupyterLabAdapter:ge}=(0,C.Hf)(),[je,ye]=(0,s.useState)(ue),[ke,Ce]=(0,s.useState)(void 0),[Se,we]=(0,s.useState)(),[_e,Ae]=(0,s.useState)(!1),[Ne,Me]=(0,s.useState)(),[Pe,ze]=(0,s.useState)(!1),[Ue,Ie]=(0,s.useState)(!0),[De,Te]=(0,s.useState)(""),[$e,Le]=(0,s.useState)(null),[Re,Ee]=(0,s.useState)(),[Oe,Ve]=(0,s.useState)(),[Fe,We]=(0,s.useState)(),[Be,Ge]=(0,s.useState)(),[Je,He]=(0,s.useState)({name:"",nameConfirm:"",description:""}),[Ke,Qe]=(0,s.useState)({name:void 0,nameConfirm:void 0,description:void 0}),{enqueueToast:qe,trackAsyncTask:Xe}=(0,G.d)(),{selectNotebookModel:Ye,reset:Ze}=(0,M.Gx)(),{screenCapture:et,space:tt,hideBackdrop:nt,setItem:rt,setScreenCapture:st,showBackdrop:at,showScreenshot:it,triggerItemsRefresh:ot}=(0,X.l5)(),{useCloneNotebook:lt,useDeleteItem:ct,useDatasources:dt,useNotebook:ut,useRefreshNotebook:mt,useUpdateNotebook:pt,useUpdateNotebookModel:ht}=(0,F.E6)(),vt=ut(e),xt=mt(),bt=pt(),ft=ht(),gt=lt(),jt=ct(),yt=dt(),{data:kt}=vt,{updateDatasources:Ct}=(0,Q.Gr)(),{updateAIAgent:St}=(0,H.Ks)(),{patchAIAgent:wt}=(0,O.w)(),_t=(0,s.useMemo)(()=>{const e=pe?.spacerRunUrl;if(e&&ve)return new I.k({runUrl:e,token:ve})},[pe,e,ve]),At=(0,s.useMemo)(()=>[new ae.H,new N._({factory:w.N})],[]),Nt=(0,s.useMemo)(()=>new o.J,[]),Mt=(0,s.useMemo)(()=>[ne.WS],[]),Pt=(0,s.useMemo)(()=>(0,Z.Kp)(),[]);(0,s.useEffect)(()=>{(0,re.wj)()},[]),(0,s.useEffect)(()=>{if(fe&&fe.length>0&&!Ne){const e=fe[0];Ut({runtimeDesc:{name:e.environment_name,language:"",location:"remote",displayName:e.given_name,kernelId:e.id,burningRate:e.burning_rate,podName:e.pod_name},runtimeModel:e})}},[fe]),(0,s.useEffect)(()=>{$e&&$e.sharedModel.awareness.setLocalStateField("user",{username:t.id,name:t.handle,display_name:t.displayName,initials:`${t.firstName[0]?.toLocaleUpperCase()??"?"}${t.lastName[0]?.toLocaleUpperCase()||"?"}`,color:Pt,avatar_url:t.avatarUrl})},[$e,t,Pt]),(0,s.useEffect)(()=>{kt&&(Ee(kt),Ve(kt.nbformat),rt(kt),He({name:kt.name,nameConfirm:"",description:kt.description}))},[kt]),(0,s.useEffect)(()=>(at(),xt.mutate(e,{onSuccess:e=>{e.success||qe(e.message,{variant:"error"})},onSettled:()=>{nt()}}),()=>{je.dispose(),Ee(void 0),Ze(),rt(void 0)}),[e]),(0,s.useEffect)(()=>{const{data:e}=yt;e&&Ct(e)},[yt.data]),(0,s.useEffect)(()=>{ce&&De&&ce.runtimeId!==ke&&(wt(e,je.serverSettings.baseUrl,je.serverSettings.token,ke),St(e,ke))},[ce,ke,e,De,je]),(0,s.useEffect)(()=>{Qe({...Ke,name:void 0===Je.name?void 0:Je.name.length>2,nameConfirm:Je.nameConfirm===Re?.name,description:void 0===Je.description?void 0:Je.description.length>2})},[Je]);const zt=(0,s.useCallback)(async()=>{at(),bt.mutate({id:e,name:Je.name,description:Je.description},{onSuccess:e=>{e.success&&(qe("The notebook is successfully updated.",{variant:"success"}),ot(),Ee({...Re,name:Je.name,description:Je.description}))},onSettled:()=>{nt()}})},[e,Je.name,Je.description,Re,bt,at,nt,qe,ot]),Ut=(0,s.useCallback)(async({runtimeDesc:r,runtimeModel:s,transferState:a})=>{const o=Ye(e);o?.model&&Ve(o.model.toJSON()),we(r);const l=r?.location;switch(Te(""),l){case void 0:Ce(void 0),Ie(!0),Ae(!1),ye(ue);break;case"browser":if(be?.browser){if(ge){if(!ge.jupyterLab.hasPlugin("@jupyterlite/pyodide-kernel-extension:kernel")){const e=await Promise.all([n.e(484),n.e(5378)]).then(n.bind(n,28924));ge.jupyterLab.registerPluginModule(e)}ge.jupyterLab.isPluginActivated("@jupyterlite/pyodide-kernel-extension:kernel")||await ge.jupyterLab.activatePlugin("@jupyterlite/pyodide-kernel-extension:kernel")}Ce(void 0),Ie(!1),Ae(!0),ye(be.browser)}else console.error("Unable to use browser kernel. No service manager for it.");break;case"remote":{if(!be?.remote){console.error("Unable to use a remote runtime. No service manager for it.");break}let n;if(a&&je&&je===be?.browser&&Ne?.kernel)try{at();let e=!0;const t=Ne.kernel.id,r=`pyodide-${t}`,s=(0,te.T)({connection:Ne.kernel,metadata:{filename:`${r}.data`},onUploadProgress:()=>{e&&(e=!1,(0,ee.Ay)().then(e=>{n=e.find(e=>e.name===r)}))}});if(Xe(s,{error:{message:e=>`Failed to save the browser kernel state. ${e}`},pending:{message:"Saving the browser kernel stateâ€¦"},success:{message:()=>"Browser kernel state saved."}}),await s,!n)throw Error("Unable to find snapshot for pyodide state.");await be.browser.kernels.shutdown(t)}finally{nt()}if(!s){const{name:e,displayName:a,params:i}=r,o=await(be?.remote?.runtimesManager.startNew({environmentName:e,type:"notebook",givenName:a,creditsLimit:i?.creditsLimit??(he?.available??0)/Math.max(xe.maxCellRuntimes-fe.filter(e=>"cell"!==e.type).length,1),capabilities:i?.capabilities,snapshot:n?.id},{username:t?.handle,handleComms:!0}));s=await be.remote.runtimesManager.findById(o.id),o.dispose()}Ae(!1),Ce(s.id),Ie(!1),Te(s.pod_name);const o=be.remote.runtimesManager.getServices(s.pod_name),l=new i.ServiceManager({contents:o?.contents,kernels:o?.kernels,kernelspecs:o?.kernelspecs,serverSettings:o?.serverSettings,sessions:o?.sessions,events:{dispose:()=>{}},terminals:{connectionFailure:{connect:()=>{}},dispose:()=>{},isAvailable:()=>!1}});ye(l),We("storage");const c=o?.serverSettings.baseUrl.replace("/jupyter/server","/mcp")+"/mcp";fetch(c+"/../api/connect",{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({provider:"datalayer",runtime_url:o?.serverSettings.baseUrl,runtime_id:s.id,runtime_token:o?.serverSettings.token,document_url:pe.spacerRunUrl,document_id:e,document_token:ve})}).then(e=>{qe("Jupyter MCP Server connected successfully.",{variant:"success"}),We("ai-agents"),Ge(c)})}}It(void 0)},[xe,he,ge,e,be,fe,je,Ne]),It=(0,s.useCallback)(e=>{Me(e||void 0)},[]),Dt=(0,s.useCallback)(async()=>{r({title:"Are you sure?",content:"Please confirm you want to clone this notebook in your private library."}).then(t=>{t&&(at(),gt.mutate(e,{onSuccess:e=>{e.success&&(qe(e.message,{variant:"success"}),ot(),A("/my-library"))},onSettled:()=>{nt()}}))})},[r,Re,gt,e,at,nt,qe,ot,A]),Tt=(0,s.useCallback)(e=>{Le(e)},[]),$t=(0,s.useCallback)(()=>{if(!Ue&&$e?.cells){at("Saving the notebook...");const t=$e.toJSON();ft.mutate({notebookId:e,nbformat:t},{onSuccess:n=>{n.success&&(qe("The notebook is successfully updated.",{variant:"success"}),Ee({...Re,id:e,nbformat:t}))},onSettled:()=>{nt()}})}},[e,$e,Ue,ft,at,nt,qe,Re]),Lt=(0,s.useCallback)(()=>{We("storage"!==Fe&&je&&je!==ue?"storage":void 0)},[Fe,je]);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsxs)(f.z,{"aria-label":Re?.name,children:[(0,le.jsx)(f.z.TitleArea,{variant:"subtitle",children:(0,le.jsx)(f.z.Title,{children:Re?.name})}),(0,le.jsx)(f.z.Actions,{children:Re&&tt&&(0,le.jsxs)(U.az,{sx:{flex:"0 0 auto",display:"flex",alignItems:"center"},children:[be?.remote&&Ne&&Ne.kernel&&(0,le.jsx)(T.m,{kernelId:Ne.kernel.id,serviceManager:be.remote,onClick:()=>{A("/runtimes")}},"credits-indicator"),(0,le.jsx)(D.P,{assignRuntime:Ut,sessionConnection:Ne,browserRuntimeAvailable:!pe.whiteLabel},"runtime-picker"),(0,le.jsx)($.C,{connection:Ne?.kernel??void 0,multiServiceManager:be,podName:De,disabled:void 0===Se?.location,children:"Snapshots"}),(0,le.jsx)(g.Q,{title:"Browse content on the Remote Runtime",variant:"invisible",size:"small",disabled:!je||je===ue,leadingVisual:()=>(0,le.jsx)(z.Cx,{type:"content"}),onClick:Lt,children:"Storage"},"content"),(0,le.jsx)(R.E,{commandRegistry:Nt,runtimeDesc:Se,save:$t,sessionConnection:Ne},"toolbar"),(0,le.jsx)(g.Q,{variant:"invisible",size:"small",leadingVisual:y.tSI,onClick:e=>We("ai-agents"===Fe?void 0:"ai-agents"),children:"AI Agent"},"clone"),(0,le.jsxs)(v.W,{children:[(0,le.jsx)(v.W.Anchor,{children:(0,le.jsx)(j.K,{variant:"invisible",icon:y.tno,"aria-label":"Open menu"})}),(0,le.jsx)(v.W.Overlay,{width:"medium",children:(0,le.jsxs)(c.l,{children:[(0,le.jsxs)(c.l.Item,{onSelect:()=>Dt(),children:[(0,le.jsx)(c.l.LeadingVisual,{children:(0,le.jsx)(y.Nc$,{})}),"Duplicate"]}),me&&(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(c.l.Divider,{}),(0,le.jsxs)(c.l.Item,{onSelect:()=>{it()},children:[(0,le.jsx)(c.l.LeadingVisual,{children:(0,le.jsx)(y.rVi,{})}),"Capture Screen"]}),(0,le.jsxs)(c.l.Item,{onSelect:()=>ze(!Pe),children:[(0,le.jsx)(c.l.LeadingVisual,{children:(0,le.jsx)(z.Cx,{type:"share"})}),"Share"]}),(0,le.jsxs)(c.l.Item,{onSelect:()=>A(`/new/page/notebook/${e}`),children:[(0,le.jsx)(c.l.LeadingVisual,{children:(0,le.jsx)(z.Cx,{type:"page"})}),"Publish"]})]}),(0,le.jsx)(c.l.Divider,{}),(0,le.jsxs)(c.l.Item,{onSelect:()=>We("mcp-server"===Fe?void 0:"mcp-server"),children:[(0,le.jsx)(c.l.LeadingVisual,{children:(0,le.jsx)(k.A,{})}),"MCP Server"]}),(0,le.jsx)(c.l.Divider,{}),(0,le.jsxs)(c.l.Item,{onSelect:()=>We("properties"===Fe?void 0:"properties"),children:[(0,le.jsx)(c.l.LeadingVisual,{children:(0,le.jsx)(y.L64,{})}),"Properties"]})]})})]}),"datalayer"===_t?.type&&$e&&(0,le.jsx)(E.P,{awareness:$e.sharedModel.awareness,currentUserHandle:t.handle},"peers")]})})]}),(0,le.jsxs)(h.O7,{children:[(0,le.jsxs)(h.O7.Content,{"aria-label":"Notebook Editor",width:"full",padding:"none",children:[et&&(0,le.jsx)(U.az,{mt:3,children:(0,le.jsxs)(U.az,{display:"flex",children:[(0,le.jsx)(U.az,{children:(0,le.jsx)("img",{src:et})}),(0,le.jsx)(U.az,{children:(0,le.jsx)(u.A,{href:"javascript: return false;",onClick:e=>st(void 0),children:(0,le.jsx)(y.uv5,{})})})]})}),Pe&&(0,le.jsx)(U.az,{sx:{flexGrow:1},children:(0,le.jsx)(se.a,{})}),Oe&&_t&&(void 0===Se?.location?(0,le.jsx)(U.az,{sx:{"& .jp-Cell":{marginTop:30}},children:(0,le.jsx)(S.j,{nbformat:Oe,outputs:!0})}):(0,le.jsx)(U.az,{children:(0,le.jsx)(_.k,{commands:Nt,extensions:At,id:e,collaborationProvider:_t,nbformat:Oe,readonly:Ue,renderers:Mt,kernelId:ke,serviceManager:je,startDefaultKernel:_e,height:"calc(100vh - 150px)",maxHeight:"calc(100vh - 150px)",cellSidebarMargin:32,onNotebookModelChanged:Tt,onSessionConnection:It})}))]}),Fe&&(0,le.jsxs)(h.O7.Pane,{"aria-label":"Notebook Sidebar",position:"start",width:"large",children:["storage"===Fe&&je.contents&&(0,le.jsx)(L.XV,{contents:je.contents,documentRegistry:ge?.jupyterLab.docRegistry}),"properties"===Fe&&(0,le.jsxs)(U.az,{as:"form",sx:{label:{marginTop:2}},children:[(0,le.jsxs)(x.A,{children:[(0,le.jsx)(x.A.Label,{children:"Name"}),(0,le.jsx)(b.A,{block:!0,value:Je.name,onChange:e=>{He(t=>({...t,name:e.target.value}))}}),!1===Ke.name&&(0,le.jsx)(x.A.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,le.jsxs)(x.A,{children:[(0,le.jsx)(x.A.Label,{children:"Description"}),(0,le.jsx)(p.Ay,{block:!0,value:Je.description,onChange:e=>{He(t=>({...t,description:e.target.value}))}}),!1===Ke.description&&(0,le.jsx)(x.A.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,le.jsx)(x.A,{children:(0,le.jsx)(g.Q,{variant:"primary",disabled:!Ke.name||!Ke.description,style:{marginTop:2},onClick:zt,children:"Update Notebook Properties"})}),(0,le.jsx)(U.az,{mt:3}),(0,le.jsx)(P.R,{variant:"default",data:Oe,fileName:`notebook-${e}`,extension:"ipynb"}),(0,le.jsxs)(U.az,{sx:{marginTop:3},children:[(0,le.jsx)(d.A,{as:"h2",sx:{fontSize:4,fontWeight:"normal",color:"danger.fg",mb:2},children:"Danger zone"}),(0,le.jsxs)(U.az,{sx:{border:"1px solid",borderColor:"danger.emphasis",borderRadius:2,p:3,alignItems:"center",justifyContent:"space-between",gap:3},children:[(0,le.jsxs)(U.az,{sx:{display:"grid",gap:1},children:[(0,le.jsx)(m.A,{sx:{fontSize:1,fontWeight:"bold",color:"danger.fg"},children:"Confirm the notebook name to delete"}),(0,le.jsx)(x.A,{children:(0,le.jsx)(b.A,{block:!0,value:Je.nameConfirm,onChange:e=>{He(t=>({...t,nameConfirm:e.target.value}))}})}),(0,le.jsx)(m.A,{sx:{fontSize:1,color:"fg.muted"},children:"This operation is not reversible."})]}),(0,le.jsx)(g.Q,{variant:"danger",disabled:!Ke.nameConfirm,onClick:async()=>{at("Deleting the notebook..."),jt.mutate(Re.id,{onSuccess:e=>{e.success&&(qe("The notebook is successfully deleted.",{variant:"success"}),A("/my-library"))},onSettled:()=>{nt()}})},children:"Delete notebook"})]})]})]}),"ai-agents"===Fe&&Be&&(0,le.jsx)(ie.z,{mcpServerUrl:Be}),"mcp-server"===Fe&&_t&&Ne&&Ne.kernel&&(0,le.jsx)(oe.m,{documentServer:{baseURL:pe.spacerRunUrl,token:ve,documentName:e,type:_t.type},runtimeId:Ne.kernel.id,runtimeSettings:Ne.serverSettings})]})]})]})}const pe=me;r()}catch(he){r(he)}})},53537:(e,t,n)=>{n.d(t,{z:()=>a});var r=n(35769),s=n(18683);const a=e=>{const{mcpServerUrl:t}=e;return(0,s.jsx)(s.Fragment,{children:t?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(r.n,{mcpServerUrl:t,height:"calc(100vh - 245px)"})}):(0,s.jsx)(s.Fragment,{})})}},60294:(e,t,n)=>{n.d(t,{m:()=>c});var r=n(3556),s=n(80006),a=n(32916),i=n(9448),o=n(45077),l=n(18683);const c=e=>{const{documentServer:t,runtimeId:n,runtimeSettings:c}=e;return(0,l.jsxs)(i.az,{children:[(0,l.jsxs)(r.A,{children:[(0,l.jsx)(a.A,{})," MCP Server"]}),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(i.az,{children:[(0,l.jsx)(s.A,{children:"Start a Jupyter MCP Server"}),(0,l.jsx)(o.O,{code:`jupyter-mcp-server start   --transport streamable-http   --provider datalayer   --document-url ${t.baseURL}   --document-id ${t.documentName}   --document-token ${t.token}   --runtime-url ${c.baseUrl}   --start-new-runtime false   --runtime-id ${n}   --runtime-token ${c.token}   --port 4040\n`})]}),(0,l.jsxs)(i.az,{sx:{mb:2},children:[(0,l.jsx)(s.A,{children:"Connect a running Jupyter MCP Server"}),(0,l.jsx)(o.O,{code:`jupyter-mcp-server start   --transport streamable-http   --provider datalayer   --start-new-runtime false\n \njupyter-mcp-server connect   --provider datalayer   --document-url ${t.baseURL}   --document-id ${t.documentName}   --document-token ${t.token}   --runtime-url ${c.baseUrl}   --runtime-id ${n}   --runtime-token ${c.token}   --jupyter-mcp-server-url http://localhost:4040\n`})]}),(0,l.jsxs)(i.az,{sx:{mb:2},children:[(0,l.jsx)(s.A,{children:"Run Code on the Runtime"}),(0,l.jsx)(o.O,{code:`import os\n\nfrom platform import node\nfrom jupyter_kernel_client import KernelClient\n\nkernel = KernelClient(\n  server_url="${c.baseUrl}",\n  kernel_id="${n}",\n  token="${c.token}"\n)\nkernel.start()\ncode = """import os\nfrom platform import node\nx=f"Hey {os.environ.get('USER', 'Foo Bar')} from {node()}."\nprint(x)\n"""\nreply = kernel.execute(code)\nprint(reply)\nassert reply["execution_count"] > 1\nassert reply["status"] == "ok"\nassert len(reply["outputs"]) > 0\n\n`})]}),(0,l.jsxs)(i.az,{children:[(0,l.jsx)(s.A,{children:"Connect to the Room, add a Cell and run it."}),(0,l.jsx)(o.O,{code:`from jupyter_nbmodel_client import NbModelClient, get_notebook_websocket_url\n\nws_url = get_notebook_websocket_url(\n  server_url = "${t.baseURL}",\n  path = "${t.documentName}",\n  token = "${t.token}",\n  provider = "datalayer"\n)\n\nasync with NbModelClient(ws_url) as notebook:\n    cell_index = notebook.add_code_cell("1+1")\n    results = notebook.execute_cell(cell_index, kernel)\n    print(results)\n    assert results["status"] == "ok"\n    assert len(results["outputs"]) > 0\n\n`})]})]})]})}}}]);
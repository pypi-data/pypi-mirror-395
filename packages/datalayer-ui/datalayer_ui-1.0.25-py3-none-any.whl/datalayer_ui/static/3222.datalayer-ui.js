"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[3222],{63222:(e,s,t)=>{t.r(s),t.d(s,{CourseTakeAssignment:()=>C,default:()=>B});var n=t(9387),a=t(45222),r=t(20568),i=t(49261),l=t(98754),d=t(3556),o=t(99180),c=t(38621),u=t(2159),m=t(84271),x=t(16476),g=t(12338),h=t(23267),j=t(84729),f=t(99179),p=t(93159),k=t(17788),S=t(18683),y=t(50825),A=t(21496),z=t(9448);const I=e=>{const{studentItem:s}=e;return s&&s?.nbgrades?(0,S.jsxs)(z.az,{children:[(0,S.jsx)(z.az,{children:(0,S.jsx)(y.A,{sx:{fontSize:1},children:"Grades"})}),(0,S.jsx)(z.az,{mt:3,children:s?.nbgrades.map(e=>(0,S.jsx)(z.az,{children:(0,S.jsxs)(A.A,{sx:{fontSize:"small"},children:[e.grade_id_s,": ",e.score_f]})}))}),(0,S.jsx)(z.az,{mt:3,children:(0,S.jsx)(y.A,{sx:{fontSize:1},children:"Total"})}),(0,S.jsxs)(z.az,{mt:3,children:[s?.nbgradesTotalScore," / ",s?.nbgradesTotalPoints]})]}):(0,S.jsxs)(z.az,{children:[(0,S.jsx)(z.az,{children:(0,S.jsx)(y.A,{sx:{fontSize:1},children:"Grades"})}),(0,S.jsx)(z.az,{mt:3,children:"Please grade your assignment."})]})};var v=t(38533),b=t(99251);const F=e=>{const{notebookId:s}=e,{grade:t}=(0,j.io)(),n=x.Fg.getState().selectNotebook(s);return(0,S.jsxs)(v.A,{display:"flex",children:[(0,S.jsx)(v.A,{children:(0,S.jsx)(b.Q,{variant:"invisible",size:"small",leadingVisual:c.iKr,onClick:()=>t(new Date),children:"Grade"})}),"busy"!==n?.kernelStatus&&(0,S.jsx)(v.A,{children:(0,S.jsx)(b.Q,{variant:"invisible",size:"small",leadingVisual:c.udU,onClick:e=>x.Fg.getState().runAll(s),children:"Run all"})}),"busy"===n?.kernelStatus&&(0,S.jsx)(v.A,{children:(0,S.jsx)(b.Q,{variant:"danger",size:"small",leadingVisual:c.wFz,onClick:e=>x.Fg.getState().interrupt(s),children:"Interrupt"})})]})},C=()=>{const e=(0,n.useMemo)(()=>[new u._({factory:m.a})],[]),{accountHandle:s,spaceHandle:t,courseId:y,assignmentId:A}=(0,r.g)();if(!y||!A)return(0,S.jsx)(S.Fragment,{});const z=(0,f.J)(),v=(0,h.mt)(),{gradeRequest:b}=(0,j.io)(),C=(0,x.Gx)(),B=`${A}-student`,{useAssignmentForStudent:w,useGradeAssignmentForStudent:R,useRefreshAssignmentForStudent:_,useResetAssignmentForStudent:Q}=(0,p.E6)(),T=w(A,y??"",z?.id??""),V=_(),E=Q(),G=R(),{data:P}=T,$=C.selectNotebookModel(B),[M]=(0,n.useState)("assignment"),D=(0,k.Z)(),[H,N]=(0,n.useState)(P);(0,n.useEffect)(()=>{P&&(N(P),J(P?.studentItem),v.layout().setItem(P))},[P]);const[U,q]=(0,n.useState)(),J=e=>{q(e);const s=(0,a.createPortal)((0,S.jsx)(I,{studentItem:e}),document.getElementById("right-panel-id"));v.layout().setRightPortal({portal:s,pinned:!1})};return(0,n.useEffect)(()=>(v.layout().showBackdrop(),V.mutate({courseId:y??"",userId:z?.id??"",assignmentId:A},{onSuccess:e=>{e.success||D("/")},onSettled:()=>{v.layout().hideBackdrop()}}),()=>{N(void 0),C.reset(),v.layout().setItem(void 0)}),[A]),(0,n.useEffect)(()=>{b&&$&&(v.layout().showBackdrop("We are grading your assignment. This may take some time..."),G.mutate({courseId:y??"",userId:z?.id??"",assignmentId:A,model:$?.model},{onSuccess:e=>{},onSettled:()=>{v.layout().hideBackdrop()}}))},[b]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(i.z,{children:(0,S.jsxs)(l.A,{display:"flex",children:[(0,S.jsx)(l.A,{flex:1,children:(0,S.jsx)(d.A,{sx:{fontSize:3},children:"Course assignment"})}),(0,S.jsx)(F,{notebookId:B}),(0,S.jsx)(l.A,{children:(0,S.jsx)(o.Q,{variant:"invisible",size:"small",leadingVisual:c.$B5,onClick:e=>{e.preventDefault(),v.layout().showBackdrop("Resetting your assignment..."),E.mutate({assignmentId:A,courseId:y??"",userId:z?.id??""},{onSuccess:e=>{},onSettled:()=>{v.layout().hideBackdrop()}})},children:"Reset"})}),(0,S.jsx)(l.A,{ml:3,children:(0,S.jsx)(o.Q,{variant:"default",size:"small",onClick:()=>D(`/${s}/${t}/course/${y}/progress`),children:"My course progress"})})]})}),H&&(0,S.jsxs)(S.Fragment,{children:["assignment"===M&&H&&(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(l.A,{children:(0,S.jsx)(g.g,{id:B,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",cellMetadataPanel:!1,nbformat:H.nbformat,extensions:e})})}),"notes"===M&&(0,S.jsx)(l.A,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,S.jsx)(l.A,{})})]})]})},B=C},84271:(e,s,t)=>{t.d(s,{a:()=>o});var n=t(18683),a=t(38621),r=t(98754),i=t(99180),l=t(71791),d=t(84604);function o(e){const{commands:s}=e;return(0,n.jsx)(r.A,{className:d.VL,sx:{"& p":{marginBottom:"0 !important"}},children:(0,n.jsx)(i.Q,{trailingVisual:a.udU,size:"small",variant:"invisible",onClick:e=>{e.preventDefault(),s.execute(l.nx.run).catch(e=>{console.error("Failed to run cell.",e)})},children:"Run"})})}}}]);
Metadata-Version: 2.4
Name: wagtail-dsfr
Version: 2.4.0rc2
Summary: Gestionnaire de contenu permettant de créer et gérer un site internet basé sur le Système de design de l'État, accessible et responsive
Author-email: Sébastien Reuiller <sebastien.reuiller@beta.gouv.fr>, Sylvain Boissel <sylvain.boissel@beta.gouv.fr>, Lucien Mollard <lucien.mollard@beta.gouv.fr>, Lucie Laporte <lucie.laporte@beta.gouv.fr>
Maintainer-email: Sylvain Boissel <sylvain.boissel@beta.gouv.fr>, Lucien Mollard <lucien.mollard@beta.gouv.fr>, Lucie Laporte <lucie.laporte@beta.gouv.fr>
Requires-Python: <4.0,>=3.11
Description-Content-Type: text/markdown
Requires-Dist: django-dsfr>=2.4.0
Requires-Dist: django>=5.2.3
Requires-Dist: wagtail>=7.0.1
Requires-Dist: psycopg2-binary>=2.9.10
Requires-Dist: python-dotenv>=1.1.0
Requires-Dist: dj-database-url>=3.0.0
Requires-Dist: gunicorn>=23.0.0
Requires-Dist: dj-static>=0.0.6
Requires-Dist: wagtailmenus>=4.0.3
Requires-Dist: wagtail-modeladmin>=2.2.0
Requires-Dist: wagtail-markdown>=0.12.1
Requires-Dist: unidecode>=1.4.0
Requires-Dist: beautifulsoup4>=4.13.4
Requires-Dist: django-taggit>=6.1.0
Requires-Dist: wagtail-localize>=1.12.1
Requires-Dist: icalendar>=6.3.1
Requires-Dist: faker>=37.4.0
Requires-Dist: rust-just>=1.40.0
Requires-Dist: mozilla-django-oidc>=4.0.1
Requires-Dist: pyyaml>=6.0.2

# wagtail_dsfr

Package Python pour Wagtail Dsfr, un gestionnaire de contenu permettant de créer et gérer un site internet basé sur le Système de design de l'État (DSFR), accessible et responsive.

Ce package est généré automatiquement à partir du projet [Sites Faciles](https://github.com/numerique-gouv/sites-faciles) officiel.

## Installation

```bash
pip install wagtail_dsfr
```

Ou avec poetry :

```bash
poetry add wagtail_dsfr
```

## Utilisation

Ajoutez les applications à votre `INSTALLED_APPS` dans `settings.py` :

```python
INSTALLED_APPS = [
    # ... vos autres apps
    "dsfr",
    "wagtail_dsfr",
    "wagtail_dsfr.blog",
    "wagtail_dsfr.content_manager",
    "wagtail_dsfr.events",
    "wagtail.contrib.settings",
    "wagtail.contrib.typed_table_block",
    "wagtail.contrib.routable_page",
    "wagtail_modeladmin",
    "wagtailmenus",
    "wagtailmarkdown",
]
```

Ajoutez les context processors nécessaires :

```python
TEMPLATES[0]["OPTIONS"]["context_processors"].extend(
    [
        "wagtailmenus.context_processors.wagtailmenus",
        "wagtail_dsfr.content_manager.context_processors.skiplinks",
        "wagtail_dsfr.content_manager.context_processors.mega_menus",
    ]
)
```

Configurez les URLs dans votre `urls.py` :

```python
# Option 1 : Utiliser directement la configuration d'URLs de wagtail_dsfr (recommandé)
from wagtail_dsfr.config.urls import *

# Option 2 : Configuration personnalisée
# Si vous avez besoin de personnaliser les URLs, vous pouvez copier le contenu
# de wagtail_dsfr.config.urls et l'adapter à vos besoins
```

## Migration depuis Sites Faciles

Si vous migrez un site existant depuis le dépôt Sites Faciles vers ce package, vous devez mettre à jour les références ContentType dans votre base de données.

### Étapes de migration

1. **Installez le package** comme décrit ci-dessus et ajoutez toutes les applications à `INSTALLED_APPS`

2. **Exécutez les migrations Django** pour créer les nouveaux ContentTypes :
   ```bash
   python manage.py migrate
   ```

3. **Migrez les ContentTypes existants** :
   ```bash
   python manage.py migrate_contenttype
   ```

   Cette commande va :
   - Identifier tous les ContentTypes de l'ancienne structure (blog, events, forms, content_manager, config)
   - Mettre à jour toutes les pages Wagtail pour pointer vers les nouveaux ContentTypes
   - Supprimer les anciens ContentTypes

4. **Vérifiez la migration** (optionnel - mode dry-run) :
   ```bash
   python manage.py migrate_contenttype --dry-run
   ```

### Pourquoi cette migration est nécessaire

Lorsque vous renommez des applications Django (par exemple de `blog` à `wagtail_dsfr_blog`), Django crée de nouveaux ContentTypes. Les pages Wagtail existantes référencent toujours les anciens ContentTypes, ce qui provoque l'erreur :

```
PageClassNotFoundError: The page 'xxx' cannot be edited because the model class
used to create it (blog.blogindexpage) can no longer be found in the codebase.
```

La commande `migrate_contenttype` résout ce problème en mettant à jour toutes les références.

## Documentation

Pour plus d'informations sur l'utilisation de Sites Faciles, consultez la [documentation officielle](https://github.com/numerique-gouv/sites-faciles).

## Licence

Ce projet est sous licence MIT - voir le fichier LICENSE pour plus de détails.

## Crédits

Ce package est basé sur [Sites Faciles](https://github.com/numerique-gouv/sites-faciles) développé par la DINUM.

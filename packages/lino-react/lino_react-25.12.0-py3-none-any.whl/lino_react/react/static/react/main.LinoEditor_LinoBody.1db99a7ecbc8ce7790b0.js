"use strict";(self.webpackChunklino_react=self.webpackChunklino_react||[]).push([[5375],{2983:(e,t,n)=>{n.r(t),n.d(t,{LinoEditor:()=>C,name:()=>x});var r=n(8168),o=n(467),a=n(4467),i=n(3029),l=n(2901),c=n(6822),s=n(5501),u=n(3954),p=n(991),d=n(4756),f=n.n(d),m=n(6540),h=n(6606),y=n(7778),b=n(2756);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach(function(t){(0,a.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function E(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(E=function(){return!!e})()}function k(e,t,n,r){var o=(0,p.A)((0,u.A)(1&r?e.prototype:e),t,n);return 2&r&&"function"==typeof o?function(e){return o.apply(n,e)}:o}var P,x="LinoEditor";P={AbortController:n.e(4166).then(n.t.bind(n,5568,23)),i18n:Promise.all([n.e(1304),n.e(8605),n.e(7211)]).then(n.bind(n,2292)),prContextMenu:Promise.all([n.e(8026),n.e(8887),n.e(5573),n.e(6836),n.e(1493)]).then(n.bind(n,3181)),prUtils:n.e(8026).then(n.bind(n,4881)),u:Promise.resolve().then(n.bind(n,1367))};(0,h.RegisterImportPool)(P);var C=function(e){function t(e){var n,r,o,a;return(0,i.A)(this,t),r=this,o=t,a=[e],o=(0,u.A)(o),(n=(0,c.A)(r,E()?Reflect.construct(o,a||[],(0,u.A)(r).constructor):o.apply(r,a))).state=w(w({},n.state),{},{plain:"plain"===e.elem.field_options.format}),n.closeEditor=n.closeEditor.bind(n),n.onGlobalKeyDown=n.onGlobalKeyDown.bind(n),n}return(0,s.A)(t,e),(0,l.A)(t,[{key:"prepare",value:(n=(0,o.A)(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,k(t,"prepare",this,3)([]);case 1:this.controller=new this.ex.AbortController.default,this.ex.i18n=this.ex.i18n.default;case 2:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"onReady",value:function(){window.addEventListener("keydown",this.onGlobalKeyDown)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.onGlobalKeyDown),this.controller.abort()}},{key:"onGlobalKeyDown",value:function(e){"Escape"==e.code&&this.closeEditor(e)}},{key:"closeEditor",value:function(){var e=this.c,t=function(){e.history.pushPath({pathname:"/api/".concat(e.value.packId,"/").concat(e.value.actorId,"/").concat(e.value.pk),params:e.actionHandler.defaultStaticParams()})};e.isModified()?e.actionHandler.discardModDConfirm({agree:t}):t()}},{key:"headerExtend",value:function(){var e=this;return m.createElement(m.Fragment,null,this.state.plain?(0,y.Zn)(this):y.PH.commonHeader(this),m.createElement("span",{className:"ql-formats"},m.createElement("button",{type:"button",onClick:function(){var t=(0,o.A)(f().mark(function t(n){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,e.c.actionHandler.submit({});case 1:t.sent.success&&e.closeEditor(n);case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),"aria-label":"Submit changes"},m.createElement("i",{className:"pi pi-save"})),m.createElement("button",{type:"button",onClick:this.closeEditor,"aria-label":"Close window"},m.createElement("i",{className:"pi pi-times"}))))}},{key:"render",value:function(){var e=this;return this.state.ready?m.createElement(h.URLContextType.Consumer,null,function(t){var n=t.controller.APP,a=(0,y.tA)(n,t.controller.actionHandler.silentFetch,e.controller.signal,t.controller.mentionValues,e.ex.i18n,e),i=a.modules,l=a.meta;return m.createElement("div",{className:"l-editor",spellCheck:!n.state.site_data.disable_spell_check,onContextMenu:(0,y.Y_)(e),onKeyDown:function(){var t=(0,o.A)(f().mark(function t(n){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.ctrlKey&&!n.metaKey||"KeyS"!==n.code){t.next=2;break}return n.stopPropagation(),n.preventDefault(),t.next=1,e.c.actionHandler.submit({});case 1:t.sent.success&&e.closeEditor(n),t.next=3;break;case 2:n.ctrlKey&&n.shiftKey&&"KeyL"==n.code?(n.stopPropagation(),n.preventDefault(),(0,y.TY)(e)):"Escape"!==n.code&&n.stopPropagation();case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},m.createElement("div",{id:l.toolbarID},e.headerExtend()),m.createElement(y.ki,{config:{modules:i,theme:"snow"},defaultValue:e.state.plain?(new y.Ru).insert(e.getValue()):null,dangerouslySetInnerHTML:e.state.plain?null:{__html:e.getValue()},onTextChange:(0,y.zl)(e),onReady:function(t){window.elem=e,e.quill=t,(0,y.a7)(e,t),(0,y.kA)(t),t.focus()}}),m.createElement(e.ex.prContextMenu.ContextMenu,(0,r.A)({},(0,y.ZI)(e),{ref:function(t){return e.tableContextMenu=t}})),m.createElement("div",{id:"raw-editor-container",onKeyDown:function(e){return e.stopPropagation()}}))}):null}}]);var n}(b.LeafComponentInput);C.requiredModules=["i18n","AbortController","prContextMenu","prUtils","u"].concat(b.LeafComponentInput.requiredModules),C.iPool=Object.assign(P,b.LeafComponentInput.iPool.copy()),C.defaultProps=w(w({},b.LeafComponentInput.defaultProps),{},{leafIndex:0})}}]);
//# sourceMappingURL=main.LinoEditor_LinoBody.1db99a7ecbc8ce7790b0.js.map
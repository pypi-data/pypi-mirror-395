"use strict";(self.webpackChunklino_react=self.webpackChunklino_react||[]).push([[7778],{5969:(e,t,n)=>{n.d(t,{A:()=>i});var l=n(1354),a=n.n(l),r=n(6314),o=n.n(r)()(a());o.push([e.id,".l-editor .ql-container {\n    font-family: inherit;\n    font-size: inherit;\n}","",{version:3,sources:["webpack://./lino_react/react/components/quillmodules.css"],names:[],mappings:"AAAA;IACI,oBAAoB;IACpB,kBAAkB;AACtB",sourcesContent:[".l-editor .ql-container {\n    font-family: inherit;\n    font-size: inherit;\n}"],sourceRoot:""}]);const i=o},7778:(e,t,n)=>{n.d(t,{Ru:()=>C.Ay,ki:()=>I.Ay,zl:()=>ne,tA:()=>te,TY:()=>ie,Y_:()=>W,kA:()=>le,a7:()=>ee,PH:()=>ce,Zn:()=>se,ZI:()=>Q});var l=n(296),a=n(2284),r=n(4467),o=n(3029),i=n(2901),s=n(6822),c=n(3954),u=n(991),m=n(5501),d=n(5072),f=n.n(d),h=n(7825),p=n.n(h),b=n(7659),g=n.n(b),A=n(5056),v=n.n(A),y=n(540),E=n.n(y),N=n(1113),w=n.n(N),q=n(5969),x={};x.styleTagTransform=w(),x.setAttributes=v(),x.insert=g().bind(null,"head"),x.domAPI=p(),x.insertStyleElement=E();f()(q.A,x);q.A&&q.A.locals&&q.A.locals;var k=n(5743),C=n(8579),I=n(8321),L=n(7421),P=n(1244),_=n(537),T=n(194),B=n(3117),F=n.n(B),R=n(5548),S=n(6540),H=n(6606);n(5065);function D(e,t,n){return t=(0,c.A)(t),(0,s.A)(e,M()?Reflect.construct(t,n||[],(0,c.A)(e).constructor):t.apply(e,n))}function M(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(M=function(){return!!e})()}function z(e,t,n,l){var a=(0,u.A)((0,c.A)(1&l?e.prototype:e),t,n);return 2&l&&"function"==typeof a?function(e){return a.apply(n,e)}:a}var V=k.Ay.import("modules/table"),j=k.Ay.import("formats/table"),U=k.Ay.import("formats/table-row"),O=k.Ay.import("formats/table-container"),K=k.Ay.import("formats/table-body"),Y=function(e){function t(){return(0,o.A)(this,t),D(this,t,arguments)}return(0,m.A)(t,e),(0,i.A)(t,[{key:"formats",value:function(){return(0,r.A)({},t.blotName,t.formats(this.domNode))}},{key:"format",value:function(e,n){if(e===t.blotName){if("string"==typeof n)throw new Error("TableCell.format: string value is not supported, use an object { row?: string, class?: string }");"object"===(0,a.A)(n)&&null!=n&&(n.row&&z(t,"format",this,3)([e,n.row]),n.class&&n.class.length?this.domNode.setAttribute("class",n.class):this.domNode.hasAttribute("class")&&this.domNode.removeAttribute("class"))}else z(t,"format",this,3)([e,n])}}],[{key:"create",value:function(e){var n;return"string"==typeof e||null==e?n=z(t,"create",this,2)([e]):(n=z(t,"create",this,2)([e.row]),e.class&&n.setAttribute("class",e.class)),n}},{key:"formats",value:function(e,n){var l={};if(l.row=z(t,"formats",this,2)([e,n]),e.hasAttribute("class")){var a=e.getAttribute("class");a&&a.length&&(l.class=a)}return l}}])}(j),Z=function(e){function t(){return(0,o.A)(this,t),D(this,t,arguments)}return(0,m.A)(t,e),(0,i.A)(t,[{key:"formats",value:function(){return(0,r.A)({},t.blotName,t.formats(this.domNode))}},{key:"format",value:function(e,n){e===t.blotName?n&&n.length?this.domNode.setAttribute("class",n):this.domNode.removeAttribute("class"):z(t,"format",this,3)([e,n])}},{key:"checkMerge",value:function(){if(P.A.prototype.checkMerge.call(this)&&null!=this.next.children.head){var e=this.children.head.formats(),t=this.children.tail.formats(),n=this.next.children.head.formats(),l=this.next.children.tail.formats();return e.table.row===t.table.row&&e.table.row===n.table.row&&e.table.row===l.table.row}return!1}},{key:"optimize",value:function(){for(var e,t=this,n=arguments.length,l=new Array(n),a=0;a<n;a++)l[a]=arguments[a];(e=P.A.prototype.optimize).call.apply(e,[this].concat(l)),this.children.forEach(function(e){if(null!=e.next){var n=e.formats(),l=e.next.formats();if(n.table.row!==l.table.row){var a=t.splitAfter(e);a&&a.optimize(),t.prev&&t.prev.optimize()}}})}}],[{key:"create",value:function(e){var n=z(t,"create",this,2)([]);return e&&e.length&&n.setAttribute("class",e),n}},{key:"formats",value:function(e){if(e.hasAttribute("class"))return e.getAttribute("class")}}])}(U),X=function(e){function t(){return(0,o.A)(this,t),D(this,t,arguments)}return(0,m.A)(t,e),(0,i.A)(t,[{key:"formats",value:function(){return(0,r.A)({},t.blotName,t.formats(this.domNode))}},{key:"format",value:function(e,n){e===t.blotName?n&&n.length?this.domNode.setAttribute("class",n):this.domNode.removeAttribute("class"):z(t,"format",this,3)([e,n])}},{key:"balanceCells",value:function(){var e=this,t=this.descendants(Z),n=t.reduce(function(e,t){return Math.max(t.children.length,e)},0);t.forEach(function(t){new Array(n-t.children.length).fill(0).forEach(function(){var n=null;null!=t.children.head&&(n=Y.formats(t.children.head.domNode));var l=e.scroll.create(Y.blotName,n);t.appendChild(l),l.optimize()})})}},{key:"insertColumn",value:function(e){var t=this,n=this.descendant(K),a=(0,l.A)(n,1)[0];null!=a&&null!=a.children.head&&a.children.forEach(function(n){var l=n.children.at(e),a=Y.formats(l.domNode),r=t.scroll.create(Y.blotName,a);n.insertBefore(r,l)})}},{key:"insertRow",value:function(e){var t=this,n=this.descendant(K),a=(0,l.A)(n,1)[0];if(null!=a&&null!=a.children.head){var r,o=(0,L.s_)(),i=a.children.head,s=i&&i.domNode?i.domNode.getAttribute("class"):void 0;s&&s.length&&(r=s);var c=this.scroll.create(Z.blotName,r);a.children.head.children.forEach(function(){var e=i.children.head,n=e&&e.domNode?e.domNode.getAttribute("class"):void 0,l=t.scroll.create(Y.blotName,{row:o,class:n||void 0});c.appendChild(l)});var u=a.children.at(e);a.insertBefore(c,u)}}}],[{key:"create",value:function(e){var n=z(t,"create",this,2)([e]);return e&&e.length&&n.setAttribute("class",e),n}},{key:"formats",value:function(e){if(e.hasAttribute("class"))return e.getAttribute("class")}}])}(O),$=function(e){function t(){return(0,o.A)(this,t),D(this,t,arguments)}return(0,m.A)(t,e),(0,i.A)(t,[{key:"insertTable",value:function(e,t){var n=this.quill.getSelection();if(null!=n){var l=new Array(e).fill(0).reduce(function(e){var n=new Array(t).fill("\n").join("");return e.insert(n,{table:{row:(0,L.s_)()}})},(new C.Ay).retain(n.index));this.quill.updateContents(l,k.Ay.sources.USER),this.quill.setSelection(n.index,k.Ay.sources.SILENT),this.balanceTables()}}}])}(V);k.Ay.register("modules/imageDropAndPaste",_.A),k.Ay.register("modules/blotFormatter2",T.Ay),k.Ay.register({"blots/mention":R.Yj,"modules/mention":R.PX}),k.Ay.register("modules/htmlEditButton",F()),k.Ay.register("modules/table",$),k.Ay.register("formats/table-row",Z),k.Ay.register("formats/table",Y),k.Ay.register("formats/table-container",X);var G,J=_.A.ImageData;G={queryString:Promise.all([n.e(4166),n.e(2298)]).then(n.bind(n,8091))};(0,H.RegisterImportPool)(G);var Q=function(e){var t=e.ex.i18n,n=function(){return e.quill.focus(),e.quill.getModule("table")},a=[{command:function(){n().insertColumnLeft()},icon:S.createElement("span",null,"Â â­°Â "),label:t.t("Insert column left")},{command:function(){n().insertColumnRight()},icon:S.createElement("span",null,"Â â­²Â "),label:t.t("Insert column right")},{command:function(){n().insertRowAbove()},icon:S.createElement("span",null,"Â â­±Â "),label:t.t("Insert row above")},{command:function(){n().insertRowBelow()},icon:S.createElement("span",null,"Â â­³Â "),label:t.t("Insert row below")},{command:function(){n().deleteColumn()},icon:"pi pi-delete-left",label:t.t("Delete column")},{command:function(){n().deleteRow()},icon:"pi pi-eraser",label:t.t("Delete row")},{command:function(){n().deleteTable()},icon:"pi pi-trash",label:t.t("Delete table")},{command:function(){var a=e.quill,o=n().getTable(),i=(0,l.A)(o,3),s=i[0],c=i[1],u=i[2],m=e.c,d=t.t("TABLE class"),f=t.t("TR class"),h=t.t("TD class"),p=t.t("Apply to all rows"),b=t.t("Apply to all cells"),g=t.t("Apply to all cells of this row"),A=t.t("Manage classes"),v=t.t("Apply");m.APP.dialogFactory.createParamDialog(m,(0,r.A)((0,r.A)((0,r.A)((0,r.A)((0,r.A)((0,r.A)({},d,{default:s.domNode.getAttribute("class")||"",react_name:"CharFieldElement"}),f,{default:c.domNode.getAttribute("class")||"",react_name:"CharFieldElement"}),p,{default:!1,react_name:"BooleanFieldElement"}),h,{default:u.domNode.getAttribute("class")||"",react_name:"CharFieldElement"}),g,{default:!1,react_name:"BooleanFieldElement"}),b,{default:!1,react_name:"BooleanFieldElement"}),A,function(e){var t=e[d].split(",").filter(function(e){return!!e}).join(" ").trim();a.formatLine(a.getIndex(s),1,X.blotName,t);var n,l=function(e,t){a.formatLine(a.getIndex(t),1,Z.blotName,e)},r=e[f].split(",").filter(function(e){return!!e}).join(" ").trim();if(l(r,c),e[p]){for(n=c.prev;null!==n;)l(r,n),n=n.prev;for(n=c.next;null!==n;)l(r,n),n=n.next}var o,i=e[b],m=e[h].split(",").filter(function(e){return!!e}).join(" ").trim();if(a.formatLine(a.getIndex(u),1,Y.blotName,{class:m}),i||e[g]){for(o=u.prev;null!==o;)a.formatLine(a.getIndex(o),1,Y.blotName,{class:m}),o=o.prev;for(o=u.next;null!==o;)a.formatLine(a.getIndex(o),1,Y.blotName,{class:m}),o=o.next}if(i){for(n=c.prev;null!==n;){if(null!==(o=n.children.head).prev)throw new Error("Programming error, row.children.head returned cell with prev item");for(;null!==o;)a.formatLine(a.getIndex(o),1,Y.blotName,{class:m}),o=o.next;n=n.prev}for(n=c.next;null!==n;){if(null!==(o=n.children.head).prev)throw new Error("Programming error, row.children.head returned cell with prev item");for(;null!==o;)a.formatLine(a.getIndex(o),1,Y.blotName,{class:m}),o=o.next;n=n.next}}return a.emitter.emit("text-change"),!0},v)},icon:S.createElement("span",null,"Â ðŸ„¿Â "),label:t.t("Properties")}];return{model:a}},W=function(e){return e.state.plain?null:function(t){var n=e.quill.getModule("table").getTable();null!==(0,l.A)(n,1)[0]&&(t.preventDefault(),e.tableContextMenu.show(t))}},ee=function(e,t){},te=function(e,t,n,a,r,o){var i=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s="l-ql-toolbar-".concat(o.props.elem.name),c={toolbar:"#".concat(s),mention:re({silentFetch:t,signal:n,mentionValues:a}),blotFormatter2:{debug:!0,resize:{useRelativeSize:!0},video:{registerBackspaceFix:!1}},table:!0};return i&&(c.htmlEditButton={msg:r.t('Edit HTML here, when you click "OK" the quill editor\'s contents will be replaced'),prependSelector:"div#raw-editor-container",okText:r.t("Ok"),cancelText:r.t("Cancel"),buttonTitle:r.t("Show HTML source")}),e.state.site_data.installed_plugins.includes("uploads")&&(c.imageDropAndPaste={handler:ae(o)}),c.keyboard={bindings:{home:{key:"Home",shiftKey:null,handler:function(e,t){var n=o.quill,a=n.getLine(e.index),r=(0,l.A)(a,1)[0];if(r&&"LI"===r.domNode.tagName){if(t.event.shiftKey){var i=r.offset(n.scroll);n.setSelection(i,e.index-i,"user")}else n.setSelection(r.offset(n.scroll),0,"user");return!1}return!0}}}},o.state.plain&&(c.keyboard.bindings["list autofill"]=!1),i||delete c.toolbar,{modules:c,meta:{toolbarID:s}}},ne=function(e){return function(t,n,l){var a=e.quill,o=a.container.children[0],i=o?o.innerHTML:null,s=a.getText();if("<p><br></p>"===i&&(i=null),"api"===l){var c=a.container.children[0],u=document.createElement("div");if(u.innerHTML=e.getValue()||"",e.ex.prUtils.DomHandler.isEqualElement(c,u))return}!function(e,t){var n=t.textValue.slice(0,-1),l=(e.state.plain?n:t.htmlValue)||"";e.update((0,r.A)({},e.dataKey,l))}(e,{htmlValue:i,textValue:s,delta:t,source:l})}},le=function(e){e.getModule("toolbar").addHandler("image",function(t){var n;t&&((n=document.createElement("input")).setAttribute("type","file"),n.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),n.classList.add("ql-image"),n.addEventListener("change",function(t){var l,a=t.target.files;if(a.length>0){var r=(l=a[0]).type,o=new FileReader;o.onload=function(t){var a=t.target.result;ae({quill:e})(a,r,new J(a,r,l.name)),n.value=""},o.readAsDataURL(l)}}),n.click())})},ae=function(e){return function(t,n,l){var a=e.quill,r=(a.getSelection()||{}).index;(void 0===r||r<0)&&(r=a.getLength()),a.insertEmbed(r,"image",t);var o=a.getLeaf(r)[0];o.domNode.setAttribute("width","100%"),o.domNode.setAttribute("height","auto")}},re=function(e){var t=e.silentFetch,n=e.signal,l=e.mentionValues;return{allowedChars:/^[A-Za-z0-9\s]*$/,mentionDenotationChars:window.App.state.site_data.suggestors,source:function(e,a,r){if(0===e.length){var o=l[r];a(o,e)}else G.resolve(["queryString"]).then(function(l){var o=l.queryString;t({path:"suggestions?".concat(o.default.stringify({query:e,trigger:r})),signal:n}).then(function(t){return a(t.suggestions,e)})})},listItemClass:"ql-mention-list-item",mentionContainerClass:"ql-mention-list-container",mentionListClass:"ql-mention-list",dataAttributes:["value","link","title","denotationChar"]}},oe=S.createElement(S.Fragment,null,S.createElement("span",{className:"ql-formats"},S.createElement("select",{className:"ql-header",defaultValue:"0"},S.createElement("option",{value:"1"},"Header 1"),S.createElement("option",{value:"2"},"Header 2"),S.createElement("option",{value:"3"},"Header 3"),S.createElement("option",{value:"4"},"Header 4"),S.createElement("option",{value:"0"},"Normal")),S.createElement("select",{className:"ql-font"},S.createElement("option",{defaultValue:!0}),S.createElement("option",{value:"serif"}),S.createElement("option",{value:"monospace"}))),S.createElement("span",{className:"ql-formats"},S.createElement("select",{className:"ql-size"},S.createElement("option",{value:"small"}),S.createElement("option",{defaultValue:!0}),S.createElement("option",{value:"large"}),S.createElement("option",{value:"huge"}))),S.createElement("span",{className:"ql-formats"},S.createElement("button",{className:"ql-script",value:"sub"}),S.createElement("button",{className:"ql-script",value:"super"})),S.createElement("span",{className:"ql-formats"},S.createElement("button",{type:"button",className:"ql-bold","aria-label":"Bold"}),S.createElement("button",{type:"button",className:"ql-italic","aria-label":"Italic"}),S.createElement("button",{type:"button",className:"ql-underline","aria-label":"Underline"})),S.createElement("span",{className:"ql-formats"},S.createElement("select",{className:"ql-color"}),S.createElement("select",{className:"ql-background"})),S.createElement("span",{className:"ql-formats"},S.createElement("button",{type:"button",className:"ql-list",value:"ordered","aria-label":"Ordered List"}),S.createElement("button",{type:"button",className:"ql-list",value:"bullet","aria-label":"Unordered List"}),S.createElement("select",{className:"ql-align"},S.createElement("option",{defaultValue:!0}),S.createElement("option",{value:"center"}),S.createElement("option",{value:"right"}),S.createElement("option",{value:"justify"}))),S.createElement("span",{className:"ql-formats"},S.createElement("button",{type:"button",className:"ql-link","aria-label":"Insert Link"}),S.createElement("button",{type:"button",className:"ql-image","aria-label":"Insert Image"}),S.createElement("button",{type:"button",className:"ql-code-block","aria-label":"Insert Code Block"})),S.createElement("span",{className:"ql-formats"},S.createElement("button",{type:"button",className:"ql-clean","aria-label":"Remove Styles"}))),ie=function(e){var t=e.props.urlParams.controller.APP.URLContext,n=(e.quill.getSelection()||{}).index;(void 0===n||n<0)&&(n=e.quill.getLength()),t.actionHandler.runAction({action_full_name:t.actionHandler.findUniqueAction("insert_reference").full_name,actorId:"about.About",response_callback:function(t){t.success&&e.quill.insertText(n,t.message)}})},se=function(e){return e.c.APP.state.site_data.installed_plugins.includes("memo")?S.createElement("span",{className:"ql-formats"},S.createElement("button",{type:"button",onClick:function(){return ie(e)},"aria-label":"Open link dialog"},S.createElement("i",{className:"pi pi-link"}))):null},ce={header:oe,commonHeader:function(e){return S.createElement(S.Fragment,null,oe,se(e),S.createElement("span",{className:"ql-formats"},S.createElement("button",{type:"button",onClick:function(){var t=e.props.urlParams.controller,n=e.ex.i18n.t("rows x columns"),l=e.ex.i18n.t("Rows"),a=e.ex.i18n.t("Columns");t.APP.dialogFactory.createParamDialog(t,(0,r.A)((0,r.A)({},l,{react_name:"IntegerFieldElement",default:3}),a,{react_name:"IntegerFieldElement",default:3}),n,function(n){var r=parseInt(n[l]),o=parseInt(n[a]),i=e.ex.u.isNaN(r);if(i||e.ex.u.isNaN(o))return t.APP.toast.show({severity:"warn",summary:e.ex.i18n.t("Not a number '{{dir}}'",{dir:i?e.ex.i18n.t("rows"):e.ex.i18n.t("columns")})}),!1;var s=e.quill.getModule("table");return e.quill.focus(),s.insertTable(r,o),!0})}},S.createElement("i",{className:"pi pi-table"}))))}}}}]);
//# sourceMappingURL=main.7778.5a18803aeef7d603dd0d.js.map
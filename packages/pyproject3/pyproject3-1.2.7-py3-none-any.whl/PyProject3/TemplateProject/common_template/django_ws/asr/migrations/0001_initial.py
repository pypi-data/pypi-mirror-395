# Generated by Django 4.1.12 on 2023-10-19 02:56

from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):
    initial = True

    dependencies = []

    operations = [
        migrations.CreateModel(
            name="AsrApp",
            fields=[
                ("id", models.BigAutoField(primary_key=True, serialize=False)),
                ("create_time", models.DateTimeField(auto_now_add=True)),
                ("update_time", models.DateTimeField(auto_now=True)),
                ("name", models.CharField(max_length=60, verbose_name="应用名称")),
                ("config", models.JSONField(verbose_name="应用配置")),
            ],
            options={
                "verbose_name": "ASR 应用",
                "verbose_name_plural": "ASR 应用",
                "ordering": ("-create_time",),
            },
        ),
        migrations.CreateModel(
            name="SubstituteWords",
            fields=[
                ("id", models.BigAutoField(primary_key=True, serialize=False)),
                ("create_time", models.DateTimeField(auto_now_add=True)),
                ("update_time", models.DateTimeField(auto_now=True)),
                ("org_term", models.CharField(max_length=30, verbose_name="目标词")),
                ("des_term", models.CharField(max_length=30, verbose_name="改写词")),
                (
                    "count",
                    models.IntegerField(
                        default=1,
                        help_text="大于 0 表示具体的改写次数，0 表示不限制次数",
                        verbose_name="改写次数",
                    ),
                ),
                (
                    "app",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="substitutewords",
                        to="asr.asrapp",
                    ),
                ),
            ],
            options={
                "verbose_name": "词改写",
                "verbose_name_plural": "词改写",
                "ordering": ("-create_time",),
            },
        ),
        migrations.CreateModel(
            name="HotWords",
            fields=[
                ("id", models.BigAutoField(primary_key=True, serialize=False)),
                ("create_time", models.DateTimeField(auto_now_add=True)),
                ("update_time", models.DateTimeField(auto_now=True)),
                ("word", models.CharField(max_length=30, verbose_name="热词")),
                (
                    "app",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="hotwords",
                        to="asr.asrapp",
                    ),
                ),
            ],
            options={
                "verbose_name": "热词",
                "verbose_name_plural": "热词",
                "ordering": ("-create_time",),
            },
        ),
        migrations.CreateModel(
            name="AsrRecord",
            fields=[
                ("id", models.BigAutoField(primary_key=True, serialize=False)),
                ("create_time", models.DateTimeField(auto_now_add=True)),
                ("update_time", models.DateTimeField(auto_now=True)),
                (
                    "session_id",
                    models.CharField(
                        help_text="每次 ASR 会话都有唯一标识",
                        max_length=128,
                        verbose_name="会话标识",
                    ),
                ),
                (
                    "asr_model_version",
                    models.CharField(
                        help_text="asr 算法模型的版本号",
                        max_length=8,
                        verbose_name="算法模型版本",
                    ),
                ),
                ("session_args", models.JSONField(verbose_name="会话参数")),
                (
                    "speeches",
                    models.JSONField(default=list, verbose_name="语音数据列表"),
                ),
                (
                    "asr_results",
                    models.JSONField(default=list, verbose_name="识别结果列表"),
                ),
                (
                    "app",
                    models.ForeignKey(
                        help_text="该记录所属 app",
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="records",
                        to="asr.asrapp",
                    ),
                ),
            ],
            options={
                "verbose_name": "语音识别记录",
                "verbose_name_plural": "语音识别记录",
                "ordering": ("-create_time",),
            },
        ),
        migrations.AddConstraint(
            model_name="substitutewords",
            constraint=models.UniqueConstraint(
                fields=("app_id", "org_term"), name="u_app_org_term"
            ),
        ),
        migrations.AddConstraint(
            model_name="hotwords",
            constraint=models.UniqueConstraint(
                fields=("app_id", "word"), name="u_app_word"
            ),
        ),
    ]

[build-system]
requires = ["uv_build"]
build-backend = "uv_build"

[project]
name = "hydraflow"
version = "0.21.3"
description = "HydraFlow seamlessly integrates Hydra and MLflow to streamline ML experiment management, combining Hydra's configuration management with MLflow's tracking capabilities."
readme = "README.md"
license = { file = "LICENSE" }
authors = [{ name = "daizutabi", email = "daizutabi@gmail.com" }]
classifiers = [
  "Development Status :: 4 - Beta",
  "Environment :: Console",
  "Intended Audience :: Developers",
  "Intended Audience :: Science/Research",
  "License :: OSI Approved :: MIT License",
  "Operating System :: OS Independent",
  "Programming Language :: Python",
  "Programming Language :: Python :: 3.13",
  "Programming Language :: Python :: 3.14",
  "Topic :: Scientific/Engineering :: Artificial Intelligence",
  "Topic :: Software Development :: Libraries :: Python Modules",
]
requires-python = ">=3.13"
keywords = [
  "machine-learning",
  "mlflow",
  "hydra",
  "experiment-tracking",
  "mlops",
  "ai",
  "deep-learning",
  "research",
  "data-science",
]
dependencies = [
  "filelock>=3.12.2",
  "hydra-core>=1.3",
  "joblib>=1.4.0",
  "mlflow>=3.6",
  "omegaconf>=2.3",
  "polars>=1.26",
  "python-ulid>=3.0.0",
  "rich>=14",
  "typer>=0.16",
]

[project.urls]
Documentation = "https://daizutabi.github.io/hydraflow/"
Source = "https://github.com/daizutabi/hydraflow"
Issues = "https://github.com/daizutabi/hydraflow/issues"

[project.scripts]
hydraflow = "hydraflow.cli:app"

[dependency-groups]
dev = [
  "basedpyright>=1.35.0",
  "hydra-joblib-launcher>=1.2",
  "prek>=0.2.18",
  "pytest>=9",
  "pytest-clarity>=1",
  "pytest-cov>=7",
  "pytest-mock>=3.15.1",
  "pytest-order>=1",
  "pytest-randomly>=4",
  "pytest-xdist>=3",
  "ruff>=0.14.8",
  "ty>=0.0.1a32",
]
docs = ["markdown-exec[ansi]", "mkapi>=4.4", "mkdocs-material"]

[tool.pytest]
addopts = [
  "--cov=hydraflow",
  "--cov-report=lcov:lcov.info",
  "--doctest-modules",
]
filterwarnings = [
  "ignore:The filesystem tracking backend.*:FutureWarning:mlflow",
  "ignore:codecs.*:DeprecationWarning:mlflow.*",
]
strict_config = true
strict_markers = true
strict_parametrization_ids = true
strict_xfail = true

[tool.coverage.report]
exclude_lines = ["no cov", "raise NotImplementedError", "if TYPE_CHECKING:"]
skip_covered = true

[tool.ruff]
line-length = 88
target-version = "py313"

[tool.ruff.lint]
select = ["ALL"]
unfixable = ["F401"]
ignore = [
  "A005",
  "ANN003",
  "ANN401",
  "B904",
  "C901",
  "D104",
  "D105",
  "D107",
  "D203",
  "D213",
  "EM101",
  "FBT001",
  "FBT002",
  "PGH003",
  "PLC0415",
  "PLR0911",
  "PLR0913",
  "PLR1704",
  "PLR2004",
  "S603",
  "SIM102",
  "SIM108",
  "SIM115",
  "TRY003",
]

[tool.ruff.lint.isort]
required-imports = ["from __future__ import annotations"]

[tool.ruff.lint.per-file-ignores]
"examples/*.py" = ["D", "G", "INP", "T"]
"src/hydraflow/__init__.py" = ["E402"]
"src/hydraflow/_py314_compat.py" = ["ANN202", "ARG005", "SLF001"]
"tests/*" = ["A001", "ANN", "ARG", "D", "FBT", "PD", "PLR", "PT", "S", "SLF"]

[tool.basedpyright]
include = ["src", "tests"]
reportAny = false
reportExplicitAny = false
reportImplicitOverride = false
reportImportCycles = false
reportIncompatibleVariableOverride = false
reportMissingTypeStubs = false
reportUnusedCallResult = false

[tool.ty.rules]
unresolved-import = "ignore"
possibly-unbound-attribute = "ignore"

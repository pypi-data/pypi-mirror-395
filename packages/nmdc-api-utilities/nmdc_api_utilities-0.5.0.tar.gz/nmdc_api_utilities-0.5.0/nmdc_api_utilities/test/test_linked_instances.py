# -*- coding: utf-8 -*-
import logging
from dotenv import load_dotenv
import os
from itertools import chain

load_dotenv()
ENV = os.getenv("ENV")
logging.basicConfig(level=logging.DEBUG)
from nmdc_api_utilities.nmdc_search import NMDCSearch


def test_get_linked_instance():
    """
    Test to get a record by a non-standard attribute.
    """
    ll_client = NMDCSearch(env=ENV)
    ids = [
        "nmdc:bsm-11-002vgm56",
        "nmdc:bsm-11-006pnx90",
        "nmdc:bsm-11-00dkyf35",
        "nmdc:bsm-11-00esf117",
        "nmdc:bsm-11-00f5nh68",
        "nmdc:bsm-11-00hrxp98",
        "nmdc:bsm-11-00m15h97",
        "nmdc:bsm-11-00n3rq22",
        "nmdc:bsm-11-00yhef97",
        "nmdc:bsm-11-011z7z70",
        "nmdc:bsm-11-0169zs66",
        "nmdc:bsm-11-01bbrr08",
        "nmdc:bsm-11-01bwgx44",
        "nmdc:bsm-11-01c63q78",
        "nmdc:bsm-11-01f6m423",
        "nmdc:bsm-11-01g9wf51",
        "nmdc:bsm-11-01gd8h56",
        "nmdc:bsm-11-01jttz71",
        "nmdc:bsm-11-01rvpq59",
        "nmdc:bsm-11-01teww33",
        "nmdc:bsm-11-0224h121",
        "nmdc:bsm-11-02323679",
        "nmdc:bsm-11-024rsd62",
        "nmdc:bsm-11-026r0w03",
        "nmdc:bsm-11-026rze76",
        "nmdc:bsm-11-02kcw433",
        "nmdc:bsm-11-02n85875",
        "nmdc:bsm-11-02nnrj92",
        "nmdc:bsm-11-02pbkx79",
        "nmdc:bsm-11-02stks54",
        "nmdc:bsm-11-02v78297",
        "nmdc:bsm-11-02x97z84",
        "nmdc:bsm-11-034x5t48",
        "nmdc:bsm-11-036sxt52",
        "nmdc:bsm-11-038c0a54",
        "nmdc:bsm-11-038rtm46",
        "nmdc:bsm-11-03c88471",
        "nmdc:bsm-11-03cvvh77",
        "nmdc:bsm-11-03dy0348",
        "nmdc:bsm-11-03kkns72",
        "nmdc:bsm-11-03nwey58",
        "nmdc:bsm-11-03rbrx77",
        "nmdc:bsm-11-03tatq76",
        "nmdc:bsm-11-03vh1p41",
        "nmdc:bsm-11-03wdqa25",
        "nmdc:bsm-11-040a1y63",
        "nmdc:bsm-11-040pda34",
        "nmdc:bsm-11-042nd237",
        "nmdc:bsm-11-0435yq18",
        "nmdc:bsm-11-043hgn06",
        "nmdc:bsm-11-047eb087",
        "nmdc:bsm-11-04bta395",
        "nmdc:bsm-11-04jj9q59",
        "nmdc:bsm-11-04kd7a87",
        "nmdc:bsm-11-04md1t87",
        "nmdc:bsm-11-04qjyv47",
        "nmdc:bsm-11-04r8kq73",
        "nmdc:bsm-11-04t36j23",
        "nmdc:bsm-11-04t67s02",
        "nmdc:bsm-11-04tyx479",
        "nmdc:bsm-11-04vy6f77",
        "nmdc:bsm-11-04whde16",
        "nmdc:bsm-11-04wp3b78",
        "nmdc:bsm-11-04z8tj85",
        "nmdc:bsm-11-0503b503",
        "nmdc:bsm-11-05082t91",
        "nmdc:bsm-11-0533mp26",
        "nmdc:bsm-11-05d5a977",
        "nmdc:bsm-11-05dve909",
        "nmdc:bsm-11-05fh0s26",
        "nmdc:bsm-11-05m5kp37",
        "nmdc:bsm-11-05t3df21",
        "nmdc:bsm-11-05yzsw39",
        "nmdc:bsm-11-063svk49",
        "nmdc:bsm-11-0674q034",
        "nmdc:bsm-11-06bhy091",
        "nmdc:bsm-11-06ccvh28",
        "nmdc:bsm-11-06dh4270",
        "nmdc:bsm-11-06dzrg11",
        "nmdc:bsm-11-06ea4y10",
        "nmdc:bsm-11-06evpv96",
        "nmdc:bsm-11-06g2dc22",
        "nmdc:bsm-11-06hvfb08",
        "nmdc:bsm-11-06ms9b03",
        "nmdc:bsm-11-06mvg980",
        "nmdc:bsm-11-06npav11",
        "nmdc:bsm-11-06pa9m89",
        "nmdc:bsm-11-06q50228",
        "nmdc:bsm-11-06qrej20",
        "nmdc:bsm-11-06rrsv58",
        "nmdc:bsm-11-06ry4a86",
        "nmdc:bsm-11-06ta8e31",
        "nmdc:bsm-11-06tgpb52",
        "nmdc:bsm-11-06wdhd53",
        "nmdc:bsm-11-06xe5s91",
        "nmdc:bsm-11-06zjzf92",
        "nmdc:bsm-11-070qpa21",
        "nmdc:bsm-11-070z3y04",
        "nmdc:bsm-11-071rdf83",
        "nmdc:bsm-11-072a9s43",
        "nmdc:bsm-11-073y9h82",
        "nmdc:bsm-11-074phz40",
        "nmdc:bsm-11-078st260",
        "nmdc:bsm-11-07ar1j63",
        "nmdc:bsm-11-07asnb39",
        "nmdc:bsm-11-07dyqv24",
        "nmdc:bsm-11-07fkx546",
        "nmdc:bsm-11-07hz4140",
        "nmdc:bsm-11-07js9c68",
        "nmdc:bsm-11-07nqms41",
        "nmdc:bsm-11-07pb3642",
        "nmdc:bsm-11-07qp3e36",
        "nmdc:bsm-11-07qq9z23",
        "nmdc:bsm-11-07s2r246",
        "nmdc:bsm-11-07spy989",
        "nmdc:bsm-11-07t6sw54",
        "nmdc:bsm-11-07vzav23",
        "nmdc:bsm-11-0806bb27",
        "nmdc:bsm-11-083pnf20",
        "nmdc:bsm-11-083vtj79",
        "nmdc:bsm-11-085vbj75",
        "nmdc:bsm-11-087tfy22",
        "nmdc:bsm-11-08bzjv22",
        "nmdc:bsm-11-08c9tv59",
        "nmdc:bsm-11-08e9gn78",
        "nmdc:bsm-11-08ee0j37",
        "nmdc:bsm-11-08fpzx54",
        "nmdc:bsm-11-08mamh62",
        "nmdc:bsm-11-08mmms67",
        "nmdc:bsm-11-08nch810",
        "nmdc:bsm-11-08nps265",
        "nmdc:bsm-11-08qsb552",
        "nmdc:bsm-11-08tvsn50",
        "nmdc:bsm-11-08vs9c51",
        "nmdc:bsm-11-08vsp197",
        "nmdc:bsm-11-08xb2k71",
        "nmdc:bsm-11-097t3b49",
        "nmdc:bsm-11-09ad0019",
        "nmdc:bsm-11-09bbdk62",
        "nmdc:bsm-11-09ep6044",
        "nmdc:bsm-11-09h8g835",
        "nmdc:bsm-11-09mw4x83",
        "nmdc:bsm-11-09rxba07",
        "nmdc:bsm-11-09tcc766",
        "nmdc:bsm-11-09z9jm13",
        "nmdc:bsm-11-09zas694",
        "nmdc:bsm-11-0ahthd94",
        "nmdc:bsm-11-0an3j196",
        "nmdc:bsm-11-0asn5d63",
        "nmdc:bsm-11-0ax2jv30",
        "nmdc:bsm-11-0b3f6q91",
        "nmdc:bsm-11-0b52dk93",
        "nmdc:bsm-11-0b7nbq19",
        "nmdc:bsm-11-0b8ncb13",
        "nmdc:bsm-11-0b9aj433",
        "nmdc:bsm-11-0bj8v379",
        "nmdc:bsm-11-0bj91094",
        "nmdc:bsm-11-0bnpdx15",
        "nmdc:bsm-11-0bq1t133",
        "nmdc:bsm-11-0br06j81",
        "nmdc:bsm-11-0bsqbq85",
        "nmdc:bsm-11-0byf2s84",
        "nmdc:bsm-11-0c0bmh09",
        "nmdc:bsm-11-0c5jqf27",
        "nmdc:bsm-11-0c5mdg78",
        "nmdc:bsm-11-0c9czb71",
        "nmdc:bsm-11-0cd1ge08",
        "nmdc:bsm-11-0cd7b431",
        "nmdc:bsm-11-0ch3bt53",
        "nmdc:bsm-11-0cmqxz82",
        "nmdc:bsm-11-0cq0tt05",
        "nmdc:bsm-11-0cqdm784",
        "nmdc:bsm-11-0cqs4m25",
        "nmdc:bsm-11-0d2xxc20",
        "nmdc:bsm-11-0d4a3v31",
        "nmdc:bsm-11-0d69tm54",
        "nmdc:bsm-11-0d6dns65",
        "nmdc:bsm-11-0d6kw824",
        "nmdc:bsm-11-0d7rka29",
        "nmdc:bsm-11-0db9vd55",
        "nmdc:bsm-11-0dg5tr66",
        "nmdc:bsm-11-0djp2e45",
        "nmdc:bsm-11-0ds10w95",
        "nmdc:bsm-11-0dvkcy09",
        "nmdc:bsm-11-0dxeyx75",
        "nmdc:bsm-11-0dxyhz83",
        "nmdc:bsm-11-0e0c0n70",
        "nmdc:bsm-11-0e3ayb34",
        "nmdc:bsm-11-0e61tc95",
        "nmdc:bsm-11-0e7t9d56",
        "nmdc:bsm-11-0eaqta51",
        "nmdc:bsm-11-0earmn44",
        "nmdc:bsm-11-0eb9eg15",
        "nmdc:bsm-11-0ebbhn67",
        "nmdc:bsm-11-0ebe7s44",
        "nmdc:bsm-11-0ef9jw05",
        "nmdc:bsm-11-0egxc971",
        "nmdc:bsm-11-0evkb371",
        "nmdc:bsm-11-0ew91192",
        "nmdc:bsm-11-0ewcv120",
        "nmdc:bsm-11-0f42r714",
        "nmdc:bsm-11-0f43ab20",
        "nmdc:bsm-11-0f4qbv31",
        "nmdc:bsm-11-0f7w3426",
        "nmdc:bsm-11-0fg7rn04",
        "nmdc:bsm-11-0fntz079",
        "nmdc:bsm-11-0fps8951",
        "nmdc:bsm-11-0frw6183",
        "nmdc:bsm-11-0g011v53",
        "nmdc:bsm-11-0g1z7378",
        "nmdc:bsm-11-0g28x785",
        "nmdc:bsm-11-0g3qzr85",
        "nmdc:bsm-11-0g4d7n95",
        "nmdc:bsm-11-0g6wkd40",
        "nmdc:bsm-11-0ga7mv28",
        "nmdc:bsm-11-0gj3wh79",
        "nmdc:bsm-11-0gmae642",
        "nmdc:bsm-11-0gmd9f09",
        "nmdc:bsm-11-0gy70878",
        "nmdc:bsm-11-0gy85h88",
        "nmdc:bsm-11-0h3s6t03",
        "nmdc:bsm-11-0h7ft579",
        "nmdc:bsm-11-0h9fx108",
        "nmdc:bsm-11-0hahtj72",
        "nmdc:bsm-11-0hc2cc92",
        "nmdc:bsm-11-0hh70w74",
        "nmdc:bsm-11-0hjwvs60",
        "nmdc:bsm-11-0hkm4783",
        "nmdc:bsm-11-0hm5p957",
        "nmdc:bsm-11-0hmr6870",
        "nmdc:bsm-11-0hns7a54",
        "nmdc:bsm-11-0hrvfj70",
        "nmdc:bsm-11-0hz4rd27",
        "nmdc:bsm-11-0j16a127",
        "nmdc:bsm-11-0j182d47",
        "nmdc:bsm-11-0j2bs453",
        "nmdc:bsm-11-0j3ff625",
        "nmdc:bsm-11-0j8e6d39",
        "nmdc:bsm-11-0jd4t824",
        "nmdc:bsm-11-0jdesy83",
        "nmdc:bsm-11-0jgtxr69",
        "nmdc:bsm-11-0jh8w006",
        "nmdc:bsm-11-0jrp3613",
        "nmdc:bsm-11-0jsqys69",
        "nmdc:bsm-11-0jw46z66",
        "nmdc:bsm-11-0jxgba87",
        "nmdc:bsm-11-0k42k540",
        "nmdc:bsm-11-0k57sy88",
        "nmdc:bsm-11-0k5bep35",
        "nmdc:bsm-11-0k60dv12",
        "nmdc:bsm-11-0k6dy332",
        "nmdc:bsm-11-0k8nkx16",
        "nmdc:bsm-11-0kawe915",
        "nmdc:bsm-11-0kekqm16",
        "nmdc:bsm-11-0ksnwp91",
        "nmdc:bsm-11-0kywv165",
        "nmdc:bsm-11-0manyb74",
        "nmdc:bsm-11-0mbb0m42",
        "nmdc:bsm-11-0me1ab18",
        "nmdc:bsm-11-0mkzz526",
        "nmdc:bsm-11-0mmva916",
        "nmdc:bsm-11-0mphb608",
        "nmdc:bsm-11-0mr28n73",
        "nmdc:bsm-11-0my71807",
        "nmdc:bsm-11-0n3z7r33",
        "nmdc:bsm-11-0n5f5q18",
        "nmdc:bsm-11-0n62s715",
        "nmdc:bsm-11-0n9kgt73",
        "nmdc:bsm-11-0nas9n36",
        "nmdc:bsm-11-0nazn012",
        "nmdc:bsm-11-0nbmnc66",
        "nmdc:bsm-11-0nd36621",
        "nmdc:bsm-11-0ne9e584",
        "nmdc:bsm-11-0nez8d79",
        "nmdc:bsm-11-0nk4at30",
        "nmdc:bsm-11-0np0tc25",
        "nmdc:bsm-11-0nq44g76",
        "nmdc:bsm-11-0nqehw82",
        "nmdc:bsm-11-0nrjh736",
        "nmdc:bsm-11-0nx48646",
        "nmdc:bsm-11-0p3waw07",
        "nmdc:bsm-11-0p5q3s54",
        "nmdc:bsm-11-0p6p9b27",
        "nmdc:bsm-11-0p6sfk08",
        "nmdc:bsm-11-0p86vg14",
        "nmdc:bsm-11-0pd6r038",
        "nmdc:bsm-11-0pm8jq17",
        "nmdc:bsm-11-0pnrfe25",
        "nmdc:bsm-11-0pp1y564",
        "nmdc:bsm-11-0pq46m48",
        "nmdc:bsm-11-0pqvg660",
        "nmdc:bsm-11-0pybkd05",
        "nmdc:bsm-11-0pyv7738",
        "nmdc:bsm-11-0q0ytn25",
        "nmdc:bsm-11-0q1w4832",
        "nmdc:bsm-11-0q26tj53",
        "nmdc:bsm-11-0qa78w81",
        "nmdc:bsm-11-0qbfyr37",
        "nmdc:bsm-11-0qk7tq18",
        "nmdc:bsm-11-0qmafj75",
        "nmdc:bsm-11-0qmfcv11",
        "nmdc:bsm-11-0qx29v78",
        "nmdc:bsm-11-0qypsy03",
        "nmdc:bsm-11-0r62mq05",
        "nmdc:bsm-11-0r8k7q62",
        "nmdc:bsm-11-0rf6yr44",
        "nmdc:bsm-11-0rn5v405",
        "nmdc:bsm-11-0rnz8g06",
        "nmdc:bsm-11-0rqhtj66",
        "nmdc:bsm-11-0rqnr440",
        "nmdc:bsm-11-0rqs8455",
        "nmdc:bsm-11-0rtyy508",
        "nmdc:bsm-11-0rvewk88",
        "nmdc:bsm-11-0ryfcf84",
        "nmdc:bsm-11-0rygg262",
        "nmdc:bsm-11-0s4z3q14",
        "nmdc:bsm-11-0s62j636",
        "nmdc:bsm-11-0s7xvb75",
        "nmdc:bsm-11-0snmnf40",
        "nmdc:bsm-11-0sv70p03",
        "nmdc:bsm-11-0t0ztq94",
        "nmdc:bsm-11-0t2nbd91",
        "nmdc:bsm-11-0t30k005",
        "nmdc:bsm-11-0t4hha86",
        "nmdc:bsm-11-0ta1qp62",
        "nmdc:bsm-11-0tbjtz54",
        "nmdc:bsm-11-0tde3t26",
        "nmdc:bsm-11-0teqzx96",
        "nmdc:bsm-11-0thxv339",
        "nmdc:bsm-11-0tqtww96",
        "nmdc:bsm-11-0txy7h75",
        "nmdc:bsm-11-0v0ecc36",
        "nmdc:bsm-11-0v1etz47",
        "nmdc:bsm-11-0v2kpm96",
        "nmdc:bsm-11-0v450r13",
        "nmdc:bsm-11-0v4vv913",
        "nmdc:bsm-11-0v7hes85",
        "nmdc:bsm-11-0v8s9y84",
        "nmdc:bsm-11-0v9c0z98",
        "nmdc:bsm-11-0ve03274",
        "nmdc:bsm-11-0vfd3065",
        "nmdc:bsm-11-0vjrp307",
        "nmdc:bsm-11-0vqkxy43",
        "nmdc:bsm-11-0w42bz83",
        "nmdc:bsm-11-0wb39875",
        "nmdc:bsm-11-0wg4f504",
        "nmdc:bsm-11-0whn0117",
        "nmdc:bsm-11-0wvxcg04",
        "nmdc:bsm-11-0x01kf67",
        "nmdc:bsm-11-0x29fa54",
        "nmdc:bsm-11-0x2ymd43",
        "nmdc:bsm-11-0x5m4z09",
        "nmdc:bsm-11-0x7bvh88",
        "nmdc:bsm-11-0x9p8y05",
        "nmdc:bsm-11-0xajtb06",
        "nmdc:bsm-11-0xf0gj57",
        "nmdc:bsm-11-0xg3w467",
        "nmdc:bsm-11-0xg79673",
        "nmdc:bsm-11-0xm44r37",
        "nmdc:bsm-11-0xn27x15",
        "nmdc:bsm-11-0xp9nk46",
        "nmdc:bsm-11-0xqxvc88",
        "nmdc:bsm-11-0xs3cz68",
        "nmdc:bsm-11-0xvgya91",
        "nmdc:bsm-11-0xxg0878",
        "nmdc:bsm-11-0xxs4588",
        "nmdc:bsm-11-0y08zq67",
        "nmdc:bsm-11-0yaa3q61",
        "nmdc:bsm-11-0yb49r23",
        "nmdc:bsm-11-0yeqsq36",
        "nmdc:bsm-11-0ykczz33",
        "nmdc:bsm-11-0ynadq83",
        "nmdc:bsm-11-0ys39334",
        "nmdc:bsm-11-0yv80b75",
        "nmdc:bsm-11-0yw1rj05",
        "nmdc:bsm-11-0ywr3c59",
        "nmdc:bsm-11-0z0yn327",
        "nmdc:bsm-11-0z0z0144",
        "nmdc:bsm-11-0z4fw943",
        "nmdc:bsm-11-0z7ad930",
        "nmdc:bsm-11-0zbejz22",
        "nmdc:bsm-11-0zcdcz38",
        "nmdc:bsm-11-0zd71e37",
        "nmdc:bsm-11-0zddn388",
        "nmdc:bsm-11-0zeeq282",
        "nmdc:bsm-11-0zgy0491",
        "nmdc:bsm-11-0zn3g786",
        "nmdc:bsm-11-0zp00g98",
        "nmdc:bsm-11-0zxynz54",
        "nmdc:bsm-11-101d8291",
        "nmdc:bsm-11-1026rp71",
        "nmdc:bsm-11-102q0657",
        "nmdc:bsm-11-1048m402",
        "nmdc:bsm-11-104brf69",
        "nmdc:bsm-11-105s2303",
        "nmdc:bsm-11-106c8d05",
        "nmdc:bsm-11-10c7qy36",
        "nmdc:bsm-11-10cg0s25",
        "nmdc:bsm-11-10czxf79",
        "nmdc:bsm-11-10fc8a15",
        "nmdc:bsm-11-10jt6t90",
        "nmdc:bsm-11-10k0rc51",
        "nmdc:bsm-11-10k8xw70",
        "nmdc:bsm-11-10kan307",
        "nmdc:bsm-11-10kjq953",
        "nmdc:bsm-11-10mq8376",
        "nmdc:bsm-11-10n69j27",
        "nmdc:bsm-11-10nmzz70",
        "nmdc:bsm-11-10pxxs40",
        "nmdc:bsm-11-10re4k49",
        "nmdc:bsm-11-10vg3331",
        "nmdc:bsm-11-10vgv258",
        "nmdc:bsm-11-10w0ew91",
        "nmdc:bsm-11-1109f777",
        "nmdc:bsm-11-1125yh42",
        "nmdc:bsm-11-112jxh69",
        "nmdc:bsm-11-113ags24",
        "nmdc:bsm-11-113gg097",
        "nmdc:bsm-11-115r6257",
        "nmdc:bsm-11-116fe613",
        "nmdc:bsm-11-1185ft33",
        "nmdc:bsm-11-11a1rr28",
        "nmdc:bsm-11-11avmz59",
        "nmdc:bsm-11-11b34877",
        "nmdc:bsm-11-11hvm142",
        "nmdc:bsm-11-11jk9a93",
        "nmdc:bsm-11-11paxx81",
        "nmdc:bsm-11-11q52h81",
        "nmdc:bsm-11-11sdrx43",
        "nmdc:bsm-11-11ybd810",
        "nmdc:bsm-11-127y7152",
        "nmdc:bsm-11-12cg4p02",
        "nmdc:bsm-11-12e4ke56",
        "nmdc:bsm-11-12esnc57",
        "nmdc:bsm-11-12khgx15",
        "nmdc:bsm-11-12nfem84",
        "nmdc:bsm-11-12snfw81",
        "nmdc:bsm-11-12vq4a05",
        "nmdc:bsm-11-12zm4r83",
        "nmdc:bsm-11-1302r041",
        "nmdc:bsm-11-133a9t75",
        "nmdc:bsm-11-135tf197",
        "nmdc:bsm-11-1362ms92",
        "nmdc:bsm-11-13b8a328",
        "nmdc:bsm-11-13c4r268",
        "nmdc:bsm-11-13gd4m13",
        "nmdc:bsm-11-13kvnw34",
        "nmdc:bsm-11-13mnr371",
        "nmdc:bsm-11-13n02604",
        "nmdc:bsm-11-13p5fw68",
        "nmdc:bsm-11-13qyg134",
        "nmdc:bsm-11-13rnnv18",
        "nmdc:bsm-11-13rvbb54",
        "nmdc:bsm-11-13s3f541",
        "nmdc:bsm-11-13tve392",
        "nmdc:bsm-11-145xg276",
        "nmdc:bsm-11-1481pt52",
        "nmdc:bsm-11-148v0y74",
        "nmdc:bsm-11-14986392",
        "nmdc:bsm-11-14dtyj87",
        "nmdc:bsm-11-14fz4k35",
        "nmdc:bsm-11-14hxc920",
        "nmdc:bsm-11-14q1kt83",
        "nmdc:bsm-11-14qr3105",
        "nmdc:bsm-11-14wbff23",
        "nmdc:bsm-11-14xprx08",
        "nmdc:bsm-11-14y6dz18",
        "nmdc:bsm-11-154j1k71",
        "nmdc:bsm-11-158pa966",
        "nmdc:bsm-11-158q2r45",
        "nmdc:bsm-11-15efp884",
        "nmdc:bsm-11-15k2me15",
        "nmdc:bsm-11-15t8c910",
        "nmdc:bsm-11-162tdx86",
        "nmdc:bsm-11-163kk106",
        "nmdc:bsm-11-1658w550",
        "nmdc:bsm-11-168xmm55",
        "nmdc:bsm-11-16svk968",
        "nmdc:bsm-11-16sx3p77",
        "nmdc:bsm-11-16t3g930",
        "nmdc:bsm-11-16t5jt45",
        "nmdc:bsm-11-16thhh67",
        "nmdc:bsm-11-16yk2m32",
        "nmdc:bsm-11-1713p538",
        "nmdc:bsm-11-171et506",
        "nmdc:bsm-11-17cg0265",
        "nmdc:bsm-11-17djvx32",
        "nmdc:bsm-11-17dpqm86",
        "nmdc:bsm-11-17hg1e09",
        "nmdc:bsm-11-17mk1p49",
        "nmdc:bsm-11-17nrhs76",
        "nmdc:bsm-11-17rsbh94",
        "nmdc:bsm-11-17yggv08",
        "nmdc:bsm-11-182t3n64",
        "nmdc:bsm-11-185e5f56",
        "nmdc:bsm-11-185xz607",
        "nmdc:bsm-11-186rqh54",
        "nmdc:bsm-11-188tvn24",
        "nmdc:bsm-11-189gwh62",
        "nmdc:bsm-11-189wmf56",
    ]
    result = ll_client.get_linked_instances(types=["nmdc:Study"], ids=ids)
    # make a list of all unique _upstream_of ids in result
    result_ids = list(set(chain.from_iterable(x["_upstream_of"] for x in result)))

    assert len(result_ids) == 500
    # assert that all result_ids are in the input ids
    assert all(rid in ids for rid in result_ids)


def test_get_linked_instance_mutiple_types():
    """
    Test to get a record by a non-standard attribute.
    """
    ll_client = NMDCSearch(env=ENV)
    ids = ["nmdc:bsm-11-002vgm56", "nmdc:bsm-11-006pnx90"]
    result = ll_client.get_linked_instances(
        types=["nmdc:Study", "nmdc:DataObject"], ids=ids
    )

    assert "nmdc:DataObject" and "nmdc:Study" in [x["type"] for x in result]


def test_get_linked_instance_strings():
    """
    Test to get a record by a non-standard attribute.
    """
    ll_client = NMDCSearch(env=ENV)
    id = "nmdc:bsm-11-002vgm56"
    result = ll_client.get_linked_instances(types="nmdc:Study", ids=id)

    assert len(result) == 2


def test_association():
    ll_client = NMDCSearch(env=ENV)
    association = ll_client.get_linked_instances_and_associate_ids(
        types=["nmdc:Study"], ids=["nmdc:bsm-11-002vgm56", "nmdc:bsm-11-006pnx90"]
    )
    assert "nmdc:bsm-11-002vgm56" and "nmdc:bsm-11-006pnx90" in association.keys()

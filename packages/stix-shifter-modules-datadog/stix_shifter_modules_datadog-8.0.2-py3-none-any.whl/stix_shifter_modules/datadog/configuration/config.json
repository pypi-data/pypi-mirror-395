{
    "connection": {
        "type": {
            "displayName": "Datadog",
            "group": "datadog",
            "type": "connectorType"
        },
        "site_url": {
            "type": "text",
            "regex": "https?:\\/\\/((app|us3|us5)\\.)[a-z0-9-]+\\.[a-z]{2,3}$"
        },
        "selfSignedCert": {
            "type": "password",
            "optional": true
        },
        "help": {
            "type": "link",
            "default": "data-sources.html"
        },
        "options": {
            "type": "fields",
            "async_call": {
                "type": "text",
                "hidden": true,
                "optional": true
            },
            "result_limit": {
                "default": 10000,
                "min": 1,
                "max": 10000000,
                "type": "number",
                "previous": "connection.resultSizeLimit"
            },
            "batch_size": {
                "default": 2000,
                "min": 1,
                "max": 10000,
                "type": "number",
                "optional": true,
                "hidden": true
            },
            "time_range": {
                "default": 5,
                "min": 1,
                "max": 10000,
                "type": "number",
                "previous": "connection.timerange",
                "nullable": true
            },
            "timeout": {
                "default": 30,
                "min": 1,
                "max": 3600,
                "hidden": true,
                "type": "number",
                "previous": "connection.timeoutLimit"
            },
            "dialects": {
                "type": "array",
                "hidden": true,
                "optional": true
            },
            "language": {
                "type": "string",
                "default": "stix",
                "optional": true,
                "hidden": true
            },
            "validate_pattern": {
                "type": "boolean",
                "optional": true,
                "hidden": true,
                "previous": "connection.validate_pattern"
            },
            "stix_validator": {
                "type": "boolean",
                "default": false,
                "optional": true,
                "hidden": true,
                "previous": "connection.stix_validator"
            },
            "mapping": {
                "type": "json",
                "optional": true,
                "previous": "connection.mapping",
                "default": {
                    "to_stix_map": {
                        "host": [
                            {
                                "key": "domain-name.value",
                                "object": "domain-name"
                            },
                            {
                                "key": "x-oca-event.domain_ref",
                                "object": "x-oca-event",
                                "references": "domain-name"
                            }
                        ],
                        "text": [
                            {
                                "key": "artifact.payload_bin",
                                "transformer": "ToBase64",
                                "object": "artifact"
                            },
                            {
                                "key": "x-oca-event.original_ref",
                                "object": "x-oca-event",
                                "references": "artifact"
                            }
                        ],
                        "source": {
                            "key": "x-oca-event.module",
                            "object": "x-oca-event"
                        },
                        "id": {
                            "key": "x-oca-event.code",
                            "object": "x-oca-event",
                            "transformer": "ToString"
                        },
                        "id_str": {
                            "key": "x-oca-event.code",
                            "object": "x-oca-event"
                        },
                        "title": {
                            "key": "x-oca-event.outcome",
                            "object": "x-oca-event"
                        },
                        "device_name": {
                            "key": "x-oca-event.agent",
                            "object": "x-oca-event"
                        },
                        "date_happened": [
                            {
                                "key": "x-ibm-finding.time_observed",
                                "object": "x-ibm-finding",
                                "transformer": "EpochToTimestamp"
                            },
                            {
                                "key": "x-oca-event.created",
                                "object": "x-oca-event",
                                "transformer": "EpochToTimestamp"
                            },
                            {
                                "key": "first_observed",
                                "transformer": "EpochToTimestamp"
                            },
                            {
                                "key": "last_observed",
                                "transformer": "EpochToTimestamp"
                            }
                        ],
                        "start": [
                            {
                                "key": "x-ibm-finding.start",
                                "object": "x-ibm-finding"
                            },
                            {
                                "key": "process.created_time",
                                "object": "process"
                            }
                        ],
                        "end": {
                            "key": "x-ibm-finding.end",
                            "object": "x-ibm-finding"
                        },
                        "priority": {
                            "key": "x-datadog-event.priority",
                            "object": "x-datadog-event"
                        },
                        "monitor_id": {
                            "key": "x-datadog-event.monitor_id",
                            "object": "x-datadog-event"
                        },
                        "tags": {
                            "key": "x-datadog-event.tags",
                            "object": "x-datadog-event"
                        },
                        "is_aggregate": {
                            "key": "x-datadog-event.unaggregated",
                            "object": "x-datadog-event"
                        },
                        "alert_type": {
                            "key": "x-datadog-event.alert_type",
                            "object": "x-datadog-event"
                        },
                        "cmdline": {
                            "key": "process.command_line",
                            "object": "process"
                        },
                        "pid": {
                            "key": "process.pid",
                            "object": "process",
                            "transformer": "ToInteger"
                        },
                        "timestamp": {
                            "key": "process.created_time",
                            "object": "process"
                        },
                        "user": [
                            {
                                "key": "user-account.user_id",
                                "object": "useraccount"
                            },
                            {
                                "key": "process.creator_user_ref",
                                "object": "process",
                                "references": "useraccount"
                            }
                        ]
                    },
                    "operators": {
                        "ComparisonExpressionOperators.And": "AND",
                        "ComparisonExpressionOperators.Or": "OR",
                        "ComparisonComparators.Equal": ":",
                        "ComparisonComparators.In": ":",
                        "ObservationOperators.Or": "OR",
                        "ObservationOperators.And": "OR"
                    },
                    "events_from_stix_map": {
                        "domain-name": {
                            "fields": {
                                "value": [
                                    "host"
                                ]
                            }
                        },
                        "artifact": {
                            "fields": {
                                "payload_bin": [
                                    "text"
                                ]
                            }
                        },
                        "x-datadog-event": {
                            "fields": {
                                "priority": [
                                    "priority"
                                ],
                                "monitor_id": [
                                    "monitor_id"
                                ],
                                "tags": [
                                    "tags"
                                ],
                                "is_aggregate": [
                                    "unaggregated"
                                ],
                                "alert_type": [
                                    "alert_type"
                                ]
                            }
                        },
                        "x-ibm-finding": {
                            "fields": {
                                "start": [
                                    "start"
                                ],
                                "end": [
                                    "end"
                                ],
                                "time_observed": [
                                    "date_happened"
                                ]
                            }
                        },
                        "x-oca-event": {
                            "fields": {
                                "code": [
                                    "id",
                                    "id_str"
                                ],
                                "outcome": [
                                    "title"
                                ],
                                "module": [
                                    "source"
                                ],
                                "agent": [
                                    "device_name"
                                ],
                                "created": [
                                    "date_happened"
                                ],
                                "original_ref.payload_bin": [
                                    "text"
                                ],
                                "domain_ref.value": [
                                    "host"
                                ]
                            }
                        }
                    },
                    "processes_from_stix_map": {
                        "domain-name": {
                            "fields": {
                                "value": [
                                    "host"
                                ]
                            }
                        },
                        "artifact": {
                            "fields": {
                                "payload_bin": [
                                    "text"
                                ]
                            }
                        },
                        "user-account": {
                            "fields": {
                                "user_id": [
                                    "user"
                                ]
                            }
                        },
                        "process": {
                            "fields": {
                                "command_line": [
                                    "cmdline"
                                ],
                                "pid": [
                                    "pid"
                                ],
                                "creator_user_ref": [
                                    "user"
                                ],
                                "created_time": [
                                    "timestamp",
                                    "start"
                                ],
                                "parent_ref": [
                                    "ppid"
                                ]
                            }
                        },
                        "x-datadog-event": {
                            "fields": {
                                "priority": [
                                    "priority"
                                ],
                                "monitor_id": [
                                    "monitor_id"
                                ],
                                "tags": [
                                    "tags"
                                ],
                                "is_aggregate": [
                                    "unaggregated"
                                ],
                                "alert_type": [
                                    "alert_type"
                                ]
                            }
                        },
                        "x-ibm-finding": {
                            "fields": {
                                "start": [
                                    "start"
                                ],
                                "end": [
                                    "end"
                                ],
                                "time_observed": [
                                    "date_happened"
                                ]
                            }
                        },
                        "x-oca-event": {
                            "fields": {
                                "code": [
                                    "id",
                                    "id_str"
                                ],
                                "outcome": [
                                    "title"
                                ],
                                "module": [
                                    "source"
                                ],
                                "agent": [
                                    "device_name"
                                ],
                                "created": [
                                    "date_happened"
                                ],
                                "original_ref.payload_bin": [
                                    "text"
                                ],
                                "domain_ref.value": [
                                    "host"
                                ]
                            }
                        }
                    }
                }
            },
            "unmapped_fallback": {
                "type": "boolean",
                "default": false,
                "optional": true,
                "hidden": true
            },
            "stix_2.1": {
                "type": "boolean",
                "default": false,
                "optional": true,
                "hidden": true
            }
        }
    },
    "configuration": {
        "auth": {
            "type": "fields",
            "api_key": {
                "type": "password"
            },
            "application_key": {
                "type": "password"
            }
        }
    }
}
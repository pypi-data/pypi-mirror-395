---
description: Python coding standards
globs: "**/*.py"
---

# Python Standards

## Style

- **Formatter**: Ruff (Black-compatible, 88 char line length)
- **Imports**: Sorted by ruff
- **Type hints**: Required on all public functions

```bash
# Format and lint
uvx ruff check --fix .
uvx ruff format .
```

## Naming

| Element | Convention | Example |
|---------|------------|---------|
| Functions/Variables | snake_case | `get_data()` |
| Classes | PascalCase | `DataProcessor` |
| Constants | UPPER_CASE | `MAX_RETRIES` |
| Private | Leading underscore | `_internal_helper()` |

## Type Hints

```python
# ✅ Modern style (Python 3.9+)
from collections.abc import Mapping, Sequence
from typing import Any

def process(items: list[dict[str, Any]]) -> dict[str, int]:
    return {"count": len(items)}

# ❌ Legacy style - avoid
from typing import Dict, List
def process(items: Dict[str, Any]) -> List[str]: ...
```

## Package Management

- **Tool**: uv (fast, Rust-based)
- **Config**: `pyproject.toml`
- **Lock file**: `uv.lock` (commit this)

```bash
# Install dependencies
uv sync

# Add dependency
uv add requests

# Add dev dependency
uv add --dev pytest
```

## Testing

- **Framework**: pytest
- **Location**: `tests/` directory
- **Run**: `pytest` or `tox -e <package>`

```bash
# Run tests
pytest

# With coverage
pytest --cov=src

# Specific test
pytest tests/test_utils.py::test_specific
```

## Imports

```python
# ✅ Use pathlib
from pathlib import Path
config = Path("config.yaml")

# ❌ Avoid os.path
import os
config = os.path.join("config.yaml")
```

## Docstrings

Use Google style:

```python
def process_items(items: list[dict], validate: bool = True) -> dict[str, Any]:
    """Process items and return summary.

    Args:
        items: List of item dictionaries.
        validate: Whether to validate before processing.

    Returns:
        Dictionary with processing results.

    Raises:
        ValueError: If items list is empty.
    """
```

import numpy

def jac(_Dummy_34, _Dummy_35):
    [x1, y1, z1, x2, y2, z2, x3, y3, z3, x4, y4, z4, x5, y5, z5, x6, y6, z6, x7, y7, z7, x8, y8, z8, x9, y9, z9, x10, y10, z10] = _Dummy_34
    [zeta1, zeta2, zeta3, zeta4] = _Dummy_35
    x0 = 4*zeta2
    x11 = 4*zeta3
    x12 = 4*zeta4
    x13 = 4*zeta1
    x14 = x13 - 1
    x15 = x0 - 1
    x16 = x11 - 1
    x17 = x12 - 1
    return numpy.array([[1, 1, 1, 1], [x0*x5 + x1*x14 + x11*x7 + x12*x8, x11*x6 + x12*x9 + x13*x5 + x15*x2, x0*x6 + x10*x12 + x13*x7 + x16*x3, x0*x9 + x10*x11 + x13*x8 + x17*x4], [x0*y5 + x11*y7 + x12*y8 + x14*y1, x11*y6 + x12*y9 + x13*y5 + x15*y2, x0*y6 + x12*y10 + x13*y7 + x16*y3, x0*y9 + x11*y10 + x13*y8 + x17*y4], [x0*z5 + x11*z7 + x12*z8 + x14*z1, x11*z6 + x12*z9 + x13*z5 + x15*z2, x0*z6 + x12*z10 + x13*z7 + x16*z3, x0*z9 + x11*z10 + x13*z8 + x17*z4]])

def N(_Dummy_36, _Dummy_37):
    [x1, y1, z1, x2, y2, z2, x3, y3, z3, x4, y4, z4, x5, y5, z5, x6, y6, z6, x7, y7, z7, x8, y8, z8, x9, y9, z9, x10, y10, z10] = _Dummy_36
    [zeta1, zeta2, zeta3, zeta4] = _Dummy_37
    x0 = zeta1*(2*zeta1 - 1)
    x1 = zeta2*(2*zeta2 - 1)
    x2 = zeta3*(2*zeta3 - 1)
    x3 = zeta4*(2*zeta4 - 1)
    x4 = 4*zeta2
    x5 = x4*zeta1
    x6 = x4*zeta3
    x7 = 4*zeta1
    x8 = x7*zeta3
    x9 = x7*zeta4
    x10 = x4*zeta4
    x11 = 4*zeta3*zeta4
    return numpy.array([[x0, 0, 0, x1, 0, 0, x2, 0, 0, x3, 0, 0, x5, 0, 0, x6, 0, 0, x8, 0, 0, x9, 0, 0, x10, 0, 0, x11, 0, 0], [0, x0, 0, 0, x1, 0, 0, x2, 0, 0, x3, 0, 0, x5, 0, 0, x6, 0, 0, x8, 0, 0, x9, 0, 0, x10, 0, 0, x11, 0], [0, 0, x0, 0, 0, x1, 0, 0, x2, 0, 0, x3, 0, 0, x5, 0, 0, x6, 0, 0, x8, 0, 0, x9, 0, 0, x10, 0, 0, x11]])

def D(E, nu):
    x0 = nu - 1
    x1 = E/(2*nu**2 + x0)
    x2 = x0*x1
    x3 = -nu*x1
    x4 = (1/2)*E/(nu + 1)
    return numpy.array([[x2, x3, x3, 0, 0, 0], [x3, x2, x3, 0, 0, 0], [x3, x3, x2, 0, 0, 0], [0, 0, 0, x4, 0, 0], [0, 0, 0, 0, x4, 0], [0, 0, 0, 0, 0, x4]])

def B2(_Dummy_38, _Dummy_39):
    [x1, y1, z1, x2, y2, z2, x3, y3, z3, x4, y4, z4, x5, y5, z5, x6, y6, z6, x7, y7, z7, x8, y8, z8, x9, y9, z9, x10, y10, z10] = _Dummy_38
    [zeta1, zeta2, zeta3, zeta4] = _Dummy_39
    x0 = 4*zeta1
    x1 = x0 - 1
    x2 = 4*zeta2
    x3 = 4*zeta3
    x4 = 4*zeta4
    x5 = x2 - 1
    x6 = x3 - 1
    x7 = x4 - 1
    return numpy.array([[x1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, x2, 0, 0, 0, 0, 0, x3, 0, 0, x4, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, x5, 0, 0, 0, 0, 0, 0, 0, 0, x0, 0, 0, x3, 0, 0, 0, 0, 0, 0, 0, 0, x4, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, x6, 0, 0, 0, 0, 0, 0, 0, 0, x2, 0, 0, x0, 0, 0, 0, 0, 0, 0, 0, 0, x4, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, x7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, x0, 0, 0, x2, 0, 0, x3, 0, 0], [0, x1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, x2, 0, 0, 0, 0, 0, x3, 0, 0, x4, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, x5, 0, 0, 0, 0, 0, 0, 0, 0, x0, 0, 0, x3, 0, 0, 0, 0, 0, 0, 0, 0, x4, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, x6, 0, 0, 0, 0, 0, 0, 0, 0, x2, 0, 0, x0, 0, 0, 0, 0, 0, 0, 0, 0, x4, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, x7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, x0, 0, 0, x2, 0, 0, x3, 0], [0, 0, x1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, x2, 0, 0, 0, 0, 0, x3, 0, 0, x4, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, x5, 0, 0, 0, 0, 0, 0, 0, 0, x0, 0, 0, x3, 0, 0, 0, 0, 0, 0, 0, 0, x4, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, x6, 0, 0, 0, 0, 0, 0, 0, 0, x2, 0, 0, x0, 0, 0, 0, 0, 0, 0, 0, 0, x4], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, x7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, x0, 0, 0, x2, 0, 0, x3]])

def gp():
    x0 = numpy.sqrt(5)
    x1 = (3/20)*x0 + 1/4
    x2 = 1/4 - 1/20*x0
    return numpy.array([[x1, x2, x2, x2], [x2, x1, x2, x2], [x2, x2, x1, x2], [x2, x2, x2, x1]])

def gw():
    return numpy.array([[0.25], [0.25], [0.25], [0.25]])

def V(x1, y1, z1, x2, y2, z2, x3, y3, z3, x4, y4, z4, x5, y5, z5, x6, y6, z6, x7, y7, z7, x8, y8, z8, x9, y9, z9, x10, y10, z10):
    x0 = (1/6)*x1
    x5 = (1/6)*x2
    x6 = (1/6)*x3
    x7 = (1/6)*x4
    return -x0*y2*z3 - x0*y3*z4 - x0*y4*z2 + (1/6)*x1*y2*z4 + (1/6)*x1*y3*z2 + (1/6)*x1*y4*z3 + (1/6)*x2*y1*z3 + (1/6)*x2*y3*z4 + (1/6)*x2*y4*z1 + (1/6)*x3*y1*z4 + (1/6)*x3*y2*z1 + (1/6)*x3*y4*z2 + (1/6)*x4*y1*z2 + (1/6)*x4*y2*z3 + (1/6)*x4*y3*z1 - x5*y1*z4 - x5*y3*z1 - x5*y4*z3 - x6*y1*z2 - x6*y2*z4 - x6*y4*z1 - x7*y1*z3 - x7*y2*z1 - x7*y3*z2


import numpy

def beam3d_circ_Kl(D1, D2, E, G, H, L, alpha, fa, fby, fbz, k0a, k0b, rho, theta):
    x0 = L**(-1.0)
    x1 = L**2
    x2 = numpy.pi*E
    x3 = H*x2
    x4 = x3*(D1 + D2 - 2*H)
    x5 = x0*((1/3)*k0a*x1 + (1/2)*x4)
    x6 = (1/6)*x0*(k0a*x1 - 3*x4)
    x7 = L**(-3.0)
    x8 = L**4
    x9 = k0b*x8
    x10 = H**3
    x11 = -40*x10
    x12 = D1**3
    x13 = D2**3
    x14 = D1**2
    x15 = 24*H
    x16 = D2**2
    x17 = D1*D2
    x18 = H*x17
    x19 = D1*x16
    x20 = H**2
    x21 = 40*x20
    x22 = D2*x21 + 3*x19
    x23 = D2*x14
    x24 = D1*x21 + 3*x23
    x25 = x11 + 7*x12 + 7*x13 - x14*x15 - x15*x16 - 12*x18 + x22 + x24
    x26 = 21*H
    x27 = x2*x26
    x28 = (1/280)*x7*(x25*x27 + 104*x9)
    x29 = 44*x9
    x30 = 51*H
    x31 = 80*x20
    x32 = -60*x10 - 18*x18
    x33 = x27*(D1*x31 + 15*x12 + 6*x13 - x14*x30 - x16*x26 + x22 + 6*x23 + x32)
    x34 = x29 + x33
    x35 = (1/840)/x1
    x36 = x34*x35
    x37 = (3/280)*x7*(12*k0b*x8 - 7*x25*x3)
    x38 = -26*x9
    x39 = x27*(D2*x31 + 6*x12 + 15*x13 - x14*x26 - x16*x30 + 6*x19 + x24 + x32)
    x40 = x38 + x39
    x41 = x35*x40
    x42 = -x34*x35
    x43 = -x35*x40
    x44 = 4*H
    x45 = 8*x20
    x46 = -x17*x44 + x19 + x23
    x47 = D1*x45 + D2*x45 - 8*x10 + x12 + x13 - x14*x44 - x16*x44 + x46
    x48 = (1/16)*numpy.pi*G*H*x0
    x49 = x47*x48
    x50 = -x47*x48
    x51 = (1/105)*x9
    x52 = H*x14
    x53 = H*x16
    x54 = 20*x20
    x55 = D2*x54
    x56 = 60*x20
    x57 = x11 - 14*x18
    x58 = (1/40)*x3
    x59 = x0*(x51 + x58*(D1*x56 + 11*x12 + 2*x13 + 2*x19 + 5*x23 - 38*x52 - 8*x53 + x55 + x57))
    x60 = x33 + x38
    x61 = x35*x60
    x62 = D1*x54
    x63 = x0*(x58*(-20*x10 + 4*x12 + 4*x13 + x46 - 13*x52 - 13*x53 + x55 + x62) - 1/140*x9)
    x64 = -x35*x60
    x65 = x29 + x39
    x66 = -x35*x65
    x67 = x35*x65
    x68 = x0*(x51 + x58*(D2*x56 + 2*x12 + 11*x13 + 5*x19 + 2*x23 - 8*x52 - 38*x53 + x57 + x62))
    return numpy.array([[x5, 0, 0, 0, 0, 0, x6, 0, 0, 0, 0, 0], [0, x28, 0, 0, 0, x36, 0, x37, 0, 0, 0, x41], [0, 0, x28, 0, x42, 0, 0, 0, x37, 0, x43, 0], [0, 0, 0, x49, 0, 0, 0, 0, 0, x50, 0, 0], [0, 0, x42, 0, x59, 0, 0, 0, x61, 0, x63, 0], [0, x36, 0, 0, 0, x59, 0, x64, 0, 0, 0, x63], [x6, 0, 0, 0, 0, 0, x5, 0, 0, 0, 0, 0], [0, x37, 0, 0, 0, x64, 0, x28, 0, 0, 0, x66], [0, 0, x37, 0, x61, 0, 0, 0, x28, 0, x67, 0], [0, 0, 0, x50, 0, 0, 0, 0, 0, x49, 0, 0], [0, 0, x43, 0, x63, 0, 0, 0, x67, 0, x68, 0], [0, x41, 0, 0, 0, x63, 0, x66, 0, 0, 0, x68]])

def beam3d_circ_Ml(D1, D2, E, G, H, L, alpha, fa, fby, fbz, k0a, k0b, rho, theta):
    x0 = 3*D1
    x1 = -4*H
    x2 = numpy.pi*H*rho
    x3 = L*x2
    x4 = (1/12)*x3
    x5 = D1 + D2 - 2*H
    x6 = x4*x5
    x7 = L**2
    x8 = 48*D2
    x9 = -208*H
    x10 = H**3
    x11 = D1**3
    x12 = 15*x11
    x13 = D2**3
    x14 = 15*x13
    x15 = D1**2
    x16 = 72*H
    x17 = D2**2
    x18 = D1*D2
    x19 = H*x18
    x20 = D1*x17
    x21 = 27*x20
    x22 = H**2
    x23 = 168*x22
    x24 = D2*x23
    x25 = x21 + x24
    x26 = D2*x15
    x27 = D1*x23 + 27*x26
    x28 = -168*x10 + x12 + x14 - x15*x16 - x16*x17 - 108*x19 + x25 + x27
    x29 = x2/L
    x30 = (1/560)*x29
    x31 = x30*(x28 + x7*(160*D1 + x8 + x9))
    x32 = 9*x26
    x33 = 21*x13
    x34 = H*x17
    x35 = 90*x34
    x36 = H*x15
    x37 = 36*x36
    x38 = 56*D2
    x39 = x38*x7
    x40 = D1*x7
    x41 = H*x7
    x42 = 84*x10
    x43 = x16*x18
    x44 = -x43
    x45 = -x42 + x44
    x46 = -176*x41 + x45
    x47 = -x12 + x25 + x32 + x33 - x35 + x37 + x39 + 120*x40 + x46
    x48 = (1/3360)*x2
    x49 = x47*x48
    x50 = 9*x20
    x51 = D1*x22
    x52 = -56*x10 + x22*x38 + 56*x51
    x53 = -3/560*x29*(5*x11 + 5*x13 - 36*x19 + x32 - 24*x34 - 24*x36 - 12*x5*x7 + x50 + x52)
    x54 = 56*x40
    x55 = 104*x41
    x56 = 36*x34
    x57 = 21*x11 - x14 + x27 - 90*x36 + x50 + x56
    x58 = x45 - x54 + x55 + x57 - x7*x8
    x59 = x48*x58
    x60 = -x47*x48
    x61 = -x48*x58
    x62 = -x37
    x63 = x0*x17
    x64 = D2*x22
    x65 = x63 + 20*x64
    x66 = -40*x10 - 18*x19
    x67 = (1/240)*x3
    x68 = -12*x19
    x69 = 3*D2
    x70 = x15*x69
    x71 = 20*x51 + x70
    x72 = x67*(-20*x10 + 2*x11 + 2*x13 - 9*x34 - 9*x36 + x65 + x68 + x71)
    x73 = D2*x7
    x74 = 11*x13 + 24*x73
    x75 = -224*x10 - 64*x41 + x44
    x76 = (1/6720)*x3
    x77 = x76*(65*x11 + 15*x20 + 21*x26 - 48*x34 - 216*x36 + 40*x40 + 336*x51 + 112*x64 + x74 + x75)
    x78 = 48*D1
    x79 = x12 - x21 - x24 - x32 - x33 + x35 + x39 + x42 + x43 - x55 + x62 + x7*x78
    x80 = -x48*x79
    x81 = -x56
    x82 = 11*x11 + 24*x40
    x83 = x76*(48*H*x7 - x52 - x62 - x63 - x68 - x70 - x74 - x81 - x82)
    x84 = x48*x79
    x85 = x30*(x28 + x7*(160*D2 + x78 + x9))
    x86 = x46 + x54 + x57 + 120*x73
    x87 = -x48*x86
    x88 = x48*x86
    x89 = x76*(65*x13 + 21*x20 + 15*x26 - 216*x34 - 48*x36 + 112*x51 + 336*x64 + 40*x73 + x75 + x82)
    return numpy.array([[x4*(D2 + x0 + x1), 0, 0, 0, 0, 0, x6, 0, 0, 0, 0, 0], [0, x31, 0, 0, 0, x49, 0, x53, 0, 0, 0, x59], [0, 0, x31, 0, x60, 0, 0, 0, x53, 0, x61, 0], [0, 0, 0, x67*(10*x11 + x13 + 6*x26 - 6*x34 + 60*x51 + x62 + x65 + x66), 0, 0, 0, 0, 0, x72, 0, 0], [0, 0, x60, 0, x77, 0, 0, 0, x80, 0, x83, 0], [0, x49, 0, 0, 0, x77, 0, x84, 0, 0, 0, x83], [x6, 0, 0, 0, 0, 0, x4*(D1 + x1 + x69), 0, 0, 0, 0, 0], [0, x53, 0, 0, 0, x84, 0, x85, 0, 0, 0, x87], [0, 0, x53, 0, x80, 0, 0, 0, x85, 0, x88, 0], [0, 0, 0, x72, 0, 0, 0, 0, 0, x67*(x11 + 10*x13 + 6*x20 - 6*x36 + 60*x64 + x66 + x71 + x81), 0, 0], [0, 0, x61, 0, x83, 0, 0, 0, x88, 0, x89, 0], [0, x59, 0, 0, 0, x83, 0, x87, 0, 0, 0, x89]])

def beam3d_circ_rl(D1, D2, E, G, H, L, alpha, fa, fby, fbz, k0a, k0b, rho, theta):
    x0 = (1/2)*numpy.pi*E*H*alpha*theta*(D1 + D2 - 2*H)
    x1 = (1/2)*L
    x2 = fby*x1
    x3 = fbz*x1
    x4 = (1/12)*L**2
    x5 = fbz*x4
    x6 = fby*x4
    return numpy.array([[(1/2)*L*fa - x0], [x2], [x3], [0], [-x5], [x6], [fa*x1 + x0], [x2], [x3], [0], [x5], [-x6]])

def beam3d_circ_Nl(D1, D2, E, G, H, L, alpha, fa, fby, fbz, k0a, k0b, rho, theta):
    x0 = (1/8)*L
    x1 = -x0
    return numpy.array([[1/2, 0, 0, 0, 0, 0, 1/2, 0, 0, 0, 0, 0], [0, 1/2, 0, 0, 0, x0, 0, 1/2, 0, 0, 0, x1], [0, 0, 1/2, 0, x1, 0, 0, 0, 1/2, 0, x0, 0]])

def beam3d_circ_Bl(D1, D2, E, G, H, L, alpha, fa, fby, fbz, k0a, k0b, rho, theta):
    x0 = L**(-1.0)
    x1 = -x0
    return numpy.array([[x1, 0, 0, 0, 0, 0, x0, 0, 0, 0, 0, 0], [0, 0, 0, 0, x0, x1, 0, 0, 0, 0, x1, x0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]])

def beam3d_circ_Dcs_mid(D1, D2, E, G, H, L, alpha, fa, fby, fbz, k0a, k0b, rho, theta):
    x0 = (1/4)*D1 + (1/4)*D2
    x1 = -H + x0
    x2 = (1/4)*numpy.pi
    x3 = E*(x0**4*x2 - x1**4*x2)
    return numpy.array([[E*(numpy.pi*x0**2 - numpy.pi*x1**2), 0, 0], [0, x3, 0], [0, 0, x3]])


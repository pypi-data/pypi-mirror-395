# Wyoming MLX Whisper

[Wyoming protocol](https://github.com/rhasspy/wyoming) server for [mlx-whisper](https://pypi.org/project/mlx-whisper) speech-to-text on Apple Silicon.

Uses [`mlx-community/whisper-large-v3-turbo`](https://huggingface.co/mlx-community/whisper-large-v3-turbo) by default (~1.6GB download, ~1.7GB memory), which runs near real-time on M1 Pro and newer. For lower memory usage, try the [quantized version](https://huggingface.co/mlx-community/whisper-large-v3-turbo-q4) with `--model mlx-community/whisper-large-v3-turbo-q4`.

<details><summary><b><u>[ToC]</u></b> ðŸ“š</summary>

<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

- [Requirements](#requirements)
- [Installation](#installation)
  - [Using uvx (recommended, no install needed)](#using-uvx-recommended-no-install-needed)
  - [Using pip](#using-pip)
- [Usage](#usage)
  - [Run directly](#run-directly)
  - [Run as macOS service (launchd)](#run-as-macos-service-launchd)
- [Home Assistant Integration](#home-assistant-integration)
- [Options](#options)
- [Development](#development)
- [Acknowledgements](#acknowledgements)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

</details>

## Requirements

- macOS with Apple Silicon (M1/M2/M3/M4)
- Python 3.10-3.13 (3.14 not yet supported by numba)
- [uv](https://docs.astral.sh/uv/) (recommended) or pip

## Installation

### Using uvx (recommended, no install needed)

```sh
uvx --python 3.12 wyoming-mlx-whisper
```

### Using pip

```sh
pip install wyoming-mlx-whisper
wyoming-mlx-whisper
```

## Usage

### Run directly

```sh
# With uvx (no install needed)
uvx --python 3.12 wyoming-mlx-whisper

# Or if installed with pip
wyoming-mlx-whisper
```

### Run as macOS service (launchd)

Download and run the install script:

```sh
curl -fsSL https://raw.githubusercontent.com/basnijholt/wyoming-mlx-whisper/main/scripts/install_service.sh | bash
```

The server runs at `tcp://localhost:10300` by default.

Uninstall the service:

```sh
curl -fsSL https://raw.githubusercontent.com/basnijholt/wyoming-mlx-whisper/main/scripts/uninstall_service.sh | bash
```

View logs:

```sh
tail -f ~/Library/Logs/wyoming-mlx-whisper/*.out ~/Library/Logs/wyoming-mlx-whisper/*.err
```

## Home Assistant Integration

1. Start the server (using any method above)
2. In Home Assistant, go to **Settings â†’ Devices & Services â†’ Add Integration**
3. Search for "Wyoming Protocol"
4. Enter `localhost` (or your Mac's IP) and port `10300`

The Whisper STT service will now be available for voice assistants.

## Options

<details>
<summary>See the output of <code>wyoming-mlx-whisper --help</code></summary>

<!-- CODE:BASH:START -->
<!-- echo '```' -->
<!-- uv run wyoming-mlx-whisper --help -->
<!-- echo '```' -->
<!-- CODE:END -->
<!-- OUTPUT:START -->
<!-- âš ï¸ This content is auto-generated by `markdown-code-runner`. -->
```

 Usage: wyoming-mlx-whisper [OPTIONS]

 Run the Wyoming MLX Whisper server.

â•­â”€ Options â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ --uri                           TEXT  unix:// or tcp://                      â”‚
â”‚                                       [env var: WHISPER_URI]                 â”‚
â”‚                                       [default: tcp://0.0.0.0:10300]         â”‚
â”‚ --model                         TEXT  Name of MLX Whisper model to use       â”‚
â”‚                                       [env var: WHISPER_MODEL]               â”‚
â”‚                                       [default:                              â”‚
â”‚                                       mlx-community/whisper-large-v3-turbo]  â”‚
â”‚ --language                      TEXT  Language code (e.g., 'en')             â”‚
â”‚                                       [env var: WHISPER_LANGUAGE]            â”‚
â”‚ --debug           --no-debug          Log DEBUG messages                     â”‚
â”‚                                       [env var: WHISPER_DEBUG]               â”‚
â”‚                                       [default: no-debug]                    â”‚
â”‚ --log-format                    TEXT  Format for log messages                â”‚
â”‚                                       [default:                              â”‚
â”‚                                       %(levelname)s:%(name)s:%(message)s]    â”‚
â”‚ --version                             Print version and exit                 â”‚
â”‚ --help        -h                      Show this message and exit.            â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

```

<!-- OUTPUT:END -->

</details>

## Development

```sh
uv sync
uv run pre-commit install
```

## Acknowledgements

- Forked from [vincent861223/wyoming-mlx-whisper](https://github.com/vincent861223/wyoming-mlx-whisper) by Vincent Lin
- Based on [wyoming-whisper-api-client](https://github.com/ser/wyoming-whisper-api-client) by Dr. Serge Victor

import{Q as k,s as V}from"./notify-rAieXmVG.js";import{c as m}from"./QSelect-DUSV0nyL.js";import{_ as D,j as r}from"./_plugin-vue_export-helper-y0AOwF65.js";import{O as p,Q as u,R as l,_ as o,T as t,W as d,U as v,B as w,Z as f,V as i,ab as b,S}from"./index-C4oMVQx5.js";import{c as g}from"./use-checkbox-CAOkKLX8.js";import{Q as y,a as N,b as h}from"./QTable-YZmoYszf.js";import{Q}from"./QPopupEdit-DW4FxPhy.js";import{Q as q}from"./QPage-QJDy7YTC.js";const U={name:"XlsxPage",components:{},setup(){return{notify:V()}},data:()=>({sheet:"",sheets:[],packages:[],modified:"",packageSelected:"",mode:"PRODUCT",jsonName:"",search:"",loading:!1,dialog:!1,dialogDelete:!1,rows:[],jsonData:{},columns:[{label:"NAME",sortable:!1,name:"name",field:"name",align:"left",headerStyle:"width: 250px"},{label:"VALUE(Click to Edit)",name:"value",field:"value",sortable:!1,align:"left",headerStyle:"width: 350px"},{label:"DESCRIPTION",name:"description",field:"description",sortable:!1,align:"left"}]}),mounted(){this.jsonName="params.json",this.getPackages()},unmounted(){},computed:{},watch:{mode(){this.getPackages()},jsonName(){this.getPackages()},packageSelected(){this.getJsonData()},sheet(){this.rows=this.jsonData[this.sheet]}},methods:{addRow(){let e=[{desc:"new-description",name:"new-name",value:"new-value"}];for(let s in this.jsonData[this.sheet])e.push(this.jsonData[this.sheet][s]);this.jsonData[this.sheet]=e},getJsonData(){this.sheet="",this.jsonData={},this.packageSelected&&(this.loading=!0,this.$api.post("get-json-data",{package:this.packageSelected,mode:this.mode,json_name:this.jsonName}).then(e=>{this.jsonData=e.data.data.json_data,this.sheets=e.data.data.sheets,this.modified=e.data.data.modified,this.sheet=this.sheets[0],this.loading=!1}).catch(e=>{console.log(e),this.notify("Get json meets Error")}))},setJsonData(){this.packageSelected&&this.$api.post("set-json-data",{package:this.packageSelected,mode:this.mode,json_data:this.jsonData,modified:this.modified,json_name:this.jsonName}).then(e=>{if(e.data.status===!1)return this.notify(e.data.message),!1;this.modified=e.data.data.modified,this.notify(e.data.message)}).catch(e=>{console.log(e),this.notify("Save json meets Error")})},getPackages(){this.packageSelected="",this.$api.post("get-packages",{mode:this.mode,file_name:this.jsonName}).then(e=>{this.packages=e.data.data,this.packages.length>0&&(this.packageSelected=this.packages[0])}).catch(e=>{console.log(e)})}}},$={class:"row q-mt-md"},C={class:"col-5"},P={class:"text-h3 text-weight-light"},_={class:"col-2 q-mr-md"},T={class:"col-3 q-ml-md q-mr-md"},E={class:"row q-mt-md"},J={class:"col-3 q-ml-md q-mr-md"},R={class:"col-3 q-ml-md q-mr-md"},B={class:"col-2 q-ml-md q-mr-md"},I={class:"col-3 text-center q-mt-md"},O={class:"col-12 q-mt-md"};function A(e,s,M,G,L,c){return u(),p(q,null,{default:l(()=>[o("div",$,[o("div",C,[o("span",P,d(e.$t("jsonData.title")),1)]),t(k),o("div",_,[t(m,{modelValue:e.mode,"onUpdate:modelValue":s[0]||(s[0]=a=>e.mode=a),options:["PRODUCT"],label:e.$t("jsonData.chooseMode")},null,8,["modelValue","label"])]),t(r,{vertical:"",inset:""}),o("div",T,[t(m,{modelValue:e.jsonName,"onUpdate:modelValue":s[1]||(s[1]=a=>e.jsonName=a),options:["params.json"],label:e.$t("jsonData.chooseJson")},null,8,["modelValue","label"])])]),o("div",E,[o("div",J,[t(m,{modelValue:e.packageSelected,"onUpdate:modelValue":s[2]||(s[2]=a=>e.packageSelected=a),options:e.packages,label:e.$t("jsonData.chooseProject")},null,8,["modelValue","options","label"])]),t(r,{vertical:"",inset:""}),o("div",R,[t(m,{modelValue:e.sheet,"onUpdate:modelValue":s[3]||(s[3]=a=>e.sheet=a),options:e.sheets,label:e.$t("jsonData.chooseSheet")},null,8,["modelValue","options","label"])]),t(r,{vertical:"",inset:""}),o("div",B,[t(g,{color:"primary",modelValue:e.search,"onUpdate:modelValue":s[4]||(s[4]=a=>e.search=a),placeholder:e.$t("jsonData.filter")},{append:l(()=>[t(v,{name:"search"})]),_:1},8,["modelValue","placeholder"])]),o("div",I,[w(t(f,{color:"primary",disable:!this.sheet,onClick:c.addRow},{default:l(()=>s[5]||(s[5]=[i("ADD")])),_:1},8,["disable","onClick"]),[[b,!1]]),t(f,{class:"q-ml-md",color:"primary",onClick:c.setJsonData,disabled:e.sheet===""},{default:l(()=>[i(d(e.$t("jsonData.save")),1)]),_:1},8,["onClick","disabled"])]),o("div",O,[e.jsonName==="params.json"?(u(),p(y,{key:0,columns:e.columns,rows:e.rows,"fixed-header":!0,filter:e.search,loading:e.loading,"row-key":"name"},{body:l(a=>[t(N,{props:a},{default:l(()=>[t(h,{key:"name",props:a},{default:l(()=>[i(d(a.row.name),1)]),_:2},1032,["props"]),t(h,{key:"value",props:a},{default:l(()=>[i(d(a.row.value)+" ",1),t(Q,{modelValue:a.row.value,"onUpdate:modelValue":n=>a.row.value=n,title:"Update Value",buttons:"",persistent:""},{default:l(n=>[t(g,{modelValue:n.value,"onUpdate:modelValue":j=>n.value=j,dense:"",autofocus:"",hint:"Set or Cancel"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"]),t(h,{key:"description",props:a},{default:l(()=>[i(d(a.row.description),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","filter","loading"])):S("",!0)])])]),_:1})}const x=D(U,[["render",A]]);export{x as default};

import{Q as x,s as w}from"./notify-rAieXmVG.js";import{c as n}from"./QSelect-DUSV0nyL.js";import{_ as k,j as c}from"./_plugin-vue_export-helper-y0AOwF65.js";import{O as V,Q as D,R as s,_ as o,T as t,W as i,U as b,B as S,Z as f,V as m,ab as v}from"./index-C4oMVQx5.js";import{c as u}from"./use-checkbox-CAOkKLX8.js";import{Q as y,a as U,b as h}from"./QTable-YZmoYszf.js";import{Q as g}from"./QPopupEdit-DW4FxPhy.js";import{Q}from"./QPage-QJDy7YTC.js";const N={name:"XlsxPage",components:{},setup(){return{notify:w()}},data:()=>({sheet:"",sheets:[],packages:[],modified:"",packageSelected:"",mode:"PRODUCT",xlsxName:"",search:"",loading:!1,dialog:!1,dialogDelete:!1,rows:[],xlsxData:{},columns:[{label:"NAME",sortable:!1,name:"name",field:"name",align:"left",headerStyle:"width: 250px"},{label:"LOW LIMIT(Click to Edit)",name:"low",field:"low",sortable:!1,align:"left",headerStyle:"width: 250px"},{label:"HIGH LIMIT(Click to Edit)",name:"high",field:"high",sortable:!1,align:"left",headerStyle:"width: 250px"},{label:"DESCRIPTION",name:"description",field:"description",sortable:!1,align:"left"}]}),mounted(){this.xlsxName="measure.xlsx",this.getPackages()},unmounted(){},computed:{},watch:{mode(){this.getPackages()},xlsxName(){this.getPackages()},packageSelected(){this.getXlsxData()},sheet(){this.rows=this.xlsxData[this.sheet]}},methods:{addRow(){let e=[{desc:"new-description",name:"new-name",value:"new-value"}];for(let l in this.xlsxData[this.sheet])e.push(this.xlsxData[this.sheet][l]);this.xlsxData[this.sheet]=e},getXlsxData(){this.sheet="",this.xlsxData={},this.packageSelected&&(this.loading=!0,this.$api.post("get-xlsx-data",{package:this.packageSelected,mode:this.mode,xlsx_name:this.xlsxName}).then(e=>{this.xlsxData=e.data.data.xlsx_data,this.sheets=e.data.data.sheets,this.modified=e.data.data.modified,this.sheet=this.sheets[0],this.loading=!1}).catch(e=>{console.log(e),this.notify("Get xlsx meets Error")}))},setXlsxData(){this.packageSelected&&this.$api.post("set-xlsx-data",{package:this.packageSelected,mode:this.mode,xlsx_data:this.xlsxData,modified:this.modified,xlsx_name:this.xlsxName}).then(e=>{if(e.data.status===!1)return this.notify(e.data.message),!1;this.modified=e.data.data.modified,this.notify(e.data.message)}).catch(e=>{console.log(e),this.notify("Save JSON meets Error")})},getPackages(){this.packageSelected="",this.$api.post("get-packages",{mode:this.mode,file_name:this.xlsxName}).then(e=>{this.packages=e.data.data,this.packages.length>0&&(this.packageSelected=this.packages[0])}).catch(e=>{console.log(e)})}}},q={class:"row q-mt-md"},_={class:"col-5"},C={class:"text-h3 text-weight-light"},$={class:"col-2 q-mr-md"},P={class:"col-3 q-ml-md q-mr-md"},T={class:"row q-mt-md"},I={class:"col-3 q-ml-md q-mr-md"},E={class:"col-3 q-ml-md q-mr-md"},X={class:"col-2 q-ml-md q-mr-md"},L={class:"col-3 text-center q-mt-md"},O={class:"col-12 q-mt-md"};function R(e,l,B,M,H,p){return D(),V(Q,null,{default:s(()=>[o("div",q,[o("div",_,[o("span",C,i(e.$t("xlsxData.title")),1)]),t(x),o("div",$,[t(n,{modelValue:e.mode,"onUpdate:modelValue":l[0]||(l[0]=a=>e.mode=a),options:["PRODUCT"],label:e.$t("xlsxData.chooseMode")},null,8,["modelValue","label"])]),t(c,{vertical:"",inset:""}),o("div",P,[t(n,{modelValue:e.xlsxName,"onUpdate:modelValue":l[1]||(l[1]=a=>e.xlsxName=a),options:["measure.xlsx"],label:e.$t("xlsxData.chooseXlsx")},null,8,["modelValue","label"])])]),o("div",T,[o("div",I,[t(n,{modelValue:e.packageSelected,"onUpdate:modelValue":l[2]||(l[2]=a=>e.packageSelected=a),options:e.packages,label:e.$t("xlsxData.chooseProject")},null,8,["modelValue","options","label"])]),t(c,{vertical:"",inset:""}),o("div",E,[t(n,{modelValue:e.sheet,"onUpdate:modelValue":l[3]||(l[3]=a=>e.sheet=a),options:e.sheets,label:e.$t("xlsxData.chooseSheet")},null,8,["modelValue","options","label"])]),t(c,{vertical:"",inset:""}),o("div",X,[t(u,{color:"primary",modelValue:e.search,"onUpdate:modelValue":l[4]||(l[4]=a=>e.search=a),placeholder:e.$t("xlsxData.filter")},{append:s(()=>[t(b,{name:"search"})]),_:1},8,["modelValue","placeholder"])]),o("div",L,[S(t(f,{color:"primary",disable:!this.sheet,onClick:p.addRow},{default:s(()=>l[5]||(l[5]=[m("ADD")])),_:1},8,["disable","onClick"]),[[v,!1]]),t(f,{class:"q-ml-md",color:"primary",onClick:p.setXlsxData,disabled:e.sheet===""},{default:s(()=>[m(i(e.$t("xlsxData.save")),1)]),_:1},8,["onClick","disabled"])]),o("div",O,[t(y,{columns:e.columns,rows:e.rows,"fixed-header":!0,filter:e.search,loading:e.loading,"row-key":"name"},{body:s(a=>[t(U,{props:a},{default:s(()=>[t(h,{key:"name",props:a},{default:s(()=>[m(i(a.row.name),1)]),_:2},1032,["props"]),t(h,{key:"low",props:a},{default:s(()=>[m(i(a.row.low)+" ",1),t(g,{modelValue:a.row.low,"onUpdate:modelValue":d=>a.row.low=d,title:"Update Low Limit",buttons:"",persistent:""},{default:s(d=>[t(u,{modelValue:d.value,"onUpdate:modelValue":r=>d.value=r,dense:"",autofocus:"",hint:"Set or Cancel"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"]),t(h,{key:"high",props:a},{default:s(()=>[m(i(a.row.high)+" ",1),t(g,{modelValue:a.row.high,"onUpdate:modelValue":d=>a.row.high=d,title:"Update High Limit",buttons:"",persistent:""},{default:s(d=>[t(u,{modelValue:d.value,"onUpdate:modelValue":r=>d.value=r,dense:"",autofocus:"",hint:"Set or Cancel"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"]),t(h,{key:"description",props:a},{default:s(()=>[m(i(a.row.description),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["columns","rows","filter","loading"])])])]),_:1})}const K=k(N,[["render",R]]);export{K as default};

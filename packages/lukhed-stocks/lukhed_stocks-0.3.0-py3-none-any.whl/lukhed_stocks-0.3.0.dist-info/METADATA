Metadata-Version: 2.1
Name: lukhed-stocks
Version: 0.3.0
Summary: A collection of stock analysis functions and api wrappers
Home-page: https://github.com/lukhed/lukhed_stocks
Author: lukhed
Author-email: lukhed.mail@gmail.com
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.10
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: lukhed-basic-utils>=1.6.6
Requires-Dist: schwab-py>=1.4.0

# lukhed_stocks
A collection of stocks analysis utility functions and API wrappers. Repo is in development. Please note that 
you are responsible for how you access and use the data. 
See the [responsible data usage section](#responsible-data-usage) for more info.


## Installation
```bash
pip install lukhed-stocks
```


## TOC
<!-- no toc -->
[No API Key Market Data](#no-api-key-market-data)<br>
[Available Wrappers](#available-wrappers)<br>
[Responsible Data Usage](#responsible-data-usage)

## No API Key Market Data
Access market data without requiring API keys or authentication. This section includes utility functions for 
obtaining ticker lists and a unified interface for real-time quotes, price history, and fundamental data.

- [Ticker Data Functions](#ticker-functions) - Get lists of stock tickers by exchange or index, plus company logos. 
  Utilizes various public sources that don't require API keys.
  - [Get Tickers By Exchange](#get-tickers-by-exchange)
  - [Get Tickers By Index](#get-tickers-by-index)
  - [Get Company Logo by Ticker](#get-company-logo-by-ticker)

- [Market Data](#marketdata) - Unified interface for accessing real-time quotes, price history, index data, and 
  fundamentals from multiple sources (Webull, Robinhood) without managing individual wrapper instances or API keys.
  
## Available Wrappers
- [CAT Wrapper](#cat-wrapper) - Conolidated Audit Trail (CAT) for exchange data provided by [CAT Webpage](https://catnmsplan.com/)
- [Wikipedia Stocks](#wikipedia-stocks) - For obtaining various stock data from Wikipedia (various pages)
- [Schwab Wrapper](#schwab-wrapper) - Wrapper for [schwab-py wrapper](https://pypi.org/project/schwab-py/). Adds key 
  management and convenience functions to the unopinionated wrapper which provides auth, quotes, history, options, account info and more.
- [Robinhood Wrapper](#robinhood-wrapper) - Wrapper for Robinhood's public API endpoints. Provides access to stock 
  data, fundamentals, charts, and popular stock lists without requiring authentication. Auth methods coming later.
- [Webull Wrapper](#webull-wrapper) - Wrapper for Webull's public API endpoints. Provides access to real-time quotes, 
  price history, and index data without requiring authentication.
- [Polygon.io Wrapper](#polygonio-wrapper) - Wrapper for Polygon.io's API. Provides free access to market status and holiday information with up to 5 API requests per minute and 500 requests per day.
- [TradingView Wrapper](#tradingview-wrapper) - Wrapper for TradingView's stock screener. Provides access to 
  stock lists, filters by sector/industry, and customizable screening criteria.


## Ticker Functions

### Tickers Import
```python
from lukhed_stocks import tickers
```

### Get Tickers By Exchange
Provides a list of stock data for the given exchange. Each function can optionally be called with 'tickers_only' parameter to return a list of strings only. These functions utilize [CAT data](https://catnmsplan.com/) by default  and do not require an API key.

```python
nasdaq = tickers.get_nasdaq_stocks()
nyse = tickers.get_nyse_stocks(tickers_only=True)
otc = tickers.get_otc_stocks()
iex = tickers.get_iex_stocks(tickers_only=True)
```

| Function | Default Source|
|------------------------------|--------------|
| tickers.get_nasdaq_stocks    | [CAT](#cat-data-usage)|
| tickers.get_nyse_stocks      | [CAT](#cat-data-usage)|
| tickers.get_otc_stocks       | [CAT](#cat-data-usage)|
| tickers.get_iex_stocks       | [CAT](#cat-data-usage)|

### Get Tickers By Index
Provides a list of stock data for the given index. Each function can optionally be called with 'tickers_only' parameter to return a list of strings only. The default source for each function does 
not require an API key.

```python
sp500 = tickers.get_sp500_stocks()
djia = tickers.get_dow_stocks(tickers_only=True)
otc = tickers.get_russell2000_stocks()
```

| Function | Default Source|
|---------------------------------|--------------|
| tickers.get_sp500_stocks        | [Wikipedia](#cat-data-usage)|
| tickers.get_dow_stocks          | [Wikipedia](#wikipedia-data-usage)|
| tickers.get_russell2000_stocks  | [TradingView](#tradingview-data-usage)|


### Get Company Logo by Ticker
```python
logo_url = tickers.get_company_logo('ALLT')
logo_url_with_download = tickers.get_company_logo('WAY', output_file='way.png')
```

| Function | Default Source|
|------------------------------|--------------|
| tickers.get_company_log      | [Synth](#synth)|



## CAT Wrapper
Documentation coming soon.

## Wikipedia Stocks
Documentation coming soon.

## Schwab Wrapper

### Setup
Setup the API auth once and use it across hardware. To setup, instantiate with schwab_api_setup=True. By default, your private github repo is used for key mangement (you will need a github account and token). Setup will ask for your [Schwab developer](https://developer.schwab.com/) app key, secret, and callback url, then take you through authenticating with Schwab.<br><br>Note: this wrapper uses [schwab-py](https://pypi.org/project/schwab-py/) for actual Schwab auth. See the documentation there for any issues or questions in setting up your schwab account.

```python
#Github setup
schwab = SchwabPy(schwab_api_setup=True)
```

```python
#Local setup (won't work across hardware)
schwab = SchwabPy(schwab_api_setup=True, key_management='local')
```

### Usage Examples After Setup
```python
schwab = SchwabPy()
quotes = schwab.get_stock_quote(['allt', 'way', 'pplt', 'impuy'])
price = schwab.get_stock_price('allt')
low = schwab.get_stock_52w_low('gld')
percent_below_high = schwab.get_percent_below_52w_high('aapl')
```

### Cache Option
If prices are stale when using this wrapper (e.g., after market) or realtime price is not needed for your analysis, you can use cache to speed up calls.

```python
schwab = SchwabPy(use_ticker_cache=True)
quotes = schwab.get_stock_quote(['allt', 'way', 'pplt', 'impuy'])   # 'allt' in cache
price = schwab.get_stock_price('allt')  # retrieve price from cache
```

### Utilizing schwab-py
My wrapper is built for key management, advanced analysis, and ease of use. The exposed methods are recommended when using my wrapper, but you can access any of the endpoints available from [schwab-py](https://pypi.org/project/schwab-py/) like below.

```python
schwab.api.get_price_history_every_minute("ALLT")
```

## Robinhood Wrapper

### Setup
No authentication required. The wrapper provides access to Robinhood's public API endpoints.

```python
from lukhed_stocks.robinhood import Robinhood

rh = Robinhood()
```

### Basic Usage Examples
```python
# Get basic instrument data
basic_data = rh.get_basic_data('AAPL')
multiple_stocks = rh.get_basic_data(['AAPL', 'TSLA', 'MSFT'])

# Get fundamental data
fundamentals = rh.get_fundamentals('AAPL')

# Get chart data for different time spans
daily_chart = rh.get_basic_chart_data('AAPL', span='day')
yearly_chart = rh.get_basic_chart_data('AAPL', span='year', extended_hours=True)
```

### Popular Lists
```python
# Get most held stocks on Robinhood
top_50 = rh.get_most_held_instruments(top_x=50)
symbols_only = rh.get_most_held_instruments(return_symbols_only=True)

# Search for instruments
search_results = rh.search_instruments_by_symbol_keyword('TECH')
```

### API Rate Limiting
The wrapper includes built-in rate limiting to be respectful of Robinhood's servers.

```python
# Adjust delay between API calls (default is 0.5 seconds)
rh = Robinhood(api_delay=1.0)

# Disable user agent randomization if needed
rh = Robinhood(random_user_agent=False)
```


## Webull Wrapper

### Setup
No authentication required. The wrapper provides access to Webull's public API endpoints.

```python
from lukhed_stocks.webull import Webull

wb = Webull()
```

### Basic Usage Examples
```python
# Get real-time quote for a single stock
quote = wb.get_quote('AAPL')

# Get quotes for multiple stocks
quotes = wb.get_quote(['AAPL', 'TSLA', 'MSFT'], ids_provided=False)

# Get major indices data (DJI, NASDAQ, SPX, RUT)
indices = wb.get_indice_data()

# Get price history for a stock
history = wb.get_price_history('AAPL', interval='1d', points=800)

# Get price history for an index
index_history = wb.get_indice_price_history('spx', interval='1d', points=800)

# Get just the prices for major indices
index_prices = wb.get_indice_prices()
```

### Cache Options
Speed up repeated calls by using cache functionality.

```python
# Enable live cache for repeated symbol lookups
wb = Webull(keep_live_cache=True)

# Enable basics cache (saved to disk for cross-session use)
wb = Webull(use_basics_cache=True)

Note: Webull api calls require symbol id's, so the wrapper uses an API call to retrieve the proper id based on input. 
Using basics cache allows saving API calls by storing the symbol to id mapping.

# Refresh the basics cache
wb = Webull(use_basics_cache=True, refresh_basics_cache=True)
```

### API Rate Limiting
```python
# Adjust delay between API calls (default is 0.5 seconds)
wb = Webull(api_delay=1.0)
```


## MarketData

### Setup
The MarketData class provides a unified interface for accessing market data from multiple sources without 
managing individual wrapper instances. No authentication required for default sources.

```python
from lukhed_stocks.marketdata import MarketData

md = MarketData()
```

### Basic Usage Examples
```python
# Get major indices prices (default: Webull)
indices = md.get_indice_prices()

# Get real-time quote
quote = md.get_quote('AAPL')
multiple_quotes = md.get_quote(['AAPL', 'TSLA', 'MSFT'])

# Get price history
history = md.get_price_history('AAPL', interval='d1', points=800)

# Get index price history
index_history = md.get_indice_price_history('spx', interval='d1', points=800)

# Get fundamental data (default: Robinhood)
fundamentals = md.get_fundamentals('AAPL')

# Get basic stock information (default: Robinhood)
basic_info = md.get_basic_info('AAPL')
```

### Specifying Data Sources
```python
# Specify source explicitly
quote_webull = md.get_quote('AAPL', source='webull')
fundamentals_rh = md.get_fundamentals('AAPL', source='robinhood')
```

### Supported Sources
- `get_indice_prices()`: Webull
- `get_quote()`: Webull
- `get_price_history()`: Webull
- `get_indice_price_history()`: Webull
- `get_fundamentals()`: Robinhood
- `get_basic_info()`: Robinhood


## Polygon.io Wrapper

### Setup
Setup the API auth once and use it across hardware. To setup, instantiate the class and follow the prompts to enter 
your [Polygon.io API key](https://polygon.io/dashboard/keys). By default, your private github repo is used for key 
management (you will need a github account and token).

```python
# Github setup
from lukhed_stocks.polygon import PolygonIo

# Default instantiation uses github key_management
poly = PolygonIo()
```

```python
# If you want to use local hardware key storage only
poly = PolygonIo(key_management='local')
```

### Usage Examples After Setup
```python
poly = PolygonIo()

# Get current market status
market_status = poly.get_market_status_now()

# Get upcoming market holidays
holidays = poly.get_upcoming_market_holidays()

# Check if market is open today
is_open = poly.is_market_open_today()
```

### API Rate Limiting
The wrapper includes built-in rate limiting. The free tier allows 5 API requests per minute and 500 requests per day.

```python
# Adjust delay between API calls (default is 1 second)
poly = PolygonIo(api_delay=2.0)
```

### Skip Setup with Auth Dictionary
```python
# Provide auth data directly to skip setup prompts
auth_data = {"key": "your_api_key_here"}
poly = PolygonIo(auth_dict=auth_data)
```


## TradingView Wrapper

### Setup
No authentication required. The wrapper provides access to TradingView's stock screener endpoints.

```python
from lukhed_stocks.tradingview import TradingView

tv = TradingView()
```

### Basic Usage Examples
```python
# Get all stocks with default TradingView filters and columns
all_stocks = tv.screener_get_all_stocks()

# Get stocks by index
dow_stocks = tv.screener_get_stocks_by_index('dow')
sp500_stocks = tv.screener_get_stocks_by_index('s&p')
nasdaq_stocks = tv.screener_get_stocks_by_index('nasdaq')
russell_stocks = tv.screener_get_stocks_by_index('russel 2000')

# Get stocks at new highs or lows
new_52w_highs = tv.screener_new_highs_lows(new_high_or_low='high', month_time_frame=12)
new_3m_lows = tv.screener_new_highs_lows(new_high_or_low='low', month_time_frame=3)
all_time_highs = tv.screener_new_highs_lows(new_high_or_low='high', month_time_frame='all time')
```

### Filtering Stock Lists
```python
# Filter by sector or industry
tech_stocks = tv.filter_stock_list_by_sector('Technology', all_stocks['data'])
multiple_sectors = tv.filter_stock_list_by_sector(['Healthcare', 'Finance'], all_stocks['data'])
industry_filtered = tv.filter_stock_list_by_industry('Software', all_stocks['data'])

# Get sector/industry information
sectors = tv.get_all_sectors_in_list(all_stocks['data'])
industries = tv.get_all_industries_in_list(all_stocks['data'])
breakdown = tv.get_sector_industry_breakdown_of_list(all_stocks['data'])
tickers = tv.get_unique_stock_tickers_in_list(all_stocks['data'])
```

### Customizing Screener Columns
```python
# Use predefined column sets
tv.set_stock_screener_columns_overview()
tv.set_stock_screener_columns_performance()
tv.set_stock_screener_columns_valuation()
tv.set_stock_screener_columns_dividends()
tv.set_stock_screener_columns_technicals()
tv.set_stock_screener_columns_profitiability()
tv.set_stock_screener_columns_per_share()

# Add custom columns
tv.custom_define_columns(["name", "description", "Perf.W", "Perf.1M", "Perf.3M", "Perf.6M", "Perf.YTD", "exchange"])

# Add to existing columns instead of replacing
tv.set_stock_screener_columns_time_period_performance(add_to_current_columns=True)

# Reset to defaults
tv.reset_screener_columns()
```

### Custom Filters
```python
# Add custom filters
custom_filter = {
    "left": "market_cap_basic",
    "operation": "egreater",
    "right": 1000000000
}
tv.add_screener_filters(custom_filter)

# Reset filters to default
tv.reset_screener_filters()

# Clear all filters
tv.clear_screener_filters()

# Set completely custom filter
tv.set_custom_screener_filter(custom_filter)
```

### Supported Index Filters
The wrapper supports filtering by the following indices (check `tv.index_lookup` for full list):
- Dow Jones: `'dow'`
- S&P 500: `'s&p'`
- Nasdaq Composite: `'nasdaq'`
- Nasdaq 100: `'nasdaq 100'`
- Russell 2000: `'russel 2000'`
- And many more sector-specific indices


## Responsible Data Usage
- Each method or wrapper in the documentation lists the source that is utilized by default
- Below is information related to data retrieval and usage for each source

### CAT Data Usage
CAT Data is pulled from [this page](https://www.catnmsplan.com/reference-data). They provide 
a [legal notice here](https://www.catnmsplan.com/legal-notice).

### Wikipedia Data Usage
Wikipedia content is licensed under the Creative Commons Attribution-ShareAlike 3.0 Unported License. 
For more details on the terms of use, please refer to the 
[Wikimedia Foundation's Terms of Use](https://foundation.wikimedia.org/wiki/Policy:Terms_of_Use).

### Synth
Full Synth terms are found [here](https://synthfinance.com/terms). This library provides access to synth:
- Images, free to use if attribution is provided (please confirm with synthfinance.com or the terms above)

### Robinhood Data Usage
Data is accessed through Robinhood's public API endpoints without authentication. This wrapper is intended for 
educational and research purposes. Please respect Robinhood's terms of service and API usage guidelines. 
Users are responsible for ensuring their usage complies with Robinhood's policies.

### Polygon.io Data Usage
Data is accessed through Polygon.io's API. Free tier provides up to 5 API requests per minute and 500 requests per day. 
For higher volume usage, please visit [Polygon.io's pricing page](https://polygon.io/pricing). 
Users are responsible for ensuring their usage complies with Polygon.io's terms of service and API usage limits.

### Tradingview Data Usage
I am currently trying to remove trading view as a source, as their policy is restrictive and confusing. 
Please read [trading view policies here](https://www.tradingview.com/policies/)

### Webull Data Usage
Data is accessed through Webull's public API endpoints without authentication. This wrapper is intended for 
educational and research purposes. Please respect Webull's terms of service and API usage guidelines. 
Users are responsible for ensuring their usage complies with Webull's policies.

[build-system]
build-backend = "flit_core.buildapi"
requires = [ "flit-core>=3.2,<4" ]

[project]
name = "ansys-stk"
description = "The next generation Python API for STK."
readme = "README.rst"
license = "MIT"
license-files = [ "LICENSE" ]
maintainers = [
  { name = "ANSYS, Inc.", email = "pyansys.core@ansys.com" },
]

authors = [
  { name = "ANSYS, Inc.", email = "pyansys.core@ansys.com" },
]
requires-python = ">=3.10"
classifiers = [
  "Development Status :: 4 - Beta",
  "Intended Audience :: Developers",
  "Intended Audience :: Science/Research",
  "Operating System :: OS Independent",
  "Programming Language :: Python :: 3 :: Only",
  "Programming Language :: Python :: 3.10",
  "Programming Language :: Python :: 3.11",
  "Programming Language :: Python :: 3.12",
  "Programming Language :: Python :: 3.13",
  "Programming Language :: Python :: 3.14",
  "Topic :: Scientific/Engineering :: Information Analysis",
  "Topic :: Scientific/Engineering :: Physics",
  "Topic :: Software Development :: Libraries",
]
dynamic = [ "version" ]
dependencies = [
  # NOTE: no dependencies are installed by default ensuring a dependency-free installation by default
]

optional-dependencies.all = [
  # Target: grpc
  "grpcio>=1.73.1",
  # Target: jupyter
  "jupyter-rfb>=0.5.3",
  # Target: migration
  "libcst>=1.8.2",
  # Target: extensions
  "matplotlib>=3.10.3",
  "numpy>=2.2.6",
  "pandas>=2.3.1",
  "pillow>=11.3.0",
  "protobuf>=6.31.1",
  "sidecar>=0.7.0",
  "simplejpeg>=1.8.2",
]
optional-dependencies.core = [
  # NOTE: no dependencies are installed by default ensuring a dependency-free installation of ansys-stk[core]
]
optional-dependencies.extensions = [
  "matplotlib>=3.10.3",
  "pandas>=2.3.1",
]
optional-dependencies.grpc = [
  "grpcio>=1.73.1",
  "protobuf>=6.31.1",
]
optional-dependencies.jupyter = [
  "jupyter-rfb>=0.5.3",
  "numpy>=2.2.6",
  "pillow>=11.3.0",
  "sidecar>=0.7.0",
  "simplejpeg>=1.8.2",
]
optional-dependencies.migration = [
  "libcst>=1.8.2",
]
urls.Changelog = "https://github.com/ansys/pystk/blob/main/doc/source/changelog.rst"
urls.Discussions = "https://github.com/ansys/pystk/discussions"
urls.Documentation = "https://stk.docs.pyansys.com/"
urls.Homepage = "https://www.ansys.com/products/missions/ansys-stk"
urls.Issues = "https://github.com/ansys/pystk/issues"
urls.Source = "https://github.com/ansys/pystk"
# NOTE: The `project.optional-dependencies` section is used to define optional
# dependencies that users can install to enable additional features.
# NOTE: The `dependency-groups` section is used to define groups of dependencies
# only available when a developer clones the repository and installs the package
# for local development.
scripts.pystk-migration-assistant = "ansys.stk.core.tools.api_migration_assistant.api_migration_assistant:main"

[dependency-groups]
vulnerabilities = [
  "bandit[toml]==1.9.2",
  "safety==3.7.0",
  "typer==0.20.0",
]
tests = [
  "numpy==2.2.6",
  "parameterized==0.9.0",
  "pytest==9.0.1",
  "pytest-cov==7.0.0",
  "pytest-mpl==0.18.0",
  "pytz==2025.2",
  "scipy==1.15.3",
]
doc = [
  "ansys-sphinx-theme==1.6.3",
  "build==1.3.0",
  "ipykernel==6.31.0",
  "jupyter-server==2.17.0",
  "jupyterlab==4.5.0",
  "jupytext==1.18.1",
  "libcst==1.8.6",
  "matplotlib==3.10.7",
  "myst-parser==4.0.1",
  "nbconvert==7.16.6",
  "nbsphinx==0.9.8",
  "numpydoc==1.9.0",
  "pandas==2.3.3",
  "plotly==6.5.0",
  "scipy==1.15.3",
  "sphinx==8.2.3",
  "sphinx-copybutton==0.5.2",
  "sphinx-design==0.6.1",
  "sphinx-jinja==2.0.2",
  "sphinxcontrib-jquery==4.1",
  "sphinxcontrib-mermaid==1.1.0",
  "toml==0.10.2",
]
docstyle = [
  "rst2html==2020.7.4",
  "vale==3.13.0.0",
]

[tool.flit.module]
name = "ansys.stk"

[tool.ruff]
line-length = 120
extend-exclude = [
  "doc/source/conf.py",
  "src/ansys/stk/core/internal/*.py",
  "tests/**/*.py",
]

# TODO: the following configuration has no effect, see issue
# https://github.com/codespell-project/codespell/issues/2375
# At the moment, all codespell configuration is done in the pre-commit file.
# Run: `pre-commit run codespell --all-files --show-diff-on-failure` to recreate
# the conditions under which codespell runs during CI/CD.
# [tool.codespell]
# skip = './src/ansys/stk/core/internal,./tests,./doc/_build,./doc/styles'
# ignore-words = "./doc/styles/config/vocabularies/ANSYS/accept.txt"
lint.select = [
  "D",   # pydocstyle, see https://beta.ruff.rs/docs/rules/#pydocstyle-d
  "E",   # pycodestyle, see https://beta.ruff.rs/docs/rules/#pycodestyle-e-w
  "F",   # pyflakes, see https://beta.ruff.rs/docs/rules/#pyflakes-f
  "I",   # isort, see https://beta.ruff.rs/docs/rules/#isort-i
  "N",   # pep8-naming, see https://beta.ruff.rs/docs/rules/#pep8-naming-n
  "PTH", # flake8-use-pathlib, https://beta.ruff.rs/docs/rules/#flake8-use-pathlib-pth
  "PYI", # flake8-pyi, see https://docs.astral.sh/ruff/rules/#flake8-pyi-pyi
  "TD",  # flake8-todos, https://docs.astral.sh/ruff/rules/#flake8-todos-td
]
lint.ignore = [
  "D204",  # One blank line required after class docstring
  "D212",  # Multi-line docstring summary should start at the first line
  "D400",  # First line should end with a period
  "E501",  # Line too long. Ignoring this so "ruff.formatter" manages line length.
  "E743",  # Ambiguous function name. N802 and Python naming restrictions ensure unambiguous names.
  "F821",  # Undefined name. PyFlakes can not handle forward reference annotations. Using flake8-pyi instead.
  "TD002", # Missing author in TODOs comment
]
lint.isort.combine-as-imports = true
lint.isort.force-sort-within-sections = true
lint.isort.known-first-party = [ "ansys" ]
# [tool.ruff.format]
# quote-style = "double"
# indent-style = "tab"
# Ignore overridden ast/libcst functions
lint.pep8-naming.extend-ignore-names = [ "leave_*", "visit_*" ]
# Settings: https://docs.astral.sh/ruff/settings/#lintpydocstyle
lint.pydocstyle.convention = "numpy"

[tool.coverage.paths]
source = [
  "src",
]

[tool.coverage.run]
branch = true
source = [ "src/ansys/stk" ]
relative_files = true

[tool.coverage.report]
show_missing = true

[tool.towncrier]
package = "ansys.stk.core"
directory = "doc/source/changelog"
filename = "doc/source/changelog.rst"
start_string = ".. towncrier release notes start\n"
template = "doc/source/changelog/template"
title_format = "`{version} <https://github.com/ansys/pystk/releases/tag/v{version}>`_ - {project_date}"
issue_format = "`#{issue} <https://github.com/ansys/pystk/pull/{issue}>`_"

[[tool.towncrier.type]]
directory = "added"
name = "Added"
showcontent = true

[[tool.towncrier.type]]
directory = "dependencies"
name = "Dependencies"
showcontent = true

[[tool.towncrier.type]]
directory = "documentation"
name = "Documentation"
showcontent = true

[[tool.towncrier.type]]
directory = "fixed"
name = "Fixed"
showcontent = true

[[tool.towncrier.type]]
directory = "maintenance"
name = "Maintenance"
showcontent = true

[[tool.towncrier.type]]
directory = "miscellaneous"
name = "Miscellaneous"
showcontent = true

[[tool.towncrier.type]]
directory = "test"
name = "Test"
showcontent = true
